!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.uxpinEngine=f()}}(function(){var define;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof require&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof require&&require,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){(function(global){var _gsScope="undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window;(_gsScope._gsQueue||(_gsScope._gsQueue=[])).push(function(){"use strict";_gsScope._gsDefine("TweenMax",["core.Animation","core.SimpleTimeline","TweenLite"],function(Animation,SimpleTimeline,TweenLite){var _slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},_applyCycle=function(vars,targets,i){var p,val,alt=vars.cycle;for(p in alt)val=alt[p],vars[p]="function"==typeof val?val(i,targets[i]):val[i%val.length];delete vars.cycle},TweenMax=function(target,duration,vars){TweenLite.call(this,target,duration,vars),this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._dirty=!0,this.render=TweenMax.prototype.render},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_isSelector=TweenLiteInternals.isSelector,_isArray=TweenLiteInternals.isArray,p=TweenMax.prototype=TweenLite.to({},.1,{}),_blankArray=[];TweenMax.version="1.19.0",p.constructor=TweenMax,p.kill()._gc=!1,TweenMax.killTweensOf=TweenMax.killDelayedCallsTo=TweenLite.killTweensOf,TweenMax.getTweensOf=TweenLite.getTweensOf,TweenMax.lagSmoothing=TweenLite.lagSmoothing,TweenMax.ticker=TweenLite.ticker,TweenMax.render=TweenLite.render,p.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),TweenLite.prototype.invalidate.call(this)},p.updateTo=function(vars,resetDuration){var p,curRatio=this.ratio,immediate=this.vars.immediateRender||vars.immediateRender;resetDuration&&this._startTime<this._timeline._time&&(this._startTime=this._timeline._time,this._uncache(!1),this._gc?this._enabled(!0,!1):this._timeline.insert(this,this._startTime-this._delay));for(p in vars)this.vars[p]=vars[p];if(this._initted||immediate)if(resetDuration)this._initted=!1,immediate&&this.render(0,!0,!0);else if(this._gc&&this._enabled(!0,!1),this._notifyPluginsOfEnabled&&this._firstPT&&TweenLite._onPluginEvent("_onDisable",this),this._time/this._duration>.998){var prevTime=this._totalTime;this.render(0,!0,!1),this._initted=!1,this.render(prevTime,!0,!1)}else if(this._initted=!1,this._init(),this._time>0||immediate)for(var endValue,inv=1/(1-curRatio),pt=this._firstPT;pt;)endValue=pt.s+pt.c,pt.c*=inv,pt.s=endValue-pt.c,pt=pt._next;return this},p.render=function(time,suppressEvents,force){this._initted||0===this._duration&&this.vars.repeat&&this.invalidate();var isComplete,callback,pt,cycleDuration,r,type,pow,rawPrevTime,totalDur=this._dirty?this.totalDuration():this._totalDuration,prevTime=this._time,prevTotalTime=this._totalTime,prevCycle=this._cycle,duration=this._duration,prevRawPrevTime=this._rawPrevTime;if(time>=totalDur-1e-7?(this._totalTime=totalDur,this._cycle=this._repeat,this._yoyo&&0!==(1&this._cycle)?(this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0):(this._time=duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1),this._reversed||(isComplete=!0,callback="onComplete",force=force||this._timeline.autoRemoveChildren),0===duration&&(this._initted||!this.vars.lazy||force)&&(this._startTime===this._timeline._duration&&(time=0),(prevRawPrevTime<0||time<=0&&time>=-1e-7||prevRawPrevTime===_tinyNum&&"isPause"!==this.data)&&prevRawPrevTime!==time&&(force=!0,prevRawPrevTime>_tinyNum&&(callback="onReverseComplete")),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum)):time<1e-7?(this._totalTime=this._time=this._cycle=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==prevTotalTime||0===duration&&prevRawPrevTime>0)&&(callback="onReverseComplete",isComplete=this._reversed),time<0&&(this._active=!1,0===duration&&(this._initted||!this.vars.lazy||force)&&(prevRawPrevTime>=0&&(force=!0),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum)),this._initted||(force=!0)):(this._totalTime=this._time=time,0!==this._repeat&&(cycleDuration=duration+this._repeatDelay,this._cycle=this._totalTime/cycleDuration>>0,0!==this._cycle&&this._cycle===this._totalTime/cycleDuration&&prevTotalTime<=time&&this._cycle--,this._time=this._totalTime-this._cycle*cycleDuration,this._yoyo&&0!==(1&this._cycle)&&(this._time=duration-this._time),this._time>duration?this._time=duration:this._time<0&&(this._time=0)),this._easeType?(r=this._time/duration,type=this._easeType,pow=this._easePower,(1===type||3===type&&r>=.5)&&(r=1-r),3===type&&(r*=2),1===pow?r*=r:2===pow?r*=r*r:3===pow?r*=r*r*r:4===pow&&(r*=r*r*r*r),1===type?this.ratio=1-r:2===type?this.ratio=r:this._time/duration<.5?this.ratio=r/2:this.ratio=1-r/2):this.ratio=this._ease.getRatio(this._time/duration)),prevTime===this._time&&!force&&prevCycle===this._cycle)return void(prevTotalTime!==this._totalTime&&this._onUpdate&&(suppressEvents||this._callback("onUpdate")));if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!force&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=prevTime,this._totalTime=prevTotalTime,this._rawPrevTime=prevRawPrevTime,this._cycle=prevCycle,TweenLiteInternals.lazyTweens.push(this),void(this._lazy=[time,suppressEvents]);this._time&&!isComplete?this.ratio=this._ease.getRatio(this._time/duration):isComplete&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==prevTime&&time>=0&&(this._active=!0),0===prevTotalTime&&(2===this._initted&&time>0&&this._init(),this._startAt&&(time>=0?this._startAt.render(time,suppressEvents,force):callback||(callback="_dummyGS")),this.vars.onStart&&(0===this._totalTime&&0!==duration||suppressEvents||this._callback("onStart"))),pt=this._firstPT;pt;)pt.f?pt.t[pt.p](pt.c*this.ratio+pt.s):pt.t[pt.p]=pt.c*this.ratio+pt.s,pt=pt._next;this._onUpdate&&(time<0&&this._startAt&&this._startTime&&this._startAt.render(time,suppressEvents,force),suppressEvents||(this._totalTime!==prevTotalTime||callback)&&this._callback("onUpdate")),this._cycle!==prevCycle&&(suppressEvents||this._gc||this.vars.onRepeat&&this._callback("onRepeat")),callback&&(this._gc&&!force||(time<0&&this._startAt&&!this._onUpdate&&this._startTime&&this._startAt.render(time,suppressEvents,force),isComplete&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback),0===duration&&this._rawPrevTime===_tinyNum&&rawPrevTime!==_tinyNum&&(this._rawPrevTime=0)))},TweenMax.to=function(target,duration,vars){return new TweenMax(target,duration,vars)},TweenMax.from=function(target,duration,vars){return vars.runBackwards=!0,vars.immediateRender=0!=vars.immediateRender,new TweenMax(target,duration,vars)},TweenMax.fromTo=function(target,duration,fromVars,toVars){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,new TweenMax(target,duration,toVars)},TweenMax.staggerTo=TweenMax.allTo=function(targets,duration,vars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope){stagger=stagger||0;var l,copy,i,p,delay=0,a=[],finalComplete=function(){vars.onComplete&&vars.onComplete.apply(vars.onCompleteScope||this,arguments),onCompleteAll.apply(onCompleteAllScope||vars.callbackScope||this,onCompleteAllParams||_blankArray)},cycle=vars.cycle,fromCycle=vars.startAt&&vars.startAt.cycle;for(_isArray(targets)||("string"==typeof targets&&(targets=TweenLite.selector(targets)||targets),_isSelector(targets)&&(targets=_slice(targets))),targets=targets||[],stagger<0&&(targets=_slice(targets),targets.reverse(),stagger*=-1),l=targets.length-1,i=0;i<=l;i++){copy={};for(p in vars)copy[p]=vars[p];if(cycle&&(_applyCycle(copy,targets,i),null!=copy.duration&&(duration=copy.duration,delete copy.duration)),fromCycle){fromCycle=copy.startAt={};for(p in vars.startAt)fromCycle[p]=vars.startAt[p];_applyCycle(copy.startAt,targets,i)}copy.delay=delay+(copy.delay||0),i===l&&onCompleteAll&&(copy.onComplete=finalComplete),a[i]=new TweenMax(targets[i],duration,copy),delay+=stagger}return a},TweenMax.staggerFrom=TweenMax.allFrom=function(targets,duration,vars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return vars.runBackwards=!0,vars.immediateRender=0!=vars.immediateRender,TweenMax.staggerTo(targets,duration,vars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},TweenMax.staggerFromTo=TweenMax.allFromTo=function(targets,duration,fromVars,toVars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,TweenMax.staggerTo(targets,duration,toVars,stagger,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},TweenMax.delayedCall=function(delay,callback,params,scope,useFrames){return new TweenMax(callback,0,{delay:delay,onComplete:callback,onCompleteParams:params,callbackScope:scope,onReverseComplete:callback,onReverseCompleteParams:params,immediateRender:!1,useFrames:useFrames,overwrite:0})},TweenMax.set=function(target,vars){return new TweenMax(target,0,vars)},TweenMax.isTweening=function(target){return TweenLite.getTweensOf(target,!0).length>0};var _getChildrenOf=function(timeline,includeTimelines){for(var a=[],cnt=0,tween=timeline._first;tween;)tween instanceof TweenLite?a[cnt++]=tween:(includeTimelines&&(a[cnt++]=tween),a=a.concat(_getChildrenOf(tween,includeTimelines)),cnt=a.length),tween=tween._next;return a},getAllTweens=TweenMax.getAllTweens=function(includeTimelines){return _getChildrenOf(Animation._rootTimeline,includeTimelines).concat(_getChildrenOf(Animation._rootFramesTimeline,includeTimelines))};TweenMax.killAll=function(complete,tweens,delayedCalls,timelines){null==tweens&&(tweens=!0),null==delayedCalls&&(delayedCalls=!0);var isDC,tween,i,a=getAllTweens(0!=timelines),l=a.length,allTrue=tweens&&delayedCalls&&timelines;for(i=0;i<l;i++)tween=a[i],(allTrue||tween instanceof SimpleTimeline||(isDC=tween.target===tween.vars.onComplete)&&delayedCalls||tweens&&!isDC)&&(complete?tween.totalTime(tween._reversed?0:tween.totalDuration()):tween._enabled(!1,!1))},TweenMax.killChildTweensOf=function(parent,complete){if(null!=parent){var a,curParent,p,i,l,tl=TweenLiteInternals.tweenLookup;if("string"==typeof parent&&(parent=TweenLite.selector(parent)||parent),_isSelector(parent)&&(parent=_slice(parent)),_isArray(parent))for(i=parent.length;--i>-1;)TweenMax.killChildTweensOf(parent[i],complete);else{a=[];for(p in tl)for(curParent=tl[p].target.parentNode;curParent;)curParent===parent&&(a=a.concat(tl[p].tweens)),curParent=curParent.parentNode;for(l=a.length,i=0;i<l;i++)complete&&a[i].totalTime(a[i].totalDuration()),a[i]._enabled(!1,!1)}}};var _changePause=function(pause,tweens,delayedCalls,timelines){tweens=tweens!==!1,delayedCalls=delayedCalls!==!1,timelines=timelines!==!1;for(var isDC,tween,a=getAllTweens(timelines),allTrue=tweens&&delayedCalls&&timelines,i=a.length;--i>-1;)tween=a[i],(allTrue||tween instanceof SimpleTimeline||(isDC=tween.target===tween.vars.onComplete)&&delayedCalls||tweens&&!isDC)&&tween.paused(pause)};return TweenMax.pauseAll=function(tweens,delayedCalls,timelines){_changePause(!0,tweens,delayedCalls,timelines)},TweenMax.resumeAll=function(tweens,delayedCalls,timelines){_changePause(!1,tweens,delayedCalls,timelines)},TweenMax.globalTimeScale=function(value){var tl=Animation._rootTimeline,t=TweenLite.ticker.time;return arguments.length?(value=value||_tinyNum,tl._startTime=t-(t-tl._startTime)*tl._timeScale/value,tl=Animation._rootFramesTimeline,t=TweenLite.ticker.frame,tl._startTime=t-(t-tl._startTime)*tl._timeScale/value,tl._timeScale=Animation._rootTimeline._timeScale=value,value):tl._timeScale},p.progress=function(value,suppressEvents){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-value:value)+this._cycle*(this._duration+this._repeatDelay),suppressEvents):this._time/this.duration()},p.totalProgress=function(value,suppressEvents){return arguments.length?this.totalTime(this.totalDuration()*value,suppressEvents):this._totalTime/this.totalDuration()},p.time=function(value,suppressEvents){return arguments.length?(this._dirty&&this.totalDuration(),value>this._duration&&(value=this._duration),this._yoyo&&0!==(1&this._cycle)?value=this._duration-value+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(value+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(value,suppressEvents)):this._time},p.duration=function(value){return arguments.length?Animation.prototype.duration.call(this,value):this._duration},p.totalDuration=function(value){return arguments.length?this._repeat===-1?this:this.duration((value-this._repeat*this._repeatDelay)/(this._repeat+1)):(this._dirty&&(this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat,this._dirty=!1),this._totalDuration)},p.repeat=function(value){return arguments.length?(this._repeat=value,this._uncache(!0)):this._repeat},p.repeatDelay=function(value){return arguments.length?(this._repeatDelay=value,this._uncache(!0)):this._repeatDelay},p.yoyo=function(value){return arguments.length?(this._yoyo=value,this):this._yoyo},TweenMax},!0),_gsScope._gsDefine("TimelineLite",["core.Animation","core.SimpleTimeline","TweenLite"],function(Animation,SimpleTimeline,TweenLite){var TimelineLite=function(vars){SimpleTimeline.call(this,vars),this._labels={},this.autoRemoveChildren=this.vars.autoRemoveChildren===!0,this.smoothChildTiming=this.vars.smoothChildTiming===!0,this._sortChildren=!0,this._onUpdate=this.vars.onUpdate;var val,p,v=this.vars;for(p in v)val=v[p],_isArray(val)&&val.join("").indexOf("{self}")!==-1&&(v[p]=this._swapSelfInParams(val));_isArray(v.tweens)&&this.add(v.tweens,0,v.align,v.stagger)},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_internals=TimelineLite._internals={},_isSelector=TweenLiteInternals.isSelector,_isArray=TweenLiteInternals.isArray,_lazyTweens=TweenLiteInternals.lazyTweens,_lazyRender=TweenLiteInternals.lazyRender,_globals=_gsScope._gsDefine.globals,_copy=function(vars){var p,copy={};for(p in vars)copy[p]=vars[p];return copy},_applyCycle=function(vars,targets,i){var p,val,alt=vars.cycle;for(p in alt)val=alt[p],vars[p]="function"==typeof val?val.call(targets[i],i):val[i%val.length];delete vars.cycle},_pauseCallback=_internals.pauseCallback=function(){},_slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},p=TimelineLite.prototype=new SimpleTimeline;return TimelineLite.version="1.19.0",p.constructor=TimelineLite,p.kill()._gc=p._forcingPlayhead=p._hasPause=!1,p.to=function(target,duration,vars,position){var Engine=vars.repeat&&_globals.TweenMax||TweenLite;return duration?this.add(new Engine(target,duration,vars),position):this.set(target,vars,position)},p.from=function(target,duration,vars,position){return this.add((vars.repeat&&_globals.TweenMax||TweenLite).from(target,duration,vars),position)},p.fromTo=function(target,duration,fromVars,toVars,position){var Engine=toVars.repeat&&_globals.TweenMax||TweenLite;return duration?this.add(Engine.fromTo(target,duration,fromVars,toVars),position):this.set(target,toVars,position)},p.staggerTo=function(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){var copy,i,tl=new TimelineLite({onComplete:onCompleteAll,onCompleteParams:onCompleteAllParams,callbackScope:onCompleteAllScope,smoothChildTiming:this.smoothChildTiming}),cycle=vars.cycle;for("string"==typeof targets&&(targets=TweenLite.selector(targets)||targets),targets=targets||[],_isSelector(targets)&&(targets=_slice(targets)),stagger=stagger||0,stagger<0&&(targets=_slice(targets),targets.reverse(),stagger*=-1),i=0;i<targets.length;i++)copy=_copy(vars),copy.startAt&&(copy.startAt=_copy(copy.startAt),copy.startAt.cycle&&_applyCycle(copy.startAt,targets,i)),cycle&&(_applyCycle(copy,targets,i),null!=copy.duration&&(duration=copy.duration,delete copy.duration)),tl.to(targets[i],duration,copy,i*stagger);return this.add(tl,position)},p.staggerFrom=function(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return vars.immediateRender=0!=vars.immediateRender,vars.runBackwards=!0,this.staggerTo(targets,duration,vars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},p.staggerFromTo=function(targets,duration,fromVars,toVars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,this.staggerTo(targets,duration,toVars,stagger,position,onCompleteAll,onCompleteAllParams,onCompleteAllScope)},p.call=function(callback,params,scope,position){return this.add(TweenLite.delayedCall(0,callback,params,scope),position)},p.set=function(target,vars,position){return position=this._parseTimeOrLabel(position,0,!0),null==vars.immediateRender&&(vars.immediateRender=position===this._time&&!this._paused),this.add(new TweenLite(target,0,vars),position)},TimelineLite.exportRoot=function(vars,ignoreDelayedCalls){vars=vars||{},null==vars.smoothChildTiming&&(vars.smoothChildTiming=!0);var tween,next,tl=new TimelineLite(vars),root=tl._timeline;for(null==ignoreDelayedCalls&&(ignoreDelayedCalls=!0),root._remove(tl,!0),tl._startTime=0,tl._rawPrevTime=tl._time=tl._totalTime=root._time,tween=root._first;tween;)next=tween._next,ignoreDelayedCalls&&tween instanceof TweenLite&&tween.target===tween.vars.onComplete||tl.add(tween,tween._startTime-tween._delay),tween=next;return root.add(tl,0),tl},p.add=function(value,position,align,stagger){var curTime,l,i,child,tl,beforeRawTime;if("number"!=typeof position&&(position=this._parseTimeOrLabel(position,0,!0,value)),!(value instanceof Animation)){if(value instanceof Array||value&&value.push&&_isArray(value)){for(align=align||"normal",stagger=stagger||0,curTime=position,l=value.length,i=0;i<l;i++)_isArray(child=value[i])&&(child=new TimelineLite({tweens:child})),this.add(child,curTime),"string"!=typeof child&&"function"!=typeof child&&("sequence"===align?curTime=child._startTime+child.totalDuration()/child._timeScale:"start"===align&&(child._startTime-=child.delay())),curTime+=stagger;return this._uncache(!0)}if("string"==typeof value)return this.addLabel(value,position);if("function"!=typeof value)throw"Cannot add "+value+" into the timeline; it is not a tween, timeline, function, or string.";value=TweenLite.delayedCall(0,value)}if(SimpleTimeline.prototype.add.call(this,value,position),(this._gc||this._time===this._duration)&&!this._paused&&this._duration<this.duration())for(tl=this,beforeRawTime=tl.rawTime()>value._startTime;tl._timeline;)beforeRawTime&&tl._timeline.smoothChildTiming?tl.totalTime(tl._totalTime,!0):tl._gc&&tl._enabled(!0,!1),tl=tl._timeline;return this},p.remove=function(value){if(value instanceof Animation){this._remove(value,!1);var tl=value._timeline=value.vars.useFrames?Animation._rootFramesTimeline:Animation._rootTimeline;return value._startTime=(value._paused?value._pauseTime:tl._time)-(value._reversed?value.totalDuration()-value._totalTime:value._totalTime)/value._timeScale,this}if(value instanceof Array||value&&value.push&&_isArray(value)){for(var i=value.length;--i>-1;)this.remove(value[i]);return this}return"string"==typeof value?this.removeLabel(value):this.kill(null,value)},p._remove=function(tween,skipDisable){SimpleTimeline.prototype._remove.call(this,tween,skipDisable);var last=this._last;return last?this._time>last._startTime+last._totalDuration/last._timeScale&&(this._time=this.duration(),this._totalTime=this._totalDuration):this._time=this._totalTime=this._duration=this._totalDuration=0,this},p.append=function(value,offsetOrLabel){return this.add(value,this._parseTimeOrLabel(null,offsetOrLabel,!0,value))},p.insert=p.insertMultiple=function(value,position,align,stagger){return this.add(value,position||0,align,stagger)},p.appendMultiple=function(tweens,offsetOrLabel,align,stagger){return this.add(tweens,this._parseTimeOrLabel(null,offsetOrLabel,!0,tweens),align,stagger)},p.addLabel=function(label,position){return this._labels[label]=this._parseTimeOrLabel(position),this},p.addPause=function(position,callback,params,scope){var t=TweenLite.delayedCall(0,_pauseCallback,params,scope||this);return t.vars.onComplete=t.vars.onReverseComplete=callback,t.data="isPause",this._hasPause=!0,this.add(t,position)},p.removeLabel=function(label){return delete this._labels[label],this},p.getLabelTime=function(label){return null!=this._labels[label]?this._labels[label]:-1},p._parseTimeOrLabel=function(timeOrLabel,offsetOrLabel,appendIfAbsent,ignore){var i;if(ignore instanceof Animation&&ignore.timeline===this)this.remove(ignore);else if(ignore&&(ignore instanceof Array||ignore.push&&_isArray(ignore)))for(i=ignore.length;--i>-1;)ignore[i]instanceof Animation&&ignore[i].timeline===this&&this.remove(ignore[i]);if("string"==typeof offsetOrLabel)return this._parseTimeOrLabel(offsetOrLabel,appendIfAbsent&&"number"==typeof timeOrLabel&&null==this._labels[offsetOrLabel]?timeOrLabel-this.duration():0,appendIfAbsent);if(offsetOrLabel=offsetOrLabel||0,"string"!=typeof timeOrLabel||!isNaN(timeOrLabel)&&null==this._labels[timeOrLabel])null==timeOrLabel&&(timeOrLabel=this.duration());else{if(i=timeOrLabel.indexOf("="),i===-1)return null==this._labels[timeOrLabel]?appendIfAbsent?this._labels[timeOrLabel]=this.duration()+offsetOrLabel:offsetOrLabel:this._labels[timeOrLabel]+offsetOrLabel;offsetOrLabel=parseInt(timeOrLabel.charAt(i-1)+"1",10)*Number(timeOrLabel.substr(i+1)),timeOrLabel=i>1?this._parseTimeOrLabel(timeOrLabel.substr(0,i-1),0,appendIfAbsent):this.duration()}return Number(timeOrLabel)+offsetOrLabel},p.seek=function(position,suppressEvents){return this.totalTime("number"==typeof position?position:this._parseTimeOrLabel(position),suppressEvents!==!1)},p.stop=function(){return this.paused(!0)},p.gotoAndPlay=function(position,suppressEvents){return this.play(position,suppressEvents)},p.gotoAndStop=function(position,suppressEvents){return this.pause(position,suppressEvents)},p.render=function(time,suppressEvents,force){this._gc&&this._enabled(!0,!1);var tween,isComplete,next,callback,internalForce,pauseTween,curTime,totalDur=this._dirty?this.totalDuration():this._totalDuration,prevTime=this._time,prevStart=this._startTime,prevTimeScale=this._timeScale,prevPaused=this._paused;if(time>=totalDur-1e-7)this._totalTime=this._time=totalDur,this._reversed||this._hasPausedChild()||(isComplete=!0,callback="onComplete",internalForce=!!this._timeline.autoRemoveChildren,0===this._duration&&(time<=0&&time>=-1e-7||this._rawPrevTime<0||this._rawPrevTime===_tinyNum)&&this._rawPrevTime!==time&&this._first&&(internalForce=!0,this._rawPrevTime>_tinyNum&&(callback="onReverseComplete"))),this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,time=totalDur+1e-4;else if(time<1e-7)if(this._totalTime=this._time=0,(0!==prevTime||0===this._duration&&this._rawPrevTime!==_tinyNum&&(this._rawPrevTime>0||time<0&&this._rawPrevTime>=0))&&(callback="onReverseComplete",isComplete=this._reversed),time<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(internalForce=isComplete=!0,callback="onReverseComplete"):this._rawPrevTime>=0&&this._first&&(internalForce=!0),this._rawPrevTime=time;else{if(this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,0===time&&isComplete)for(tween=this._first;tween&&0===tween._startTime;)tween._duration||(isComplete=!1),tween=tween._next;time=0,this._initted||(internalForce=!0)}else{if(this._hasPause&&!this._forcingPlayhead&&!suppressEvents){if(time>=prevTime)for(tween=this._first;tween&&tween._startTime<=time&&!pauseTween;)tween._duration||"isPause"!==tween.data||tween.ratio||0===tween._startTime&&0===this._rawPrevTime||(pauseTween=tween),tween=tween._next;else for(tween=this._last;tween&&tween._startTime>=time&&!pauseTween;)tween._duration||"isPause"===tween.data&&tween._rawPrevTime>0&&(pauseTween=tween),tween=tween._prev;pauseTween&&(this._time=time=pauseTween._startTime,this._totalTime=time+this._cycle*(this._totalDuration+this._repeatDelay))}this._totalTime=this._time=this._rawPrevTime=time}if(this._time!==prevTime&&this._first||force||internalForce||pauseTween){if(this._initted||(this._initted=!0),this._active||!this._paused&&this._time!==prevTime&&time>0&&(this._active=!0),0===prevTime&&this.vars.onStart&&(0===this._time&&this._duration||suppressEvents||this._callback("onStart")),curTime=this._time,curTime>=prevTime)for(tween=this._first;tween&&(next=tween._next,curTime===this._time&&(!this._paused||prevPaused));)(tween._active||tween._startTime<=curTime&&!tween._paused&&!tween._gc)&&(pauseTween===tween&&this.pause(),tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next;else for(tween=this._last;tween&&(next=tween._prev,curTime===this._time&&(!this._paused||prevPaused));){if(tween._active||tween._startTime<=prevTime&&!tween._paused&&!tween._gc){if(pauseTween===tween){for(pauseTween=tween._prev;pauseTween&&pauseTween.endTime()>this._time;)pauseTween.render(pauseTween._reversed?pauseTween.totalDuration()-(time-pauseTween._startTime)*pauseTween._timeScale:(time-pauseTween._startTime)*pauseTween._timeScale,suppressEvents,force),pauseTween=pauseTween._prev;pauseTween=null,this.pause()}tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)}tween=next}this._onUpdate&&(suppressEvents||(_lazyTweens.length&&_lazyRender(),this._callback("onUpdate"))),callback&&(this._gc||prevStart!==this._startTime&&prevTimeScale===this._timeScale||(0===this._time||totalDur>=this.totalDuration())&&(isComplete&&(_lazyTweens.length&&_lazyRender(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback)))}},p._hasPausedChild=function(){for(var tween=this._first;tween;){if(tween._paused||tween instanceof TimelineLite&&tween._hasPausedChild())return!0;tween=tween._next}return!1},p.getChildren=function(nested,tweens,timelines,ignoreBeforeTime){ignoreBeforeTime=ignoreBeforeTime||-9999999999;for(var a=[],tween=this._first,cnt=0;tween;)tween._startTime<ignoreBeforeTime||(tween instanceof TweenLite?tweens!==!1&&(a[cnt++]=tween):(timelines!==!1&&(a[cnt++]=tween),nested!==!1&&(a=a.concat(tween.getChildren(!0,tweens,timelines)),cnt=a.length))),tween=tween._next;return a},p.getTweensOf=function(target,nested){var tweens,i,disabled=this._gc,a=[],cnt=0;for(disabled&&this._enabled(!0,!0),tweens=TweenLite.getTweensOf(target),i=tweens.length;--i>-1;)(tweens[i].timeline===this||nested&&this._contains(tweens[i]))&&(a[cnt++]=tweens[i]);return disabled&&this._enabled(!1,!0),a},p.recent=function(){return this._recent},p._contains=function(tween){for(var tl=tween.timeline;tl;){if(tl===this)return!0;tl=tl.timeline}return!1},p.shiftChildren=function(amount,adjustLabels,ignoreBeforeTime){ignoreBeforeTime=ignoreBeforeTime||0;for(var p,tween=this._first,labels=this._labels;tween;)tween._startTime>=ignoreBeforeTime&&(tween._startTime+=amount),tween=tween._next;if(adjustLabels)for(p in labels)labels[p]>=ignoreBeforeTime&&(labels[p]+=amount);return this._uncache(!0)},p._kill=function(vars,target){if(!vars&&!target)return this._enabled(!1,!1);for(var tweens=target?this.getTweensOf(target):this.getChildren(!0,!0,!1),i=tweens.length,changed=!1;--i>-1;)tweens[i]._kill(vars,target)&&(changed=!0);return changed},p.clear=function(labels){var tweens=this.getChildren(!1,!0,!0),i=tweens.length;for(this._time=this._totalTime=0;--i>-1;)tweens[i]._enabled(!1,!1);return labels!==!1&&(this._labels={}),this._uncache(!0)},p.invalidate=function(){for(var tween=this._first;tween;)tween.invalidate(),tween=tween._next;return Animation.prototype.invalidate.call(this)},p._enabled=function(enabled,ignoreTimeline){if(enabled===this._gc)for(var tween=this._first;tween;)tween._enabled(enabled,!0),tween=tween._next;return SimpleTimeline.prototype._enabled.call(this,enabled,ignoreTimeline)},p.totalTime=function(time,suppressEvents,uncapped){this._forcingPlayhead=!0;var val=Animation.prototype.totalTime.apply(this,arguments);return this._forcingPlayhead=!1,val},p.duration=function(value){return arguments.length?(0!==this.duration()&&0!==value&&this.timeScale(this._duration/value),this):(this._dirty&&this.totalDuration(),this._duration)},p.totalDuration=function(value){if(!arguments.length){if(this._dirty){for(var prev,end,max=0,tween=this._last,prevStart=999999999999;tween;)prev=tween._prev,tween._dirty&&tween.totalDuration(),tween._startTime>prevStart&&this._sortChildren&&!tween._paused?this.add(tween,tween._startTime-tween._delay):prevStart=tween._startTime,tween._startTime<0&&!tween._paused&&(max-=tween._startTime,this._timeline.smoothChildTiming&&(this._startTime+=tween._startTime/this._timeScale),this.shiftChildren(-tween._startTime,!1,-9999999999),prevStart=0),end=tween._startTime+tween._totalDuration/tween._timeScale,end>max&&(max=end),tween=prev;this._duration=this._totalDuration=max,this._dirty=!1}return this._totalDuration}return value&&this.totalDuration()?this.timeScale(this._totalDuration/value):this},p.paused=function(value){if(!value)for(var tween=this._first,time=this._time;tween;)tween._startTime===time&&"isPause"===tween.data&&(tween._rawPrevTime=0),tween=tween._next;return Animation.prototype.paused.apply(this,arguments)},p.usesFrames=function(){for(var tl=this._timeline;tl._timeline;)tl=tl._timeline;return tl===Animation._rootFramesTimeline},p.rawTime=function(){return this._paused?this._totalTime:(this._timeline.rawTime()-this._startTime)*this._timeScale},TimelineLite},!0),_gsScope._gsDefine("TimelineMax",["TimelineLite","TweenLite","easing.Ease"],function(TimelineLite,TweenLite,Ease){var TimelineMax=function(vars){TimelineLite.call(this,vars),this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._cycle=0,this._yoyo=this.vars.yoyo===!0,this._dirty=!0},_tinyNum=1e-10,TweenLiteInternals=TweenLite._internals,_lazyTweens=TweenLiteInternals.lazyTweens,_lazyRender=TweenLiteInternals.lazyRender,_globals=_gsScope._gsDefine.globals,_easeNone=new Ease(null,null,1,0),p=TimelineMax.prototype=new TimelineLite;return p.constructor=TimelineMax,p.kill()._gc=!1,TimelineMax.version="1.19.0",p.invalidate=function(){return this._yoyo=this.vars.yoyo===!0,this._repeat=this.vars.repeat||0,this._repeatDelay=this.vars.repeatDelay||0,this._uncache(!0),TimelineLite.prototype.invalidate.call(this)},p.addCallback=function(callback,position,params,scope){return this.add(TweenLite.delayedCall(0,callback,params,scope),position)},p.removeCallback=function(callback,position){if(callback)if(null==position)this._kill(null,callback);else for(var a=this.getTweensOf(callback,!1),i=a.length,time=this._parseTimeOrLabel(position);--i>-1;)a[i]._startTime===time&&a[i]._enabled(!1,!1);
return this},p.removePause=function(position){return this.removeCallback(TimelineLite._internals.pauseCallback,position)},p.tweenTo=function(position,vars){vars=vars||{};var duration,p,t,copy={ease:_easeNone,useFrames:this.usesFrames(),immediateRender:!1},Engine=vars.repeat&&_globals.TweenMax||TweenLite;for(p in vars)copy[p]=vars[p];return copy.time=this._parseTimeOrLabel(position),duration=Math.abs(Number(copy.time)-this._time)/this._timeScale||.001,t=new Engine(this,duration,copy),copy.onStart=function(){t.target.paused(!0),t.vars.time!==t.target.time()&&duration===t.duration()&&t.duration(Math.abs(t.vars.time-t.target.time())/t.target._timeScale),vars.onStart&&t._callback("onStart")},t},p.tweenFromTo=function(fromPosition,toPosition,vars){vars=vars||{},fromPosition=this._parseTimeOrLabel(fromPosition),vars.startAt={onComplete:this.seek,onCompleteParams:[fromPosition],callbackScope:this},vars.immediateRender=vars.immediateRender!==!1;var t=this.tweenTo(toPosition,vars);return t.duration(Math.abs(t.vars.time-fromPosition)/this._timeScale||.001)},p.render=function(time,suppressEvents,force){this._gc&&this._enabled(!0,!1);var tween,isComplete,next,callback,internalForce,cycleDuration,pauseTween,curTime,totalDur=this._dirty?this.totalDuration():this._totalDuration,dur=this._duration,prevTime=this._time,prevTotalTime=this._totalTime,prevStart=this._startTime,prevTimeScale=this._timeScale,prevRawPrevTime=this._rawPrevTime,prevPaused=this._paused,prevCycle=this._cycle;if(time>=totalDur-1e-7)this._locked||(this._totalTime=totalDur,this._cycle=this._repeat),this._reversed||this._hasPausedChild()||(isComplete=!0,callback="onComplete",internalForce=!!this._timeline.autoRemoveChildren,0===this._duration&&(time<=0&&time>=-1e-7||prevRawPrevTime<0||prevRawPrevTime===_tinyNum)&&prevRawPrevTime!==time&&this._first&&(internalForce=!0,prevRawPrevTime>_tinyNum&&(callback="onReverseComplete"))),this._rawPrevTime=this._duration||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,this._yoyo&&0!==(1&this._cycle)?this._time=time=0:(this._time=dur,time=dur+1e-4);else if(time<1e-7)if(this._locked||(this._totalTime=this._cycle=0),this._time=0,(0!==prevTime||0===dur&&prevRawPrevTime!==_tinyNum&&(prevRawPrevTime>0||time<0&&prevRawPrevTime>=0)&&!this._locked)&&(callback="onReverseComplete",isComplete=this._reversed),time<0)this._active=!1,this._timeline.autoRemoveChildren&&this._reversed?(internalForce=isComplete=!0,callback="onReverseComplete"):prevRawPrevTime>=0&&this._first&&(internalForce=!0),this._rawPrevTime=time;else{if(this._rawPrevTime=dur||!suppressEvents||time||this._rawPrevTime===time?time:_tinyNum,0===time&&isComplete)for(tween=this._first;tween&&0===tween._startTime;)tween._duration||(isComplete=!1),tween=tween._next;time=0,this._initted||(internalForce=!0)}else if(0===dur&&prevRawPrevTime<0&&(internalForce=!0),this._time=this._rawPrevTime=time,this._locked||(this._totalTime=time,0!==this._repeat&&(cycleDuration=dur+this._repeatDelay,this._cycle=this._totalTime/cycleDuration>>0,0!==this._cycle&&this._cycle===this._totalTime/cycleDuration&&prevTotalTime<=time&&this._cycle--,this._time=this._totalTime-this._cycle*cycleDuration,this._yoyo&&0!==(1&this._cycle)&&(this._time=dur-this._time),this._time>dur?(this._time=dur,time=dur+1e-4):this._time<0?this._time=time=0:time=this._time)),this._hasPause&&!this._forcingPlayhead&&!suppressEvents){if(time=this._time,time>=prevTime)for(tween=this._first;tween&&tween._startTime<=time&&!pauseTween;)tween._duration||"isPause"!==tween.data||tween.ratio||0===tween._startTime&&0===this._rawPrevTime||(pauseTween=tween),tween=tween._next;else for(tween=this._last;tween&&tween._startTime>=time&&!pauseTween;)tween._duration||"isPause"===tween.data&&tween._rawPrevTime>0&&(pauseTween=tween),tween=tween._prev;pauseTween&&(this._time=time=pauseTween._startTime,this._totalTime=time+this._cycle*(this._totalDuration+this._repeatDelay))}if(this._cycle!==prevCycle&&!this._locked){var backwards=this._yoyo&&0!==(1&prevCycle),wrap=backwards===(this._yoyo&&0!==(1&this._cycle)),recTotalTime=this._totalTime,recCycle=this._cycle,recRawPrevTime=this._rawPrevTime,recTime=this._time;if(this._totalTime=prevCycle*dur,this._cycle<prevCycle?backwards=!backwards:this._totalTime+=dur,this._time=prevTime,this._rawPrevTime=0===dur?prevRawPrevTime-1e-4:prevRawPrevTime,this._cycle=prevCycle,this._locked=!0,prevTime=backwards?0:dur,this.render(prevTime,suppressEvents,0===dur),suppressEvents||this._gc||this.vars.onRepeat&&this._callback("onRepeat"),prevTime!==this._time)return;if(wrap&&(prevTime=backwards?dur+1e-4:-1e-4,this.render(prevTime,!0,!1)),this._locked=!1,this._paused&&!prevPaused)return;this._time=recTime,this._totalTime=recTotalTime,this._cycle=recCycle,this._rawPrevTime=recRawPrevTime}if(!(this._time!==prevTime&&this._first||force||internalForce||pauseTween))return void(prevTotalTime!==this._totalTime&&this._onUpdate&&(suppressEvents||this._callback("onUpdate")));if(this._initted||(this._initted=!0),this._active||!this._paused&&this._totalTime!==prevTotalTime&&time>0&&(this._active=!0),0===prevTotalTime&&this.vars.onStart&&(0===this._totalTime&&this._totalDuration||suppressEvents||this._callback("onStart")),curTime=this._time,curTime>=prevTime)for(tween=this._first;tween&&(next=tween._next,curTime===this._time&&(!this._paused||prevPaused));)(tween._active||tween._startTime<=this._time&&!tween._paused&&!tween._gc)&&(pauseTween===tween&&this.pause(),tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next;else for(tween=this._last;tween&&(next=tween._prev,curTime===this._time&&(!this._paused||prevPaused));){if(tween._active||tween._startTime<=prevTime&&!tween._paused&&!tween._gc){if(pauseTween===tween){for(pauseTween=tween._prev;pauseTween&&pauseTween.endTime()>this._time;)pauseTween.render(pauseTween._reversed?pauseTween.totalDuration()-(time-pauseTween._startTime)*pauseTween._timeScale:(time-pauseTween._startTime)*pauseTween._timeScale,suppressEvents,force),pauseTween=pauseTween._prev;pauseTween=null,this.pause()}tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)}tween=next}this._onUpdate&&(suppressEvents||(_lazyTweens.length&&_lazyRender(),this._callback("onUpdate"))),callback&&(this._locked||this._gc||prevStart!==this._startTime&&prevTimeScale===this._timeScale||(0===this._time||totalDur>=this.totalDuration())&&(isComplete&&(_lazyTweens.length&&_lazyRender(),this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback)))},p.getActive=function(nested,tweens,timelines){null==nested&&(nested=!0),null==tweens&&(tweens=!0),null==timelines&&(timelines=!1);var i,tween,a=[],all=this.getChildren(nested,tweens,timelines),cnt=0,l=all.length;for(i=0;i<l;i++)tween=all[i],tween.isActive()&&(a[cnt++]=tween);return a},p.getLabelAfter=function(time){time||0!==time&&(time=this._time);var i,labels=this.getLabelsArray(),l=labels.length;for(i=0;i<l;i++)if(labels[i].time>time)return labels[i].name;return null},p.getLabelBefore=function(time){null==time&&(time=this._time);for(var labels=this.getLabelsArray(),i=labels.length;--i>-1;)if(labels[i].time<time)return labels[i].name;return null},p.getLabelsArray=function(){var p,a=[],cnt=0;for(p in this._labels)a[cnt++]={time:this._labels[p],name:p};return a.sort(function(a,b){return a.time-b.time}),a},p.progress=function(value,suppressEvents){return arguments.length?this.totalTime(this.duration()*(this._yoyo&&0!==(1&this._cycle)?1-value:value)+this._cycle*(this._duration+this._repeatDelay),suppressEvents):this._time/this.duration()},p.totalProgress=function(value,suppressEvents){return arguments.length?this.totalTime(this.totalDuration()*value,suppressEvents):this._totalTime/this.totalDuration()},p.totalDuration=function(value){return arguments.length?this._repeat!==-1&&value?this.timeScale(this.totalDuration()/value):this:(this._dirty&&(TimelineLite.prototype.totalDuration.call(this),this._totalDuration=this._repeat===-1?999999999999:this._duration*(this._repeat+1)+this._repeatDelay*this._repeat),this._totalDuration)},p.time=function(value,suppressEvents){return arguments.length?(this._dirty&&this.totalDuration(),value>this._duration&&(value=this._duration),this._yoyo&&0!==(1&this._cycle)?value=this._duration-value+this._cycle*(this._duration+this._repeatDelay):0!==this._repeat&&(value+=this._cycle*(this._duration+this._repeatDelay)),this.totalTime(value,suppressEvents)):this._time},p.repeat=function(value){return arguments.length?(this._repeat=value,this._uncache(!0)):this._repeat},p.repeatDelay=function(value){return arguments.length?(this._repeatDelay=value,this._uncache(!0)):this._repeatDelay},p.yoyo=function(value){return arguments.length?(this._yoyo=value,this):this._yoyo},p.currentLabel=function(value){return arguments.length?this.seek(value,!0):this.getLabelBefore(this._time+1e-8)},TimelineMax},!0),function(){var _RAD2DEG=180/Math.PI,_r1=[],_r2=[],_r3=[],_corProps={},_globals=_gsScope._gsDefine.globals,Segment=function(a,b,c,d){c===d&&(c=d-(d-b)/1e6),a===b&&(b=a+(c-a)/1e6),this.a=a,this.b=b,this.c=c,this.d=d,this.da=d-a,this.ca=c-a,this.ba=b-a},_correlate=",x,y,z,left,top,right,bottom,marginTop,marginLeft,marginRight,marginBottom,paddingLeft,paddingTop,paddingRight,paddingBottom,backgroundPosition,backgroundPosition_y,",cubicToQuadratic=function(a,b,c,d){var q1={a:a},q2={},q3={},q4={c:d},mab=(a+b)/2,mbc=(b+c)/2,mcd=(c+d)/2,mabc=(mab+mbc)/2,mbcd=(mbc+mcd)/2,m8=(mbcd-mabc)/8;return q1.b=mab+(a-mab)/4,q2.b=mabc+m8,q1.c=q2.a=(q1.b+q2.b)/2,q2.c=q3.a=(mabc+mbcd)/2,q3.b=mbcd-m8,q4.b=mcd+(d-mcd)/4,q3.c=q4.a=(q3.b+q4.b)/2,[q1,q2,q3,q4]},_calculateControlPoints=function(a,curviness,quad,basic,correlate){var i,p1,p2,p3,seg,m1,m2,mm,cp2,qb,r1,r2,tl,l=a.length-1,ii=0,cp1=a[0].a;for(i=0;i<l;i++)seg=a[ii],p1=seg.a,p2=seg.d,p3=a[ii+1].d,correlate?(r1=_r1[i],r2=_r2[i],tl=(r2+r1)*curviness*.25/(basic?.5:_r3[i]||.5),m1=p2-(p2-p1)*(basic?.5*curviness:0!==r1?tl/r1:0),m2=p2+(p3-p2)*(basic?.5*curviness:0!==r2?tl/r2:0),mm=p2-(m1+((m2-m1)*(3*r1/(r1+r2)+.5)/4||0))):(m1=p2-(p2-p1)*curviness*.5,m2=p2+(p3-p2)*curviness*.5,mm=p2-(m1+m2)/2),m1+=mm,m2+=mm,seg.c=cp2=m1,0!==i?seg.b=cp1:seg.b=cp1=seg.a+.6*(seg.c-seg.a),seg.da=p2-p1,seg.ca=cp2-p1,seg.ba=cp1-p1,quad?(qb=cubicToQuadratic(p1,cp1,cp2,p2),a.splice(ii,1,qb[0],qb[1],qb[2],qb[3]),ii+=4):ii++,cp1=m2;seg=a[ii],seg.b=cp1,seg.c=cp1+.4*(seg.d-cp1),seg.da=seg.d-seg.a,seg.ca=seg.c-seg.a,seg.ba=cp1-seg.a,quad&&(qb=cubicToQuadratic(seg.a,cp1,seg.c,seg.d),a.splice(ii,1,qb[0],qb[1],qb[2],qb[3]))},_parseAnchors=function(values,p,correlate,prepend){var l,i,p1,p2,p3,tmp,a=[];if(prepend)for(values=[prepend].concat(values),i=values.length;--i>-1;)"string"==typeof(tmp=values[i][p])&&"="===tmp.charAt(1)&&(values[i][p]=prepend[p]+Number(tmp.charAt(0)+tmp.substr(2)));if(l=values.length-2,l<0)return a[0]=new Segment(values[0][p],0,0,values[l<-1?0:1][p]),a;for(i=0;i<l;i++)p1=values[i][p],p2=values[i+1][p],a[i]=new Segment(p1,0,0,p2),correlate&&(p3=values[i+2][p],_r1[i]=(_r1[i]||0)+(p2-p1)*(p2-p1),_r2[i]=(_r2[i]||0)+(p3-p2)*(p3-p2));return a[i]=new Segment(values[i][p],0,0,values[i+1][p]),a},bezierThrough=function(values,curviness,quadratic,basic,correlate,prepend){var i,p,a,j,r,l,seamless,last,obj={},props=[],first=prepend||values[0];correlate="string"==typeof correlate?","+correlate+",":_correlate,null==curviness&&(curviness=1);for(p in values[0])props.push(p);if(values.length>1){for(last=values[values.length-1],seamless=!0,i=props.length;--i>-1;)if(p=props[i],Math.abs(first[p]-last[p])>.05){seamless=!1;break}seamless&&(values=values.concat(),prepend&&values.unshift(prepend),values.push(values[1]),prepend=values[values.length-3])}for(_r1.length=_r2.length=_r3.length=0,i=props.length;--i>-1;)p=props[i],_corProps[p]=correlate.indexOf(","+p+",")!==-1,obj[p]=_parseAnchors(values,p,_corProps[p],prepend);for(i=_r1.length;--i>-1;)_r1[i]=Math.sqrt(_r1[i]),_r2[i]=Math.sqrt(_r2[i]);if(!basic){for(i=props.length;--i>-1;)if(_corProps[p])for(a=obj[props[i]],l=a.length-1,j=0;j<l;j++)r=a[j+1].da/_r2[j]+a[j].da/_r1[j]||0,_r3[j]=(_r3[j]||0)+r*r;for(i=_r3.length;--i>-1;)_r3[i]=Math.sqrt(_r3[i])}for(i=props.length,j=quadratic?4:1;--i>-1;)p=props[i],a=obj[p],_calculateControlPoints(a,curviness,quadratic,basic,_corProps[p]),seamless&&(a.splice(0,j),a.splice(a.length-j,j));return obj},_parseBezierData=function(values,type,prepend){type=type||"soft";var a,b,c,d,cur,i,j,l,p,cnt,tmp,obj={},inc="cubic"===type?3:2,soft="soft"===type,props=[];if(soft&&prepend&&(values=[prepend].concat(values)),null==values||values.length<inc+1)throw"invalid Bezier data";for(p in values[0])props.push(p);for(i=props.length;--i>-1;){for(p=props[i],obj[p]=cur=[],cnt=0,l=values.length,j=0;j<l;j++)a=null==prepend?values[j][p]:"string"==typeof(tmp=values[j][p])&&"="===tmp.charAt(1)?prepend[p]+Number(tmp.charAt(0)+tmp.substr(2)):Number(tmp),soft&&j>1&&j<l-1&&(cur[cnt++]=(a+cur[cnt-2])/2),cur[cnt++]=a;for(l=cnt-inc+1,cnt=0,j=0;j<l;j+=inc)a=cur[j],b=cur[j+1],c=cur[j+2],d=2===inc?0:cur[j+3],cur[cnt++]=tmp=3===inc?new Segment(a,b,c,d):new Segment(a,(2*b+a)/3,(2*b+c)/3,c);cur.length=cnt}return obj},_addCubicLengths=function(a,steps,resolution){for(var d,d1,s,da,ca,ba,p,i,inv,bez,index,inc=1/resolution,j=a.length;--j>-1;)for(bez=a[j],s=bez.a,da=bez.d-s,ca=bez.c-s,ba=bez.b-s,d=d1=0,i=1;i<=resolution;i++)p=inc*i,inv=1-p,d=d1-(d1=(p*p*da+3*inv*(p*ca+inv*ba))*p),index=j*resolution+i-1,steps[index]=(steps[index]||0)+d*d},_parseLengthData=function(obj,resolution){resolution=resolution>>0||6;var p,i,l,index,a=[],lengths=[],d=0,total=0,threshold=resolution-1,segments=[],curLS=[];for(p in obj)_addCubicLengths(obj[p],a,resolution);for(l=a.length,i=0;i<l;i++)d+=Math.sqrt(a[i]),index=i%resolution,curLS[index]=d,index===threshold&&(total+=d,index=i/resolution>>0,segments[index]=curLS,lengths[index]=total,d=0,curLS=[]);return{length:total,lengths:lengths,segments:segments}},BezierPlugin=_gsScope._gsDefine.plugin({propName:"bezier",priority:-1,version:"1.3.7",API:2,global:!0,init:function(target,vars,tween){this._target=target,vars instanceof Array&&(vars={values:vars}),this._func={},this._mod={},this._props=[],this._timeRes=null==vars.timeResolution?6:parseInt(vars.timeResolution,10);var p,isFunc,i,j,prepend,values=vars.values||[],first={},second=values[0],autoRotate=vars.autoRotate||tween.vars.orientToBezier;this._autoRotate=autoRotate?autoRotate instanceof Array?autoRotate:[["x","y","rotation",autoRotate===!0?0:Number(autoRotate)||0]]:null;for(p in second)this._props.push(p);for(i=this._props.length;--i>-1;)p=this._props[i],this._overwriteProps.push(p),isFunc=this._func[p]="function"==typeof target[p],first[p]=isFunc?target[p.indexOf("set")||"function"!=typeof target["get"+p.substr(3)]?p:"get"+p.substr(3)]():parseFloat(target[p]),prepend||first[p]!==values[0][p]&&(prepend=first);if(this._beziers="cubic"!==vars.type&&"quadratic"!==vars.type&&"soft"!==vars.type?bezierThrough(values,isNaN(vars.curviness)?1:vars.curviness,!1,"thruBasic"===vars.type,vars.correlate,prepend):_parseBezierData(values,vars.type,first),this._segCount=this._beziers[p].length,this._timeRes){var ld=_parseLengthData(this._beziers,this._timeRes);this._length=ld.length,this._lengths=ld.lengths,this._segments=ld.segments,this._l1=this._li=this._s1=this._si=0,this._l2=this._lengths[0],this._curSeg=this._segments[0],this._s2=this._curSeg[0],this._prec=1/this._curSeg.length}if(autoRotate=this._autoRotate)for(this._initialRotations=[],autoRotate[0]instanceof Array||(this._autoRotate=autoRotate=[autoRotate]),i=autoRotate.length;--i>-1;){for(j=0;j<3;j++)p=autoRotate[i][j],this._func[p]="function"==typeof target[p]&&target[p.indexOf("set")||"function"!=typeof target["get"+p.substr(3)]?p:"get"+p.substr(3)];p=autoRotate[i][2],this._initialRotations[i]=(this._func[p]?this._func[p].call(this._target):this._target[p])||0,this._overwriteProps.push(p)}return this._startRatio=tween.vars.runBackwards?1:0,!0},set:function(v){var curIndex,inv,i,p,b,t,val,l,lengths,curSeg,segments=this._segCount,func=this._func,target=this._target,notStart=v!==this._startRatio;if(this._timeRes){if(lengths=this._lengths,curSeg=this._curSeg,v*=this._length,i=this._li,v>this._l2&&i<segments-1){for(l=segments-1;i<l&&(this._l2=lengths[++i])<=v;);this._l1=lengths[i-1],this._li=i,this._curSeg=curSeg=this._segments[i],this._s2=curSeg[this._s1=this._si=0]}else if(v<this._l1&&i>0){for(;i>0&&(this._l1=lengths[--i])>=v;);0===i&&v<this._l1?this._l1=0:i++,this._l2=lengths[i],this._li=i,this._curSeg=curSeg=this._segments[i],this._s1=curSeg[(this._si=curSeg.length-1)-1]||0,this._s2=curSeg[this._si]}if(curIndex=i,v-=this._l1,i=this._si,v>this._s2&&i<curSeg.length-1){for(l=curSeg.length-1;i<l&&(this._s2=curSeg[++i])<=v;);this._s1=curSeg[i-1],this._si=i}else if(v<this._s1&&i>0){for(;i>0&&(this._s1=curSeg[--i])>=v;);0===i&&v<this._s1?this._s1=0:i++,this._s2=curSeg[i],this._si=i}t=(i+(v-this._s1)/(this._s2-this._s1))*this._prec||0}else curIndex=v<0?0:v>=1?segments-1:segments*v>>0,t=(v-curIndex*(1/segments))*segments;for(inv=1-t,i=this._props.length;--i>-1;)p=this._props[i],b=this._beziers[p][curIndex],val=(t*t*b.da+3*inv*(t*b.ca+inv*b.ba))*t+b.a,this._mod[p]&&(val=this._mod[p](val,target)),func[p]?target[p](val):target[p]=val;if(this._autoRotate){var b2,x1,y1,x2,y2,add,conv,ar=this._autoRotate;for(i=ar.length;--i>-1;)p=ar[i][2],add=ar[i][3]||0,conv=ar[i][4]===!0?1:_RAD2DEG,b=this._beziers[ar[i][0]],b2=this._beziers[ar[i][1]],b&&b2&&(b=b[curIndex],b2=b2[curIndex],x1=b.a+(b.b-b.a)*t,x2=b.b+(b.c-b.b)*t,x1+=(x2-x1)*t,x2+=(b.c+(b.d-b.c)*t-x2)*t,y1=b2.a+(b2.b-b2.a)*t,y2=b2.b+(b2.c-b2.b)*t,y1+=(y2-y1)*t,y2+=(b2.c+(b2.d-b2.c)*t-y2)*t,val=notStart?Math.atan2(y2-y1,x2-x1)*conv+add:this._initialRotations[i],this._mod[p]&&(val=this._mod[p](val,target)),func[p]?target[p](val):target[p]=val)}}}),p=BezierPlugin.prototype;BezierPlugin.bezierThrough=bezierThrough,BezierPlugin.cubicToQuadratic=cubicToQuadratic,BezierPlugin._autoCSS=!0,BezierPlugin.quadraticToCubic=function(a,b,c){return new Segment(a,(2*b+a)/3,(2*b+c)/3,c)},BezierPlugin._cssRegister=function(){var CSSPlugin=_globals.CSSPlugin;if(CSSPlugin){var _internals=CSSPlugin._internals,_parseToProxy=_internals._parseToProxy,_setPluginRatio=_internals._setPluginRatio,CSSPropTween=_internals.CSSPropTween;_internals._registerComplexSpecialProp("bezier",{parser:function(t,e,prop,cssp,pt,plugin){e instanceof Array&&(e={values:e}),plugin=new BezierPlugin;var i,p,data,values=e.values,l=values.length-1,pluginValues=[],v={};if(l<0)return pt;for(i=0;i<=l;i++)data=_parseToProxy(t,values[i],cssp,pt,plugin,l!==i),pluginValues[i]=data.end;for(p in e)v[p]=e[p];return v.values=pluginValues,pt=new CSSPropTween(t,"bezier",0,0,data.pt,2),pt.data=data,pt.plugin=plugin,pt.setRatio=_setPluginRatio,0===v.autoRotate&&(v.autoRotate=!0),!v.autoRotate||v.autoRotate instanceof Array||(i=v.autoRotate===!0?0:Number(v.autoRotate),v.autoRotate=null!=data.end.left?[["left","top","rotation",i,!1]]:null!=data.end.x&&[["x","y","rotation",i,!1]]),v.autoRotate&&(cssp._transform||cssp._enableTransforms(!1),data.autoRotate=cssp._target._gsTransform,data.proxy.rotation=data.autoRotate.rotation||0,cssp._overwriteProps.push("rotation")),plugin._onInitTween(data.proxy,v,cssp._tween),pt}})}},p._mod=function(lookup){for(var val,op=this._overwriteProps,i=op.length;--i>-1;)val=lookup[op[i]],val&&"function"==typeof val&&(this._mod[op[i]]=val)},p._kill=function(lookup){var p,i,a=this._props;for(p in this._beziers)if(p in lookup)for(delete this._beziers[p],delete this._func[p],i=a.length;--i>-1;)a[i]===p&&a.splice(i,1);if(a=this._autoRotate)for(i=a.length;--i>-1;)lookup[a[i][2]]&&a.splice(i,1);return this._super._kill.call(this,lookup)}}(),_gsScope._gsDefine("plugins.CSSPlugin",["plugins.TweenPlugin","TweenLite"],function(TweenPlugin,TweenLite){var _hasPriority,_suffixMap,_cs,_overwriteProps,CSSPlugin=function(){TweenPlugin.call(this,"css"),this._overwriteProps.length=0,this.setRatio=CSSPlugin.prototype.setRatio},_globals=_gsScope._gsDefine.globals,_specialProps={},p=CSSPlugin.prototype=new TweenPlugin("css");p.constructor=CSSPlugin,CSSPlugin.version="1.19.0",CSSPlugin.API=2,CSSPlugin.defaultTransformPerspective=0,CSSPlugin.defaultSkewType="compensated",CSSPlugin.defaultSmoothOrigin=!0,p="px",CSSPlugin.suffixMap={top:p,right:p,bottom:p,left:p,width:p,height:p,fontSize:p,padding:p,margin:p,perspective:p,lineHeight:""};var _autoRound,_reqSafariFix,_isSafari,_isFirefox,_isSafariLT6,_ieVers,_target,_index,_numExp=/(?:\-|\.|\b)(\d|\.|e\-)+/g,_relNumExp=/(?:\d|\-\d|\.\d|\-\.\d|\+=\d|\-=\d|\+=.\d|\-=\.\d)+/g,_valuesExp=/(?:\+=|\-=|\-|\b)[\d\-\.]+[a-zA-Z0-9]*(?:%|\b)/gi,_NaNExp=/(?![+-]?\d*\.?\d+|[+-]|e[+-]\d+)[^0-9]/g,_suffixExp=/(?:\d|\-|\+|=|#|\.)*/g,_opacityExp=/opacity *= *([^)]*)/i,_opacityValExp=/opacity:([^;]*)/i,_alphaFilterExp=/alpha\(opacity *=.+?\)/i,_rgbhslExp=/^(rgb|hsl)/,_capsExp=/([A-Z])/g,_camelExp=/-([a-z])/gi,_urlExp=/(^(?:url\(\"|url\())|(?:(\"\))$|\)$)/gi,_camelFunc=function(s,g){return g.toUpperCase()},_horizExp=/(?:Left|Right|Width)/i,_ieGetMatrixExp=/(M11|M12|M21|M22)=[\d\-\.e]+/gi,_ieSetMatrixExp=/progid\:DXImageTransform\.Microsoft\.Matrix\(.+?\)/i,_commasOutsideParenExp=/,(?=[^\)]*(?:\(|$))/gi,_complexExp=/[\s,\(]/i,_DEG2RAD=Math.PI/180,_RAD2DEG=180/Math.PI,_forcePT={},_doc=document,_createElement=function(type){return _doc.createElementNS?_doc.createElementNS("http://www.w3.org/1999/xhtml",type):_doc.createElement(type)},_tempDiv=_createElement("div"),_tempImg=_createElement("img"),_internals=CSSPlugin._internals={_specialProps:_specialProps},_agent=navigator.userAgent,_supportsOpacity=function(){var i=_agent.indexOf("Android"),a=_createElement("a");return _isSafari=_agent.indexOf("Safari")!==-1&&_agent.indexOf("Chrome")===-1&&(i===-1||Number(_agent.substr(i+8,1))>3),_isSafariLT6=_isSafari&&Number(_agent.substr(_agent.indexOf("Version/")+8,1))<6,_isFirefox=_agent.indexOf("Firefox")!==-1,(/MSIE ([0-9]{1,}[\.0-9]{0,})/.exec(_agent)||/Trident\/.*rv:([0-9]{1,}[\.0-9]{0,})/.exec(_agent))&&(_ieVers=parseFloat(RegExp.$1)),!!a&&(a.style.cssText="top:1px;opacity:.55;",/^0.55/.test(a.style.opacity))}(),_getIEOpacity=function(v){return _opacityExp.test("string"==typeof v?v:(v.currentStyle?v.currentStyle.filter:v.style.filter)||"")?parseFloat(RegExp.$1)/100:1},_log=function(s){window.console&&console.log(s)},_prefixCSS="",_prefix="",_checkPropPrefix=function(p,e){e=e||_tempDiv;var a,i,s=e.style;if(void 0!==s[p])return p;for(p=p.charAt(0).toUpperCase()+p.substr(1),a=["O","Moz","ms","Ms","Webkit"],i=5;--i>-1&&void 0===s[a[i]+p];);return i>=0?(_prefix=3===i?"ms":a[i],_prefixCSS="-"+_prefix.toLowerCase()+"-",_prefix+p):null},_getComputedStyle=_doc.defaultView?_doc.defaultView.getComputedStyle:function(){},_getStyle=CSSPlugin.getStyle=function(t,p,cs,calc,dflt){var rv;return _supportsOpacity||"opacity"!==p?(!calc&&t.style[p]?rv=t.style[p]:(cs=cs||_getComputedStyle(t))?rv=cs[p]||cs.getPropertyValue(p)||cs.getPropertyValue(p.replace(_capsExp,"-$1").toLowerCase()):t.currentStyle&&(rv=t.currentStyle[p]),null==dflt||rv&&"none"!==rv&&"auto"!==rv&&"auto auto"!==rv?rv:dflt):_getIEOpacity(t)},_convertToPixels=_internals.convertToPixels=function(t,p,v,sfx,recurse){if("px"===sfx||!sfx)return v;if("auto"===sfx||!v)return 0;var pix,cache,time,horiz=_horizExp.test(p),node=t,style=_tempDiv.style,neg=v<0,precise=1===v;if(neg&&(v=-v),precise&&(v*=100),"%"===sfx&&p.indexOf("border")!==-1)pix=v/100*(horiz?t.clientWidth:t.clientHeight);else{if(style.cssText="border:0 solid red;position:"+_getStyle(t,"position")+";line-height:0;","%"!==sfx&&node.appendChild&&"v"!==sfx.charAt(0)&&"rem"!==sfx)style[horiz?"borderLeftWidth":"borderTopWidth"]=v+sfx;else{if(node=t.parentNode||_doc.body,cache=node._gsCache,time=TweenLite.ticker.frame,cache&&horiz&&cache.time===time)return cache.width*v/100;style[horiz?"width":"height"]=v+sfx}node.appendChild(_tempDiv),pix=parseFloat(_tempDiv[horiz?"offsetWidth":"offsetHeight"]),node.removeChild(_tempDiv),horiz&&"%"===sfx&&CSSPlugin.cacheWidths!==!1&&(cache=node._gsCache=node._gsCache||{},cache.time=time,cache.width=pix/v*100),0!==pix||recurse||(pix=_convertToPixels(t,p,v,sfx,!0))}return precise&&(pix/=100),neg?-pix:pix},_calculateOffset=_internals.calculateOffset=function(t,p,cs){if("absolute"!==_getStyle(t,"position",cs))return 0;var dim="left"===p?"Left":"Top",v=_getStyle(t,"margin"+dim,cs);return t["offset"+dim]-(_convertToPixels(t,p,parseFloat(v),v.replace(_suffixExp,""))||0)},_getAllStyles=function(t,cs){var i,tr,p,s={};if(cs=cs||_getComputedStyle(t,null))if(i=cs.length)for(;--i>-1;)p=cs[i],p.indexOf("-transform")!==-1&&_transformPropCSS!==p||(s[p.replace(_camelExp,_camelFunc)]=cs.getPropertyValue(p));else for(i in cs)i.indexOf("Transform")!==-1&&_transformProp!==i||(s[i]=cs[i]);else if(cs=t.currentStyle||t.style)for(i in cs)"string"==typeof i&&void 0===s[i]&&(s[i.replace(_camelExp,_camelFunc)]=cs[i]);return _supportsOpacity||(s.opacity=_getIEOpacity(t)),tr=_getTransform(t,cs,!1),s.rotation=tr.rotation,s.skewX=tr.skewX,s.scaleX=tr.scaleX,s.scaleY=tr.scaleY,s.x=tr.x,s.y=tr.y,_supports3D&&(s.z=tr.z,s.rotationX=tr.rotationX,s.rotationY=tr.rotationY,s.scaleZ=tr.scaleZ),s.filters&&delete s.filters,s},_cssDif=function(t,s1,s2,vars,forceLookup){var val,p,mpt,difs={},style=t.style;for(p in s2)"cssText"!==p&&"length"!==p&&isNaN(p)&&(s1[p]!==(val=s2[p])||forceLookup&&forceLookup[p])&&p.indexOf("Origin")===-1&&("number"!=typeof val&&"string"!=typeof val||(difs[p]="auto"!==val||"left"!==p&&"top"!==p?""!==val&&"auto"!==val&&"none"!==val||"string"!=typeof s1[p]||""===s1[p].replace(_NaNExp,"")?val:0:_calculateOffset(t,p),void 0!==style[p]&&(mpt=new MiniPropTween(style,p,style[p],mpt))));if(vars)for(p in vars)"className"!==p&&(difs[p]=vars[p]);return{difs:difs,firstMPT:mpt}},_dimensions={width:["Left","Right"],height:["Top","Bottom"]},_margins=["marginLeft","marginRight","marginTop","marginBottom"],_getDimension=function(t,p,cs){if("svg"===(t.nodeName+"").toLowerCase())return(cs||_getComputedStyle(t))[p]||0;if(t.getBBox&&_isSVG(t))return t.getBBox()[p]||0;var v=parseFloat("width"===p?t.offsetWidth:t.offsetHeight),a=_dimensions[p],i=a.length;for(cs=cs||_getComputedStyle(t,null);--i>-1;)v-=parseFloat(_getStyle(t,"padding"+a[i],cs,!0))||0,v-=parseFloat(_getStyle(t,"border"+a[i]+"Width",cs,!0))||0;return v},_parsePosition=function(v,recObj){if("contain"===v||"auto"===v||"auto auto"===v)return v+" ";null!=v&&""!==v||(v="0 0");var i,a=v.split(" "),x=v.indexOf("left")!==-1?"0%":v.indexOf("right")!==-1?"100%":a[0],y=v.indexOf("top")!==-1?"0%":v.indexOf("bottom")!==-1?"100%":a[1];if(a.length>3&&!recObj){for(a=v.split(", ").join(",").split(","),v=[],i=0;i<a.length;i++)v.push(_parsePosition(a[i]));return v.join(",")}return null==y?y="center"===x?"50%":"0":"center"===y&&(y="50%"),("center"===x||isNaN(parseFloat(x))&&(x+"").indexOf("=")===-1)&&(x="50%"),v=x+" "+y+(a.length>2?" "+a[2]:""),recObj&&(recObj.oxp=x.indexOf("%")!==-1,recObj.oyp=y.indexOf("%")!==-1,recObj.oxr="="===x.charAt(1),recObj.oyr="="===y.charAt(1),recObj.ox=parseFloat(x.replace(_NaNExp,"")),recObj.oy=parseFloat(y.replace(_NaNExp,"")),recObj.v=v),recObj||v},_parseChange=function(e,b){return"function"==typeof e&&(e=e(_index,_target)),"string"==typeof e&&"="===e.charAt(1)?parseInt(e.charAt(0)+"1",10)*parseFloat(e.substr(2)):parseFloat(e)-parseFloat(b)||0},_parseVal=function(v,d){return"function"==typeof v&&(v=v(_index,_target)),null==v?d:"string"==typeof v&&"="===v.charAt(1)?parseInt(v.charAt(0)+"1",10)*parseFloat(v.substr(2))+d:parseFloat(v)||0},_parseAngle=function(v,d,p,directionalEnd){var cap,split,dif,result,isRelative,min=1e-6;return"function"==typeof v&&(v=v(_index,_target)),null==v?result=d:"number"==typeof v?result=v:(cap=360,split=v.split("_"),isRelative="="===v.charAt(1),dif=(isRelative?parseInt(v.charAt(0)+"1",10)*parseFloat(split[0].substr(2)):parseFloat(split[0]))*(v.indexOf("rad")===-1?1:_RAD2DEG)-(isRelative?0:d),split.length&&(directionalEnd&&(directionalEnd[p]=d+dif),v.indexOf("short")!==-1&&(dif%=cap,dif!==dif%(cap/2)&&(dif=dif<0?dif+cap:dif-cap)),v.indexOf("_cw")!==-1&&dif<0?dif=(dif+9999999999*cap)%cap-(dif/cap|0)*cap:v.indexOf("ccw")!==-1&&dif>0&&(dif=(dif-9999999999*cap)%cap-(dif/cap|0)*cap)),result=d+dif),result<min&&result>-min&&(result=0),result},_colorLookup={aqua:[0,255,255],lime:[0,255,0],silver:[192,192,192],black:[0,0,0],maroon:[128,0,0],teal:[0,128,128],blue:[0,0,255],navy:[0,0,128],white:[255,255,255],fuchsia:[255,0,255],olive:[128,128,0],yellow:[255,255,0],orange:[255,165,0],gray:[128,128,128],purple:[128,0,128],green:[0,128,0],red:[255,0,0],pink:[255,192,203],cyan:[0,255,255],transparent:[255,255,255,0]},_hue=function(h,m1,m2){return h=h<0?h+1:h>1?h-1:h,255*(6*h<1?m1+(m2-m1)*h*6:h<.5?m2:3*h<2?m1+(m2-m1)*(2/3-h)*6:m1)+.5|0},_parseColor=CSSPlugin.parseColor=function(v,toHSL){var a,r,g,b,h,s,l,max,min,d,wasHSL;if(v)if("number"==typeof v)a=[v>>16,v>>8&255,255&v];else{if(","===v.charAt(v.length-1)&&(v=v.substr(0,v.length-1)),_colorLookup[v])a=_colorLookup[v];else if("#"===v.charAt(0))4===v.length&&(r=v.charAt(1),g=v.charAt(2),b=v.charAt(3),v="#"+r+r+g+g+b+b),v=parseInt(v.substr(1),16),a=[v>>16,v>>8&255,255&v];else if("hsl"===v.substr(0,3))if(a=wasHSL=v.match(_numExp),toHSL){if(v.indexOf("=")!==-1)return v.match(_relNumExp)}else h=Number(a[0])%360/360,s=Number(a[1])/100,l=Number(a[2])/100,g=l<=.5?l*(s+1):l+s-l*s,r=2*l-g,a.length>3&&(a[3]=Number(v[3])),a[0]=_hue(h+1/3,r,g),a[1]=_hue(h,r,g),a[2]=_hue(h-1/3,r,g);else a=v.match(_numExp)||_colorLookup.transparent;a[0]=Number(a[0]),a[1]=Number(a[1]),a[2]=Number(a[2]),a.length>3&&(a[3]=Number(a[3]))}else a=_colorLookup.black;return toHSL&&!wasHSL&&(r=a[0]/255,g=a[1]/255,b=a[2]/255,max=Math.max(r,g,b),min=Math.min(r,g,b),l=(max+min)/2,max===min?h=s=0:(d=max-min,s=l>.5?d/(2-max-min):d/(max+min),h=max===r?(g-b)/d+(g<b?6:0):max===g?(b-r)/d+2:(r-g)/d+4,h*=60),a[0]=h+.5|0,a[1]=100*s+.5|0,a[2]=100*l+.5|0),a},_formatColors=function(s,toHSL){var i,color,temp,colors=s.match(_colorExp)||[],charIndex=0,parsed=colors.length?"":s;for(i=0;i<colors.length;i++)color=colors[i],temp=s.substr(charIndex,s.indexOf(color,charIndex)-charIndex),charIndex+=temp.length+color.length,color=_parseColor(color,toHSL),3===color.length&&color.push(1),parsed+=temp+(toHSL?"hsla("+color[0]+","+color[1]+"%,"+color[2]+"%,"+color[3]:"rgba("+color.join(","))+")";return parsed+s.substr(charIndex)},_colorExp="(?:\\b(?:(?:rgb|rgba|hsl|hsla)\\(.+?\\))|\\B#(?:[0-9a-f]{3}){1,2}\\b";for(p in _colorLookup)_colorExp+="|"+p+"\\b";_colorExp=new RegExp(_colorExp+")","gi"),CSSPlugin.colorStringFilter=function(a){var toHSL,combined=a[0]+a[1];_colorExp.test(combined)&&(toHSL=combined.indexOf("hsl(")!==-1||combined.indexOf("hsla(")!==-1,a[0]=_formatColors(a[0],toHSL),a[1]=_formatColors(a[1],toHSL)),_colorExp.lastIndex=0},TweenLite.defaultStringFilter||(TweenLite.defaultStringFilter=CSSPlugin.colorStringFilter);var _getFormatter=function(dflt,clr,collapsible,multi){if(null==dflt)return function(v){return v};var formatter,dColor=clr?(dflt.match(_colorExp)||[""])[0]:"",dVals=dflt.split(dColor).join("").match(_valuesExp)||[],pfx=dflt.substr(0,dflt.indexOf(dVals[0])),sfx=")"===dflt.charAt(dflt.length-1)?")":"",delim=dflt.indexOf(" ")!==-1?" ":",",numVals=dVals.length,dSfx=numVals>0?dVals[0].replace(_numExp,""):"";return numVals?formatter=clr?function(v){var color,vals,i,a;if("number"==typeof v)v+=dSfx;else if(multi&&_commasOutsideParenExp.test(v)){for(a=v.replace(_commasOutsideParenExp,"|").split("|"),i=0;i<a.length;i++)a[i]=formatter(a[i]);return a.join(",")}if(color=(v.match(_colorExp)||[dColor])[0],vals=v.split(color).join("").match(_valuesExp)||[],i=vals.length,numVals>i--)for(;++i<numVals;)vals[i]=collapsible?vals[(i-1)/2|0]:dVals[i];
return pfx+vals.join(delim)+delim+color+sfx+(v.indexOf("inset")!==-1?" inset":"")}:function(v){var vals,a,i;if("number"==typeof v)v+=dSfx;else if(multi&&_commasOutsideParenExp.test(v)){for(a=v.replace(_commasOutsideParenExp,"|").split("|"),i=0;i<a.length;i++)a[i]=formatter(a[i]);return a.join(",")}if(vals=v.match(_valuesExp)||[],i=vals.length,numVals>i--)for(;++i<numVals;)vals[i]=collapsible?vals[(i-1)/2|0]:dVals[i];return pfx+vals.join(delim)+sfx}:function(v){return v}},_getEdgeParser=function(props){return props=props.split(","),function(t,e,p,cssp,pt,plugin,vars){var i,a=(e+"").split(" ");for(vars={},i=0;i<4;i++)vars[props[i]]=a[i]=a[i]||a[(i-1)/2>>0];return cssp.parse(t,vars,pt,plugin)}},MiniPropTween=(_internals._setPluginRatio=function(v){this.plugin.setRatio(v);for(var val,pt,i,str,p,d=this.data,proxy=d.proxy,mpt=d.firstMPT,min=1e-6;mpt;)val=proxy[mpt.v],mpt.r?val=Math.round(val):val<min&&val>-min&&(val=0),mpt.t[mpt.p]=val,mpt=mpt._next;if(d.autoRotate&&(d.autoRotate.rotation=d.mod?d.mod(proxy.rotation,this.t):proxy.rotation),1===v||0===v)for(mpt=d.firstMPT,p=1===v?"e":"b";mpt;){if(pt=mpt.t,pt.type){if(1===pt.type){for(str=pt.xs0+pt.s+pt.xs1,i=1;i<pt.l;i++)str+=pt["xn"+i]+pt["xs"+(i+1)];pt[p]=str}}else pt[p]=pt.s+pt.xs0;mpt=mpt._next}},function(t,p,v,next,r){this.t=t,this.p=p,this.v=v,this.r=r,next&&(next._prev=this,this._next=next)}),CSSPropTween=(_internals._parseToProxy=function(t,vars,cssp,pt,plugin,shallow){var i,p,xp,mpt,firstPT,bpt=pt,start={},end={},transform=cssp._transform,oldForce=_forcePT;for(cssp._transform=null,_forcePT=vars,pt=firstPT=cssp.parse(t,vars,pt,plugin),_forcePT=oldForce,shallow&&(cssp._transform=transform,bpt&&(bpt._prev=null,bpt._prev&&(bpt._prev._next=null)));pt&&pt!==bpt;){if(pt.type<=1&&(p=pt.p,end[p]=pt.s+pt.c,start[p]=pt.s,shallow||(mpt=new MiniPropTween(pt,"s",p,mpt,pt.r),pt.c=0),1===pt.type))for(i=pt.l;--i>0;)xp="xn"+i,p=pt.p+"_"+xp,end[p]=pt.data[xp],start[p]=pt[xp],shallow||(mpt=new MiniPropTween(pt,xp,p,mpt,pt.rxp[xp]));pt=pt._next}return{proxy:start,end:end,firstMPT:mpt,pt:firstPT}},_internals.CSSPropTween=function(t,p,s,c,next,type,n,r,pr,b,e){this.t=t,this.p=p,this.s=s,this.c=c,this.n=n||p,t instanceof CSSPropTween||_overwriteProps.push(this.n),this.r=r,this.type=type||0,pr&&(this.pr=pr,_hasPriority=!0),this.b=void 0===b?s:b,this.e=void 0===e?s+c:e,next&&(this._next=next,next._prev=this)}),_addNonTweeningNumericPT=function(target,prop,start,end,next,overwriteProp){var pt=new CSSPropTween(target,prop,start,end-start,next,(-1),overwriteProp);return pt.b=start,pt.e=pt.xs0=end,pt},_parseComplex=CSSPlugin.parseComplex=function(t,p,b,e,clrs,dflt,pt,pr,plugin,setRatio){b=b||dflt||"","function"==typeof e&&(e=e(_index,_target)),pt=new CSSPropTween(t,p,0,0,pt,setRatio?2:1,null,(!1),pr,b,e),e+="",clrs&&_colorExp.test(e+b)&&(e=[b,e],CSSPlugin.colorStringFilter(e),b=e[0],e=e[1]);var i,xi,ni,bv,ev,bnums,enums,bn,hasAlpha,temp,cv,str,useHSL,ba=b.split(", ").join(",").split(" "),ea=e.split(", ").join(",").split(" "),l=ba.length,autoRound=_autoRound!==!1;for(e.indexOf(",")===-1&&b.indexOf(",")===-1||(ba=ba.join(" ").replace(_commasOutsideParenExp,", ").split(" "),ea=ea.join(" ").replace(_commasOutsideParenExp,", ").split(" "),l=ba.length),l!==ea.length&&(ba=(dflt||"").split(" "),l=ba.length),pt.plugin=plugin,pt.setRatio=setRatio,_colorExp.lastIndex=0,i=0;i<l;i++)if(bv=ba[i],ev=ea[i],bn=parseFloat(bv),bn||0===bn)pt.appendXtra("",bn,_parseChange(ev,bn),ev.replace(_relNumExp,""),autoRound&&ev.indexOf("px")!==-1,!0);else if(clrs&&_colorExp.test(bv))str=ev.indexOf(")")+1,str=")"+(str?ev.substr(str):""),useHSL=ev.indexOf("hsl")!==-1&&_supportsOpacity,bv=_parseColor(bv,useHSL),ev=_parseColor(ev,useHSL),hasAlpha=bv.length+ev.length>6,hasAlpha&&!_supportsOpacity&&0===ev[3]?(pt["xs"+pt.l]+=pt.l?" transparent":"transparent",pt.e=pt.e.split(ea[i]).join("transparent")):(_supportsOpacity||(hasAlpha=!1),useHSL?pt.appendXtra(hasAlpha?"hsla(":"hsl(",bv[0],_parseChange(ev[0],bv[0]),",",!1,!0).appendXtra("",bv[1],_parseChange(ev[1],bv[1]),"%,",!1).appendXtra("",bv[2],_parseChange(ev[2],bv[2]),hasAlpha?"%,":"%"+str,!1):pt.appendXtra(hasAlpha?"rgba(":"rgb(",bv[0],ev[0]-bv[0],",",!0,!0).appendXtra("",bv[1],ev[1]-bv[1],",",!0).appendXtra("",bv[2],ev[2]-bv[2],hasAlpha?",":str,!0),hasAlpha&&(bv=bv.length<4?1:bv[3],pt.appendXtra("",bv,(ev.length<4?1:ev[3])-bv,str,!1))),_colorExp.lastIndex=0;else if(bnums=bv.match(_numExp)){if(enums=ev.match(_relNumExp),!enums||enums.length!==bnums.length)return pt;for(ni=0,xi=0;xi<bnums.length;xi++)cv=bnums[xi],temp=bv.indexOf(cv,ni),pt.appendXtra(bv.substr(ni,temp-ni),Number(cv),_parseChange(enums[xi],cv),"",autoRound&&"px"===bv.substr(temp+cv.length,2),0===xi),ni=temp+cv.length;pt["xs"+pt.l]+=bv.substr(ni)}else pt["xs"+pt.l]+=pt.l||pt["xs"+pt.l]?" "+ev:ev;if(e.indexOf("=")!==-1&&pt.data){for(str=pt.xs0+pt.data.s,i=1;i<pt.l;i++)str+=pt["xs"+i]+pt.data["xn"+i];pt.e=str+pt["xs"+i]}return pt.l||(pt.type=-1,pt.xs0=pt.e),pt.xfirst||pt},i=9;for(p=CSSPropTween.prototype,p.l=p.pr=0;--i>0;)p["xn"+i]=0,p["xs"+i]="";p.xs0="",p._next=p._prev=p.xfirst=p.data=p.plugin=p.setRatio=p.rxp=null,p.appendXtra=function(pfx,s,c,sfx,r,pad){var pt=this,l=pt.l;return pt["xs"+l]+=pad&&(l||pt["xs"+l])?" "+pfx:pfx||"",c||0===l||pt.plugin?(pt.l++,pt.type=pt.setRatio?2:1,pt["xs"+pt.l]=sfx||"",l>0?(pt.data["xn"+l]=s+c,pt.rxp["xn"+l]=r,pt["xn"+l]=s,pt.plugin||(pt.xfirst=new CSSPropTween(pt,"xn"+l,s,c,pt.xfirst||pt,0,pt.n,r,pt.pr),pt.xfirst.xs0=0),pt):(pt.data={s:s+c},pt.rxp={},pt.s=s,pt.c=c,pt.r=r,pt)):(pt["xs"+l]+=s+(sfx||""),pt)};var SpecialProp=function(p,options){options=options||{},this.p=options.prefix?_checkPropPrefix(p)||p:p,_specialProps[p]=_specialProps[this.p]=this,this.format=options.formatter||_getFormatter(options.defaultValue,options.color,options.collapsible,options.multi),options.parser&&(this.parse=options.parser),this.clrs=options.color,this.multi=options.multi,this.keyword=options.keyword,this.dflt=options.defaultValue,this.pr=options.priority||0},_registerComplexSpecialProp=_internals._registerComplexSpecialProp=function(p,options,defaults){"object"!=typeof options&&(options={parser:defaults});var i,temp,a=p.split(","),d=options.defaultValue;for(defaults=defaults||[d],i=0;i<a.length;i++)options.prefix=0===i&&options.prefix,options.defaultValue=defaults[i]||d,temp=new SpecialProp(a[i],options)},_registerPluginProp=_internals._registerPluginProp=function(p){if(!_specialProps[p]){var pluginName=p.charAt(0).toUpperCase()+p.substr(1)+"Plugin";_registerComplexSpecialProp(p,{parser:function(t,e,p,cssp,pt,plugin,vars){var pluginClass=_globals.com.greensock.plugins[pluginName];return pluginClass?(pluginClass._cssRegister(),_specialProps[p].parse(t,e,p,cssp,pt,plugin,vars)):(_log("Error: "+pluginName+" js file not loaded."),pt)}})}};p=SpecialProp.prototype,p.parseComplex=function(t,b,e,pt,plugin,setRatio){var i,ba,ea,l,bi,ei,kwd=this.keyword;if(this.multi&&(_commasOutsideParenExp.test(e)||_commasOutsideParenExp.test(b)?(ba=b.replace(_commasOutsideParenExp,"|").split("|"),ea=e.replace(_commasOutsideParenExp,"|").split("|")):kwd&&(ba=[b],ea=[e])),ea){for(l=ea.length>ba.length?ea.length:ba.length,i=0;i<l;i++)b=ba[i]=ba[i]||this.dflt,e=ea[i]=ea[i]||this.dflt,kwd&&(bi=b.indexOf(kwd),ei=e.indexOf(kwd),bi!==ei&&(ei===-1?ba[i]=ba[i].split(kwd).join(""):bi===-1&&(ba[i]+=" "+kwd)));b=ba.join(", "),e=ea.join(", ")}return _parseComplex(t,this.p,b,e,this.clrs,this.dflt,pt,this.pr,plugin,setRatio)},p.parse=function(t,e,p,cssp,pt,plugin,vars){return this.parseComplex(t.style,this.format(_getStyle(t,this.p,_cs,!1,this.dflt)),this.format(e),pt,plugin)},CSSPlugin.registerSpecialProp=function(name,onInitTween,priority){_registerComplexSpecialProp(name,{parser:function(t,e,p,cssp,pt,plugin,vars){var rv=new CSSPropTween(t,p,0,0,pt,2,p,(!1),priority);return rv.plugin=plugin,rv.setRatio=onInitTween(t,e,cssp._tween,p),rv},priority:priority})},CSSPlugin.useSVGTransformAttr=_isSafari||_isFirefox;var _useSVGTransformAttr,_transformProps="scaleX,scaleY,scaleZ,x,y,z,skewX,skewY,rotation,rotationX,rotationY,perspective,xPercent,yPercent".split(","),_transformProp=_checkPropPrefix("transform"),_transformPropCSS=_prefixCSS+"transform",_transformOriginProp=_checkPropPrefix("transformOrigin"),_supports3D=null!==_checkPropPrefix("perspective"),Transform=_internals.Transform=function(){this.perspective=parseFloat(CSSPlugin.defaultTransformPerspective)||0,this.force3D=!(CSSPlugin.defaultForce3D===!1||!_supports3D)&&(CSSPlugin.defaultForce3D||"auto")},_SVGElement=window.SVGElement,_createSVG=function(type,container,attributes){var p,element=_doc.createElementNS("http://www.w3.org/2000/svg",type),reg=/([a-z])([A-Z])/g;for(p in attributes)element.setAttributeNS(null,p.replace(reg,"$1-$2").toLowerCase(),attributes[p]);return container.appendChild(element),element},_docElement=_doc.documentElement,_forceSVGTransformAttr=function(){var svg,rect,width,force=_ieVers||/Android/i.test(_agent)&&!window.chrome;return _doc.createElementNS&&!force&&(svg=_createSVG("svg",_docElement),rect=_createSVG("rect",svg,{width:100,height:50,x:100}),width=rect.getBoundingClientRect().width,rect.style[_transformOriginProp]="50% 50%",rect.style[_transformProp]="scaleX(0.5)",force=width===rect.getBoundingClientRect().width&&!(_isFirefox&&_supports3D),_docElement.removeChild(svg)),force}(),_parseSVGOrigin=function(e,local,decoratee,absolute,smoothOrigin,skipRecord){var v,x,y,xOrigin,yOrigin,a,b,c,d,tx,ty,determinant,xOriginOld,yOriginOld,tm=e._gsTransform,m=_getMatrix(e,!0);tm&&(xOriginOld=tm.xOrigin,yOriginOld=tm.yOrigin),(!absolute||(v=absolute.split(" ")).length<2)&&(b=e.getBBox(),local=_parsePosition(local).split(" "),v=[(local[0].indexOf("%")!==-1?parseFloat(local[0])/100*b.width:parseFloat(local[0]))+b.x,(local[1].indexOf("%")!==-1?parseFloat(local[1])/100*b.height:parseFloat(local[1]))+b.y]),decoratee.xOrigin=xOrigin=parseFloat(v[0]),decoratee.yOrigin=yOrigin=parseFloat(v[1]),absolute&&m!==_identity2DMatrix&&(a=m[0],b=m[1],c=m[2],d=m[3],tx=m[4],ty=m[5],determinant=a*d-b*c,x=xOrigin*(d/determinant)+yOrigin*(-c/determinant)+(c*ty-d*tx)/determinant,y=xOrigin*(-b/determinant)+yOrigin*(a/determinant)-(a*ty-b*tx)/determinant,xOrigin=decoratee.xOrigin=v[0]=x,yOrigin=decoratee.yOrigin=v[1]=y),tm&&(skipRecord&&(decoratee.xOffset=tm.xOffset,decoratee.yOffset=tm.yOffset,tm=decoratee),smoothOrigin||smoothOrigin!==!1&&CSSPlugin.defaultSmoothOrigin!==!1?(x=xOrigin-xOriginOld,y=yOrigin-yOriginOld,tm.xOffset+=x*m[0]+y*m[2]-x,tm.yOffset+=x*m[1]+y*m[3]-y):tm.xOffset=tm.yOffset=0),skipRecord||e.setAttribute("data-svg-origin",v.join(" "))},_canGetBBox=function(e){try{return e.getBBox()}catch(e){}},_isSVG=function(e){return!!(_SVGElement&&e.getBBox&&e.getCTM&&_canGetBBox(e)&&(!e.parentNode||e.parentNode.getBBox&&e.parentNode.getCTM))},_identity2DMatrix=[1,0,0,1,0,0],_getMatrix=function(e,force2D){var isDefault,s,m,n,dec,none,tm=e._gsTransform||new Transform,rnd=1e5,style=e.style;if(_transformProp?s=_getStyle(e,_transformPropCSS,null,!0):e.currentStyle&&(s=e.currentStyle.filter.match(_ieGetMatrixExp),s=s&&4===s.length?[s[0].substr(4),Number(s[2].substr(4)),Number(s[1].substr(4)),s[3].substr(4),tm.x||0,tm.y||0].join(","):""),isDefault=!s||"none"===s||"matrix(1, 0, 0, 1, 0, 0)"===s,isDefault&&_transformProp&&((none="none"===_getComputedStyle(e).display)||!e.parentNode)&&(none&&(n=style.display,style.display="block"),e.parentNode||(dec=1,_docElement.appendChild(e)),s=_getStyle(e,_transformPropCSS,null,!0),isDefault=!s||"none"===s||"matrix(1, 0, 0, 1, 0, 0)"===s,n?style.display=n:none&&_removeProp(style,"display"),dec&&_docElement.removeChild(e)),(tm.svg||e.getBBox&&_isSVG(e))&&(isDefault&&(style[_transformProp]+"").indexOf("matrix")!==-1&&(s=style[_transformProp],isDefault=0),m=e.getAttribute("transform"),isDefault&&m&&(m.indexOf("matrix")!==-1?(s=m,isDefault=0):m.indexOf("translate")!==-1&&(s="matrix(1,0,0,1,"+m.match(/(?:\-|\b)[\d\-\.e]+\b/gi).join(",")+")",isDefault=0))),isDefault)return _identity2DMatrix;for(m=(s||"").match(_numExp)||[],i=m.length;--i>-1;)n=Number(m[i]),m[i]=(dec=n-(n|=0))?(dec*rnd+(dec<0?-.5:.5)|0)/rnd+n:n;return force2D&&m.length>6?[m[0],m[1],m[4],m[5],m[12],m[13]]:m},_getTransform=_internals.getTransform=function(t,cs,rec,parse){if(t._gsTransform&&rec&&!parse)return t._gsTransform;var m,i,scaleX,scaleY,rotation,skewX,tm=rec?t._gsTransform||new Transform:new Transform,invX=tm.scaleX<0,min=2e-5,rnd=1e5,zOrigin=_supports3D?parseFloat(_getStyle(t,_transformOriginProp,cs,!1,"0 0 0").split(" ")[2])||tm.zOrigin||0:0,defaultTransformPerspective=parseFloat(CSSPlugin.defaultTransformPerspective)||0;if(tm.svg=!(!t.getBBox||!_isSVG(t)),tm.svg&&(_parseSVGOrigin(t,_getStyle(t,_transformOriginProp,cs,!1,"50% 50%")+"",tm,t.getAttribute("data-svg-origin")),_useSVGTransformAttr=CSSPlugin.useSVGTransformAttr||_forceSVGTransformAttr),m=_getMatrix(t),m!==_identity2DMatrix){if(16===m.length){var t1,t2,t3,cos,sin,a11=m[0],a21=m[1],a31=m[2],a41=m[3],a12=m[4],a22=m[5],a32=m[6],a42=m[7],a13=m[8],a23=m[9],a33=m[10],a14=m[12],a24=m[13],a34=m[14],a43=m[11],angle=Math.atan2(a32,a33);tm.zOrigin&&(a34=-tm.zOrigin,a14=a13*a34-m[12],a24=a23*a34-m[13],a34=a33*a34+tm.zOrigin-m[14]),tm.rotationX=angle*_RAD2DEG,angle&&(cos=Math.cos(-angle),sin=Math.sin(-angle),t1=a12*cos+a13*sin,t2=a22*cos+a23*sin,t3=a32*cos+a33*sin,a13=a12*-sin+a13*cos,a23=a22*-sin+a23*cos,a33=a32*-sin+a33*cos,a43=a42*-sin+a43*cos,a12=t1,a22=t2,a32=t3),angle=Math.atan2(-a31,a33),tm.rotationY=angle*_RAD2DEG,angle&&(cos=Math.cos(-angle),sin=Math.sin(-angle),t1=a11*cos-a13*sin,t2=a21*cos-a23*sin,t3=a31*cos-a33*sin,a23=a21*sin+a23*cos,a33=a31*sin+a33*cos,a43=a41*sin+a43*cos,a11=t1,a21=t2,a31=t3),angle=Math.atan2(a21,a11),tm.rotation=angle*_RAD2DEG,angle&&(cos=Math.cos(-angle),sin=Math.sin(-angle),a11=a11*cos+a12*sin,t2=a21*cos+a22*sin,a22=a21*-sin+a22*cos,a32=a31*-sin+a32*cos,a21=t2),tm.rotationX&&Math.abs(tm.rotationX)+Math.abs(tm.rotation)>359.9&&(tm.rotationX=tm.rotation=0,tm.rotationY=180-tm.rotationY),tm.scaleX=(Math.sqrt(a11*a11+a21*a21)*rnd+.5|0)/rnd,tm.scaleY=(Math.sqrt(a22*a22+a23*a23)*rnd+.5|0)/rnd,tm.scaleZ=(Math.sqrt(a32*a32+a33*a33)*rnd+.5|0)/rnd,tm.rotationX||tm.rotationY?tm.skewX=0:(tm.skewX=a12||a22?Math.atan2(a12,a22)*_RAD2DEG+tm.rotation:tm.skewX||0,Math.abs(tm.skewX)>90&&Math.abs(tm.skewX)<270&&(invX?(tm.scaleX*=-1,tm.skewX+=tm.rotation<=0?180:-180,tm.rotation+=tm.rotation<=0?180:-180):(tm.scaleY*=-1,tm.skewX+=tm.skewX<=0?180:-180))),tm.perspective=a43?1/(a43<0?-a43:a43):0,tm.x=a14,tm.y=a24,tm.z=a34,tm.svg&&(tm.x-=tm.xOrigin-(tm.xOrigin*a11-tm.yOrigin*a12),tm.y-=tm.yOrigin-(tm.yOrigin*a21-tm.xOrigin*a22))}else if(!_supports3D||parse||!m.length||tm.x!==m[4]||tm.y!==m[5]||!tm.rotationX&&!tm.rotationY){var k=m.length>=6,a=k?m[0]:1,b=m[1]||0,c=m[2]||0,d=k?m[3]:1;tm.x=m[4]||0,tm.y=m[5]||0,scaleX=Math.sqrt(a*a+b*b),scaleY=Math.sqrt(d*d+c*c),rotation=a||b?Math.atan2(b,a)*_RAD2DEG:tm.rotation||0,skewX=c||d?Math.atan2(c,d)*_RAD2DEG+rotation:tm.skewX||0,Math.abs(skewX)>90&&Math.abs(skewX)<270&&(invX?(scaleX*=-1,skewX+=rotation<=0?180:-180,rotation+=rotation<=0?180:-180):(scaleY*=-1,skewX+=skewX<=0?180:-180)),tm.scaleX=scaleX,tm.scaleY=scaleY,tm.rotation=rotation,tm.skewX=skewX,_supports3D&&(tm.rotationX=tm.rotationY=tm.z=0,tm.perspective=defaultTransformPerspective,tm.scaleZ=1),tm.svg&&(tm.x-=tm.xOrigin-(tm.xOrigin*a+tm.yOrigin*c),tm.y-=tm.yOrigin-(tm.xOrigin*b+tm.yOrigin*d))}tm.zOrigin=zOrigin;for(i in tm)tm[i]<min&&tm[i]>-min&&(tm[i]=0)}return rec&&(t._gsTransform=tm,tm.svg&&(_useSVGTransformAttr&&t.style[_transformProp]?TweenLite.delayedCall(.001,function(){_removeProp(t.style,_transformProp)}):!_useSVGTransformAttr&&t.getAttribute("transform")&&TweenLite.delayedCall(.001,function(){t.removeAttribute("transform")}))),tm},_setIETransformRatio=function(v){var filters,val,t=this.data,ang=-t.rotation*_DEG2RAD,skew=ang+t.skewX*_DEG2RAD,rnd=1e5,a=(Math.cos(ang)*t.scaleX*rnd|0)/rnd,b=(Math.sin(ang)*t.scaleX*rnd|0)/rnd,c=(Math.sin(skew)*-t.scaleY*rnd|0)/rnd,d=(Math.cos(skew)*t.scaleY*rnd|0)/rnd,style=this.t.style,cs=this.t.currentStyle;if(cs){val=b,b=-c,c=-val,filters=cs.filter,style.filter="";var dx,dy,w=this.t.offsetWidth,h=this.t.offsetHeight,clip="absolute"!==cs.position,m="progid:DXImageTransform.Microsoft.Matrix(M11="+a+", M12="+b+", M21="+c+", M22="+d,ox=t.x+w*t.xPercent/100,oy=t.y+h*t.yPercent/100;if(null!=t.ox&&(dx=(t.oxp?w*t.ox*.01:t.ox)-w/2,dy=(t.oyp?h*t.oy*.01:t.oy)-h/2,ox+=dx-(dx*a+dy*b),oy+=dy-(dx*c+dy*d)),clip?(dx=w/2,dy=h/2,m+=", Dx="+(dx-(dx*a+dy*b)+ox)+", Dy="+(dy-(dx*c+dy*d)+oy)+")"):m+=", sizingMethod='auto expand')",filters.indexOf("DXImageTransform.Microsoft.Matrix(")!==-1?style.filter=filters.replace(_ieSetMatrixExp,m):style.filter=m+" "+filters,0!==v&&1!==v||1===a&&0===b&&0===c&&1===d&&(clip&&m.indexOf("Dx=0, Dy=0")===-1||_opacityExp.test(filters)&&100!==parseFloat(RegExp.$1)||filters.indexOf(filters.indexOf("Alpha"))===-1&&style.removeAttribute("filter")),!clip){var marg,prop,dif,mult=_ieVers<8?1:-1;for(dx=t.ieOffsetX||0,dy=t.ieOffsetY||0,t.ieOffsetX=Math.round((w-((a<0?-a:a)*w+(b<0?-b:b)*h))/2+ox),t.ieOffsetY=Math.round((h-((d<0?-d:d)*h+(c<0?-c:c)*w))/2+oy),i=0;i<4;i++)prop=_margins[i],marg=cs[prop],val=marg.indexOf("px")!==-1?parseFloat(marg):_convertToPixels(this.t,prop,parseFloat(marg),marg.replace(_suffixExp,""))||0,dif=val!==t[prop]?i<2?-t.ieOffsetX:-t.ieOffsetY:i<2?dx-t.ieOffsetX:dy-t.ieOffsetY,style[prop]=(t[prop]=Math.round(val-dif*(0===i||2===i?1:mult)))+"px"}}},_setTransformRatio=_internals.set3DTransformRatio=_internals.setTransformRatio=function(v){var a11,a12,a13,a21,a22,a23,a31,a32,a33,a41,a42,a43,zOrigin,min,cos,sin,t1,t2,transform,comma,zero,skew,rnd,t=this.data,style=this.t.style,angle=t.rotation,rotationX=t.rotationX,rotationY=t.rotationY,sx=t.scaleX,sy=t.scaleY,sz=t.scaleZ,x=t.x,y=t.y,z=t.z,isSVG=t.svg,perspective=t.perspective,force3D=t.force3D;if(((1===v||0===v)&&"auto"===force3D&&(this.tween._totalTime===this.tween._totalDuration||!this.tween._totalTime)||!force3D)&&!z&&!perspective&&!rotationY&&!rotationX&&1===sz||_useSVGTransformAttr&&isSVG||!_supports3D)return void(angle||t.skewX||isSVG?(angle*=_DEG2RAD,skew=t.skewX*_DEG2RAD,rnd=1e5,a11=Math.cos(angle)*sx,a21=Math.sin(angle)*sx,a12=Math.sin(angle-skew)*-sy,a22=Math.cos(angle-skew)*sy,skew&&"simple"===t.skewType&&(t1=Math.tan(skew-t.skewY*_DEG2RAD),t1=Math.sqrt(1+t1*t1),a12*=t1,a22*=t1,t.skewY&&(t1=Math.tan(t.skewY*_DEG2RAD),t1=Math.sqrt(1+t1*t1),a11*=t1,a21*=t1)),isSVG&&(x+=t.xOrigin-(t.xOrigin*a11+t.yOrigin*a12)+t.xOffset,y+=t.yOrigin-(t.xOrigin*a21+t.yOrigin*a22)+t.yOffset,_useSVGTransformAttr&&(t.xPercent||t.yPercent)&&(min=this.t.getBBox(),x+=.01*t.xPercent*min.width,y+=.01*t.yPercent*min.height),min=1e-6,x<min&&x>-min&&(x=0),y<min&&y>-min&&(y=0)),transform=(a11*rnd|0)/rnd+","+(a21*rnd|0)/rnd+","+(a12*rnd|0)/rnd+","+(a22*rnd|0)/rnd+","+x+","+y+")",isSVG&&_useSVGTransformAttr?this.t.setAttribute("transform","matrix("+transform):style[_transformProp]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+transform):style[_transformProp]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix(":"matrix(")+sx+",0,0,"+sy+","+x+","+y+")");if(_isFirefox&&(min=1e-4,sx<min&&sx>-min&&(sx=sz=2e-5),sy<min&&sy>-min&&(sy=sz=2e-5),!perspective||t.z||t.rotationX||t.rotationY||(perspective=0)),angle||t.skewX)angle*=_DEG2RAD,cos=a11=Math.cos(angle),sin=a21=Math.sin(angle),t.skewX&&(angle-=t.skewX*_DEG2RAD,cos=Math.cos(angle),sin=Math.sin(angle),"simple"===t.skewType&&(t1=Math.tan((t.skewX-t.skewY)*_DEG2RAD),t1=Math.sqrt(1+t1*t1),cos*=t1,sin*=t1,t.skewY&&(t1=Math.tan(t.skewY*_DEG2RAD),t1=Math.sqrt(1+t1*t1),a11*=t1,a21*=t1))),a12=-sin,a22=cos;else{if(!(rotationY||rotationX||1!==sz||perspective||isSVG))return void(style[_transformProp]=(t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) translate3d(":"translate3d(")+x+"px,"+y+"px,"+z+"px)"+(1!==sx||1!==sy?" scale("+sx+","+sy+")":""));a11=a22=1,a12=a21=0}a33=1,a13=a23=a31=a32=a41=a42=0,a43=perspective?-1/perspective:0,zOrigin=t.zOrigin,min=1e-6,comma=",",zero="0",angle=rotationY*_DEG2RAD,angle&&(cos=Math.cos(angle),sin=Math.sin(angle),a31=-sin,a41=a43*-sin,a13=a11*sin,a23=a21*sin,a33=cos,a43*=cos,a11*=cos,a21*=cos),angle=rotationX*_DEG2RAD,angle&&(cos=Math.cos(angle),sin=Math.sin(angle),t1=a12*cos+a13*sin,t2=a22*cos+a23*sin,a32=a33*sin,a42=a43*sin,a13=a12*-sin+a13*cos,a23=a22*-sin+a23*cos,a33*=cos,a43*=cos,a12=t1,a22=t2),1!==sz&&(a13*=sz,a23*=sz,a33*=sz,a43*=sz),1!==sy&&(a12*=sy,a22*=sy,a32*=sy,a42*=sy),1!==sx&&(a11*=sx,a21*=sx,a31*=sx,a41*=sx),(zOrigin||isSVG)&&(zOrigin&&(x+=a13*-zOrigin,y+=a23*-zOrigin,z+=a33*-zOrigin+zOrigin),isSVG&&(x+=t.xOrigin-(t.xOrigin*a11+t.yOrigin*a12)+t.xOffset,y+=t.yOrigin-(t.xOrigin*a21+t.yOrigin*a22)+t.yOffset),x<min&&x>-min&&(x=zero),y<min&&y>-min&&(y=zero),z<min&&z>-min&&(z=0)),transform=t.xPercent||t.yPercent?"translate("+t.xPercent+"%,"+t.yPercent+"%) matrix3d(":"matrix3d(",transform+=(a11<min&&a11>-min?zero:a11)+comma+(a21<min&&a21>-min?zero:a21)+comma+(a31<min&&a31>-min?zero:a31),transform+=comma+(a41<min&&a41>-min?zero:a41)+comma+(a12<min&&a12>-min?zero:a12)+comma+(a22<min&&a22>-min?zero:a22),rotationX||rotationY||1!==sz?(transform+=comma+(a32<min&&a32>-min?zero:a32)+comma+(a42<min&&a42>-min?zero:a42)+comma+(a13<min&&a13>-min?zero:a13),transform+=comma+(a23<min&&a23>-min?zero:a23)+comma+(a33<min&&a33>-min?zero:a33)+comma+(a43<min&&a43>-min?zero:a43)+comma):transform+=",0,0,0,0,1,0,",transform+=x+comma+y+comma+z+comma+(perspective?1+-z/perspective:1)+")",style[_transformProp]=transform};p=Transform.prototype,p.x=p.y=p.z=p.skewX=p.skewY=p.rotation=p.rotationX=p.rotationY=p.zOrigin=p.xPercent=p.yPercent=p.xOffset=p.yOffset=0,p.scaleX=p.scaleY=p.scaleZ=1,_registerComplexSpecialProp("transform,scale,scaleX,scaleY,scaleZ,x,y,z,rotation,rotationX,rotationY,rotationZ,skewX,skewY,shortRotation,shortRotationX,shortRotationY,shortRotationZ,transformOrigin,svgOrigin,transformPerspective,directionalRotation,parseTransform,force3D,skewType,xPercent,yPercent,smoothOrigin",{parser:function(t,e,parsingProp,cssp,pt,plugin,vars){if(cssp._lastParsedTransform===vars)return pt;cssp._lastParsedTransform=vars;var swapFunc;"function"==typeof vars[parsingProp]&&(swapFunc=vars[parsingProp],vars[parsingProp]=e);var m2,copy,has3D,hasChange,dr,x,y,matrix,p,originalGSTransform=t._gsTransform,style=t.style,min=1e-6,i=_transformProps.length,v=vars,endRotations={},transformOriginString="transformOrigin",m1=_getTransform(t,_cs,!0,v.parseTransform),orig=v.transform&&("function"==typeof v.transform?v.transform(_index,_target):v.transform);if(cssp._transform=m1,orig&&"string"==typeof orig&&_transformProp)copy=_tempDiv.style,copy[_transformProp]=orig,copy.display="block",copy.position="absolute",_doc.body.appendChild(_tempDiv),m2=_getTransform(_tempDiv,null,!1),m1.svg&&(x=m1.xOrigin,y=m1.yOrigin,m2.x-=m1.xOffset,m2.y-=m1.yOffset,(v.transformOrigin||v.svgOrigin)&&(orig={},_parseSVGOrigin(t,_parsePosition(v.transformOrigin),orig,v.svgOrigin,v.smoothOrigin,!0),x=orig.xOrigin,y=orig.yOrigin,m2.x-=orig.xOffset-m1.xOffset,m2.y-=orig.yOffset-m1.yOffset),(x||y)&&(matrix=_getMatrix(_tempDiv,!0),m2.x-=x-(x*matrix[0]+y*matrix[2]),m2.y-=y-(x*matrix[1]+y*matrix[3]))),_doc.body.removeChild(_tempDiv),m2.perspective||(m2.perspective=m1.perspective),null!=v.xPercent&&(m2.xPercent=_parseVal(v.xPercent,m1.xPercent)),null!=v.yPercent&&(m2.yPercent=_parseVal(v.yPercent,m1.yPercent));else if("object"==typeof v){if(m2={scaleX:_parseVal(null!=v.scaleX?v.scaleX:v.scale,m1.scaleX),scaleY:_parseVal(null!=v.scaleY?v.scaleY:v.scale,m1.scaleY),scaleZ:_parseVal(v.scaleZ,m1.scaleZ),x:_parseVal(v.x,m1.x),y:_parseVal(v.y,m1.y),z:_parseVal(v.z,m1.z),xPercent:_parseVal(v.xPercent,m1.xPercent),yPercent:_parseVal(v.yPercent,m1.yPercent),perspective:_parseVal(v.transformPerspective,m1.perspective)},dr=v.directionalRotation,null!=dr)if("object"==typeof dr)for(copy in dr)v[copy]=dr[copy];else v.rotation=dr;"string"==typeof v.x&&v.x.indexOf("%")!==-1&&(m2.x=0,m2.xPercent=_parseVal(v.x,m1.xPercent)),"string"==typeof v.y&&v.y.indexOf("%")!==-1&&(m2.y=0,m2.yPercent=_parseVal(v.y,m1.yPercent)),m2.rotation=_parseAngle("rotation"in v?v.rotation:"shortRotation"in v?v.shortRotation+"_short":"rotationZ"in v?v.rotationZ:m1.rotation-m1.skewY,m1.rotation-m1.skewY,"rotation",endRotations),_supports3D&&(m2.rotationX=_parseAngle("rotationX"in v?v.rotationX:"shortRotationX"in v?v.shortRotationX+"_short":m1.rotationX||0,m1.rotationX,"rotationX",endRotations),m2.rotationY=_parseAngle("rotationY"in v?v.rotationY:"shortRotationY"in v?v.shortRotationY+"_short":m1.rotationY||0,m1.rotationY,"rotationY",endRotations)),m2.skewX=_parseAngle(v.skewX,m1.skewX-m1.skewY),(m2.skewY=_parseAngle(v.skewY,m1.skewY))&&(m2.skewX+=m2.skewY,m2.rotation+=m2.skewY)}for(_supports3D&&null!=v.force3D&&(m1.force3D=v.force3D,hasChange=!0),m1.skewType=v.skewType||m1.skewType||CSSPlugin.defaultSkewType,has3D=m1.force3D||m1.z||m1.rotationX||m1.rotationY||m2.z||m2.rotationX||m2.rotationY||m2.perspective,has3D||null==v.scale||(m2.scaleZ=1);--i>-1;)p=_transformProps[i],orig=m2[p]-m1[p],(orig>min||orig<-min||null!=v[p]||null!=_forcePT[p])&&(hasChange=!0,pt=new CSSPropTween(m1,p,m1[p],orig,pt),p in endRotations&&(pt.e=endRotations[p]),pt.xs0=0,pt.plugin=plugin,cssp._overwriteProps.push(pt.n));return orig=v.transformOrigin,m1.svg&&(orig||v.svgOrigin)&&(x=m1.xOffset,y=m1.yOffset,_parseSVGOrigin(t,_parsePosition(orig),m2,v.svgOrigin,v.smoothOrigin),pt=_addNonTweeningNumericPT(m1,"xOrigin",(originalGSTransform?m1:m2).xOrigin,m2.xOrigin,pt,transformOriginString),pt=_addNonTweeningNumericPT(m1,"yOrigin",(originalGSTransform?m1:m2).yOrigin,m2.yOrigin,pt,transformOriginString),x===m1.xOffset&&y===m1.yOffset||(pt=_addNonTweeningNumericPT(m1,"xOffset",originalGSTransform?x:m1.xOffset,m1.xOffset,pt,transformOriginString),pt=_addNonTweeningNumericPT(m1,"yOffset",originalGSTransform?y:m1.yOffset,m1.yOffset,pt,transformOriginString)),orig=_useSVGTransformAttr?null:"0px 0px"),(orig||_supports3D&&has3D&&m1.zOrigin)&&(_transformProp?(hasChange=!0,p=_transformOriginProp,orig=(orig||_getStyle(t,p,_cs,!1,"50% 50%"))+"",pt=new CSSPropTween(style,p,0,0,pt,(-1),transformOriginString),pt.b=style[p],pt.plugin=plugin,_supports3D?(copy=m1.zOrigin,orig=orig.split(" "),m1.zOrigin=(orig.length>2&&(0===copy||"0px"!==orig[2])?parseFloat(orig[2]):copy)||0,pt.xs0=pt.e=orig[0]+" "+(orig[1]||"50%")+" 0px",pt=new CSSPropTween(m1,"zOrigin",0,0,pt,(-1),pt.n),pt.b=copy,pt.xs0=pt.e=m1.zOrigin):pt.xs0=pt.e=orig):_parsePosition(orig+"",m1)),hasChange&&(cssp._transformType=m1.svg&&_useSVGTransformAttr||!has3D&&3!==this._transformType?2:3),swapFunc&&(vars[parsingProp]=swapFunc),pt},prefix:!0}),_registerComplexSpecialProp("boxShadow",{defaultValue:"0px 0px 0px 0px #999",prefix:!0,color:!0,multi:!0,keyword:"inset"}),_registerComplexSpecialProp("borderRadius",{defaultValue:"0px",parser:function(t,e,p,cssp,pt,plugin){e=this.format(e);var ea1,i,es2,bs2,bs,es,bn,en,w,h,esfx,bsfx,rel,hn,vn,em,props=["borderTopLeftRadius","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius"],style=t.style;for(w=parseFloat(t.offsetWidth),h=parseFloat(t.offsetHeight),ea1=e.split(" "),i=0;i<props.length;i++)this.p.indexOf("border")&&(props[i]=_checkPropPrefix(props[i])),bs=bs2=_getStyle(t,props[i],_cs,!1,"0px"),bs.indexOf(" ")!==-1&&(bs2=bs.split(" "),bs=bs2[0],bs2=bs2[1]),es=es2=ea1[i],bn=parseFloat(bs),bsfx=bs.substr((bn+"").length),rel="="===es.charAt(1),rel?(en=parseInt(es.charAt(0)+"1",10),es=es.substr(2),en*=parseFloat(es),esfx=es.substr((en+"").length-(en<0?1:0))||""):(en=parseFloat(es),esfx=es.substr((en+"").length)),""===esfx&&(esfx=_suffixMap[p]||bsfx),esfx!==bsfx&&(hn=_convertToPixels(t,"borderLeft",bn,bsfx),vn=_convertToPixels(t,"borderTop",bn,bsfx),"%"===esfx?(bs=hn/w*100+"%",bs2=vn/h*100+"%"):"em"===esfx?(em=_convertToPixels(t,"borderLeft",1,"em"),bs=hn/em+"em",bs2=vn/em+"em"):(bs=hn+"px",bs2=vn+"px"),rel&&(es=parseFloat(bs)+en+esfx,es2=parseFloat(bs2)+en+esfx)),pt=_parseComplex(style,props[i],bs+" "+bs2,es+" "+es2,!1,"0px",pt);return pt},prefix:!0,formatter:_getFormatter("0px 0px 0px 0px",!1,!0)}),_registerComplexSpecialProp("borderBottomLeftRadius,borderBottomRightRadius,borderTopLeftRadius,borderTopRightRadius",{defaultValue:"0px",parser:function(t,e,p,cssp,pt,plugin){return _parseComplex(t.style,p,this.format(_getStyle(t,p,_cs,!1,"0px 0px")),this.format(e),!1,"0px",pt)},prefix:!0,formatter:_getFormatter("0px 0px",!1,!0)}),_registerComplexSpecialProp("backgroundPosition",{defaultValue:"0 0",parser:function(t,e,p,cssp,pt,plugin){var ba,ea,i,pct,overlap,src,bp="background-position",cs=_cs||_getComputedStyle(t,null),bs=this.format((cs?_ieVers?cs.getPropertyValue(bp+"-x")+" "+cs.getPropertyValue(bp+"-y"):cs.getPropertyValue(bp):t.currentStyle.backgroundPositionX+" "+t.currentStyle.backgroundPositionY)||"0 0"),es=this.format(e);if(bs.indexOf("%")!==-1!=(es.indexOf("%")!==-1)&&es.split(",").length<2&&(src=_getStyle(t,"backgroundImage").replace(_urlExp,""),src&&"none"!==src)){for(ba=bs.split(" "),ea=es.split(" "),_tempImg.setAttribute("src",src),i=2;--i>-1;)bs=ba[i],pct=bs.indexOf("%")!==-1,pct!==(ea[i].indexOf("%")!==-1)&&(overlap=0===i?t.offsetWidth-_tempImg.width:t.offsetHeight-_tempImg.height,ba[i]=pct?parseFloat(bs)/100*overlap+"px":parseFloat(bs)/overlap*100+"%");bs=ba.join(" ")}return this.parseComplex(t.style,bs,es,pt,plugin)},formatter:_parsePosition}),_registerComplexSpecialProp("backgroundSize",{defaultValue:"0 0",formatter:function(v){return v+="",_parsePosition(v.indexOf(" ")===-1?v+" "+v:v)}}),_registerComplexSpecialProp("perspective",{defaultValue:"0px",prefix:!0}),_registerComplexSpecialProp("perspectiveOrigin",{defaultValue:"50% 50%",prefix:!0}),_registerComplexSpecialProp("transformStyle",{prefix:!0}),_registerComplexSpecialProp("backfaceVisibility",{prefix:!0}),_registerComplexSpecialProp("userSelect",{prefix:!0}),_registerComplexSpecialProp("margin",{parser:_getEdgeParser("marginTop,marginRight,marginBottom,marginLeft")}),_registerComplexSpecialProp("padding",{parser:_getEdgeParser("paddingTop,paddingRight,paddingBottom,paddingLeft")}),_registerComplexSpecialProp("clip",{defaultValue:"rect(0px,0px,0px,0px)",parser:function(t,e,p,cssp,pt,plugin){var b,cs,delim;return _ieVers<9?(cs=t.currentStyle,delim=_ieVers<8?" ":",",b="rect("+cs.clipTop+delim+cs.clipRight+delim+cs.clipBottom+delim+cs.clipLeft+")",e=this.format(e).split(",").join(delim)):(b=this.format(_getStyle(t,this.p,_cs,!1,this.dflt)),e=this.format(e)),this.parseComplex(t.style,b,e,pt,plugin)}}),_registerComplexSpecialProp("textShadow",{defaultValue:"0px 0px 0px #999",color:!0,multi:!0}),_registerComplexSpecialProp("autoRound,strictUnits",{parser:function(t,e,p,cssp,pt){return pt}}),_registerComplexSpecialProp("border",{defaultValue:"0px solid #000",parser:function(t,e,p,cssp,pt,plugin){var bw=_getStyle(t,"borderTopWidth",_cs,!1,"0px"),end=this.format(e).split(" "),esfx=end[0].replace(_suffixExp,"");return"px"!==esfx&&(bw=parseFloat(bw)/_convertToPixels(t,"borderTopWidth",1,esfx)+esfx),this.parseComplex(t.style,this.format(bw+" "+_getStyle(t,"borderTopStyle",_cs,!1,"solid")+" "+_getStyle(t,"borderTopColor",_cs,!1,"#000")),end.join(" "),pt,plugin)},color:!0,formatter:function(v){var a=v.split(" ");return a[0]+" "+(a[1]||"solid")+" "+(v.match(_colorExp)||["#000"])[0]}}),_registerComplexSpecialProp("borderWidth",{parser:_getEdgeParser("borderTopWidth,borderRightWidth,borderBottomWidth,borderLeftWidth")}),_registerComplexSpecialProp("float,cssFloat,styleFloat",{parser:function(t,e,p,cssp,pt,plugin){var s=t.style,prop="cssFloat"in s?"cssFloat":"styleFloat";return new CSSPropTween(s,prop,0,0,pt,(-1),p,(!1),0,s[prop],e)}});var _setIEOpacityRatio=function(v){var skip,t=this.t,filters=t.filter||_getStyle(this.data,"filter")||"",val=this.s+this.c*v|0;100===val&&(filters.indexOf("atrix(")===-1&&filters.indexOf("radient(")===-1&&filters.indexOf("oader(")===-1?(t.removeAttribute("filter"),skip=!_getStyle(this.data,"filter")):(t.filter=filters.replace(_alphaFilterExp,""),
skip=!0)),skip||(this.xn1&&(t.filter=filters=filters||"alpha(opacity="+val+")"),filters.indexOf("pacity")===-1?0===val&&this.xn1||(t.filter=filters+" alpha(opacity="+val+")"):t.filter=filters.replace(_opacityExp,"opacity="+val))};_registerComplexSpecialProp("opacity,alpha,autoAlpha",{defaultValue:"1",parser:function(t,e,p,cssp,pt,plugin){var b=parseFloat(_getStyle(t,"opacity",_cs,!1,"1")),style=t.style,isAutoAlpha="autoAlpha"===p;return"string"==typeof e&&"="===e.charAt(1)&&(e=("-"===e.charAt(0)?-1:1)*parseFloat(e.substr(2))+b),isAutoAlpha&&1===b&&"hidden"===_getStyle(t,"visibility",_cs)&&0!==e&&(b=0),_supportsOpacity?pt=new CSSPropTween(style,"opacity",b,e-b,pt):(pt=new CSSPropTween(style,"opacity",100*b,100*(e-b),pt),pt.xn1=isAutoAlpha?1:0,style.zoom=1,pt.type=2,pt.b="alpha(opacity="+pt.s+")",pt.e="alpha(opacity="+(pt.s+pt.c)+")",pt.data=t,pt.plugin=plugin,pt.setRatio=_setIEOpacityRatio),isAutoAlpha&&(pt=new CSSPropTween(style,"visibility",0,0,pt,(-1),null,(!1),0,0!==b?"inherit":"hidden",0===e?"hidden":"inherit"),pt.xs0="inherit",cssp._overwriteProps.push(pt.n),cssp._overwriteProps.push(p)),pt}});var _removeProp=function(s,p){p&&(s.removeProperty?("ms"!==p.substr(0,2)&&"webkit"!==p.substr(0,6)||(p="-"+p),s.removeProperty(p.replace(_capsExp,"-$1").toLowerCase())):s.removeAttribute(p))},_setClassNameRatio=function(v){if(this.t._gsClassPT=this,1===v||0===v){this.t.setAttribute("class",0===v?this.b:this.e);for(var mpt=this.data,s=this.t.style;mpt;)mpt.v?s[mpt.p]=mpt.v:_removeProp(s,mpt.p),mpt=mpt._next;1===v&&this.t._gsClassPT===this&&(this.t._gsClassPT=null)}else this.t.getAttribute("class")!==this.e&&this.t.setAttribute("class",this.e)};_registerComplexSpecialProp("className",{parser:function(t,e,p,cssp,pt,plugin,vars){var difData,bs,cnpt,cnptLookup,mpt,b=t.getAttribute("class")||"",cssText=t.style.cssText;if(pt=cssp._classNamePT=new CSSPropTween(t,p,0,0,pt,2),pt.setRatio=_setClassNameRatio,pt.pr=-11,_hasPriority=!0,pt.b=b,bs=_getAllStyles(t,_cs),cnpt=t._gsClassPT){for(cnptLookup={},mpt=cnpt.data;mpt;)cnptLookup[mpt.p]=1,mpt=mpt._next;cnpt.setRatio(1)}return t._gsClassPT=pt,pt.e="="!==e.charAt(1)?e:b.replace(new RegExp("(?:\\s|^)"+e.substr(2)+"(?![\\w-])"),"")+("+"===e.charAt(0)?" "+e.substr(2):""),t.setAttribute("class",pt.e),difData=_cssDif(t,bs,_getAllStyles(t),vars,cnptLookup),t.setAttribute("class",b),pt.data=difData.firstMPT,t.style.cssText=cssText,pt=pt.xfirst=cssp.parse(t,difData.difs,pt,plugin)}});var _setClearPropsRatio=function(v){if((1===v||0===v)&&this.data._totalTime===this.data._totalDuration&&"isFromStart"!==this.data.data){var a,p,i,clearTransform,transform,s=this.t.style,transformParse=_specialProps.transform.parse;if("all"===this.e)s.cssText="",clearTransform=!0;else for(a=this.e.split(" ").join("").split(","),i=a.length;--i>-1;)p=a[i],_specialProps[p]&&(_specialProps[p].parse===transformParse?clearTransform=!0:p="transformOrigin"===p?_transformOriginProp:_specialProps[p].p),_removeProp(s,p);clearTransform&&(_removeProp(s,_transformProp),transform=this.t._gsTransform,transform&&(transform.svg&&(this.t.removeAttribute("data-svg-origin"),this.t.removeAttribute("transform")),delete this.t._gsTransform))}};for(_registerComplexSpecialProp("clearProps",{parser:function(t,e,p,cssp,pt){return pt=new CSSPropTween(t,p,0,0,pt,2),pt.setRatio=_setClearPropsRatio,pt.e=e,pt.pr=-10,pt.data=cssp._tween,_hasPriority=!0,pt}}),p="bezier,throwProps,physicsProps,physics2D".split(","),i=p.length;i--;)_registerPluginProp(p[i]);p=CSSPlugin.prototype,p._firstPT=p._lastParsedTransform=p._transform=null,p._onInitTween=function(target,vars,tween,index){if(!target.nodeType)return!1;this._target=_target=target,this._tween=tween,this._vars=vars,_index=index,_autoRound=vars.autoRound,_hasPriority=!1,_suffixMap=vars.suffixMap||CSSPlugin.suffixMap,_cs=_getComputedStyle(target,""),_overwriteProps=this._overwriteProps;var v,pt,pt2,first,last,next,zIndex,tpt,threeD,style=target.style;if(_reqSafariFix&&""===style.zIndex&&(v=_getStyle(target,"zIndex",_cs),"auto"!==v&&""!==v||this._addLazySet(style,"zIndex",0)),"string"==typeof vars&&(first=style.cssText,v=_getAllStyles(target,_cs),style.cssText=first+";"+vars,v=_cssDif(target,v,_getAllStyles(target)).difs,!_supportsOpacity&&_opacityValExp.test(vars)&&(v.opacity=parseFloat(RegExp.$1)),vars=v,style.cssText=first),vars.className?this._firstPT=pt=_specialProps.className.parse(target,vars.className,"className",this,null,null,vars):this._firstPT=pt=this.parse(target,vars,null),this._transformType){for(threeD=3===this._transformType,_transformProp?_isSafari&&(_reqSafariFix=!0,""===style.zIndex&&(zIndex=_getStyle(target,"zIndex",_cs),"auto"!==zIndex&&""!==zIndex||this._addLazySet(style,"zIndex",0)),_isSafariLT6&&this._addLazySet(style,"WebkitBackfaceVisibility",this._vars.WebkitBackfaceVisibility||(threeD?"visible":"hidden"))):style.zoom=1,pt2=pt;pt2&&pt2._next;)pt2=pt2._next;tpt=new CSSPropTween(target,"transform",0,0,null,2),this._linkCSSP(tpt,null,pt2),tpt.setRatio=_transformProp?_setTransformRatio:_setIETransformRatio,tpt.data=this._transform||_getTransform(target,_cs,!0),tpt.tween=tween,tpt.pr=-1,_overwriteProps.pop()}if(_hasPriority){for(;pt;){for(next=pt._next,pt2=first;pt2&&pt2.pr>pt.pr;)pt2=pt2._next;(pt._prev=pt2?pt2._prev:last)?pt._prev._next=pt:first=pt,(pt._next=pt2)?pt2._prev=pt:last=pt,pt=next}this._firstPT=first}return!0},p.parse=function(target,vars,pt,plugin){var p,sp,bn,en,bs,es,bsfx,esfx,isStr,rel,style=target.style;for(p in vars)es=vars[p],"function"==typeof es&&(es=es(_index,_target)),sp=_specialProps[p],sp?pt=sp.parse(target,es,p,this,pt,plugin,vars):(bs=_getStyle(target,p,_cs)+"",isStr="string"==typeof es,"color"===p||"fill"===p||"stroke"===p||p.indexOf("Color")!==-1||isStr&&_rgbhslExp.test(es)?(isStr||(es=_parseColor(es),es=(es.length>3?"rgba(":"rgb(")+es.join(",")+")"),pt=_parseComplex(style,p,bs,es,!0,"transparent",pt,0,plugin)):isStr&&_complexExp.test(es)?pt=_parseComplex(style,p,bs,es,!0,null,pt,0,plugin):(bn=parseFloat(bs),bsfx=bn||0===bn?bs.substr((bn+"").length):"",""!==bs&&"auto"!==bs||("width"===p||"height"===p?(bn=_getDimension(target,p,_cs),bsfx="px"):"left"===p||"top"===p?(bn=_calculateOffset(target,p,_cs),bsfx="px"):(bn="opacity"!==p?0:1,bsfx="")),rel=isStr&&"="===es.charAt(1),rel?(en=parseInt(es.charAt(0)+"1",10),es=es.substr(2),en*=parseFloat(es),esfx=es.replace(_suffixExp,"")):(en=parseFloat(es),esfx=isStr?es.replace(_suffixExp,""):""),""===esfx&&(esfx=p in _suffixMap?_suffixMap[p]:bsfx),es=en||0===en?(rel?en+bn:en)+esfx:vars[p],bsfx!==esfx&&""!==esfx&&(en||0===en)&&bn&&(bn=_convertToPixels(target,p,bn,bsfx),"%"===esfx?(bn/=_convertToPixels(target,p,100,"%")/100,vars.strictUnits!==!0&&(bs=bn+"%")):"em"===esfx||"rem"===esfx||"vw"===esfx||"vh"===esfx?bn/=_convertToPixels(target,p,1,esfx):"px"!==esfx&&(en=_convertToPixels(target,p,en,esfx),esfx="px"),rel&&(en||0===en)&&(es=en+bn+esfx)),rel&&(en+=bn),!bn&&0!==bn||!en&&0!==en?void 0!==style[p]&&(es||es+""!="NaN"&&null!=es)?(pt=new CSSPropTween(style,p,en||bn||0,0,pt,(-1),p,(!1),0,bs,es),pt.xs0="none"!==es||"display"!==p&&p.indexOf("Style")===-1?es:bs):_log("invalid "+p+" tween value: "+vars[p]):(pt=new CSSPropTween(style,p,bn,en-bn,pt,0,p,_autoRound!==!1&&("px"===esfx||"zIndex"===p),0,bs,es),pt.xs0=esfx))),plugin&&pt&&!pt.plugin&&(pt.plugin=plugin);return pt},p.setRatio=function(v){var val,str,i,pt=this._firstPT,min=1e-6;if(1!==v||this._tween._time!==this._tween._duration&&0!==this._tween._time)if(v||this._tween._time!==this._tween._duration&&0!==this._tween._time||this._tween._rawPrevTime===-1e-6)for(;pt;){if(val=pt.c*v+pt.s,pt.r?val=Math.round(val):val<min&&val>-min&&(val=0),pt.type)if(1===pt.type)if(i=pt.l,2===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2;else if(3===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2+pt.xn2+pt.xs3;else if(4===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2+pt.xn2+pt.xs3+pt.xn3+pt.xs4;else if(5===i)pt.t[pt.p]=pt.xs0+val+pt.xs1+pt.xn1+pt.xs2+pt.xn2+pt.xs3+pt.xn3+pt.xs4+pt.xn4+pt.xs5;else{for(str=pt.xs0+val+pt.xs1,i=1;i<pt.l;i++)str+=pt["xn"+i]+pt["xs"+(i+1)];pt.t[pt.p]=str}else pt.type===-1?pt.t[pt.p]=pt.xs0:pt.setRatio&&pt.setRatio(v);else pt.t[pt.p]=val+pt.xs0;pt=pt._next}else for(;pt;)2!==pt.type?pt.t[pt.p]=pt.b:pt.setRatio(v),pt=pt._next;else for(;pt;){if(2!==pt.type)if(pt.r&&pt.type!==-1)if(val=Math.round(pt.s+pt.c),pt.type){if(1===pt.type){for(i=pt.l,str=pt.xs0+val+pt.xs1,i=1;i<pt.l;i++)str+=pt["xn"+i]+pt["xs"+(i+1)];pt.t[pt.p]=str}}else pt.t[pt.p]=val+pt.xs0;else pt.t[pt.p]=pt.e;else pt.setRatio(v);pt=pt._next}},p._enableTransforms=function(threeD){this._transform=this._transform||_getTransform(this._target,_cs,!0),this._transformType=this._transform.svg&&_useSVGTransformAttr||!threeD&&3!==this._transformType?2:3};var lazySet=function(v){this.t[this.p]=this.e,this.data._linkCSSP(this,this._next,null,!0)};p._addLazySet=function(t,p,v){var pt=this._firstPT=new CSSPropTween(t,p,0,0,this._firstPT,2);pt.e=v,pt.setRatio=lazySet,pt.data=this},p._linkCSSP=function(pt,next,prev,remove){return pt&&(next&&(next._prev=pt),pt._next&&(pt._next._prev=pt._prev),pt._prev?pt._prev._next=pt._next:this._firstPT===pt&&(this._firstPT=pt._next,remove=!0),prev?prev._next=pt:remove||null!==this._firstPT||(this._firstPT=pt),pt._next=next,pt._prev=prev),pt},p._mod=function(lookup){for(var pt=this._firstPT;pt;)"function"==typeof lookup[pt.p]&&lookup[pt.p]===Math.round&&(pt.r=1),pt=pt._next},p._kill=function(lookup){var pt,p,xfirst,copy=lookup;if(lookup.autoAlpha||lookup.alpha){copy={};for(p in lookup)copy[p]=lookup[p];copy.opacity=1,copy.autoAlpha&&(copy.visibility=1)}for(lookup.className&&(pt=this._classNamePT)&&(xfirst=pt.xfirst,xfirst&&xfirst._prev?this._linkCSSP(xfirst._prev,pt._next,xfirst._prev._prev):xfirst===this._firstPT&&(this._firstPT=pt._next),pt._next&&this._linkCSSP(pt._next,pt._next._next,xfirst._prev),this._classNamePT=null),pt=this._firstPT;pt;)pt.plugin&&pt.plugin!==p&&pt.plugin._kill&&(pt.plugin._kill(lookup),p=pt.plugin),pt=pt._next;return TweenPlugin.prototype._kill.call(this,copy)};var _getChildStyles=function(e,props,targets){var children,i,child,type;if(e.slice)for(i=e.length;--i>-1;)_getChildStyles(e[i],props,targets);else for(children=e.childNodes,i=children.length;--i>-1;)child=children[i],type=child.type,child.style&&(props.push(_getAllStyles(child)),targets&&targets.push(child)),1!==type&&9!==type&&11!==type||!child.childNodes.length||_getChildStyles(child,props,targets)};return CSSPlugin.cascadeTo=function(target,duration,vars){var i,difs,p,from,tween=TweenLite.to(target,duration,vars),results=[tween],b=[],e=[],targets=[],_reservedProps=TweenLite._internals.reservedProps;for(target=tween._targets||tween.target,_getChildStyles(target,b,targets),tween.render(duration,!0,!0),_getChildStyles(target,e),tween.render(0,!0,!0),tween._enabled(!0),i=targets.length;--i>-1;)if(difs=_cssDif(targets[i],b[i],e[i]),difs.firstMPT){difs=difs.difs;for(p in vars)_reservedProps[p]&&(difs[p]=vars[p]);from={};for(p in difs)from[p]=b[i][p];results.push(TweenLite.fromTo(targets[i],duration,from,difs))}return results},TweenPlugin.activate([CSSPlugin]),CSSPlugin},!0),function(){var RoundPropsPlugin=_gsScope._gsDefine.plugin({propName:"roundProps",version:"1.6.0",priority:-1,API:2,init:function(target,value,tween){return this._tween=tween,!0}}),_roundLinkedList=function(node){for(;node;)node.f||node.blob||(node.m=Math.round),node=node._next},p=RoundPropsPlugin.prototype;p._onInitAllProps=function(){for(var prop,pt,next,tween=this._tween,rp=tween.vars.roundProps.join?tween.vars.roundProps:tween.vars.roundProps.split(","),i=rp.length,lookup={},rpt=tween._propLookup.roundProps;--i>-1;)lookup[rp[i]]=Math.round;for(i=rp.length;--i>-1;)for(prop=rp[i],pt=tween._firstPT;pt;)next=pt._next,pt.pg?pt.t._mod(lookup):pt.n===prop&&(2===pt.f&&pt.t?_roundLinkedList(pt.t._firstPT):(this._add(pt.t,prop,pt.s,pt.c),next&&(next._prev=pt._prev),pt._prev?pt._prev._next=next:tween._firstPT===pt&&(tween._firstPT=next),pt._next=pt._prev=null,tween._propLookup[prop]=rpt)),pt=next;return!1},p._add=function(target,p,s,c){this._addTween(target,p,s,s+c,p,Math.round),this._overwriteProps.push(p)}}(),function(){_gsScope._gsDefine.plugin({propName:"attr",API:2,version:"0.6.0",init:function(target,value,tween,index){var p,end;if("function"!=typeof target.setAttribute)return!1;for(p in value)end=value[p],"function"==typeof end&&(end=end(index,target)),this._addTween(target,"setAttribute",target.getAttribute(p)+"",end+"",p,!1,p),this._overwriteProps.push(p);return!0}})}(),_gsScope._gsDefine.plugin({propName:"directionalRotation",version:"0.3.0",API:2,init:function(target,value,tween,index){"object"!=typeof value&&(value={rotation:value}),this.finals={};var p,v,start,end,dif,split,cap=value.useRadians===!0?2*Math.PI:360,min=1e-6;for(p in value)"useRadians"!==p&&(end=value[p],"function"==typeof end&&(end=end(index,target)),split=(end+"").split("_"),v=split[0],start=parseFloat("function"!=typeof target[p]?target[p]:target[p.indexOf("set")||"function"!=typeof target["get"+p.substr(3)]?p:"get"+p.substr(3)]()),end=this.finals[p]="string"==typeof v&&"="===v.charAt(1)?start+parseInt(v.charAt(0)+"1",10)*Number(v.substr(2)):Number(v)||0,dif=end-start,split.length&&(v=split.join("_"),v.indexOf("short")!==-1&&(dif%=cap,dif!==dif%(cap/2)&&(dif=dif<0?dif+cap:dif-cap)),v.indexOf("_cw")!==-1&&dif<0?dif=(dif+9999999999*cap)%cap-(dif/cap|0)*cap:v.indexOf("ccw")!==-1&&dif>0&&(dif=(dif-9999999999*cap)%cap-(dif/cap|0)*cap)),(dif>min||dif<-min)&&(this._addTween(target,p,start,start+dif,p),this._overwriteProps.push(p)));return!0},set:function(ratio){var pt;if(1!==ratio)this._super.setRatio.call(this,ratio);else for(pt=this._firstPT;pt;)pt.f?pt.t[pt.p](this.finals[pt.p]):pt.t[pt.p]=this.finals[pt.p],pt=pt._next}})._autoCSS=!0,_gsScope._gsDefine("easing.Back",["easing.Ease"],function(Ease){var SteppedEase,RoughEase,_createElastic,w=_gsScope.GreenSockGlobals||_gsScope,gs=w.com.greensock,_2PI=2*Math.PI,_HALF_PI=Math.PI/2,_class=gs._class,_create=function(n,f){var C=_class("easing."+n,function(){},!0),p=C.prototype=new Ease;return p.constructor=C,p.getRatio=f,C},_easeReg=Ease.register||function(){},_wrap=function(name,EaseOut,EaseIn,EaseInOut,aliases){var C=_class("easing."+name,{easeOut:new EaseOut,easeIn:new EaseIn,easeInOut:new EaseInOut},!0);return _easeReg(C,name),C},EasePoint=function(time,value,next){this.t=time,this.v=value,next&&(this.next=next,next.prev=this,this.c=next.v-value,this.gap=next.t-time)},_createBack=function(n,f){var C=_class("easing."+n,function(overshoot){this._p1=overshoot||0===overshoot?overshoot:1.70158,this._p2=1.525*this._p1},!0),p=C.prototype=new Ease;return p.constructor=C,p.getRatio=f,p.config=function(overshoot){return new C(overshoot)},C},Back=_wrap("Back",_createBack("BackOut",function(p){return(p-=1)*p*((this._p1+1)*p+this._p1)+1}),_createBack("BackIn",function(p){return p*p*((this._p1+1)*p-this._p1)}),_createBack("BackInOut",function(p){return(p*=2)<1?.5*p*p*((this._p2+1)*p-this._p2):.5*((p-=2)*p*((this._p2+1)*p+this._p2)+2)})),SlowMo=_class("easing.SlowMo",function(linearRatio,power,yoyoMode){power=power||0===power?power:.7,null==linearRatio?linearRatio=.7:linearRatio>1&&(linearRatio=1),this._p=1!==linearRatio?power:0,this._p1=(1-linearRatio)/2,this._p2=linearRatio,this._p3=this._p1+this._p2,this._calcEnd=yoyoMode===!0},!0),p=SlowMo.prototype=new Ease;return p.constructor=SlowMo,p.getRatio=function(p){var r=p+(.5-p)*this._p;return p<this._p1?this._calcEnd?1-(p=1-p/this._p1)*p:r-(p=1-p/this._p1)*p*p*p*r:p>this._p3?this._calcEnd?1-(p=(p-this._p3)/this._p1)*p:r+(p-r)*(p=(p-this._p3)/this._p1)*p*p*p:this._calcEnd?1:r},SlowMo.ease=new SlowMo(.7,.7),p.config=SlowMo.config=function(linearRatio,power,yoyoMode){return new SlowMo(linearRatio,power,yoyoMode)},SteppedEase=_class("easing.SteppedEase",function(steps){steps=steps||1,this._p1=1/steps,this._p2=steps+1},!0),p=SteppedEase.prototype=new Ease,p.constructor=SteppedEase,p.getRatio=function(p){return p<0?p=0:p>=1&&(p=.999999999),(this._p2*p>>0)*this._p1},p.config=SteppedEase.config=function(steps){return new SteppedEase(steps)},RoughEase=_class("easing.RoughEase",function(vars){vars=vars||{};for(var x,y,bump,invX,obj,pnt,taper=vars.taper||"none",a=[],cnt=0,points=0|(vars.points||20),i=points,randomize=vars.randomize!==!1,clamp=vars.clamp===!0,template=vars.template instanceof Ease?vars.template:null,strength="number"==typeof vars.strength?.4*vars.strength:.4;--i>-1;)x=randomize?Math.random():1/points*i,y=template?template.getRatio(x):x,"none"===taper?bump=strength:"out"===taper?(invX=1-x,bump=invX*invX*strength):"in"===taper?bump=x*x*strength:x<.5?(invX=2*x,bump=invX*invX*.5*strength):(invX=2*(1-x),bump=invX*invX*.5*strength),randomize?y+=Math.random()*bump-.5*bump:i%2?y+=.5*bump:y-=.5*bump,clamp&&(y>1?y=1:y<0&&(y=0)),a[cnt++]={x:x,y:y};for(a.sort(function(a,b){return a.x-b.x}),pnt=new EasePoint(1,1,null),i=points;--i>-1;)obj=a[i],pnt=new EasePoint(obj.x,obj.y,pnt);this._prev=new EasePoint(0,0,0!==pnt.t?pnt:pnt.next)},!0),p=RoughEase.prototype=new Ease,p.constructor=RoughEase,p.getRatio=function(p){var pnt=this._prev;if(p>pnt.t){for(;pnt.next&&p>=pnt.t;)pnt=pnt.next;pnt=pnt.prev}else for(;pnt.prev&&p<=pnt.t;)pnt=pnt.prev;return this._prev=pnt,pnt.v+(p-pnt.t)/pnt.gap*pnt.c},p.config=function(vars){return new RoughEase(vars)},RoughEase.ease=new RoughEase,_wrap("Bounce",_create("BounceOut",function(p){return p<1/2.75?7.5625*p*p:p<2/2.75?7.5625*(p-=1.5/2.75)*p+.75:p<2.5/2.75?7.5625*(p-=2.25/2.75)*p+.9375:7.5625*(p-=2.625/2.75)*p+.984375}),_create("BounceIn",function(p){return(p=1-p)<1/2.75?1-7.5625*p*p:p<2/2.75?1-(7.5625*(p-=1.5/2.75)*p+.75):p<2.5/2.75?1-(7.5625*(p-=2.25/2.75)*p+.9375):1-(7.5625*(p-=2.625/2.75)*p+.984375)}),_create("BounceInOut",function(p){var invert=p<.5;return p=invert?1-2*p:2*p-1,p=p<1/2.75?7.5625*p*p:p<2/2.75?7.5625*(p-=1.5/2.75)*p+.75:p<2.5/2.75?7.5625*(p-=2.25/2.75)*p+.9375:7.5625*(p-=2.625/2.75)*p+.984375,invert?.5*(1-p):.5*p+.5})),_wrap("Circ",_create("CircOut",function(p){return Math.sqrt(1-(p-=1)*p)}),_create("CircIn",function(p){return-(Math.sqrt(1-p*p)-1)}),_create("CircInOut",function(p){return(p*=2)<1?-.5*(Math.sqrt(1-p*p)-1):.5*(Math.sqrt(1-(p-=2)*p)+1)})),_createElastic=function(n,f,def){var C=_class("easing."+n,function(amplitude,period){this._p1=amplitude>=1?amplitude:1,this._p2=(period||def)/(amplitude<1?amplitude:1),this._p3=this._p2/_2PI*(Math.asin(1/this._p1)||0),this._p2=_2PI/this._p2},!0),p=C.prototype=new Ease;return p.constructor=C,p.getRatio=f,p.config=function(amplitude,period){return new C(amplitude,period)},C},_wrap("Elastic",_createElastic("ElasticOut",function(p){return this._p1*Math.pow(2,-10*p)*Math.sin((p-this._p3)*this._p2)+1},.3),_createElastic("ElasticIn",function(p){return-(this._p1*Math.pow(2,10*(p-=1))*Math.sin((p-this._p3)*this._p2))},.3),_createElastic("ElasticInOut",function(p){return(p*=2)<1?-.5*(this._p1*Math.pow(2,10*(p-=1))*Math.sin((p-this._p3)*this._p2)):this._p1*Math.pow(2,-10*(p-=1))*Math.sin((p-this._p3)*this._p2)*.5+1},.45)),_wrap("Expo",_create("ExpoOut",function(p){return 1-Math.pow(2,-10*p)}),_create("ExpoIn",function(p){return Math.pow(2,10*(p-1))-.001}),_create("ExpoInOut",function(p){return(p*=2)<1?.5*Math.pow(2,10*(p-1)):.5*(2-Math.pow(2,-10*(p-1)))})),_wrap("Sine",_create("SineOut",function(p){return Math.sin(p*_HALF_PI)}),_create("SineIn",function(p){return-Math.cos(p*_HALF_PI)+1}),_create("SineInOut",function(p){return-.5*(Math.cos(Math.PI*p)-1)})),_class("easing.EaseLookup",{find:function(s){return Ease.map[s]}},!0),_easeReg(w.SlowMo,"SlowMo","ease,"),_easeReg(RoughEase,"RoughEase","ease,"),_easeReg(SteppedEase,"SteppedEase","ease,"),Back},!0)}),_gsScope._gsDefine&&_gsScope._gsQueue.pop()(),function(window,moduleName){"use strict";var _exports={},_globals=window.GreenSockGlobals=window.GreenSockGlobals||window;if(!_globals.TweenLite){var a,i,p,_ticker,_tickerActive,_namespace=function(ns){var i,a=ns.split("."),p=_globals;for(i=0;i<a.length;i++)p[a[i]]=p=p[a[i]]||{};return p},gs=_namespace("com.greensock"),_tinyNum=1e-10,_slice=function(a){var i,b=[],l=a.length;for(i=0;i!==l;b.push(a[i++]));return b},_emptyFunc=function(){},_isArray=function(){var toString=Object.prototype.toString,array=toString.call([]);return function(obj){return null!=obj&&(obj instanceof Array||"object"==typeof obj&&!!obj.push&&toString.call(obj)===array)}}(),_defLookup={},Definition=function(ns,dependencies,func,global){this.sc=_defLookup[ns]?_defLookup[ns].sc:[],_defLookup[ns]=this,this.gsClass=null,this.func=func;var _classes=[];this.check=function(init){for(var cur,a,n,cl,hasModule,i=dependencies.length,missing=i;--i>-1;)(cur=_defLookup[dependencies[i]]||new Definition(dependencies[i],[])).gsClass?(_classes[i]=cur.gsClass,missing--):init&&cur.sc.push(this);if(0===missing&&func){if(a=("com.greensock."+ns).split("."),n=a.pop(),cl=_namespace(a.join("."))[n]=this.gsClass=func.apply(func,_classes),global)if(_globals[n]=_exports[n]=cl,hasModule="undefined"!=typeof module&&module.exports,!hasModule&&"function"==typeof define&&define.amd)define((window.GreenSockAMDPath?window.GreenSockAMDPath+"/":"")+ns.split(".").pop(),[],function(){return cl});else if(hasModule)if(ns===moduleName){module.exports=_exports[moduleName]=cl;for(i in _exports)cl[i]=_exports[i]}else _exports[moduleName]&&(_exports[moduleName][n]=cl);for(i=0;i<this.sc.length;i++)this.sc[i].check()}},this.check(!0)},_gsDefine=window._gsDefine=function(ns,dependencies,func,global){return new Definition(ns,dependencies,func,global)},_class=gs._class=function(ns,func,global){return func=func||function(){},_gsDefine(ns,[],function(){return func},global),func};_gsDefine.globals=_globals;var _baseParams=[0,0,1,1],Ease=_class("easing.Ease",function(func,extraParams,type,power){this._func=func,this._type=type||0,this._power=power||0,this._params=extraParams?_baseParams.concat(extraParams):_baseParams},!0),_easeMap=Ease.map={},_easeReg=Ease.register=function(ease,names,types,create){for(var e,name,j,type,na=names.split(","),i=na.length,ta=(types||"easeIn,easeOut,easeInOut").split(",");--i>-1;)for(name=na[i],e=create?_class("easing."+name,null,!0):gs.easing[name]||{},j=ta.length;--j>-1;)type=ta[j],_easeMap[name+"."+type]=_easeMap[type+name]=e[type]=ease.getRatio?ease:ease[type]||new ease};for(p=Ease.prototype,p._calcEnd=!1,p.getRatio=function(p){if(this._func)return this._params[0]=p,this._func.apply(null,this._params);var t=this._type,pw=this._power,r=1===t?1-p:2===t?p:p<.5?2*p:2*(1-p);return 1===pw?r*=r:2===pw?r*=r*r:3===pw?r*=r*r*r:4===pw&&(r*=r*r*r*r),1===t?1-r:2===t?r:p<.5?r/2:1-r/2},a=["Linear","Quad","Cubic","Quart","Quint,Strong"],i=a.length;--i>-1;)p=a[i]+",Power"+i,_easeReg(new Ease(null,null,1,i),p,"easeOut",!0),_easeReg(new Ease(null,null,2,i),p,"easeIn"+(0===i?",easeNone":"")),_easeReg(new Ease(null,null,3,i),p,"easeInOut");_easeMap.linear=gs.easing.Linear.easeIn,_easeMap.swing=gs.easing.Quad.easeInOut;var EventDispatcher=_class("events.EventDispatcher",function(target){this._listeners={},this._eventTarget=target||this});p=EventDispatcher.prototype,p.addEventListener=function(type,callback,scope,useParam,priority){priority=priority||0;var listener,i,list=this._listeners[type],index=0;for(this!==_ticker||_tickerActive||_ticker.wake(),null==list&&(this._listeners[type]=list=[]),i=list.length;--i>-1;)listener=list[i],listener.c===callback&&listener.s===scope?list.splice(i,1):0===index&&listener.pr<priority&&(index=i+1);list.splice(index,0,{c:callback,s:scope,up:useParam,pr:priority})},p.removeEventListener=function(type,callback){var i,list=this._listeners[type];if(list)for(i=list.length;--i>-1;)if(list[i].c===callback)return void list.splice(i,1)},p.dispatchEvent=function(type){var i,t,listener,list=this._listeners[type];if(list)for(i=list.length,i>1&&(list=list.slice(0)),t=this._eventTarget;--i>-1;)listener=list[i],listener&&(listener.up?listener.c.call(listener.s||t,{type:type,target:t}):listener.c.call(listener.s||t))};var _reqAnimFrame=window.requestAnimationFrame,_cancelAnimFrame=window.cancelAnimationFrame,_getTime=Date.now||function(){return(new Date).getTime()},_lastUpdate=_getTime();for(a=["ms","moz","webkit","o"],i=a.length;--i>-1&&!_reqAnimFrame;)_reqAnimFrame=window[a[i]+"RequestAnimationFrame"],_cancelAnimFrame=window[a[i]+"CancelAnimationFrame"]||window[a[i]+"CancelRequestAnimationFrame"];_class("Ticker",function(fps,useRAF){var _fps,_req,_id,_gap,_nextTime,_self=this,_startTime=_getTime(),_useRAF=!(useRAF===!1||!_reqAnimFrame)&&"auto",_lagThreshold=500,_adjustedLag=33,_tickWord="tick",_tick=function(manual){var overlap,dispatch,elapsed=_getTime()-_lastUpdate;elapsed>_lagThreshold&&(_startTime+=elapsed-_adjustedLag),_lastUpdate+=elapsed,_self.time=(_lastUpdate-_startTime)/1e3,overlap=_self.time-_nextTime,(!_fps||overlap>0||manual===!0)&&(_self.frame++,_nextTime+=overlap+(overlap>=_gap?.004:_gap-overlap),dispatch=!0),manual!==!0&&(_id=_req(_tick)),dispatch&&_self.dispatchEvent(_tickWord)};EventDispatcher.call(_self),_self.time=_self.frame=0,_self.tick=function(){_tick(!0)},_self.lagSmoothing=function(threshold,adjustedLag){_lagThreshold=threshold||1/_tinyNum,_adjustedLag=Math.min(adjustedLag,_lagThreshold,0)},_self.sleep=function(){null!=_id&&(_useRAF&&_cancelAnimFrame?_cancelAnimFrame(_id):clearTimeout(_id),_req=_emptyFunc,_id=null,_self===_ticker&&(_tickerActive=!1))},_self.wake=function(seamless){null!==_id?_self.sleep():seamless?_startTime+=-_lastUpdate+(_lastUpdate=_getTime()):_self.frame>10&&(_lastUpdate=_getTime()-_lagThreshold+5),_req=0===_fps?_emptyFunc:_useRAF&&_reqAnimFrame?_reqAnimFrame:function(f){return setTimeout(f,1e3*(_nextTime-_self.time)+1|0)},_self===_ticker&&(_tickerActive=!0),_tick(2)},_self.fps=function(value){return arguments.length?(_fps=value,_gap=1/(_fps||60),_nextTime=this.time+_gap,void _self.wake()):_fps},_self.useRAF=function(value){return arguments.length?(_self.sleep(),_useRAF=value,void _self.fps(_fps)):_useRAF},_self.fps(fps),setTimeout(function(){"auto"===_useRAF&&_self.frame<5&&"hidden"!==document.visibilityState&&_self.useRAF(!1)},1500)}),p=gs.Ticker.prototype=new gs.events.EventDispatcher,p.constructor=gs.Ticker;var Animation=_class("core.Animation",function(duration,vars){if(this.vars=vars=vars||{},this._duration=this._totalDuration=duration||0,this._delay=Number(vars.delay)||0,this._timeScale=1,this._active=vars.immediateRender===!0,this.data=vars.data,this._reversed=vars.reversed===!0,_rootTimeline){_tickerActive||_ticker.wake();var tl=this.vars.useFrames?_rootFramesTimeline:_rootTimeline;tl.add(this,tl._time),this.vars.paused&&this.paused(!0)}});_ticker=Animation.ticker=new gs.Ticker,p=Animation.prototype,p._dirty=p._gc=p._initted=p._paused=!1,p._totalTime=p._time=0,p._rawPrevTime=-1,p._next=p._last=p._onUpdate=p._timeline=p.timeline=null,p._paused=!1;var _checkTimeout=function(){_tickerActive&&_getTime()-_lastUpdate>2e3&&_ticker.wake(),setTimeout(_checkTimeout,2e3)};_checkTimeout(),p.play=function(from,suppressEvents){return null!=from&&this.seek(from,suppressEvents),this.reversed(!1).paused(!1)},p.pause=function(atTime,suppressEvents){return null!=atTime&&this.seek(atTime,suppressEvents),this.paused(!0)},p.resume=function(from,suppressEvents){return null!=from&&this.seek(from,suppressEvents),this.paused(!1)},p.seek=function(time,suppressEvents){return this.totalTime(Number(time),suppressEvents!==!1)},p.restart=function(includeDelay,suppressEvents){return this.reversed(!1).paused(!1).totalTime(includeDelay?-this._delay:0,suppressEvents!==!1,!0)},p.reverse=function(from,suppressEvents){return null!=from&&this.seek(from||this.totalDuration(),suppressEvents),this.reversed(!0).paused(!1)},p.render=function(time,suppressEvents,force){},p.invalidate=function(){return this._time=this._totalTime=0,this._initted=this._gc=!1,this._rawPrevTime=-1,!this._gc&&this.timeline||this._enabled(!0),this},p.isActive=function(){var rawTime,tl=this._timeline,startTime=this._startTime;return!tl||!this._gc&&!this._paused&&tl.isActive()&&(rawTime=tl.rawTime())>=startTime&&rawTime<startTime+this.totalDuration()/this._timeScale},p._enabled=function(enabled,ignoreTimeline){return _tickerActive||_ticker.wake(),this._gc=!enabled,this._active=this.isActive(),ignoreTimeline!==!0&&(enabled&&!this.timeline?this._timeline.add(this,this._startTime-this._delay):!enabled&&this.timeline&&this._timeline._remove(this,!0)),!1},p._kill=function(vars,target){return this._enabled(!1,!1)},p.kill=function(vars,target){return this._kill(vars,target),this},p._uncache=function(includeSelf){for(var tween=includeSelf?this:this.timeline;tween;)tween._dirty=!0,tween=tween.timeline;return this},p._swapSelfInParams=function(params){for(var i=params.length,copy=params.concat();--i>-1;)"{self}"===params[i]&&(copy[i]=this);return copy},p._callback=function(type){var v=this.vars,callback=v[type],params=v[type+"Params"],scope=v[type+"Scope"]||v.callbackScope||this,l=params?params.length:0;switch(l){case 0:callback.call(scope);break;case 1:callback.call(scope,params[0]);break;case 2:callback.call(scope,params[0],params[1]);break;default:callback.apply(scope,params)}},p.eventCallback=function(type,callback,params,scope){if("on"===(type||"").substr(0,2)){var v=this.vars;if(1===arguments.length)return v[type];null==callback?delete v[type]:(v[type]=callback,v[type+"Params"]=_isArray(params)&&params.join("").indexOf("{self}")!==-1?this._swapSelfInParams(params):params,v[type+"Scope"]=scope),"onUpdate"===type&&(this._onUpdate=callback)}return this},p.delay=function(value){return arguments.length?(this._timeline.smoothChildTiming&&this.startTime(this._startTime+value-this._delay),this._delay=value,this):this._delay},p.duration=function(value){return arguments.length?(this._duration=this._totalDuration=value,this._uncache(!0),this._timeline.smoothChildTiming&&this._time>0&&this._time<this._duration&&0!==value&&this.totalTime(this._totalTime*(value/this._duration),!0),this):(this._dirty=!1,this._duration)},p.totalDuration=function(value){return this._dirty=!1,arguments.length?this.duration(value):this._totalDuration},p.time=function(value,suppressEvents){return arguments.length?(this._dirty&&this.totalDuration(),this.totalTime(value>this._duration?this._duration:value,suppressEvents)):this._time},p.totalTime=function(time,suppressEvents,uncapped){if(_tickerActive||_ticker.wake(),!arguments.length)return this._totalTime;if(this._timeline){if(time<0&&!uncapped&&(time+=this.totalDuration()),this._timeline.smoothChildTiming){this._dirty&&this.totalDuration();var totalDuration=this._totalDuration,tl=this._timeline;if(time>totalDuration&&!uncapped&&(time=totalDuration),this._startTime=(this._paused?this._pauseTime:tl._time)-(this._reversed?totalDuration-time:time)/this._timeScale,tl._dirty||this._uncache(!1),tl._timeline)for(;tl._timeline;)tl._timeline._time!==(tl._startTime+tl._totalTime)/tl._timeScale&&tl.totalTime(tl._totalTime,!0),tl=tl._timeline}this._gc&&this._enabled(!0,!1),this._totalTime===time&&0!==this._duration||(_lazyTweens.length&&_lazyRender(),this.render(time,suppressEvents,!1),_lazyTweens.length&&_lazyRender())}return this},p.progress=p.totalProgress=function(value,suppressEvents){var duration=this.duration();return arguments.length?this.totalTime(duration*value,suppressEvents):duration?this._time/duration:this.ratio},p.startTime=function(value){return arguments.length?(value!==this._startTime&&(this._startTime=value,this.timeline&&this.timeline._sortChildren&&this.timeline.add(this,value-this._delay)),this):this._startTime},p.endTime=function(includeRepeats){return this._startTime+(0!=includeRepeats?this.totalDuration():this.duration())/this._timeScale},p.timeScale=function(value){if(!arguments.length)return this._timeScale;if(value=value||_tinyNum,this._timeline&&this._timeline.smoothChildTiming){var pauseTime=this._pauseTime,t=pauseTime||0===pauseTime?pauseTime:this._timeline.totalTime();this._startTime=t-(t-this._startTime)*this._timeScale/value}return this._timeScale=value,this._uncache(!1)},p.reversed=function(value){return arguments.length?(value!=this._reversed&&(this._reversed=value,
this.totalTime(this._timeline&&!this._timeline.smoothChildTiming?this.totalDuration()-this._totalTime:this._totalTime,!0)),this):this._reversed},p.paused=function(value){if(!arguments.length)return this._paused;var raw,elapsed,tl=this._timeline;return value!=this._paused&&tl&&(_tickerActive||value||_ticker.wake(),raw=tl.rawTime(),elapsed=raw-this._pauseTime,!value&&tl.smoothChildTiming&&(this._startTime+=elapsed,this._uncache(!1)),this._pauseTime=value?raw:null,this._paused=value,this._active=this.isActive(),!value&&0!==elapsed&&this._initted&&this.duration()&&(raw=tl.smoothChildTiming?this._totalTime:(raw-this._startTime)/this._timeScale,this.render(raw,raw===this._totalTime,!0))),this._gc&&!value&&this._enabled(!0,!1),this};var SimpleTimeline=_class("core.SimpleTimeline",function(vars){Animation.call(this,0,vars),this.autoRemoveChildren=this.smoothChildTiming=!0});p=SimpleTimeline.prototype=new Animation,p.constructor=SimpleTimeline,p.kill()._gc=!1,p._first=p._last=p._recent=null,p._sortChildren=!1,p.add=p.insert=function(child,position,align,stagger){var prevTween,st;if(child._startTime=Number(position||0)+child._delay,child._paused&&this!==child._timeline&&(child._pauseTime=child._startTime+(this.rawTime()-child._startTime)/child._timeScale),child.timeline&&child.timeline._remove(child,!0),child.timeline=child._timeline=this,child._gc&&child._enabled(!0,!0),prevTween=this._last,this._sortChildren)for(st=child._startTime;prevTween&&prevTween._startTime>st;)prevTween=prevTween._prev;return prevTween?(child._next=prevTween._next,prevTween._next=child):(child._next=this._first,this._first=child),child._next?child._next._prev=child:this._last=child,child._prev=prevTween,this._recent=child,this._timeline&&this._uncache(!0),this},p._remove=function(tween,skipDisable){return tween.timeline===this&&(skipDisable||tween._enabled(!1,!0),tween._prev?tween._prev._next=tween._next:this._first===tween&&(this._first=tween._next),tween._next?tween._next._prev=tween._prev:this._last===tween&&(this._last=tween._prev),tween._next=tween._prev=tween.timeline=null,tween===this._recent&&(this._recent=this._last),this._timeline&&this._uncache(!0)),this},p.render=function(time,suppressEvents,force){var next,tween=this._first;for(this._totalTime=this._time=this._rawPrevTime=time;tween;)next=tween._next,(tween._active||time>=tween._startTime&&!tween._paused)&&(tween._reversed?tween.render((tween._dirty?tween.totalDuration():tween._totalDuration)-(time-tween._startTime)*tween._timeScale,suppressEvents,force):tween.render((time-tween._startTime)*tween._timeScale,suppressEvents,force)),tween=next},p.rawTime=function(){return _tickerActive||_ticker.wake(),this._totalTime};var TweenLite=_class("TweenLite",function(target,duration,vars){if(Animation.call(this,duration,vars),this.render=TweenLite.prototype.render,null==target)throw"Cannot tween a null target.";this.target=target="string"!=typeof target?target:TweenLite.selector(target)||target;var i,targ,targets,isSelector=target.jquery||target.length&&target!==window&&target[0]&&(target[0]===window||target[0].nodeType&&target[0].style&&!target.nodeType),overwrite=this.vars.overwrite;if(this._overwrite=overwrite=null==overwrite?_overwriteLookup[TweenLite.defaultOverwrite]:"number"==typeof overwrite?overwrite>>0:_overwriteLookup[overwrite],(isSelector||target instanceof Array||target.push&&_isArray(target))&&"number"!=typeof target[0])for(this._targets=targets=_slice(target),this._propLookup=[],this._siblings=[],i=0;i<targets.length;i++)targ=targets[i],targ?"string"!=typeof targ?targ.length&&targ!==window&&targ[0]&&(targ[0]===window||targ[0].nodeType&&targ[0].style&&!targ.nodeType)?(targets.splice(i--,1),this._targets=targets=targets.concat(_slice(targ))):(this._siblings[i]=_register(targ,this,!1),1===overwrite&&this._siblings[i].length>1&&_applyOverwrite(targ,this,null,1,this._siblings[i])):(targ=targets[i--]=TweenLite.selector(targ),"string"==typeof targ&&targets.splice(i+1,1)):targets.splice(i--,1);else this._propLookup={},this._siblings=_register(target,this,!1),1===overwrite&&this._siblings.length>1&&_applyOverwrite(target,this,null,1,this._siblings);(this.vars.immediateRender||0===duration&&0===this._delay&&this.vars.immediateRender!==!1)&&(this._time=-_tinyNum,this.render(Math.min(0,-this._delay)))},!0),_isSelector=function(v){return v&&v.length&&v!==window&&v[0]&&(v[0]===window||v[0].nodeType&&v[0].style&&!v.nodeType)},_autoCSS=function(vars,target){var p,css={};for(p in vars)_reservedProps[p]||p in target&&"transform"!==p&&"x"!==p&&"y"!==p&&"width"!==p&&"height"!==p&&"className"!==p&&"border"!==p||!(!_plugins[p]||_plugins[p]&&_plugins[p]._autoCSS)||(css[p]=vars[p],delete vars[p]);vars.css=css};p=TweenLite.prototype=new Animation,p.constructor=TweenLite,p.kill()._gc=!1,p.ratio=0,p._firstPT=p._targets=p._overwrittenProps=p._startAt=null,p._notifyPluginsOfEnabled=p._lazy=!1,TweenLite.version="1.19.0",TweenLite.defaultEase=p._ease=new Ease(null,null,1,1),TweenLite.defaultOverwrite="auto",TweenLite.ticker=_ticker,TweenLite.autoSleep=120,TweenLite.lagSmoothing=function(threshold,adjustedLag){_ticker.lagSmoothing(threshold,adjustedLag)},TweenLite.selector=window.$||window.jQuery||function(e){var selector=window.$||window.jQuery;return selector?(TweenLite.selector=selector,selector(e)):"undefined"==typeof document?e:document.querySelectorAll?document.querySelectorAll(e):document.getElementById("#"===e.charAt(0)?e.substr(1):e)};var _lazyTweens=[],_lazyLookup={},_numbersExp=/(?:(-|-=|\+=)?\d*\.?\d*(?:e[\-+]?\d+)?)[0-9]/gi,_setRatio=function(v){for(var val,pt=this._firstPT,min=1e-6;pt;)val=pt.blob?v?this.join(""):this.start:pt.c*v+pt.s,pt.m?val=pt.m(val,this._target||pt.t):val<min&&val>-min&&(val=0),pt.f?pt.fp?pt.t[pt.p](pt.fp,val):pt.t[pt.p](val):pt.t[pt.p]=val,pt=pt._next},_blobDif=function(start,end,filter,pt){var startNums,endNums,num,i,l,nonNumbers,currentNum,a=[start,end],charIndex=0,s="",color=0;for(a.start=start,filter&&(filter(a),start=a[0],end=a[1]),a.length=0,startNums=start.match(_numbersExp)||[],endNums=end.match(_numbersExp)||[],pt&&(pt._next=null,pt.blob=1,a._firstPT=a._applyPT=pt),l=endNums.length,i=0;i<l;i++)currentNum=endNums[i],nonNumbers=end.substr(charIndex,end.indexOf(currentNum,charIndex)-charIndex),s+=nonNumbers||!i?nonNumbers:",",charIndex+=nonNumbers.length,color?color=(color+1)%5:"rgba("===nonNumbers.substr(-5)&&(color=1),currentNum===startNums[i]||startNums.length<=i?s+=currentNum:(s&&(a.push(s),s=""),num=parseFloat(startNums[i]),a.push(num),a._firstPT={_next:a._firstPT,t:a,p:a.length-1,s:num,c:("="===currentNum.charAt(1)?parseInt(currentNum.charAt(0)+"1",10)*parseFloat(currentNum.substr(2)):parseFloat(currentNum)-num)||0,f:0,m:color&&color<4?Math.round:0}),charIndex+=currentNum.length;return s+=end.substr(charIndex),s&&a.push(s),a.setRatio=_setRatio,a},_addPropTween=function(target,prop,start,end,overwriteProp,mod,funcParam,stringFilter,index){"function"==typeof end&&(end=end(index||0,target));var blob,getterName,s="get"===start?target[prop]:start,type=typeof target[prop],isRelative="string"==typeof end&&"="===end.charAt(1),pt={t:target,p:prop,s:s,f:"function"===type,pg:0,n:overwriteProp||prop,m:mod?"function"==typeof mod?mod:Math.round:0,pr:0,c:isRelative?parseInt(end.charAt(0)+"1",10)*parseFloat(end.substr(2)):parseFloat(end)-s||0};if("number"!==type&&("function"===type&&"get"===start&&(getterName=prop.indexOf("set")||"function"!=typeof target["get"+prop.substr(3)]?prop:"get"+prop.substr(3),pt.s=s=funcParam?target[getterName](funcParam):target[getterName]()),"string"==typeof s&&(funcParam||isNaN(s))?(pt.fp=funcParam,blob=_blobDif(s,end,stringFilter||TweenLite.defaultStringFilter,pt),pt={t:blob,p:"setRatio",s:0,c:1,f:2,pg:0,n:overwriteProp||prop,pr:0,m:0}):isRelative||(pt.s=parseFloat(s),pt.c=parseFloat(end)-pt.s||0)),pt.c)return(pt._next=this._firstPT)&&(pt._next._prev=pt),this._firstPT=pt,pt},_internals=TweenLite._internals={isArray:_isArray,isSelector:_isSelector,lazyTweens:_lazyTweens,blobDif:_blobDif},_plugins=TweenLite._plugins={},_tweenLookup=_internals.tweenLookup={},_tweenLookupNum=0,_reservedProps=_internals.reservedProps={ease:1,delay:1,overwrite:1,onComplete:1,onCompleteParams:1,onCompleteScope:1,useFrames:1,runBackwards:1,startAt:1,onUpdate:1,onUpdateParams:1,onUpdateScope:1,onStart:1,onStartParams:1,onStartScope:1,onReverseComplete:1,onReverseCompleteParams:1,onReverseCompleteScope:1,onRepeat:1,onRepeatParams:1,onRepeatScope:1,easeParams:1,yoyo:1,immediateRender:1,repeat:1,repeatDelay:1,data:1,paused:1,reversed:1,autoCSS:1,lazy:1,onOverwrite:1,callbackScope:1,stringFilter:1,id:1},_overwriteLookup={none:0,all:1,auto:2,concurrent:3,allOnStart:4,preexisting:5,"true":1,"false":0},_rootFramesTimeline=Animation._rootFramesTimeline=new SimpleTimeline,_rootTimeline=Animation._rootTimeline=new SimpleTimeline,_nextGCFrame=30,_lazyRender=_internals.lazyRender=function(){var tween,i=_lazyTweens.length;for(_lazyLookup={};--i>-1;)tween=_lazyTweens[i],tween&&tween._lazy!==!1&&(tween.render(tween._lazy[0],tween._lazy[1],!0),tween._lazy=!1);_lazyTweens.length=0};_rootTimeline._startTime=_ticker.time,_rootFramesTimeline._startTime=_ticker.frame,_rootTimeline._active=_rootFramesTimeline._active=!0,setTimeout(_lazyRender,1),Animation._updateRoot=TweenLite.render=function(){var i,a,p;if(_lazyTweens.length&&_lazyRender(),_rootTimeline.render((_ticker.time-_rootTimeline._startTime)*_rootTimeline._timeScale,!1,!1),_rootFramesTimeline.render((_ticker.frame-_rootFramesTimeline._startTime)*_rootFramesTimeline._timeScale,!1,!1),_lazyTweens.length&&_lazyRender(),_ticker.frame>=_nextGCFrame){_nextGCFrame=_ticker.frame+(parseInt(TweenLite.autoSleep,10)||120);for(p in _tweenLookup){for(a=_tweenLookup[p].tweens,i=a.length;--i>-1;)a[i]._gc&&a.splice(i,1);0===a.length&&delete _tweenLookup[p]}if(p=_rootTimeline._first,(!p||p._paused)&&TweenLite.autoSleep&&!_rootFramesTimeline._first&&1===_ticker._listeners.tick.length){for(;p&&p._paused;)p=p._next;p||_ticker.sleep()}}},_ticker.addEventListener("tick",Animation._updateRoot);var _register=function(target,tween,scrub){var a,i,id=target._gsTweenID;if(_tweenLookup[id||(target._gsTweenID=id="t"+_tweenLookupNum++)]||(_tweenLookup[id]={target:target,tweens:[]}),tween&&(a=_tweenLookup[id].tweens,a[i=a.length]=tween,scrub))for(;--i>-1;)a[i]===tween&&a.splice(i,1);return _tweenLookup[id].tweens},_onOverwrite=function(overwrittenTween,overwritingTween,target,killedProps){var r1,r2,func=overwrittenTween.vars.onOverwrite;return func&&(r1=func(overwrittenTween,overwritingTween,target,killedProps)),func=TweenLite.onOverwrite,func&&(r2=func(overwrittenTween,overwritingTween,target,killedProps)),r1!==!1&&r2!==!1},_applyOverwrite=function(target,tween,props,mode,siblings){var i,changed,curTween,l;if(1===mode||mode>=4){for(l=siblings.length,i=0;i<l;i++)if((curTween=siblings[i])!==tween)curTween._gc||curTween._kill(null,target,tween)&&(changed=!0);else if(5===mode)break;return changed}var globalStart,startTime=tween._startTime+_tinyNum,overlaps=[],oCount=0,zeroDur=0===tween._duration;for(i=siblings.length;--i>-1;)(curTween=siblings[i])===tween||curTween._gc||curTween._paused||(curTween._timeline!==tween._timeline?(globalStart=globalStart||_checkOverlap(tween,0,zeroDur),0===_checkOverlap(curTween,globalStart,zeroDur)&&(overlaps[oCount++]=curTween)):curTween._startTime<=startTime&&curTween._startTime+curTween.totalDuration()/curTween._timeScale>startTime&&((zeroDur||!curTween._initted)&&startTime-curTween._startTime<=2e-10||(overlaps[oCount++]=curTween)));for(i=oCount;--i>-1;)if(curTween=overlaps[i],2===mode&&curTween._kill(props,target,tween)&&(changed=!0),2!==mode||!curTween._firstPT&&curTween._initted){if(2!==mode&&!_onOverwrite(curTween,tween))continue;curTween._enabled(!1,!1)&&(changed=!0)}return changed},_checkOverlap=function(tween,reference,zeroDur){for(var tl=tween._timeline,ts=tl._timeScale,t=tween._startTime;tl._timeline;){if(t+=tl._startTime,ts*=tl._timeScale,tl._paused)return-100;tl=tl._timeline}return t/=ts,t>reference?t-reference:zeroDur&&t===reference||!tween._initted&&t-reference<2*_tinyNum?_tinyNum:(t+=tween.totalDuration()/tween._timeScale/ts)>reference+_tinyNum?0:t-reference-_tinyNum};p._init=function(){var i,initPlugins,pt,p,startVars,l,v=this.vars,op=this._overwrittenProps,dur=this._duration,immediate=!!v.immediateRender,ease=v.ease;if(v.startAt){this._startAt&&(this._startAt.render(-1,!0),this._startAt.kill()),startVars={};for(p in v.startAt)startVars[p]=v.startAt[p];if(startVars.overwrite=!1,startVars.immediateRender=!0,startVars.lazy=immediate&&v.lazy!==!1,startVars.startAt=startVars.delay=null,this._startAt=TweenLite.to(this.target,0,startVars),immediate)if(this._time>0)this._startAt=null;else if(0!==dur)return}else if(v.runBackwards&&0!==dur)if(this._startAt)this._startAt.render(-1,!0),this._startAt.kill(),this._startAt=null;else{0!==this._time&&(immediate=!1),pt={};for(p in v)_reservedProps[p]&&"autoCSS"!==p||(pt[p]=v[p]);if(pt.overwrite=0,pt.data="isFromStart",pt.lazy=immediate&&v.lazy!==!1,pt.immediateRender=immediate,this._startAt=TweenLite.to(this.target,0,pt),immediate){if(0===this._time)return}else this._startAt._init(),this._startAt._enabled(!1),this.vars.immediateRender&&(this._startAt=null)}if(this._ease=ease=ease?ease instanceof Ease?ease:"function"==typeof ease?new Ease(ease,v.easeParams):_easeMap[ease]||TweenLite.defaultEase:TweenLite.defaultEase,v.easeParams instanceof Array&&ease.config&&(this._ease=ease.config.apply(ease,v.easeParams)),this._easeType=this._ease._type,this._easePower=this._ease._power,this._firstPT=null,this._targets)for(l=this._targets.length,i=0;i<l;i++)this._initProps(this._targets[i],this._propLookup[i]={},this._siblings[i],op?op[i]:null,i)&&(initPlugins=!0);else initPlugins=this._initProps(this.target,this._propLookup,this._siblings,op,0);if(initPlugins&&TweenLite._onPluginEvent("_onInitAllProps",this),op&&(this._firstPT||"function"!=typeof this.target&&this._enabled(!1,!1)),v.runBackwards)for(pt=this._firstPT;pt;)pt.s+=pt.c,pt.c=-pt.c,pt=pt._next;this._onUpdate=v.onUpdate,this._initted=!0},p._initProps=function(target,propLookup,siblings,overwrittenProps,index){var p,i,initPlugins,plugin,pt,v;if(null==target)return!1;_lazyLookup[target._gsTweenID]&&_lazyRender(),this.vars.css||target.style&&target!==window&&target.nodeType&&_plugins.css&&this.vars.autoCSS!==!1&&_autoCSS(this.vars,target);for(p in this.vars)if(v=this.vars[p],_reservedProps[p])v&&(v instanceof Array||v.push&&_isArray(v))&&v.join("").indexOf("{self}")!==-1&&(this.vars[p]=v=this._swapSelfInParams(v,this));else if(_plugins[p]&&(plugin=new _plugins[p])._onInitTween(target,this.vars[p],this,index)){for(this._firstPT=pt={_next:this._firstPT,t:plugin,p:"setRatio",s:0,c:1,f:1,n:p,pg:1,pr:plugin._priority,m:0},i=plugin._overwriteProps.length;--i>-1;)propLookup[plugin._overwriteProps[i]]=this._firstPT;(plugin._priority||plugin._onInitAllProps)&&(initPlugins=!0),(plugin._onDisable||plugin._onEnable)&&(this._notifyPluginsOfEnabled=!0),pt._next&&(pt._next._prev=pt)}else propLookup[p]=_addPropTween.call(this,target,p,"get",v,p,0,null,this.vars.stringFilter,index);return overwrittenProps&&this._kill(overwrittenProps,target)?this._initProps(target,propLookup,siblings,overwrittenProps,index):this._overwrite>1&&this._firstPT&&siblings.length>1&&_applyOverwrite(target,this,propLookup,this._overwrite,siblings)?(this._kill(propLookup,target),this._initProps(target,propLookup,siblings,overwrittenProps,index)):(this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration)&&(_lazyLookup[target._gsTweenID]=!0),initPlugins)},p.render=function(time,suppressEvents,force){var isComplete,callback,pt,rawPrevTime,prevTime=this._time,duration=this._duration,prevRawPrevTime=this._rawPrevTime;if(time>=duration-1e-7)this._totalTime=this._time=duration,this.ratio=this._ease._calcEnd?this._ease.getRatio(1):1,this._reversed||(isComplete=!0,callback="onComplete",force=force||this._timeline.autoRemoveChildren),0===duration&&(this._initted||!this.vars.lazy||force)&&(this._startTime===this._timeline._duration&&(time=0),(prevRawPrevTime<0||time<=0&&time>=-1e-7||prevRawPrevTime===_tinyNum&&"isPause"!==this.data)&&prevRawPrevTime!==time&&(force=!0,prevRawPrevTime>_tinyNum&&(callback="onReverseComplete")),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum);else if(time<1e-7)this._totalTime=this._time=0,this.ratio=this._ease._calcEnd?this._ease.getRatio(0):0,(0!==prevTime||0===duration&&prevRawPrevTime>0)&&(callback="onReverseComplete",isComplete=this._reversed),time<0&&(this._active=!1,0===duration&&(this._initted||!this.vars.lazy||force)&&(prevRawPrevTime>=0&&(prevRawPrevTime!==_tinyNum||"isPause"!==this.data)&&(force=!0),this._rawPrevTime=rawPrevTime=!suppressEvents||time||prevRawPrevTime===time?time:_tinyNum)),this._initted||(force=!0);else if(this._totalTime=this._time=time,this._easeType){var r=time/duration,type=this._easeType,pow=this._easePower;(1===type||3===type&&r>=.5)&&(r=1-r),3===type&&(r*=2),1===pow?r*=r:2===pow?r*=r*r:3===pow?r*=r*r*r:4===pow&&(r*=r*r*r*r),1===type?this.ratio=1-r:2===type?this.ratio=r:time/duration<.5?this.ratio=r/2:this.ratio=1-r/2}else this.ratio=this._ease.getRatio(time/duration);if(this._time!==prevTime||force){if(!this._initted){if(this._init(),!this._initted||this._gc)return;if(!force&&this._firstPT&&(this.vars.lazy!==!1&&this._duration||this.vars.lazy&&!this._duration))return this._time=this._totalTime=prevTime,this._rawPrevTime=prevRawPrevTime,_lazyTweens.push(this),void(this._lazy=[time,suppressEvents]);this._time&&!isComplete?this.ratio=this._ease.getRatio(this._time/duration):isComplete&&this._ease._calcEnd&&(this.ratio=this._ease.getRatio(0===this._time?0:1))}for(this._lazy!==!1&&(this._lazy=!1),this._active||!this._paused&&this._time!==prevTime&&time>=0&&(this._active=!0),0===prevTime&&(this._startAt&&(time>=0?this._startAt.render(time,suppressEvents,force):callback||(callback="_dummyGS")),this.vars.onStart&&(0===this._time&&0!==duration||suppressEvents||this._callback("onStart"))),pt=this._firstPT;pt;)pt.f?pt.t[pt.p](pt.c*this.ratio+pt.s):pt.t[pt.p]=pt.c*this.ratio+pt.s,pt=pt._next;this._onUpdate&&(time<0&&this._startAt&&time!==-1e-4&&this._startAt.render(time,suppressEvents,force),suppressEvents||(this._time!==prevTime||isComplete||force)&&this._callback("onUpdate")),callback&&(this._gc&&!force||(time<0&&this._startAt&&!this._onUpdate&&time!==-1e-4&&this._startAt.render(time,suppressEvents,force),isComplete&&(this._timeline.autoRemoveChildren&&this._enabled(!1,!1),this._active=!1),!suppressEvents&&this.vars[callback]&&this._callback(callback),0===duration&&this._rawPrevTime===_tinyNum&&rawPrevTime!==_tinyNum&&(this._rawPrevTime=0)))}},p._kill=function(vars,target,overwritingTween){if("all"===vars&&(vars=null),null==vars&&(null==target||target===this.target))return this._lazy=!1,this._enabled(!1,!1);target="string"!=typeof target?target||this._targets||this.target:TweenLite.selector(target)||target;var i,overwrittenProps,p,pt,propLookup,changed,killProps,record,killed,simultaneousOverwrite=overwritingTween&&this._time&&overwritingTween._startTime===this._startTime&&this._timeline===overwritingTween._timeline;if((_isArray(target)||_isSelector(target))&&"number"!=typeof target[0])for(i=target.length;--i>-1;)this._kill(vars,target[i],overwritingTween)&&(changed=!0);else{if(this._targets){for(i=this._targets.length;--i>-1;)if(target===this._targets[i]){propLookup=this._propLookup[i]||{},this._overwrittenProps=this._overwrittenProps||[],overwrittenProps=this._overwrittenProps[i]=vars?this._overwrittenProps[i]||{}:"all";break}}else{if(target!==this.target)return!1;propLookup=this._propLookup,overwrittenProps=this._overwrittenProps=vars?this._overwrittenProps||{}:"all"}if(propLookup){if(killProps=vars||propLookup,record=vars!==overwrittenProps&&"all"!==overwrittenProps&&vars!==propLookup&&("object"!=typeof vars||!vars._tempKill),overwritingTween&&(TweenLite.onOverwrite||this.vars.onOverwrite)){for(p in killProps)propLookup[p]&&(killed||(killed=[]),killed.push(p));if((killed||!vars)&&!_onOverwrite(this,overwritingTween,target,killed))return!1}for(p in killProps)(pt=propLookup[p])&&(simultaneousOverwrite&&(pt.f?pt.t[pt.p](pt.s):pt.t[pt.p]=pt.s,changed=!0),pt.pg&&pt.t._kill(killProps)&&(changed=!0),pt.pg&&0!==pt.t._overwriteProps.length||(pt._prev?pt._prev._next=pt._next:pt===this._firstPT&&(this._firstPT=pt._next),pt._next&&(pt._next._prev=pt._prev),pt._next=pt._prev=null),delete propLookup[p]),record&&(overwrittenProps[p]=1);!this._firstPT&&this._initted&&this._enabled(!1,!1)}}return changed},p.invalidate=function(){return this._notifyPluginsOfEnabled&&TweenLite._onPluginEvent("_onDisable",this),this._firstPT=this._overwrittenProps=this._startAt=this._onUpdate=null,this._notifyPluginsOfEnabled=this._active=this._lazy=!1,this._propLookup=this._targets?{}:[],Animation.prototype.invalidate.call(this),this.vars.immediateRender&&(this._time=-_tinyNum,this.render(Math.min(0,-this._delay))),this},p._enabled=function(enabled,ignoreTimeline){if(_tickerActive||_ticker.wake(),enabled&&this._gc){var i,targets=this._targets;if(targets)for(i=targets.length;--i>-1;)this._siblings[i]=_register(targets[i],this,!0);else this._siblings=_register(this.target,this,!0)}return Animation.prototype._enabled.call(this,enabled,ignoreTimeline),!(!this._notifyPluginsOfEnabled||!this._firstPT)&&TweenLite._onPluginEvent(enabled?"_onEnable":"_onDisable",this)},TweenLite.to=function(target,duration,vars){return new TweenLite(target,duration,vars)},TweenLite.from=function(target,duration,vars){return vars.runBackwards=!0,vars.immediateRender=0!=vars.immediateRender,new TweenLite(target,duration,vars)},TweenLite.fromTo=function(target,duration,fromVars,toVars){return toVars.startAt=fromVars,toVars.immediateRender=0!=toVars.immediateRender&&0!=fromVars.immediateRender,new TweenLite(target,duration,toVars)},TweenLite.delayedCall=function(delay,callback,params,scope,useFrames){return new TweenLite(callback,0,{delay:delay,onComplete:callback,onCompleteParams:params,callbackScope:scope,onReverseComplete:callback,onReverseCompleteParams:params,immediateRender:!1,lazy:!1,useFrames:useFrames,overwrite:0})},TweenLite.set=function(target,vars){return new TweenLite(target,0,vars)},TweenLite.getTweensOf=function(target,onlyActive){if(null==target)return[];target="string"!=typeof target?target:TweenLite.selector(target)||target;var i,a,j,t;if((_isArray(target)||_isSelector(target))&&"number"!=typeof target[0]){for(i=target.length,a=[];--i>-1;)a=a.concat(TweenLite.getTweensOf(target[i],onlyActive));for(i=a.length;--i>-1;)for(t=a[i],j=i;--j>-1;)t===a[j]&&a.splice(i,1)}else for(a=_register(target).concat(),i=a.length;--i>-1;)(a[i]._gc||onlyActive&&!a[i].isActive())&&a.splice(i,1);return a},TweenLite.killTweensOf=TweenLite.killDelayedCallsTo=function(target,onlyActive,vars){"object"==typeof onlyActive&&(vars=onlyActive,onlyActive=!1);for(var a=TweenLite.getTweensOf(target,onlyActive),i=a.length;--i>-1;)a[i]._kill(vars,target)};var TweenPlugin=_class("plugins.TweenPlugin",function(props,priority){this._overwriteProps=(props||"").split(","),this._propName=this._overwriteProps[0],this._priority=priority||0,this._super=TweenPlugin.prototype},!0);if(p=TweenPlugin.prototype,TweenPlugin.version="1.19.0",TweenPlugin.API=2,p._firstPT=null,p._addTween=_addPropTween,p.setRatio=_setRatio,p._kill=function(lookup){var i,a=this._overwriteProps,pt=this._firstPT;if(null!=lookup[this._propName])this._overwriteProps=[];else for(i=a.length;--i>-1;)null!=lookup[a[i]]&&a.splice(i,1);for(;pt;)null!=lookup[pt.n]&&(pt._next&&(pt._next._prev=pt._prev),pt._prev?(pt._prev._next=pt._next,pt._prev=null):this._firstPT===pt&&(this._firstPT=pt._next)),pt=pt._next;return!1},p._mod=p._roundProps=function(lookup){for(var val,pt=this._firstPT;pt;)val=lookup[this._propName]||null!=pt.n&&lookup[pt.n.split(this._propName+"_").join("")],val&&"function"==typeof val&&(2===pt.f?pt.t._applyPT.m=val:pt.m=val),pt=pt._next},TweenLite._onPluginEvent=function(type,tween){var changed,pt2,first,last,next,pt=tween._firstPT;if("_onInitAllProps"===type){for(;pt;){for(next=pt._next,pt2=first;pt2&&pt2.pr>pt.pr;)pt2=pt2._next;(pt._prev=pt2?pt2._prev:last)?pt._prev._next=pt:first=pt,(pt._next=pt2)?pt2._prev=pt:last=pt,pt=next}pt=tween._firstPT=first}for(;pt;)pt.pg&&"function"==typeof pt.t[type]&&pt.t[type]()&&(changed=!0),pt=pt._next;return changed},TweenPlugin.activate=function(plugins){for(var i=plugins.length;--i>-1;)plugins[i].API===TweenPlugin.API&&(_plugins[(new plugins[i])._propName]=plugins[i]);return!0},_gsDefine.plugin=function(config){if(!(config&&config.propName&&config.init&&config.API))throw"illegal plugin definition.";var prop,propName=config.propName,priority=config.priority||0,overwriteProps=config.overwriteProps,map={init:"_onInitTween",set:"setRatio",kill:"_kill",round:"_mod",mod:"_mod",initAll:"_onInitAllProps"},Plugin=_class("plugins."+propName.charAt(0).toUpperCase()+propName.substr(1)+"Plugin",function(){TweenPlugin.call(this,propName,priority),this._overwriteProps=overwriteProps||[]},config.global===!0),p=Plugin.prototype=new TweenPlugin(propName);p.constructor=Plugin,Plugin.API=config.API;for(prop in map)"function"==typeof config[prop]&&(p[map[prop]]=config[prop]);return Plugin.version=config.version,TweenPlugin.activate([Plugin]),Plugin},a=window._gsQueue){for(i=0;i<a.length;i++)a[i]();for(p in _defLookup)_defLookup[p].func||window.console.log("GSAP encountered missing dependency: "+p)}_tickerActive=!1}}("undefined"!=typeof module&&module.exports&&"undefined"!=typeof global?global:this||window,"TweenMax")}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],2:[function(_dereq_,module,exports){!function(window,document,exportName,undefined){"use strict";function setTimeoutContext(fn,timeout,context){return setTimeout(bindFn(fn,context),timeout)}function invokeArrayArg(arg,fn,context){return!!Array.isArray(arg)&&(each(arg,context[fn],context),!0)}function each(obj,iterator,context){var i;if(obj)if(obj.forEach)obj.forEach(iterator,context);else if(obj.length!==undefined)for(i=0;i<obj.length;)iterator.call(context,obj[i],i,obj),i++;else for(i in obj)obj.hasOwnProperty(i)&&iterator.call(context,obj[i],i,obj)}function deprecate(method,name,message){var deprecationMessage="DEPRECATED METHOD: "+name+"\n"+message+" AT \n";return function(){var e=new Error("get-stack-trace"),stack=e&&e.stack?e.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",log=window.console&&(window.console.warn||window.console.log);return log&&log.call(window.console,deprecationMessage,stack),method.apply(this,arguments)}}function inherit(child,base,properties){var childP,baseP=base.prototype;childP=child.prototype=Object.create(baseP),childP.constructor=child,childP._super=baseP,properties&&assign(childP,properties)}function bindFn(fn,context){return function(){return fn.apply(context,arguments)}}function boolOrFn(val,args){return typeof val==TYPE_FUNCTION?val.apply(args?args[0]||undefined:undefined,args):val}function ifUndefined(val1,val2){return val1===undefined?val2:val1}function addEventListeners(target,types,handler){each(splitStr(types),function(type){target.addEventListener(type,handler,!1)})}function removeEventListeners(target,types,handler){each(splitStr(types),function(type){target.removeEventListener(type,handler,!1)})}function hasParent(node,parent){for(;node;){if(node==parent)return!0;node=node.parentNode}return!1}function inStr(str,find){return str.indexOf(find)>-1}function splitStr(str){return str.trim().split(/\s+/g)}function inArray(src,find,findByKey){if(src.indexOf&&!findByKey)return src.indexOf(find);for(var i=0;i<src.length;){if(findByKey&&src[i][findByKey]==find||!findByKey&&src[i]===find)return i;i++}return-1}function toArray(obj){return Array.prototype.slice.call(obj,0)}function uniqueArray(src,key,sort){for(var results=[],values=[],i=0;i<src.length;){var val=key?src[i][key]:src[i];inArray(values,val)<0&&results.push(src[i]),values[i]=val,i++}return sort&&(results=key?results.sort(function(a,b){return a[key]>b[key]}):results.sort()),results}function prefixed(obj,property){for(var prefix,prop,camelProp=property[0].toUpperCase()+property.slice(1),i=0;i<VENDOR_PREFIXES.length;){if(prefix=VENDOR_PREFIXES[i],prop=prefix?prefix+camelProp:property,prop in obj)return prop;i++}return undefined}function uniqueId(){return _uniqueId++}function getWindowForElement(element){var doc=element.ownerDocument||element;return doc.defaultView||doc.parentWindow||window}function Input(manager,callback){var self=this;this.manager=manager,this.callback=callback,this.element=manager.element,this.target=manager.options.inputTarget,this.domHandler=function(ev){boolOrFn(manager.options.enable,[manager])&&self.handler(ev)},this.init()}function createInputInstance(manager){var Type,inputClass=manager.options.inputClass;return new(Type=inputClass?inputClass:SUPPORT_POINTER_EVENTS?PointerEventInput:SUPPORT_ONLY_TOUCH?TouchInput:SUPPORT_TOUCH?TouchMouseInput:MouseInput)(manager,inputHandler)}function inputHandler(manager,eventType,input){var pointersLen=input.pointers.length,changedPointersLen=input.changedPointers.length,isFirst=eventType&INPUT_START&&pointersLen-changedPointersLen===0,isFinal=eventType&(INPUT_END|INPUT_CANCEL)&&pointersLen-changedPointersLen===0;input.isFirst=!!isFirst,input.isFinal=!!isFinal,isFirst&&(manager.session={}),input.eventType=eventType,computeInputData(manager,input),manager.emit("hammer.input",input),manager.recognize(input),manager.session.prevInput=input}function computeInputData(manager,input){var session=manager.session,pointers=input.pointers,pointersLength=pointers.length;session.firstInput||(session.firstInput=simpleCloneInputData(input)),pointersLength>1&&!session.firstMultiple?session.firstMultiple=simpleCloneInputData(input):1===pointersLength&&(session.firstMultiple=!1);var firstInput=session.firstInput,firstMultiple=session.firstMultiple,offsetCenter=firstMultiple?firstMultiple.center:firstInput.center,center=input.center=getCenter(pointers);input.timeStamp=now(),input.deltaTime=input.timeStamp-firstInput.timeStamp,input.angle=getAngle(offsetCenter,center),input.distance=getDistance(offsetCenter,center),computeDeltaXY(session,input),input.offsetDirection=getDirection(input.deltaX,input.deltaY);var overallVelocity=getVelocity(input.deltaTime,input.deltaX,input.deltaY);input.overallVelocityX=overallVelocity.x,input.overallVelocityY=overallVelocity.y,input.overallVelocity=abs(overallVelocity.x)>abs(overallVelocity.y)?overallVelocity.x:overallVelocity.y,input.scale=firstMultiple?getScale(firstMultiple.pointers,pointers):1,input.rotation=firstMultiple?getRotation(firstMultiple.pointers,pointers):0,input.maxPointers=session.prevInput?input.pointers.length>session.prevInput.maxPointers?input.pointers.length:session.prevInput.maxPointers:input.pointers.length,computeIntervalInputData(session,input);var target=manager.element;hasParent(input.srcEvent.target,target)&&(target=input.srcEvent.target),input.target=target}function computeDeltaXY(session,input){var center=input.center,offset=session.offsetDelta||{},prevDelta=session.prevDelta||{},prevInput=session.prevInput||{};input.eventType!==INPUT_START&&prevInput.eventType!==INPUT_END||(prevDelta=session.prevDelta={x:prevInput.deltaX||0,y:prevInput.deltaY||0},offset=session.offsetDelta={x:center.x,y:center.y}),input.deltaX=prevDelta.x+(center.x-offset.x),input.deltaY=prevDelta.y+(center.y-offset.y)}function computeIntervalInputData(session,input){var velocity,velocityX,velocityY,direction,last=session.lastInterval||input,deltaTime=input.timeStamp-last.timeStamp;if(input.eventType!=INPUT_CANCEL&&(deltaTime>COMPUTE_INTERVAL||last.velocity===undefined)){var deltaX=input.deltaX-last.deltaX,deltaY=input.deltaY-last.deltaY,v=getVelocity(deltaTime,deltaX,deltaY);
velocityX=v.x,velocityY=v.y,velocity=abs(v.x)>abs(v.y)?v.x:v.y,direction=getDirection(deltaX,deltaY),session.lastInterval=input}else velocity=last.velocity,velocityX=last.velocityX,velocityY=last.velocityY,direction=last.direction;input.velocity=velocity,input.velocityX=velocityX,input.velocityY=velocityY,input.direction=direction}function simpleCloneInputData(input){for(var pointers=[],i=0;i<input.pointers.length;)pointers[i]={clientX:round(input.pointers[i].clientX),clientY:round(input.pointers[i].clientY)},i++;return{timeStamp:now(),pointers:pointers,center:getCenter(pointers),deltaX:input.deltaX,deltaY:input.deltaY}}function getCenter(pointers){var pointersLength=pointers.length;if(1===pointersLength)return{x:round(pointers[0].clientX),y:round(pointers[0].clientY)};for(var x=0,y=0,i=0;i<pointersLength;)x+=pointers[i].clientX,y+=pointers[i].clientY,i++;return{x:round(x/pointersLength),y:round(y/pointersLength)}}function getVelocity(deltaTime,x,y){return{x:x/deltaTime||0,y:y/deltaTime||0}}function getDirection(x,y){return x===y?DIRECTION_NONE:abs(x)>=abs(y)?x<0?DIRECTION_LEFT:DIRECTION_RIGHT:y<0?DIRECTION_UP:DIRECTION_DOWN}function getDistance(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return Math.sqrt(x*x+y*y)}function getAngle(p1,p2,props){props||(props=PROPS_XY);var x=p2[props[0]]-p1[props[0]],y=p2[props[1]]-p1[props[1]];return 180*Math.atan2(y,x)/Math.PI}function getRotation(start,end){return getAngle(end[1],end[0],PROPS_CLIENT_XY)+getAngle(start[1],start[0],PROPS_CLIENT_XY)}function getScale(start,end){return getDistance(end[0],end[1],PROPS_CLIENT_XY)/getDistance(start[0],start[1],PROPS_CLIENT_XY)}function MouseInput(){this.evEl=MOUSE_ELEMENT_EVENTS,this.evWin=MOUSE_WINDOW_EVENTS,this.pressed=!1,Input.apply(this,arguments)}function PointerEventInput(){this.evEl=POINTER_ELEMENT_EVENTS,this.evWin=POINTER_WINDOW_EVENTS,Input.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}function SingleTouchInput(){this.evTarget=SINGLE_TOUCH_TARGET_EVENTS,this.evWin=SINGLE_TOUCH_WINDOW_EVENTS,this.started=!1,Input.apply(this,arguments)}function normalizeSingleTouches(ev,type){var all=toArray(ev.touches),changed=toArray(ev.changedTouches);return type&(INPUT_END|INPUT_CANCEL)&&(all=uniqueArray(all.concat(changed),"identifier",!0)),[all,changed]}function TouchInput(){this.evTarget=TOUCH_TARGET_EVENTS,this.targetIds={},Input.apply(this,arguments)}function getTouches(ev,type){var allTouches=toArray(ev.touches),targetIds=this.targetIds;if(type&(INPUT_START|INPUT_MOVE)&&1===allTouches.length)return targetIds[allTouches[0].identifier]=!0,[allTouches,allTouches];var i,targetTouches,changedTouches=toArray(ev.changedTouches),changedTargetTouches=[],target=this.target;if(targetTouches=allTouches.filter(function(touch){return hasParent(touch.target,target)}),type===INPUT_START)for(i=0;i<targetTouches.length;)targetIds[targetTouches[i].identifier]=!0,i++;for(i=0;i<changedTouches.length;)targetIds[changedTouches[i].identifier]&&changedTargetTouches.push(changedTouches[i]),type&(INPUT_END|INPUT_CANCEL)&&delete targetIds[changedTouches[i].identifier],i++;return changedTargetTouches.length?[uniqueArray(targetTouches.concat(changedTargetTouches),"identifier",!0),changedTargetTouches]:void 0}function TouchMouseInput(){Input.apply(this,arguments);var handler=bindFn(this.handler,this);this.touch=new TouchInput(this.manager,handler),this.mouse=new MouseInput(this.manager,handler),this.primaryTouch=null,this.lastTouches=[]}function recordTouches(eventType,eventData){eventType&INPUT_START?(this.primaryTouch=eventData.changedPointers[0].identifier,setLastTouch.call(this,eventData)):eventType&(INPUT_END|INPUT_CANCEL)&&setLastTouch.call(this,eventData)}function setLastTouch(eventData){var touch=eventData.changedPointers[0];if(touch.identifier===this.primaryTouch){var lastTouch={x:touch.clientX,y:touch.clientY};this.lastTouches.push(lastTouch);var lts=this.lastTouches,removeLastTouch=function(){var i=lts.indexOf(lastTouch);i>-1&&lts.splice(i,1)};setTimeout(removeLastTouch,DEDUP_TIMEOUT)}}function isSyntheticEvent(eventData){for(var x=eventData.srcEvent.clientX,y=eventData.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var t=this.lastTouches[i],dx=Math.abs(x-t.x),dy=Math.abs(y-t.y);if(dx<=DEDUP_DISTANCE&&dy<=DEDUP_DISTANCE)return!0}return!1}function TouchAction(manager,value){this.manager=manager,this.set(value)}function cleanTouchActions(actions){if(inStr(actions,TOUCH_ACTION_NONE))return TOUCH_ACTION_NONE;var hasPanX=inStr(actions,TOUCH_ACTION_PAN_X),hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y);return hasPanX&&hasPanY?TOUCH_ACTION_NONE:hasPanX||hasPanY?hasPanX?TOUCH_ACTION_PAN_X:TOUCH_ACTION_PAN_Y:inStr(actions,TOUCH_ACTION_MANIPULATION)?TOUCH_ACTION_MANIPULATION:TOUCH_ACTION_AUTO}function getTouchActionProps(){if(!NATIVE_TOUCH_ACTION)return!1;var touchMap={},cssSupports=window.CSS&&window.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(val){touchMap[val]=!cssSupports||window.CSS.supports("touch-action",val)}),touchMap}function Recognizer(options){this.options=assign({},this.defaults,options||{}),this.id=uniqueId(),this.manager=null,this.options.enable=ifUndefined(this.options.enable,!0),this.state=STATE_POSSIBLE,this.simultaneous={},this.requireFail=[]}function stateStr(state){return state&STATE_CANCELLED?"cancel":state&STATE_ENDED?"end":state&STATE_CHANGED?"move":state&STATE_BEGAN?"start":""}function directionStr(direction){return direction==DIRECTION_DOWN?"down":direction==DIRECTION_UP?"up":direction==DIRECTION_LEFT?"left":direction==DIRECTION_RIGHT?"right":""}function getRecognizerByNameIfManager(otherRecognizer,recognizer){var manager=recognizer.manager;return manager?manager.get(otherRecognizer):otherRecognizer}function AttrRecognizer(){Recognizer.apply(this,arguments)}function PanRecognizer(){AttrRecognizer.apply(this,arguments),this.pX=null,this.pY=null}function PinchRecognizer(){AttrRecognizer.apply(this,arguments)}function PressRecognizer(){Recognizer.apply(this,arguments),this._timer=null,this._input=null}function RotateRecognizer(){AttrRecognizer.apply(this,arguments)}function SwipeRecognizer(){AttrRecognizer.apply(this,arguments)}function TapRecognizer(){Recognizer.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Hammer(element,options){return options=options||{},options.recognizers=ifUndefined(options.recognizers,Hammer.defaults.preset),new Manager(element,options)}function Manager(element,options){this.options=assign({},Hammer.defaults,options||{}),this.options.inputTarget=this.options.inputTarget||element,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=element,this.input=createInputInstance(this),this.touchAction=new TouchAction(this,this.options.touchAction),toggleCssProps(this,!0),each(this.options.recognizers,function(item){var recognizer=this.add(new item[0](item[1]));item[2]&&recognizer.recognizeWith(item[2]),item[3]&&recognizer.requireFailure(item[3])},this)}function toggleCssProps(manager,add){var element=manager.element;if(element.style){var prop;each(manager.options.cssProps,function(value,name){prop=prefixed(element.style,name),add?(manager.oldCssProps[prop]=element.style[prop],element.style[prop]=value):element.style[prop]=manager.oldCssProps[prop]||""}),add||(manager.oldCssProps={})}}function triggerDomEvent(event,data){var gestureEvent=document.createEvent("Event");gestureEvent.initEvent(event,!0,!0),gestureEvent.gesture=data,data.target.dispatchEvent(gestureEvent)}var assign,VENDOR_PREFIXES=["","webkit","Moz","MS","ms","o"],TEST_ELEMENT=document.createElement("div"),TYPE_FUNCTION="function",round=Math.round,abs=Math.abs,now=Date.now;assign="function"!=typeof Object.assign?function(target){if(target===undefined||null===target)throw new TypeError("Cannot convert undefined or null to object");for(var output=Object(target),index=1;index<arguments.length;index++){var source=arguments[index];if(source!==undefined&&null!==source)for(var nextKey in source)source.hasOwnProperty(nextKey)&&(output[nextKey]=source[nextKey])}return output}:Object.assign;var extend=deprecate(function(dest,src,merge){for(var keys=Object.keys(src),i=0;i<keys.length;)(!merge||merge&&dest[keys[i]]===undefined)&&(dest[keys[i]]=src[keys[i]]),i++;return dest},"extend","Use `assign`."),merge=deprecate(function(dest,src){return extend(dest,src,!0)},"merge","Use `assign`."),_uniqueId=1,MOBILE_REGEX=/mobile|tablet|ip(ad|hone|od)|android/i,SUPPORT_TOUCH="ontouchstart"in window,SUPPORT_POINTER_EVENTS=prefixed(window,"PointerEvent")!==undefined,SUPPORT_ONLY_TOUCH=SUPPORT_TOUCH&&MOBILE_REGEX.test(navigator.userAgent),INPUT_TYPE_TOUCH="touch",INPUT_TYPE_PEN="pen",INPUT_TYPE_MOUSE="mouse",INPUT_TYPE_KINECT="kinect",COMPUTE_INTERVAL=25,INPUT_START=1,INPUT_MOVE=2,INPUT_END=4,INPUT_CANCEL=8,DIRECTION_NONE=1,DIRECTION_LEFT=2,DIRECTION_RIGHT=4,DIRECTION_UP=8,DIRECTION_DOWN=16,DIRECTION_HORIZONTAL=DIRECTION_LEFT|DIRECTION_RIGHT,DIRECTION_VERTICAL=DIRECTION_UP|DIRECTION_DOWN,DIRECTION_ALL=DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,PROPS_XY=["x","y"],PROPS_CLIENT_XY=["clientX","clientY"];Input.prototype={handler:function(){},init:function(){this.evEl&&addEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&addEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&addEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&removeEventListeners(this.element,this.evEl,this.domHandler),this.evTarget&&removeEventListeners(this.target,this.evTarget,this.domHandler),this.evWin&&removeEventListeners(getWindowForElement(this.element),this.evWin,this.domHandler)}};var MOUSE_INPUT_MAP={mousedown:INPUT_START,mousemove:INPUT_MOVE,mouseup:INPUT_END},MOUSE_ELEMENT_EVENTS="mousedown",MOUSE_WINDOW_EVENTS="mousemove mouseup";inherit(MouseInput,Input,{handler:function(ev){var eventType=MOUSE_INPUT_MAP[ev.type];eventType&INPUT_START&&0===ev.button&&(this.pressed=!0),eventType&INPUT_MOVE&&1!==ev.which&&(eventType=INPUT_END),this.pressed&&(eventType&INPUT_END&&(this.pressed=!1),this.callback(this.manager,eventType,{pointers:[ev],changedPointers:[ev],pointerType:INPUT_TYPE_MOUSE,srcEvent:ev}))}});var POINTER_INPUT_MAP={pointerdown:INPUT_START,pointermove:INPUT_MOVE,pointerup:INPUT_END,pointercancel:INPUT_CANCEL,pointerout:INPUT_CANCEL},IE10_POINTER_TYPE_ENUM={2:INPUT_TYPE_TOUCH,3:INPUT_TYPE_PEN,4:INPUT_TYPE_MOUSE,5:INPUT_TYPE_KINECT},POINTER_ELEMENT_EVENTS="pointerdown",POINTER_WINDOW_EVENTS="pointermove pointerup pointercancel";window.MSPointerEvent&&!window.PointerEvent&&(POINTER_ELEMENT_EVENTS="MSPointerDown",POINTER_WINDOW_EVENTS="MSPointerMove MSPointerUp MSPointerCancel"),inherit(PointerEventInput,Input,{handler:function(ev){var store=this.store,removePointer=!1,eventTypeNormalized=ev.type.toLowerCase().replace("ms",""),eventType=POINTER_INPUT_MAP[eventTypeNormalized],pointerType=IE10_POINTER_TYPE_ENUM[ev.pointerType]||ev.pointerType,isTouch=pointerType==INPUT_TYPE_TOUCH,storeIndex=inArray(store,ev.pointerId,"pointerId");eventType&INPUT_START&&(0===ev.button||isTouch)?storeIndex<0&&(store.push(ev),storeIndex=store.length-1):eventType&(INPUT_END|INPUT_CANCEL)&&(removePointer=!0),storeIndex<0||(store[storeIndex]=ev,this.callback(this.manager,eventType,{pointers:store,changedPointers:[ev],pointerType:pointerType,srcEvent:ev}),removePointer&&store.splice(storeIndex,1))}});var SINGLE_TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},SINGLE_TOUCH_TARGET_EVENTS="touchstart",SINGLE_TOUCH_WINDOW_EVENTS="touchstart touchmove touchend touchcancel";inherit(SingleTouchInput,Input,{handler:function(ev){var type=SINGLE_TOUCH_INPUT_MAP[ev.type];if(type===INPUT_START&&(this.started=!0),this.started){var touches=normalizeSingleTouches.call(this,ev,type);type&(INPUT_END|INPUT_CANCEL)&&touches[0].length-touches[1].length===0&&(this.started=!1),this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}}});var TOUCH_INPUT_MAP={touchstart:INPUT_START,touchmove:INPUT_MOVE,touchend:INPUT_END,touchcancel:INPUT_CANCEL},TOUCH_TARGET_EVENTS="touchstart touchmove touchend touchcancel";inherit(TouchInput,Input,{handler:function(ev){var type=TOUCH_INPUT_MAP[ev.type],touches=getTouches.call(this,ev,type);touches&&this.callback(this.manager,type,{pointers:touches[0],changedPointers:touches[1],pointerType:INPUT_TYPE_TOUCH,srcEvent:ev})}});var DEDUP_TIMEOUT=2500,DEDUP_DISTANCE=25;inherit(TouchMouseInput,Input,{handler:function(manager,inputEvent,inputData){var isTouch=inputData.pointerType==INPUT_TYPE_TOUCH,isMouse=inputData.pointerType==INPUT_TYPE_MOUSE;if(!(isMouse&&inputData.sourceCapabilities&&inputData.sourceCapabilities.firesTouchEvents)){if(isTouch)recordTouches.call(this,inputEvent,inputData);else if(isMouse&&isSyntheticEvent.call(this,inputData))return;this.callback(manager,inputEvent,inputData)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var PREFIXED_TOUCH_ACTION=prefixed(TEST_ELEMENT.style,"touchAction"),NATIVE_TOUCH_ACTION=PREFIXED_TOUCH_ACTION!==undefined,TOUCH_ACTION_COMPUTE="compute",TOUCH_ACTION_AUTO="auto",TOUCH_ACTION_MANIPULATION="manipulation",TOUCH_ACTION_NONE="none",TOUCH_ACTION_PAN_X="pan-x",TOUCH_ACTION_PAN_Y="pan-y",TOUCH_ACTION_MAP=getTouchActionProps();TouchAction.prototype={set:function(value){value==TOUCH_ACTION_COMPUTE&&(value=this.compute()),NATIVE_TOUCH_ACTION&&this.manager.element.style&&TOUCH_ACTION_MAP[value]&&(this.manager.element.style[PREFIXED_TOUCH_ACTION]=value),this.actions=value.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var actions=[];return each(this.manager.recognizers,function(recognizer){boolOrFn(recognizer.options.enable,[recognizer])&&(actions=actions.concat(recognizer.getTouchAction()))}),cleanTouchActions(actions.join(" "))},preventDefaults:function(input){var srcEvent=input.srcEvent,direction=input.offsetDirection;if(this.manager.session.prevented)return void srcEvent.preventDefault();var actions=this.actions,hasNone=inStr(actions,TOUCH_ACTION_NONE)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_NONE],hasPanY=inStr(actions,TOUCH_ACTION_PAN_Y)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y],hasPanX=inStr(actions,TOUCH_ACTION_PAN_X)&&!TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];if(hasNone){var isTapPointer=1===input.pointers.length,isTapMovement=input.distance<2,isTapTouchTime=input.deltaTime<250;if(isTapPointer&&isTapMovement&&isTapTouchTime)return}return hasPanX&&hasPanY?void 0:hasNone||hasPanY&&direction&DIRECTION_HORIZONTAL||hasPanX&&direction&DIRECTION_VERTICAL?this.preventSrc(srcEvent):void 0},preventSrc:function(srcEvent){this.manager.session.prevented=!0,srcEvent.preventDefault()}};var STATE_POSSIBLE=1,STATE_BEGAN=2,STATE_CHANGED=4,STATE_ENDED=8,STATE_RECOGNIZED=STATE_ENDED,STATE_CANCELLED=16,STATE_FAILED=32;Recognizer.prototype={defaults:{},set:function(options){return assign(this.options,options),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"recognizeWith",this))return this;var simultaneous=this.simultaneous;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),simultaneous[otherRecognizer.id]||(simultaneous[otherRecognizer.id]=otherRecognizer,otherRecognizer.recognizeWith(this)),this},dropRecognizeWith:function(otherRecognizer){return invokeArrayArg(otherRecognizer,"dropRecognizeWith",this)?this:(otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),delete this.simultaneous[otherRecognizer.id],this)},requireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"requireFailure",this))return this;var requireFail=this.requireFail;return otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this),inArray(requireFail,otherRecognizer)===-1&&(requireFail.push(otherRecognizer),otherRecognizer.requireFailure(this)),this},dropRequireFailure:function(otherRecognizer){if(invokeArrayArg(otherRecognizer,"dropRequireFailure",this))return this;otherRecognizer=getRecognizerByNameIfManager(otherRecognizer,this);var index=inArray(this.requireFail,otherRecognizer);return index>-1&&this.requireFail.splice(index,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(otherRecognizer){return!!this.simultaneous[otherRecognizer.id]},emit:function(input){function emit(event){self.manager.emit(event,input)}var self=this,state=this.state;state<STATE_ENDED&&emit(self.options.event+stateStr(state)),emit(self.options.event),input.additionalEvent&&emit(input.additionalEvent),state>=STATE_ENDED&&emit(self.options.event+stateStr(state))},tryEmit:function(input){return this.canEmit()?this.emit(input):void(this.state=STATE_FAILED)},canEmit:function(){for(var i=0;i<this.requireFail.length;){if(!(this.requireFail[i].state&(STATE_FAILED|STATE_POSSIBLE)))return!1;i++}return!0},recognize:function(inputData){var inputDataClone=assign({},inputData);return boolOrFn(this.options.enable,[this,inputDataClone])?(this.state&(STATE_RECOGNIZED|STATE_CANCELLED|STATE_FAILED)&&(this.state=STATE_POSSIBLE),this.state=this.process(inputDataClone),void(this.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED|STATE_CANCELLED)&&this.tryEmit(inputDataClone))):(this.reset(),void(this.state=STATE_FAILED))},process:function(inputData){},getTouchAction:function(){},reset:function(){}},inherit(AttrRecognizer,Recognizer,{defaults:{pointers:1},attrTest:function(input){var optionPointers=this.options.pointers;return 0===optionPointers||input.pointers.length===optionPointers},process:function(input){var state=this.state,eventType=input.eventType,isRecognized=state&(STATE_BEGAN|STATE_CHANGED),isValid=this.attrTest(input);return isRecognized&&(eventType&INPUT_CANCEL||!isValid)?state|STATE_CANCELLED:isRecognized||isValid?eventType&INPUT_END?state|STATE_ENDED:state&STATE_BEGAN?state|STATE_CHANGED:STATE_BEGAN:STATE_FAILED}}),inherit(PanRecognizer,AttrRecognizer,{defaults:{event:"pan",threshold:10,pointers:1,direction:DIRECTION_ALL},getTouchAction:function(){var direction=this.options.direction,actions=[];return direction&DIRECTION_HORIZONTAL&&actions.push(TOUCH_ACTION_PAN_Y),direction&DIRECTION_VERTICAL&&actions.push(TOUCH_ACTION_PAN_X),actions},directionTest:function(input){var options=this.options,hasMoved=!0,distance=input.distance,direction=input.direction,x=input.deltaX,y=input.deltaY;return direction&options.direction||(options.direction&DIRECTION_HORIZONTAL?(direction=0===x?DIRECTION_NONE:x<0?DIRECTION_LEFT:DIRECTION_RIGHT,hasMoved=x!=this.pX,distance=Math.abs(input.deltaX)):(direction=0===y?DIRECTION_NONE:y<0?DIRECTION_UP:DIRECTION_DOWN,hasMoved=y!=this.pY,distance=Math.abs(input.deltaY))),input.direction=direction,hasMoved&&distance>options.threshold&&direction&options.direction},attrTest:function(input){return AttrRecognizer.prototype.attrTest.call(this,input)&&(this.state&STATE_BEGAN||!(this.state&STATE_BEGAN)&&this.directionTest(input))},emit:function(input){this.pX=input.deltaX,this.pY=input.deltaY;var direction=directionStr(input.direction);direction&&(input.additionalEvent=this.options.event+direction),this._super.emit.call(this,input)}}),inherit(PinchRecognizer,AttrRecognizer,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.scale-1)>this.options.threshold||this.state&STATE_BEGAN)},emit:function(input){if(1!==input.scale){var inOut=input.scale<1?"in":"out";input.additionalEvent=this.options.event+inOut}this._super.emit.call(this,input)}}),inherit(PressRecognizer,Recognizer,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[TOUCH_ACTION_AUTO]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTime=input.deltaTime>options.time;if(this._input=input,!validMovement||!validPointers||input.eventType&(INPUT_END|INPUT_CANCEL)&&!validTime)this.reset();else if(input.eventType&INPUT_START)this.reset(),this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.time,this);else if(input.eventType&INPUT_END)return STATE_RECOGNIZED;return STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(input){this.state===STATE_RECOGNIZED&&(input&&input.eventType&INPUT_END?this.manager.emit(this.options.event+"up",input):(this._input.timeStamp=now(),this.manager.emit(this.options.event,this._input)))}}),inherit(RotateRecognizer,AttrRecognizer,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[TOUCH_ACTION_NONE]},attrTest:function(input){return this._super.attrTest.call(this,input)&&(Math.abs(input.rotation)>this.options.threshold||this.state&STATE_BEGAN)}}),inherit(SwipeRecognizer,AttrRecognizer,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:DIRECTION_HORIZONTAL|DIRECTION_VERTICAL,pointers:1},getTouchAction:function(){return PanRecognizer.prototype.getTouchAction.call(this)},attrTest:function(input){var velocity,direction=this.options.direction;return direction&(DIRECTION_HORIZONTAL|DIRECTION_VERTICAL)?velocity=input.overallVelocity:direction&DIRECTION_HORIZONTAL?velocity=input.overallVelocityX:direction&DIRECTION_VERTICAL&&(velocity=input.overallVelocityY),this._super.attrTest.call(this,input)&&direction&input.offsetDirection&&input.distance>this.options.threshold&&input.maxPointers==this.options.pointers&&abs(velocity)>this.options.velocity&&input.eventType&INPUT_END},emit:function(input){var direction=directionStr(input.offsetDirection);direction&&this.manager.emit(this.options.event+direction,input),this.manager.emit(this.options.event,input)}}),inherit(TapRecognizer,Recognizer,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[TOUCH_ACTION_MANIPULATION]},process:function(input){var options=this.options,validPointers=input.pointers.length===options.pointers,validMovement=input.distance<options.threshold,validTouchTime=input.deltaTime<options.time;if(this.reset(),input.eventType&INPUT_START&&0===this.count)return this.failTimeout();if(validMovement&&validTouchTime&&validPointers){if(input.eventType!=INPUT_END)return this.failTimeout();var validInterval=!this.pTime||input.timeStamp-this.pTime<options.interval,validMultiTap=!this.pCenter||getDistance(this.pCenter,input.center)<options.posThreshold;this.pTime=input.timeStamp,this.pCenter=input.center,validMultiTap&&validInterval?this.count+=1:this.count=1,this._input=input;var tapCount=this.count%options.taps;if(0===tapCount)return this.hasRequireFailures()?(this._timer=setTimeoutContext(function(){this.state=STATE_RECOGNIZED,this.tryEmit()},options.interval,this),STATE_BEGAN):STATE_RECOGNIZED}return STATE_FAILED},failTimeout:function(){return this._timer=setTimeoutContext(function(){this.state=STATE_FAILED},this.options.interval,this),STATE_FAILED},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==STATE_RECOGNIZED&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Hammer.VERSION="2.0.7",Hammer.defaults={domEvents:!1,touchAction:TOUCH_ACTION_COMPUTE,enable:!0,inputTarget:null,inputClass:null,preset:[[RotateRecognizer,{enable:!1}],[PinchRecognizer,{enable:!1},["rotate"]],[SwipeRecognizer,{direction:DIRECTION_HORIZONTAL}],[PanRecognizer,{direction:DIRECTION_HORIZONTAL},["swipe"]],[TapRecognizer],[TapRecognizer,{event:"doubletap",taps:2},["tap"]],[PressRecognizer]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var STOP=1,FORCED_STOP=2;Manager.prototype={set:function(options){return assign(this.options,options),options.touchAction&&this.touchAction.update(),options.inputTarget&&(this.input.destroy(),this.input.target=options.inputTarget,this.input.init()),this},stop:function(force){this.session.stopped=force?FORCED_STOP:STOP},recognize:function(inputData){var session=this.session;if(!session.stopped){this.touchAction.preventDefaults(inputData);var recognizer,recognizers=this.recognizers,curRecognizer=session.curRecognizer;(!curRecognizer||curRecognizer&&curRecognizer.state&STATE_RECOGNIZED)&&(curRecognizer=session.curRecognizer=null);for(var i=0;i<recognizers.length;)recognizer=recognizers[i],session.stopped===FORCED_STOP||curRecognizer&&recognizer!=curRecognizer&&!recognizer.canRecognizeWith(curRecognizer)?recognizer.reset():recognizer.recognize(inputData),!curRecognizer&&recognizer.state&(STATE_BEGAN|STATE_CHANGED|STATE_ENDED)&&(curRecognizer=session.curRecognizer=recognizer),i++}},get:function(recognizer){if(recognizer instanceof Recognizer)return recognizer;for(var recognizers=this.recognizers,i=0;i<recognizers.length;i++)if(recognizers[i].options.event==recognizer)return recognizers[i];return null},add:function(recognizer){if(invokeArrayArg(recognizer,"add",this))return this;var existing=this.get(recognizer.options.event);return existing&&this.remove(existing),this.recognizers.push(recognizer),recognizer.manager=this,this.touchAction.update(),recognizer},remove:function(recognizer){if(invokeArrayArg(recognizer,"remove",this))return this;if(recognizer=this.get(recognizer)){var recognizers=this.recognizers,index=inArray(recognizers,recognizer);index!==-1&&(recognizers.splice(index,1),this.touchAction.update())}return this},on:function(events,handler){if(events!==undefined&&handler!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handlers[event]=handlers[event]||[],handlers[event].push(handler)}),this}},off:function(events,handler){if(events!==undefined){var handlers=this.handlers;return each(splitStr(events),function(event){handler?handlers[event]&&handlers[event].splice(inArray(handlers[event],handler),1):delete handlers[event]}),this}},emit:function(event,data){this.options.domEvents&&triggerDomEvent(event,data);var handlers=this.handlers[event]&&this.handlers[event].slice();if(handlers&&handlers.length){data.type=event,data.preventDefault=function(){data.srcEvent.preventDefault()};for(var i=0;i<handlers.length;)handlers[i](data),i++}},destroy:function(){this.element&&toggleCssProps(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},assign(Hammer,{INPUT_START:INPUT_START,INPUT_MOVE:INPUT_MOVE,INPUT_END:INPUT_END,INPUT_CANCEL:INPUT_CANCEL,STATE_POSSIBLE:STATE_POSSIBLE,STATE_BEGAN:STATE_BEGAN,STATE_CHANGED:STATE_CHANGED,STATE_ENDED:STATE_ENDED,STATE_RECOGNIZED:STATE_RECOGNIZED,STATE_CANCELLED:STATE_CANCELLED,STATE_FAILED:STATE_FAILED,DIRECTION_NONE:DIRECTION_NONE,DIRECTION_LEFT:DIRECTION_LEFT,DIRECTION_RIGHT:DIRECTION_RIGHT,DIRECTION_UP:DIRECTION_UP,DIRECTION_DOWN:DIRECTION_DOWN,DIRECTION_HORIZONTAL:DIRECTION_HORIZONTAL,DIRECTION_VERTICAL:DIRECTION_VERTICAL,DIRECTION_ALL:DIRECTION_ALL,Manager:Manager,Input:Input,TouchAction:TouchAction,TouchInput:TouchInput,MouseInput:MouseInput,PointerEventInput:PointerEventInput,TouchMouseInput:TouchMouseInput,SingleTouchInput:SingleTouchInput,Recognizer:Recognizer,AttrRecognizer:AttrRecognizer,Tap:TapRecognizer,Pan:PanRecognizer,Swipe:SwipeRecognizer,Pinch:PinchRecognizer,Rotate:RotateRecognizer,Press:PressRecognizer,on:addEventListeners,off:removeEventListeners,each:each,merge:merge,extend:extend,assign:assign,inherit:inherit,bindFn:bindFn,prefixed:prefixed});var freeGlobal="undefined"!=typeof window?window:"undefined"!=typeof self?self:{};freeGlobal.Hammer=Hammer,"function"==typeof define&&define.amd?define(function(){return Hammer}):"undefined"!=typeof module&&module.exports?module.exports=Hammer:window[exportName]=Hammer}(window,document,"Hammer")},{}],3:[function(_dereq_,module,exports){"use strict";var on,once,off,emit,methods,descriptors,base,d=_dereq_("d"),callable=_dereq_("es5-ext/object/valid-callable"),apply=Function.prototype.apply,call=Function.prototype.call,create=Object.create,defineProperty=Object.defineProperty,defineProperties=Object.defineProperties,hasOwnProperty=Object.prototype.hasOwnProperty,descriptor={configurable:!0,enumerable:!1,writable:!0};on=function(type,listener){var data;return callable(listener),hasOwnProperty.call(this,"__ee__")?data=this.__ee__:(data=descriptor.value=create(null),defineProperty(this,"__ee__",descriptor),descriptor.value=null),data[type]?"object"==typeof data[type]?data[type].push(listener):data[type]=[data[type],listener]:data[type]=listener,this},once=function(type,listener){var once,self;return callable(listener),self=this,on.call(this,type,once=function(){off.call(self,type,once),apply.call(listener,this,arguments)}),once.__eeOnceListener__=listener,this},off=function(type,listener){var data,listeners,candidate,i;if(callable(listener),!hasOwnProperty.call(this,"__ee__"))return this;if(data=this.__ee__,!data[type])return this;if(listeners=data[type],"object"==typeof listeners)for(i=0;candidate=listeners[i];++i)candidate!==listener&&candidate.__eeOnceListener__!==listener||(2===listeners.length?data[type]=listeners[i?0:1]:listeners.splice(i,1));else listeners!==listener&&listeners.__eeOnceListener__!==listener||delete data[type];return this},emit=function(type){var i,l,listener,listeners,args;if(hasOwnProperty.call(this,"__ee__")&&(listeners=this.__ee__[type]))if("object"==typeof listeners){for(l=arguments.length,args=new Array(l-1),i=1;i<l;++i)args[i-1]=arguments[i];for(listeners=listeners.slice(),i=0;listener=listeners[i];++i)apply.call(listener,this,args)}else switch(arguments.length){case 1:call.call(listeners,this);break;case 2:call.call(listeners,this,arguments[1]);break;case 3:call.call(listeners,this,arguments[1],arguments[2]);break;default:for(l=arguments.length,args=new Array(l-1),i=1;i<l;++i)args[i-1]=arguments[i];apply.call(listeners,this,args)}},methods={on:on,once:once,off:off,emit:emit},descriptors={on:d(on),once:d(once),off:d(off),emit:d(emit)},base=defineProperties({},descriptors),module.exports=exports=function(o){return null==o?create(base):defineProperties(Object(o),descriptors)},exports.methods=methods},{d:4,"es5-ext/object/valid-callable":13}],4:[function(_dereq_,module,exports){"use strict";var d,assign=_dereq_("es5-ext/object/assign"),normalizeOpts=_dereq_("es5-ext/object/normalize-options"),isCallable=_dereq_("es5-ext/object/is-callable"),contains=_dereq_("es5-ext/string/#/contains");d=module.exports=function(dscr,value){var c,e,w,options,desc;return arguments.length<2||"string"!=typeof dscr?(options=value,value=dscr,dscr=null):options=arguments[2],null==dscr?(c=w=!0,e=!1):(c=contains.call(dscr,"c"),e=contains.call(dscr,"e"),w=contains.call(dscr,"w")),desc={value:value,configurable:c,enumerable:e,writable:w},options?assign(normalizeOpts(options),desc):desc},d.gs=function(dscr,get,set){var c,e,options,desc;return"string"!=typeof dscr?(options=set,set=get,get=dscr,dscr=null):options=arguments[3],null==get?get=void 0:isCallable(get)?null==set?set=void 0:isCallable(set)||(options=set,set=void 0):(options=get,get=set=void 0),null==dscr?(c=!0,e=!1):(c=contains.call(dscr,"c"),e=contains.call(dscr,"e")),desc={get:get,set:set,configurable:c,enumerable:e},options?assign(normalizeOpts(options),desc):desc}},{"es5-ext/object/assign":5,"es5-ext/object/is-callable":8,"es5-ext/object/normalize-options":12,"es5-ext/string/#/contains":15}],5:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./is-implemented")()?Object.assign:_dereq_("./shim")},{"./is-implemented":6,"./shim":7}],6:[function(_dereq_,module,exports){"use strict";module.exports=function(){var obj,assign=Object.assign;return"function"==typeof assign&&(obj={foo:"raz"},assign(obj,{bar:"dwa"},{trzy:"trzy"}),obj.foo+obj.bar+obj.trzy==="razdwatrzy")}},{}],7:[function(_dereq_,module,exports){"use strict";
var keys=_dereq_("../keys"),value=_dereq_("../valid-value"),max=Math.max;module.exports=function(dest,src){var error,i,assign,l=max(arguments.length,2);for(dest=Object(value(dest)),assign=function(key){try{dest[key]=src[key]}catch(e){error||(error=e)}},i=1;i<l;++i)src=arguments[i],keys(src).forEach(assign);if(void 0!==error)throw error;return dest}},{"../keys":9,"../valid-value":14}],8:[function(_dereq_,module,exports){"use strict";module.exports=function(obj){return"function"==typeof obj}},{}],9:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./is-implemented")()?Object.keys:_dereq_("./shim")},{"./is-implemented":10,"./shim":11}],10:[function(_dereq_,module,exports){"use strict";module.exports=function(){try{return Object.keys("primitive"),!0}catch(e){return!1}}},{}],11:[function(_dereq_,module,exports){"use strict";var keys=Object.keys;module.exports=function(object){return keys(null==object?object:Object(object))}},{}],12:[function(_dereq_,module,exports){"use strict";var forEach=Array.prototype.forEach,create=Object.create,process=function(src,obj){var key;for(key in src)obj[key]=src[key]};module.exports=function(options){var result=create(null);return forEach.call(arguments,function(options){null!=options&&process(Object(options),result)}),result}},{}],13:[function(_dereq_,module,exports){"use strict";module.exports=function(fn){if("function"!=typeof fn)throw new TypeError(fn+" is not a function");return fn}},{}],14:[function(_dereq_,module,exports){"use strict";module.exports=function(value){if(null==value)throw new TypeError("Cannot use null or undefined");return value}},{}],15:[function(_dereq_,module,exports){"use strict";module.exports=_dereq_("./is-implemented")()?String.prototype.contains:_dereq_("./shim")},{"./is-implemented":16,"./shim":17}],16:[function(_dereq_,module,exports){"use strict";var str="razdwatrzy";module.exports=function(){return"function"==typeof str.contains&&(str.contains("dwa")===!0&&str.contains("foo")===!1)}},{}],17:[function(_dereq_,module,exports){"use strict";var indexOf=String.prototype.indexOf;module.exports=function(searchString){return indexOf.call(this,searchString,arguments[1])>-1}},{}],18:[function(_dereq_,module,exports){(function(global){!function(f){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=f();else if("function"==typeof define&&define.amd)define([],f);else{var g;g="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,g.localforage=f()}}(function(){return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a="function"==typeof _dereq_&&_dereq_;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}for(var i="function"==typeof _dereq_&&_dereq_,o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";function INTERNAL(){}function Promise(resolver){if("function"!=typeof resolver)throw new TypeError("resolver must be a function");this.state=PENDING,this.queue=[],this.outcome=void 0,resolver!==INTERNAL&&safelyResolveThenable(this,resolver)}function QueueItem(promise,onFulfilled,onRejected){this.promise=promise,"function"==typeof onFulfilled&&(this.onFulfilled=onFulfilled,this.callFulfilled=this.otherCallFulfilled),"function"==typeof onRejected&&(this.onRejected=onRejected,this.callRejected=this.otherCallRejected)}function unwrap(promise,func,value){immediate(function(){var returnValue;try{returnValue=func(value)}catch(e){return handlers.reject(promise,e)}returnValue===promise?handlers.reject(promise,new TypeError("Cannot resolve promise with itself")):handlers.resolve(promise,returnValue)})}function getThen(obj){var then=obj&&obj.then;if(obj&&"object"==typeof obj&&"function"==typeof then)return function(){then.apply(obj,arguments)}}function safelyResolveThenable(self,thenable){function onError(value){called||(called=!0,handlers.reject(self,value))}function onSuccess(value){called||(called=!0,handlers.resolve(self,value))}function tryToUnwrap(){thenable(onSuccess,onError)}var called=!1,result=tryCatch(tryToUnwrap);"error"===result.status&&onError(result.value)}function tryCatch(func,value){var out={};try{out.value=func(value),out.status="success"}catch(e){out.status="error",out.value=e}return out}function resolve(value){return value instanceof this?value:handlers.resolve(new this(INTERNAL),value)}function reject(reason){var promise=new this(INTERNAL);return handlers.reject(promise,reason)}function all(iterable){function allResolver(value,i){function resolveFromAll(outValue){values[i]=outValue,++resolved!==len||called||(called=!0,handlers.resolve(promise,values))}self.resolve(value).then(resolveFromAll,function(error){called||(called=!0,handlers.reject(promise,error))})}var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var values=new Array(len),resolved=0,i=-1,promise=new this(INTERNAL);++i<len;)allResolver(iterable[i],i);return promise}function race(iterable){function resolver(value){self.resolve(value).then(function(response){called||(called=!0,handlers.resolve(promise,response))},function(error){called||(called=!0,handlers.reject(promise,error))})}var self=this;if("[object Array]"!==Object.prototype.toString.call(iterable))return this.reject(new TypeError("must be an array"));var len=iterable.length,called=!1;if(!len)return this.resolve([]);for(var i=-1,promise=new this(INTERNAL);++i<len;)resolver(iterable[i]);return promise}var immediate=_dereq_(2),handlers={},REJECTED=["REJECTED"],FULFILLED=["FULFILLED"],PENDING=["PENDING"];module.exports=exports=Promise,Promise.prototype["catch"]=function(onRejected){return this.then(null,onRejected)},Promise.prototype.then=function(onFulfilled,onRejected){if("function"!=typeof onFulfilled&&this.state===FULFILLED||"function"!=typeof onRejected&&this.state===REJECTED)return this;var promise=new this.constructor(INTERNAL);if(this.state!==PENDING){var resolver=this.state===FULFILLED?onFulfilled:onRejected;unwrap(promise,resolver,this.outcome)}else this.queue.push(new QueueItem(promise,onFulfilled,onRejected));return promise},QueueItem.prototype.callFulfilled=function(value){handlers.resolve(this.promise,value)},QueueItem.prototype.otherCallFulfilled=function(value){unwrap(this.promise,this.onFulfilled,value)},QueueItem.prototype.callRejected=function(value){handlers.reject(this.promise,value)},QueueItem.prototype.otherCallRejected=function(value){unwrap(this.promise,this.onRejected,value)},handlers.resolve=function(self,value){var result=tryCatch(getThen,value);if("error"===result.status)return handlers.reject(self,result.value);var thenable=result.value;if(thenable)safelyResolveThenable(self,thenable);else{self.state=FULFILLED,self.outcome=value;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callFulfilled(value)}return self},handlers.reject=function(self,error){self.state=REJECTED,self.outcome=error;for(var i=-1,len=self.queue.length;++i<len;)self.queue[i].callRejected(error);return self},exports.resolve=resolve,exports.reject=reject,exports.all=all,exports.race=race},{2:2}],2:[function(_dereq_,module,exports){(function(global){"use strict";function nextTick(){draining=!0;for(var i,oldQueue,len=queue.length;len;){for(oldQueue=queue,queue=[],i=-1;++i<len;)oldQueue[i]();len=queue.length}draining=!1}function immediate(task){1!==queue.push(task)||draining||scheduleDrain()}var scheduleDrain,Mutation=global.MutationObserver||global.WebKitMutationObserver;if(Mutation){var called=0,observer=new Mutation(nextTick),element=global.document.createTextNode("");observer.observe(element,{characterData:!0}),scheduleDrain=function(){element.data=called=++called%2}}else if(global.setImmediate||"undefined"==typeof global.MessageChannel)scheduleDrain="document"in global&&"onreadystatechange"in global.document.createElement("script")?function(){var scriptEl=global.document.createElement("script");scriptEl.onreadystatechange=function(){nextTick(),scriptEl.onreadystatechange=null,scriptEl.parentNode.removeChild(scriptEl),scriptEl=null},global.document.documentElement.appendChild(scriptEl)}:function(){setTimeout(nextTick,0)};else{var channel=new global.MessageChannel;channel.port1.onmessage=nextTick,scheduleDrain=function(){channel.port2.postMessage(0)}}var draining,queue=[];module.exports=immediate}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],3:[function(_dereq_,module,exports){(function(global){"use strict";"function"!=typeof global.Promise&&(global.Promise=_dereq_(1))}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{1:1}],4:[function(_dereq_,module,exports){"use strict";function _classCallCheck(instance,Constructor){if(!(instance instanceof Constructor))throw new TypeError("Cannot call a class as a function")}function getIDB(){return"undefined"!=typeof indexedDB?indexedDB:"undefined"!=typeof webkitIndexedDB?webkitIndexedDB:"undefined"!=typeof mozIndexedDB?mozIndexedDB:"undefined"!=typeof OIndexedDB?OIndexedDB:"undefined"!=typeof msIndexedDB?msIndexedDB:void 0}function isIndexedDBValid(){try{return!!idb&&(!("undefined"!=typeof openDatabase&&"undefined"!=typeof navigator&&navigator.userAgent&&/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))&&(idb&&"function"==typeof idb.open&&"undefined"!=typeof IDBKeyRange))}catch(e){return!1}}function isWebSQLValid(){return"function"==typeof openDatabase}function isLocalStorageValid(){try{return"undefined"!=typeof localStorage&&"setItem"in localStorage&&localStorage.setItem}catch(e){return!1}}function createBlob(parts,properties){parts=parts||[],properties=properties||{};try{return new Blob(parts,properties)}catch(e){if("TypeError"!==e.name)throw e;for(var Builder="undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder,builder=new Builder,i=0;i<parts.length;i+=1)builder.append(parts[i]);return builder.getBlob(properties.type)}}function executeCallback(promise,callback){callback&&promise.then(function(result){callback(null,result)},function(error){callback(error)})}function _binStringToArrayBuffer(bin){for(var length=bin.length,buf=new ArrayBuffer(length),arr=new Uint8Array(buf),i=0;i<length;i++)arr[i]=bin.charCodeAt(i);return buf}function _checkBlobSupportWithoutCaching(txn){return new Promise$1(function(resolve){var blob=createBlob([""]);txn.objectStore(DETECT_BLOB_SUPPORT_STORE).put(blob,"key"),txn.onabort=function(e){e.preventDefault(),e.stopPropagation(),resolve(!1)},txn.oncomplete=function(){var matchedChrome=navigator.userAgent.match(/Chrome\/(\d+)/),matchedEdge=navigator.userAgent.match(/Edge\//);resolve(matchedEdge||!matchedChrome||parseInt(matchedChrome[1],10)>=43)}})["catch"](function(){return!1})}function _checkBlobSupport(idb){return"boolean"==typeof supportsBlobs?Promise$1.resolve(supportsBlobs):_checkBlobSupportWithoutCaching(idb).then(function(value){return supportsBlobs=value})}function _deferReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation={};deferredOperation.promise=new Promise$1(function(resolve){deferredOperation.resolve=resolve}),dbContext.deferredOperations.push(deferredOperation),dbContext.dbReady?dbContext.dbReady=dbContext.dbReady.then(function(){return deferredOperation.promise}):dbContext.dbReady=deferredOperation.promise}function _advanceReadiness(dbInfo){var dbContext=dbContexts[dbInfo.name],deferredOperation=dbContext.deferredOperations.pop();deferredOperation&&deferredOperation.resolve()}function _getConnection(dbInfo,upgradeNeeded){return new Promise$1(function(resolve,reject){if(dbInfo.db){if(!upgradeNeeded)return resolve(dbInfo.db);_deferReadiness(dbInfo),dbInfo.db.close()}var dbArgs=[dbInfo.name];upgradeNeeded&&dbArgs.push(dbInfo.version);var openreq=idb.open.apply(idb,dbArgs);upgradeNeeded&&(openreq.onupgradeneeded=function(e){var db=openreq.result;try{db.createObjectStore(dbInfo.storeName),e.oldVersion<=1&&db.createObjectStore(DETECT_BLOB_SUPPORT_STORE)}catch(ex){if("ConstraintError"!==ex.name)throw ex;console.warn('The database "'+dbInfo.name+'" has been upgraded from version '+e.oldVersion+" to version "+e.newVersion+', but the storage "'+dbInfo.storeName+'" already exists.')}}),openreq.onerror=function(){reject(openreq.error)},openreq.onsuccess=function(){resolve(openreq.result),_advanceReadiness(dbInfo)}})}function _getOriginalConnection(dbInfo){return _getConnection(dbInfo,!1)}function _getUpgradedConnection(dbInfo){return _getConnection(dbInfo,!0)}function _isUpgradeNeeded(dbInfo,defaultVersion){if(!dbInfo.db)return!0;var isNewStore=!dbInfo.db.objectStoreNames.contains(dbInfo.storeName),isDowngrade=dbInfo.version<dbInfo.db.version,isUpgrade=dbInfo.version>dbInfo.db.version;if(isDowngrade&&(dbInfo.version!==defaultVersion&&console.warn('The database "'+dbInfo.name+"\" can't be downgraded from version "+dbInfo.db.version+" to version "+dbInfo.version+"."),dbInfo.version=dbInfo.db.version),isUpgrade||isNewStore){if(isNewStore){var incVersion=dbInfo.db.version+1;incVersion>dbInfo.version&&(dbInfo.version=incVersion)}return!0}return!1}function _encodeBlob(blob){return new Promise$1(function(resolve,reject){var reader=new FileReader;reader.onerror=reject,reader.onloadend=function(e){var base64=btoa(e.target.result||"");resolve({__local_forage_encoded_blob:!0,data:base64,type:blob.type})},reader.readAsBinaryString(blob)})}function _decodeBlob(encodedBlob){var arrayBuff=_binStringToArrayBuffer(atob(encodedBlob.data));return createBlob([arrayBuff],{type:encodedBlob.type})}function _isEncodedBlob(value){return value&&value.__local_forage_encoded_blob}function _fullyReady(callback){var self=this,promise=self._initReady().then(function(){var dbContext=dbContexts[self._dbInfo.name];if(dbContext&&dbContext.dbReady)return dbContext.dbReady});return promise.then(callback,callback),promise}function _initStorage(options){function ignoreErrors(){return Promise$1.resolve()}var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]=options[i];dbContexts||(dbContexts={});var dbContext=dbContexts[dbInfo.name];dbContext||(dbContext={forages:[],db:null,dbReady:null,deferredOperations:[]},dbContexts[dbInfo.name]=dbContext),dbContext.forages.push(self),self._initReady||(self._initReady=self.ready,self.ready=_fullyReady);for(var initPromises=[],j=0;j<dbContext.forages.length;j++){var forage=dbContext.forages[j];forage!==self&&initPromises.push(forage._initReady()["catch"](ignoreErrors))}var forages=dbContext.forages.slice(0);return Promise$1.all(initPromises).then(function(){return dbInfo.db=dbContext.db,_getOriginalConnection(dbInfo)}).then(function(db){return dbInfo.db=db,_isUpgradeNeeded(dbInfo,self._defaultConfig.version)?_getUpgradedConnection(dbInfo):db}).then(function(db){dbInfo.db=dbContext.db=db,self._dbInfo=dbInfo;for(var k=0;k<forages.length;k++){var forage=forages[k];forage!==self&&(forage._dbInfo.db=dbInfo.db,forage._dbInfo.version=dbInfo.version)}})}function getItem(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.get(key);req.onsuccess=function(){var value=req.result;void 0===value&&(value=null),_isEncodedBlob(value)&&(value=_decodeBlob(value)),resolve(value)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function iterate(iterator,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.openCursor(),iterationNumber=1;req.onsuccess=function(){var cursor=req.result;if(cursor){var value=cursor.value;_isEncodedBlob(value)&&(value=_decodeBlob(value));var result=iterator(value,cursor.key,iterationNumber++);void 0!==result?resolve(result):cursor["continue"]()}else resolve()},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function setItem(key,value,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){var dbInfo;self.ready().then(function(){return dbInfo=self._dbInfo,value instanceof Blob?_checkBlobSupport(dbInfo.db).then(function(blobSupport){return blobSupport?value:_encodeBlob(value)}):value}).then(function(value){var transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite"),store=transaction.objectStore(dbInfo.storeName);null===value&&(value=void 0),transaction.oncomplete=function(){void 0===value&&(value=null),resolve(value)},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)};var req=store.put(value,key)})["catch"](reject)});return executeCallback(promise,callback),promise}function removeItem(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite"),store=transaction.objectStore(dbInfo.storeName),req=store["delete"](key);transaction.oncomplete=function(){resolve()},transaction.onerror=function(){reject(req.error)},transaction.onabort=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});return executeCallback(promise,callback),promise}function clear(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,transaction=dbInfo.db.transaction(dbInfo.storeName,"readwrite"),store=transaction.objectStore(dbInfo.storeName),req=store.clear();transaction.oncomplete=function(){resolve()},transaction.onabort=transaction.onerror=function(){var err=req.error?req.error:req.transaction.error;reject(err)}})["catch"](reject)});return executeCallback(promise,callback),promise}function length(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.count();req.onsuccess=function(){resolve(req.result)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function key(n,callback){var self=this,promise=new Promise$1(function(resolve,reject){return n<0?void resolve(null):void self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),advanced=!1,req=store.openCursor();req.onsuccess=function(){var cursor=req.result;return cursor?void(0===n?resolve(cursor.key):advanced?resolve(cursor.key):(advanced=!0,cursor.advance(n))):void resolve(null)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function keys(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo,store=dbInfo.db.transaction(dbInfo.storeName,"readonly").objectStore(dbInfo.storeName),req=store.openCursor(),keys=[];req.onsuccess=function(){var cursor=req.result;return cursor?(keys.push(cursor.key),void cursor["continue"]()):void resolve(keys)},req.onerror=function(){reject(req.error)}})["catch"](reject)});return executeCallback(promise,callback),promise}function stringToBuffer(serializedString){var i,encoded1,encoded2,encoded3,encoded4,bufferLength=.75*serializedString.length,len=serializedString.length,p=0;"="===serializedString[serializedString.length-1]&&(bufferLength--,"="===serializedString[serializedString.length-2]&&bufferLength--);var buffer=new ArrayBuffer(bufferLength),bytes=new Uint8Array(buffer);for(i=0;i<len;i+=4)encoded1=BASE_CHARS.indexOf(serializedString[i]),encoded2=BASE_CHARS.indexOf(serializedString[i+1]),encoded3=BASE_CHARS.indexOf(serializedString[i+2]),encoded4=BASE_CHARS.indexOf(serializedString[i+3]),bytes[p++]=encoded1<<2|encoded2>>4,bytes[p++]=(15&encoded2)<<4|encoded3>>2,bytes[p++]=(3&encoded3)<<6|63&encoded4;return buffer}function bufferToString(buffer){var i,bytes=new Uint8Array(buffer),base64String="";for(i=0;i<bytes.length;i+=3)base64String+=BASE_CHARS[bytes[i]>>2],base64String+=BASE_CHARS[(3&bytes[i])<<4|bytes[i+1]>>4],base64String+=BASE_CHARS[(15&bytes[i+1])<<2|bytes[i+2]>>6],base64String+=BASE_CHARS[63&bytes[i+2]];return bytes.length%3===2?base64String=base64String.substring(0,base64String.length-1)+"=":bytes.length%3===1&&(base64String=base64String.substring(0,base64String.length-2)+"=="),base64String}function serialize(value,callback){var valueString="";if(value&&(valueString=value.toString()),value&&("[object ArrayBuffer]"===value.toString()||value.buffer&&"[object ArrayBuffer]"===value.buffer.toString())){var buffer,marker=SERIALIZED_MARKER;value instanceof ArrayBuffer?(buffer=value,marker+=TYPE_ARRAYBUFFER):(buffer=value.buffer,"[object Int8Array]"===valueString?marker+=TYPE_INT8ARRAY:"[object Uint8Array]"===valueString?marker+=TYPE_UINT8ARRAY:"[object Uint8ClampedArray]"===valueString?marker+=TYPE_UINT8CLAMPEDARRAY:"[object Int16Array]"===valueString?marker+=TYPE_INT16ARRAY:"[object Uint16Array]"===valueString?marker+=TYPE_UINT16ARRAY:"[object Int32Array]"===valueString?marker+=TYPE_INT32ARRAY:"[object Uint32Array]"===valueString?marker+=TYPE_UINT32ARRAY:"[object Float32Array]"===valueString?marker+=TYPE_FLOAT32ARRAY:"[object Float64Array]"===valueString?marker+=TYPE_FLOAT64ARRAY:callback(new Error("Failed to get type for BinaryArray"))),callback(marker+bufferToString(buffer))}else if("[object Blob]"===valueString){var fileReader=new FileReader;fileReader.onload=function(){var str=BLOB_TYPE_PREFIX+value.type+"~"+bufferToString(this.result);callback(SERIALIZED_MARKER+TYPE_BLOB+str)},fileReader.readAsArrayBuffer(value)}else try{callback(JSON.stringify(value))}catch(e){console.error("Couldn't convert value into a JSON string: ",value),callback(null,e)}}function deserialize(value){if(value.substring(0,SERIALIZED_MARKER_LENGTH)!==SERIALIZED_MARKER)return JSON.parse(value);var blobType,serializedString=value.substring(TYPE_SERIALIZED_MARKER_LENGTH),type=value.substring(SERIALIZED_MARKER_LENGTH,TYPE_SERIALIZED_MARKER_LENGTH);if(type===TYPE_BLOB&&BLOB_TYPE_PREFIX_REGEX.test(serializedString)){var matcher=serializedString.match(BLOB_TYPE_PREFIX_REGEX);blobType=matcher[1],serializedString=serializedString.substring(matcher[0].length)}var buffer=stringToBuffer(serializedString);switch(type){case TYPE_ARRAYBUFFER:return buffer;case TYPE_BLOB:return createBlob([buffer],{type:blobType});case TYPE_INT8ARRAY:return new Int8Array(buffer);case TYPE_UINT8ARRAY:return new Uint8Array(buffer);case TYPE_UINT8CLAMPEDARRAY:return new Uint8ClampedArray(buffer);case TYPE_INT16ARRAY:return new Int16Array(buffer);case TYPE_UINT16ARRAY:return new Uint16Array(buffer);case TYPE_INT32ARRAY:return new Int32Array(buffer);case TYPE_UINT32ARRAY:return new Uint32Array(buffer);case TYPE_FLOAT32ARRAY:return new Float32Array(buffer);case TYPE_FLOAT64ARRAY:return new Float64Array(buffer);default:throw new Error("Unkown type: "+type)}}function _initStorage$1(options){var self=this,dbInfo={db:null};if(options)for(var i in options)dbInfo[i]="string"!=typeof options[i]?options[i].toString():options[i];var dbInfoPromise=new Promise$1(function(resolve,reject){try{dbInfo.db=openDatabase(dbInfo.name,String(dbInfo.version),dbInfo.description,dbInfo.size)}catch(e){return reject(e)}dbInfo.db.transaction(function(t){t.executeSql("CREATE TABLE IF NOT EXISTS "+dbInfo.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],function(){self._dbInfo=dbInfo,resolve()},function(t,error){reject(error)})})});return dbInfo.serializer=localforageSerializer,dbInfoPromise}function getItem$1(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.storeName+" WHERE key = ? LIMIT 1",[key],function(t,results){var result=results.rows.length?results.rows.item(0).value:null;result&&(result=dbInfo.serializer.deserialize(result)),resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function iterate$1(iterator,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT * FROM "+dbInfo.storeName,[],function(t,results){for(var rows=results.rows,length=rows.length,i=0;i<length;i++){var item=rows.item(i),result=item.value;if(result&&(result=dbInfo.serializer.deserialize(result)),result=iterator(result,item.key,i+1),void 0!==result)return void resolve(result)}resolve()},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function setItem$1(key,value,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){void 0===value&&(value=null);var originalValue=value,dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){error?reject(error):dbInfo.db.transaction(function(t){t.executeSql("INSERT OR REPLACE INTO "+dbInfo.storeName+" (key, value) VALUES (?, ?)",[key,value],function(){resolve(originalValue)},function(t,error){reject(error)})},function(sqlError){sqlError.code===sqlError.QUOTA_ERR&&reject(sqlError)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function removeItem$1(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.storeName+" WHERE key = ?",[key],function(){resolve()},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function clear$1(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("DELETE FROM "+dbInfo.storeName,[],function(){resolve()},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function length$1(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT COUNT(key) as c FROM "+dbInfo.storeName,[],function(t,results){var result=results.rows.item(0).c;resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function key$1(n,callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.storeName+" WHERE id = ? LIMIT 1",[n+1],function(t,results){var result=results.rows.length?results.rows.item(0).key:null;resolve(result)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function keys$1(callback){var self=this,promise=new Promise$1(function(resolve,reject){self.ready().then(function(){var dbInfo=self._dbInfo;dbInfo.db.transaction(function(t){t.executeSql("SELECT key FROM "+dbInfo.storeName,[],function(t,results){for(var keys=[],i=0;i<results.rows.length;i++)keys.push(results.rows.item(i).key);resolve(keys)},function(t,error){reject(error)})})})["catch"](reject)});return executeCallback(promise,callback),promise}function _initStorage$2(options){var self=this,dbInfo={};if(options)for(var i in options)dbInfo[i]=options[i];return dbInfo.keyPrefix=dbInfo.name+"/",dbInfo.storeName!==self._defaultConfig.storeName&&(dbInfo.keyPrefix+=dbInfo.storeName+"/"),self._dbInfo=dbInfo,dbInfo.serializer=localforageSerializer,Promise$1.resolve()}function clear$2(callback){var self=this,promise=self.ready().then(function(){for(var keyPrefix=self._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var key=localStorage.key(i);0===key.indexOf(keyPrefix)&&localStorage.removeItem(key)}});return executeCallback(promise,callback),promise}function getItem$2(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self._dbInfo,result=localStorage.getItem(dbInfo.keyPrefix+key);return result&&(result=dbInfo.serializer.deserialize(result)),result});return executeCallback(promise,callback),promise}function iterate$2(iterator,callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self._dbInfo,keyPrefix=dbInfo.keyPrefix,keyPrefixLength=keyPrefix.length,length=localStorage.length,iterationNumber=1,i=0;i<length;i++){var key=localStorage.key(i);if(0===key.indexOf(keyPrefix)){var value=localStorage.getItem(key);if(value&&(value=dbInfo.serializer.deserialize(value)),value=iterator(value,key.substring(keyPrefixLength),iterationNumber++),void 0!==value)return value}}});return executeCallback(promise,callback),promise}function key$2(n,callback){var self=this,promise=self.ready().then(function(){var result,dbInfo=self._dbInfo;try{result=localStorage.key(n)}catch(error){result=null}return result&&(result=result.substring(dbInfo.keyPrefix.length)),result});return executeCallback(promise,callback),promise}function keys$2(callback){var self=this,promise=self.ready().then(function(){for(var dbInfo=self._dbInfo,length=localStorage.length,keys=[],i=0;i<length;i++)0===localStorage.key(i).indexOf(dbInfo.keyPrefix)&&keys.push(localStorage.key(i).substring(dbInfo.keyPrefix.length));return keys});return executeCallback(promise,callback),promise}function length$2(callback){var self=this,promise=self.keys().then(function(keys){return keys.length});return executeCallback(promise,callback),promise}function removeItem$2(key,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){var dbInfo=self._dbInfo;localStorage.removeItem(dbInfo.keyPrefix+key)});return executeCallback(promise,callback),promise}function setItem$2(key,value,callback){var self=this;"string"!=typeof key&&(console.warn(key+" used as a key, but it is not a string."),key=String(key));var promise=self.ready().then(function(){void 0===value&&(value=null);var originalValue=value;return new Promise$1(function(resolve,reject){var dbInfo=self._dbInfo;dbInfo.serializer.serialize(value,function(value,error){if(error)reject(error);else try{localStorage.setItem(dbInfo.keyPrefix+key,value),resolve(originalValue)}catch(e){"QuotaExceededError"!==e.name&&"NS_ERROR_DOM_QUOTA_REACHED"!==e.name||reject(e),reject(e)}})})});return executeCallback(promise,callback),promise}function executeTwoCallbacks(promise,callback,errorCallback){"function"==typeof callback&&promise.then(callback),"function"==typeof errorCallback&&promise["catch"](errorCallback);
}function callWhenReady(localForageInstance,libraryMethod){localForageInstance[libraryMethod]=function(){var _args=arguments;return localForageInstance.ready().then(function(){return localForageInstance[libraryMethod].apply(localForageInstance,_args)})}}function extend(){for(var i=1;i<arguments.length;i++){var arg=arguments[i];if(arg)for(var key in arg)arg.hasOwnProperty(key)&&(isArray(arg[key])?arguments[0][key]=arg[key].slice():arguments[0][key]=arg[key])}return arguments[0]}function isLibraryDriver(driverName){for(var driver in DriverType)if(DriverType.hasOwnProperty(driver)&&DriverType[driver]===driverName)return!0;return!1}var _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(obj){return typeof obj}:function(obj){return obj&&"function"==typeof Symbol&&obj.constructor===Symbol?"symbol":typeof obj},idb=getIDB();"undefined"==typeof Promise&&"undefined"!=typeof _dereq_&&_dereq_(3);var supportsBlobs,dbContexts,Promise$1=Promise,DETECT_BLOB_SUPPORT_STORE="local-forage-detect-blob-support",asyncStorage={_driver:"asyncStorage",_initStorage:_initStorage,iterate:iterate,getItem:getItem,setItem:setItem,removeItem:removeItem,clear:clear,length:length,key:key,keys:keys},BASE_CHARS="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",BLOB_TYPE_PREFIX="~~local_forage_type~",BLOB_TYPE_PREFIX_REGEX=/^~~local_forage_type~([^~]+)~/,SERIALIZED_MARKER="__lfsc__:",SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER.length,TYPE_ARRAYBUFFER="arbf",TYPE_BLOB="blob",TYPE_INT8ARRAY="si08",TYPE_UINT8ARRAY="ui08",TYPE_UINT8CLAMPEDARRAY="uic8",TYPE_INT16ARRAY="si16",TYPE_INT32ARRAY="si32",TYPE_UINT16ARRAY="ur16",TYPE_UINT32ARRAY="ui32",TYPE_FLOAT32ARRAY="fl32",TYPE_FLOAT64ARRAY="fl64",TYPE_SERIALIZED_MARKER_LENGTH=SERIALIZED_MARKER_LENGTH+TYPE_ARRAYBUFFER.length,localforageSerializer={serialize:serialize,deserialize:deserialize,stringToBuffer:stringToBuffer,bufferToString:bufferToString},webSQLStorage={_driver:"webSQLStorage",_initStorage:_initStorage$1,iterate:iterate$1,getItem:getItem$1,setItem:setItem$1,removeItem:removeItem$1,clear:clear$1,length:length$1,key:key$1,keys:keys$1},localStorageWrapper={_driver:"localStorageWrapper",_initStorage:_initStorage$2,iterate:iterate$2,getItem:getItem$2,setItem:setItem$2,removeItem:removeItem$2,clear:clear$2,length:length$2,key:key$2,keys:keys$2},CustomDrivers={},DriverType={INDEXEDDB:"asyncStorage",LOCALSTORAGE:"localStorageWrapper",WEBSQL:"webSQLStorage"},DefaultDriverOrder=[DriverType.INDEXEDDB,DriverType.WEBSQL,DriverType.LOCALSTORAGE],LibraryMethods=["clear","getItem","iterate","key","keys","length","removeItem","setItem"],DefaultConfig={description:"",driver:DefaultDriverOrder.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1},driverSupport={};driverSupport[DriverType.INDEXEDDB]=isIndexedDBValid(),driverSupport[DriverType.WEBSQL]=isWebSQLValid(),driverSupport[DriverType.LOCALSTORAGE]=isLocalStorageValid();var isArray=Array.isArray||function(arg){return"[object Array]"===Object.prototype.toString.call(arg)},LocalForage=function(){function LocalForage(options){_classCallCheck(this,LocalForage),this.INDEXEDDB=DriverType.INDEXEDDB,this.LOCALSTORAGE=DriverType.LOCALSTORAGE,this.WEBSQL=DriverType.WEBSQL,this._defaultConfig=extend({},DefaultConfig),this._config=extend({},this._defaultConfig,options),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver)}return LocalForage.prototype.config=function(options){if("object"===("undefined"==typeof options?"undefined":_typeof(options))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var i in options)"storeName"===i&&(options[i]=options[i].replace(/\W/g,"_")),this._config[i]=options[i];return"driver"in options&&options.driver&&this.setDriver(this._config.driver),!0}return"string"==typeof options?this._config[options]:this._config},LocalForage.prototype.defineDriver=function(driverObject,callback,errorCallback){var promise=new Promise$1(function(resolve,reject){try{var driverName=driverObject._driver,complianceError=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver"),namingError=new Error("Custom driver name already in use: "+driverObject._driver);if(!driverObject._driver)return void reject(complianceError);if(isLibraryDriver(driverObject._driver))return void reject(namingError);for(var customDriverMethods=LibraryMethods.concat("_initStorage"),i=0;i<customDriverMethods.length;i++){var customDriverMethod=customDriverMethods[i];if(!customDriverMethod||!driverObject[customDriverMethod]||"function"!=typeof driverObject[customDriverMethod])return void reject(complianceError)}var supportPromise=Promise$1.resolve(!0);"_support"in driverObject&&(supportPromise=driverObject._support&&"function"==typeof driverObject._support?driverObject._support():Promise$1.resolve(!!driverObject._support)),supportPromise.then(function(supportResult){driverSupport[driverName]=supportResult,CustomDrivers[driverName]=driverObject,resolve()},reject)}catch(e){reject(e)}});return executeTwoCallbacks(promise,callback,errorCallback),promise},LocalForage.prototype.driver=function(){return this._driver||null},LocalForage.prototype.getDriver=function(driverName,callback,errorCallback){var self=this,getDriverPromise=Promise$1.resolve().then(function(){if(!isLibraryDriver(driverName)){if(CustomDrivers[driverName])return CustomDrivers[driverName];throw new Error("Driver not found.")}switch(driverName){case self.INDEXEDDB:return asyncStorage;case self.LOCALSTORAGE:return localStorageWrapper;case self.WEBSQL:return webSQLStorage}});return executeTwoCallbacks(getDriverPromise,callback,errorCallback),getDriverPromise},LocalForage.prototype.getSerializer=function(callback){var serializerPromise=Promise$1.resolve(localforageSerializer);return executeTwoCallbacks(serializerPromise,callback),serializerPromise},LocalForage.prototype.ready=function(callback){var self=this,promise=self._driverSet.then(function(){return null===self._ready&&(self._ready=self._initDriver()),self._ready});return executeTwoCallbacks(promise,callback,callback),promise},LocalForage.prototype.setDriver=function(drivers,callback,errorCallback){function setDriverToConfig(){self._config.driver=self.driver()}function initDriver(supportedDrivers){return function(){function driverPromiseLoop(){for(;currentDriverIndex<supportedDrivers.length;){var driverName=supportedDrivers[currentDriverIndex];return currentDriverIndex++,self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(function(driver){return self._extend(driver),setDriverToConfig(),self._ready=self._initStorage(self._config),self._ready})["catch"](driverPromiseLoop)}setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}var currentDriverIndex=0;return driverPromiseLoop()}}var self=this;isArray(drivers)||(drivers=[drivers]);var supportedDrivers=this._getSupportedDrivers(drivers),oldDriverSetDone=null!==this._driverSet?this._driverSet["catch"](function(){return Promise$1.resolve()}):Promise$1.resolve();return this._driverSet=oldDriverSetDone.then(function(){var driverName=supportedDrivers[0];return self._dbInfo=null,self._ready=null,self.getDriver(driverName).then(function(driver){self._driver=driver._driver,setDriverToConfig(),self._wrapLibraryMethodsWithReady(),self._initDriver=initDriver(supportedDrivers)})})["catch"](function(){setDriverToConfig();var error=new Error("No available storage method found.");return self._driverSet=Promise$1.reject(error),self._driverSet}),executeTwoCallbacks(this._driverSet,callback,errorCallback),this._driverSet},LocalForage.prototype.supports=function(driverName){return!!driverSupport[driverName]},LocalForage.prototype._extend=function(libraryMethodsAndProperties){extend(this,libraryMethodsAndProperties)},LocalForage.prototype._getSupportedDrivers=function(drivers){for(var supportedDrivers=[],i=0,len=drivers.length;i<len;i++){var driverName=drivers[i];this.supports(driverName)&&supportedDrivers.push(driverName)}return supportedDrivers},LocalForage.prototype._wrapLibraryMethodsWithReady=function(){for(var i=0;i<LibraryMethods.length;i++)callWhenReady(this,LibraryMethods[i])},LocalForage.prototype.createInstance=function(options){return new LocalForage(options)},LocalForage}(),localforage_js=new LocalForage;module.exports=localforage_js},{3:3}]},{},[4])(4)})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],19:[function(_dereq_,module,exports){(function(global){(function(){function baseCompareAscending(value,other){if(value!==other){var valIsNull=null===value,valIsUndef=value===undefined,valIsReflexive=value===value,othIsNull=null===other,othIsUndef=other===undefined,othIsReflexive=other===other;if(value>other&&!othIsNull||!valIsReflexive||valIsNull&&!othIsUndef&&othIsReflexive||valIsUndef&&othIsReflexive)return 1;if(value<other&&!valIsNull||!othIsReflexive||othIsNull&&!valIsUndef&&valIsReflexive||othIsUndef&&valIsReflexive)return-1}return 0}function baseFindIndex(array,predicate,fromRight){for(var length=array.length,index=fromRight?length:-1;fromRight?index--:++index<length;)if(predicate(array[index],index,array))return index;return-1}function baseIndexOf(array,value,fromIndex){if(value!==value)return indexOfNaN(array,fromIndex);for(var index=fromIndex-1,length=array.length;++index<length;)if(array[index]===value)return index;return-1}function baseIsFunction(value){return"function"==typeof value||!1}function baseToString(value){return null==value?"":value+""}function charsLeftIndex(string,chars){for(var index=-1,length=string.length;++index<length&&chars.indexOf(string.charAt(index))>-1;);return index}function charsRightIndex(string,chars){for(var index=string.length;index--&&chars.indexOf(string.charAt(index))>-1;);return index}function compareAscending(object,other){return baseCompareAscending(object.criteria,other.criteria)||object.index-other.index}function compareMultiple(object,other,orders){for(var index=-1,objCriteria=object.criteria,othCriteria=other.criteria,length=objCriteria.length,ordersLength=orders.length;++index<length;){var result=baseCompareAscending(objCriteria[index],othCriteria[index]);if(result){if(index>=ordersLength)return result;var order=orders[index];return result*("asc"===order||order===!0?1:-1)}}return object.index-other.index}function deburrLetter(letter){return deburredLetters[letter]}function escapeHtmlChar(chr){return htmlEscapes[chr]}function escapeRegExpChar(chr,leadingChar,whitespaceChar){return leadingChar?chr=regexpEscapes[chr]:whitespaceChar&&(chr=stringEscapes[chr]),"\\"+chr}function escapeStringChar(chr){return"\\"+stringEscapes[chr]}function indexOfNaN(array,fromIndex,fromRight){for(var length=array.length,index=fromIndex+(fromRight?0:-1);fromRight?index--:++index<length;){var other=array[index];if(other!==other)return index}return-1}function isObjectLike(value){return!!value&&"object"==typeof value}function isSpace(charCode){return charCode<=160&&charCode>=9&&charCode<=13||32==charCode||160==charCode||5760==charCode||6158==charCode||charCode>=8192&&(charCode<=8202||8232==charCode||8233==charCode||8239==charCode||8287==charCode||12288==charCode||65279==charCode)}function replaceHolders(array,placeholder){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;)array[index]===placeholder&&(array[index]=PLACEHOLDER,result[++resIndex]=index);return result}function sortedUniq(array,iteratee){for(var seen,index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;index&&seen===computed||(seen=computed,result[++resIndex]=value)}return result}function trimmedLeftIndex(string){for(var index=-1,length=string.length;++index<length&&isSpace(string.charCodeAt(index)););return index}function trimmedRightIndex(string){for(var index=string.length;index--&&isSpace(string.charCodeAt(index)););return index}function unescapeHtmlChar(chr){return htmlUnescapes[chr]}function runInContext(context){function lodash(value){if(isObjectLike(value)&&!isArray(value)&&!(value instanceof LazyWrapper)){if(value instanceof LodashWrapper)return value;if(hasOwnProperty.call(value,"__chain__")&&hasOwnProperty.call(value,"__wrapped__"))return wrapperClone(value)}return new LodashWrapper(value)}function baseLodash(){}function LodashWrapper(value,chainAll,actions){this.__wrapped__=value,this.__actions__=actions||[],this.__chain__=!!chainAll}function LazyWrapper(value){this.__wrapped__=value,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=POSITIVE_INFINITY,this.__views__=[]}function lazyClone(){var result=new LazyWrapper(this.__wrapped__);return result.__actions__=arrayCopy(this.__actions__),result.__dir__=this.__dir__,result.__filtered__=this.__filtered__,result.__iteratees__=arrayCopy(this.__iteratees__),result.__takeCount__=this.__takeCount__,result.__views__=arrayCopy(this.__views__),result}function lazyReverse(){if(this.__filtered__){var result=new LazyWrapper(this);result.__dir__=-1,result.__filtered__=!0}else result=this.clone(),result.__dir__*=-1;return result}function lazyValue(){var array=this.__wrapped__.value(),dir=this.__dir__,isArr=isArray(array),isRight=dir<0,arrLength=isArr?array.length:0,view=getView(0,arrLength,this.__views__),start=view.start,end=view.end,length=end-start,index=isRight?end:start-1,iteratees=this.__iteratees__,iterLength=iteratees.length,resIndex=0,takeCount=nativeMin(length,this.__takeCount__);if(!isArr||arrLength<LARGE_ARRAY_SIZE||arrLength==length&&takeCount==length)return baseWrapperValue(isRight&&isArr?array.reverse():array,this.__actions__);var result=[];outer:for(;length--&&resIndex<takeCount;){index+=dir;for(var iterIndex=-1,value=array[index];++iterIndex<iterLength;){var data=iteratees[iterIndex],iteratee=data.iteratee,type=data.type,computed=iteratee(value);if(type==LAZY_MAP_FLAG)value=computed;else if(!computed){if(type==LAZY_FILTER_FLAG)continue outer;break outer}}result[resIndex++]=value}return result}function MapCache(){this.__data__={}}function mapDelete(key){return this.has(key)&&delete this.__data__[key]}function mapGet(key){return"__proto__"==key?undefined:this.__data__[key]}function mapHas(key){return"__proto__"!=key&&hasOwnProperty.call(this.__data__,key)}function mapSet(key,value){return"__proto__"!=key&&(this.__data__[key]=value),this}function SetCache(values){var length=values?values.length:0;for(this.data={hash:nativeCreate(null),set:new Set};length--;)this.push(values[length])}function cacheIndexOf(cache,value){var data=cache.data,result="string"==typeof value||isObject(value)?data.set.has(value):data.hash[value];return result?0:-1}function cachePush(value){var data=this.data;"string"==typeof value||isObject(value)?data.set.add(value):data.hash[value]=!0}function arrayConcat(array,other){for(var index=-1,length=array.length,othIndex=-1,othLength=other.length,result=Array(length+othLength);++index<length;)result[index]=array[index];for(;++othIndex<othLength;)result[index++]=other[othIndex];return result}function arrayCopy(source,array){var index=-1,length=source.length;for(array||(array=Array(length));++index<length;)array[index]=source[index];return array}function arrayEach(array,iteratee){for(var index=-1,length=array.length;++index<length&&iteratee(array[index],index,array)!==!1;);return array}function arrayEachRight(array,iteratee){for(var length=array.length;length--&&iteratee(array[length],length,array)!==!1;);return array}function arrayEvery(array,predicate){for(var index=-1,length=array.length;++index<length;)if(!predicate(array[index],index,array))return!1;return!0}function arrayExtremum(array,iteratee,comparator,exValue){for(var index=-1,length=array.length,computed=exValue,result=computed;++index<length;){var value=array[index],current=+iteratee(value);comparator(current,computed)&&(computed=current,result=value)}return result}function arrayFilter(array,predicate){for(var index=-1,length=array.length,resIndex=-1,result=[];++index<length;){var value=array[index];predicate(value,index,array)&&(result[++resIndex]=value)}return result}function arrayMap(array,iteratee){for(var index=-1,length=array.length,result=Array(length);++index<length;)result[index]=iteratee(array[index],index,array);return result}function arrayPush(array,values){for(var index=-1,length=values.length,offset=array.length;++index<length;)array[offset+index]=values[index];return array}function arrayReduce(array,iteratee,accumulator,initFromArray){var index=-1,length=array.length;for(initFromArray&&length&&(accumulator=array[++index]);++index<length;)accumulator=iteratee(accumulator,array[index],index,array);return accumulator}function arrayReduceRight(array,iteratee,accumulator,initFromArray){var length=array.length;for(initFromArray&&length&&(accumulator=array[--length]);length--;)accumulator=iteratee(accumulator,array[length],length,array);return accumulator}function arraySome(array,predicate){for(var index=-1,length=array.length;++index<length;)if(predicate(array[index],index,array))return!0;return!1}function arraySum(array,iteratee){for(var length=array.length,result=0;length--;)result+=+iteratee(array[length])||0;return result}function assignDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:objectValue}function assignOwnDefaults(objectValue,sourceValue,key,object){return objectValue!==undefined&&hasOwnProperty.call(object,key)?objectValue:sourceValue}function assignWith(object,source,customizer){for(var index=-1,props=keys(source),length=props.length;++index<length;){var key=props[index],value=object[key],result=customizer(value,source[key],key,object,source);(result===result?result===value:value!==value)&&(value!==undefined||key in object)||(object[key]=result)}return object}function baseAssign(object,source){return null==source?object:baseCopy(source,keys(source),object)}function baseAt(collection,props){for(var index=-1,isNil=null==collection,isArr=!isNil&&isArrayLike(collection),length=isArr?collection.length:0,propsLength=props.length,result=Array(propsLength);++index<propsLength;){var key=props[index];isArr?result[index]=isIndex(key,length)?collection[key]:undefined:result[index]=isNil?undefined:collection[key]}return result}function baseCopy(source,props,object){object||(object={});for(var index=-1,length=props.length;++index<length;){var key=props[index];object[key]=source[key]}return object}function baseCallback(func,thisArg,argCount){var type=typeof func;return"function"==type?thisArg===undefined?func:bindCallback(func,thisArg,argCount):null==func?identity:"object"==type?baseMatches(func):thisArg===undefined?property(func):baseMatchesProperty(func,thisArg)}function baseClone(value,isDeep,customizer,key,object,stackA,stackB){var result;if(customizer&&(result=object?customizer(value,key,object):customizer(value)),result!==undefined)return result;if(!isObject(value))return value;var isArr=isArray(value);if(isArr){if(result=initCloneArray(value),!isDeep)return arrayCopy(value,result)}else{var tag=objToString.call(value),isFunc=tag==funcTag;if(tag!=objectTag&&tag!=argsTag&&(!isFunc||object))return cloneableTags[tag]?initCloneByTag(value,tag,isDeep):object?value:{};if(result=initCloneObject(isFunc?{}:value),!isDeep)return baseAssign(result,value)}stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==value)return stackB[length];return stackA.push(value),stackB.push(result),(isArr?arrayEach:baseForOwn)(value,function(subValue,key){result[key]=baseClone(subValue,isDeep,customizer,key,value,stackA,stackB)}),result}function baseDelay(func,wait,args){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return setTimeout(function(){func.apply(undefined,args)},wait)}function baseDifference(array,values){var length=array?array.length:0,result=[];if(!length)return result;var index=-1,indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,cache=isCommon&&values.length>=LARGE_ARRAY_SIZE?createCache(values):null,valuesLength=values.length;cache&&(indexOf=cacheIndexOf,isCommon=!1,values=cache);outer:for(;++index<length;){var value=array[index];if(isCommon&&value===value){for(var valuesIndex=valuesLength;valuesIndex--;)if(values[valuesIndex]===value)continue outer;result.push(value)}else indexOf(values,value,0)<0&&result.push(value)}return result}function baseEvery(collection,predicate){var result=!0;return baseEach(collection,function(value,index,collection){return result=!!predicate(value,index,collection)}),result}function baseExtremum(collection,iteratee,comparator,exValue){var computed=exValue,result=computed;return baseEach(collection,function(value,index,collection){var current=+iteratee(value,index,collection);(comparator(current,computed)||current===exValue&&current===result)&&(computed=current,result=value)}),result}function baseFill(array,value,start,end){var length=array.length;for(start=null==start?0:+start||0,start<0&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,end<0&&(end+=length),length=start>end?0:end>>>0,start>>>=0;start<length;)array[start++]=value;return array}function baseFilter(collection,predicate){var result=[];return baseEach(collection,function(value,index,collection){predicate(value,index,collection)&&result.push(value)}),result}function baseFind(collection,predicate,eachFunc,retKey){var result;return eachFunc(collection,function(value,key,collection){if(predicate(value,key,collection))return result=retKey?key:value,!1}),result}function baseFlatten(array,isDeep,isStrict,result){result||(result=[]);for(var index=-1,length=array.length;++index<length;){var value=array[index];isObjectLike(value)&&isArrayLike(value)&&(isStrict||isArray(value)||isArguments(value))?isDeep?baseFlatten(value,isDeep,isStrict,result):arrayPush(result,value):isStrict||(result[result.length]=value)}return result}function baseForIn(object,iteratee){return baseFor(object,iteratee,keysIn)}function baseForOwn(object,iteratee){return baseFor(object,iteratee,keys)}function baseForOwnRight(object,iteratee){return baseForRight(object,iteratee,keys)}function baseFunctions(object,props){for(var index=-1,length=props.length,resIndex=-1,result=[];++index<length;){var key=props[index];isFunction(object[key])&&(result[++resIndex]=key)}return result}function baseGet(object,path,pathKey){if(null!=object){pathKey!==undefined&&pathKey in toObject(object)&&(path=[pathKey]);for(var index=0,length=path.length;null!=object&&index<length;)object=object[path[index++]];return index&&index==length?object:undefined}}function baseIsEqual(value,other,customizer,isLoose,stackA,stackB){return value===other||(null==value||null==other||!isObject(value)&&!isObjectLike(other)?value!==value&&other!==other:baseIsEqualDeep(value,other,baseIsEqual,customizer,isLoose,stackA,stackB))}function baseIsEqualDeep(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objIsArr=isArray(object),othIsArr=isArray(other),objTag=arrayTag,othTag=arrayTag;objIsArr||(objTag=objToString.call(object),objTag==argsTag?objTag=objectTag:objTag!=objectTag&&(objIsArr=isTypedArray(object))),othIsArr||(othTag=objToString.call(other),othTag==argsTag?othTag=objectTag:othTag!=objectTag&&(othIsArr=isTypedArray(other)));var objIsObj=objTag==objectTag,othIsObj=othTag==objectTag,isSameTag=objTag==othTag;if(isSameTag&&!objIsArr&&!objIsObj)return equalByTag(object,other,objTag);if(!isLoose){var objIsWrapped=objIsObj&&hasOwnProperty.call(object,"__wrapped__"),othIsWrapped=othIsObj&&hasOwnProperty.call(other,"__wrapped__");if(objIsWrapped||othIsWrapped)return equalFunc(objIsWrapped?object.value():object,othIsWrapped?other.value():other,customizer,isLoose,stackA,stackB)}if(!isSameTag)return!1;stackA||(stackA=[]),stackB||(stackB=[]);for(var length=stackA.length;length--;)if(stackA[length]==object)return stackB[length]==other;stackA.push(object),stackB.push(other);var result=(objIsArr?equalArrays:equalObjects)(object,other,equalFunc,customizer,isLoose,stackA,stackB);return stackA.pop(),stackB.pop(),result}function baseIsMatch(object,matchData,customizer){var index=matchData.length,length=index,noCustomizer=!customizer;if(null==object)return!length;for(object=toObject(object);index--;){var data=matchData[index];if(noCustomizer&&data[2]?data[1]!==object[data[0]]:!(data[0]in object))return!1}for(;++index<length;){data=matchData[index];var key=data[0],objValue=object[key],srcValue=data[1];if(noCustomizer&&data[2]){if(objValue===undefined&&!(key in object))return!1}else{var result=customizer?customizer(objValue,srcValue,key):undefined;if(!(result===undefined?baseIsEqual(srcValue,objValue,customizer,!0):result))return!1}}return!0}function baseMap(collection,iteratee){var index=-1,result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value,key,collection){result[++index]=iteratee(value,key,collection)}),result}function baseMatches(source){var matchData=getMatchData(source);if(1==matchData.length&&matchData[0][2]){var key=matchData[0][0],value=matchData[0][1];return function(object){return null!=object&&(object[key]===value&&(value!==undefined||key in toObject(object)))}}return function(object){return baseIsMatch(object,matchData)}}function baseMatchesProperty(path,srcValue){var isArr=isArray(path),isCommon=isKey(path)&&isStrictComparable(srcValue),pathKey=path+"";return path=toPath(path),function(object){if(null==object)return!1;var key=pathKey;if(object=toObject(object),(isArr||!isCommon)&&!(key in object)){if(object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;key=last(path),object=toObject(object)}return object[key]===srcValue?srcValue!==undefined||key in object:baseIsEqual(srcValue,object[key],undefined,!0)}}function baseMerge(object,source,customizer,stackA,stackB){if(!isObject(object))return object;var isSrcArr=isArrayLike(source)&&(isArray(source)||isTypedArray(source)),props=isSrcArr?undefined:keys(source);return arrayEach(props||source,function(srcValue,key){if(props&&(key=srcValue,srcValue=source[key]),isObjectLike(srcValue))stackA||(stackA=[]),stackB||(stackB=[]),baseMergeDeep(object,source,key,baseMerge,customizer,stackA,stackB);else{var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue),result===undefined&&(!isSrcArr||key in object)||!isCommon&&(result===result?result===value:value!==value)||(object[key]=result)}}),object}function baseMergeDeep(object,source,key,mergeFunc,customizer,stackA,stackB){for(var length=stackA.length,srcValue=source[key];length--;)if(stackA[length]==srcValue)return void(object[key]=stackB[length]);var value=object[key],result=customizer?customizer(value,srcValue,key,object,source):undefined,isCommon=result===undefined;isCommon&&(result=srcValue,isArrayLike(srcValue)&&(isArray(srcValue)||isTypedArray(srcValue))?result=isArray(value)?value:isArrayLike(value)?arrayCopy(value):[]:isPlainObject(srcValue)||isArguments(srcValue)?result=isArguments(value)?toPlainObject(value):isPlainObject(value)?value:{}:isCommon=!1),stackA.push(srcValue),stackB.push(result),isCommon?object[key]=mergeFunc(result,srcValue,customizer,stackA,stackB):(result===result?result!==value:value===value)&&(object[key]=result)}function baseProperty(key){return function(object){return null==object?undefined:object[key]}}function basePropertyDeep(path){var pathKey=path+"";return path=toPath(path),function(object){return baseGet(object,path,pathKey)}}function basePullAt(array,indexes){for(var length=array?indexes.length:0;length--;){var index=indexes[length];if(index!=previous&&isIndex(index)){var previous=index;splice.call(array,index,1)}}return array}function baseRandom(min,max){return min+nativeFloor(nativeRandom()*(max-min+1))}function baseReduce(collection,iteratee,accumulator,initFromCollection,eachFunc){return eachFunc(collection,function(value,index,collection){accumulator=initFromCollection?(initFromCollection=!1,value):iteratee(accumulator,value,index,collection)}),accumulator}function baseSlice(array,start,end){var index=-1,length=array.length;start=null==start?0:+start||0,start<0&&(start=-start>length?0:length+start),end=end===undefined||end>length?length:+end||0,end<0&&(end+=length),length=start>end?0:end-start>>>0,start>>>=0;for(var result=Array(length);++index<length;)result[index]=array[index+start];return result}function baseSome(collection,predicate){var result;return baseEach(collection,function(value,index,collection){return result=predicate(value,index,collection),!result}),!!result}function baseSortBy(array,comparer){var length=array.length;for(array.sort(comparer);length--;)array[length]=array[length].value;return array}function baseSortByOrder(collection,iteratees,orders){var callback=getCallback(),index=-1;iteratees=arrayMap(iteratees,function(iteratee){return callback(iteratee)});var result=baseMap(collection,function(value){var criteria=arrayMap(iteratees,function(iteratee){return iteratee(value)});return{criteria:criteria,index:++index,value:value}});return baseSortBy(result,function(object,other){return compareMultiple(object,other,orders)})}function baseSum(collection,iteratee){var result=0;return baseEach(collection,function(value,index,collection){result+=+iteratee(value,index,collection)||0}),result}function baseUniq(array,iteratee){var index=-1,indexOf=getIndexOf(),length=array.length,isCommon=indexOf==baseIndexOf,isLarge=isCommon&&length>=LARGE_ARRAY_SIZE,seen=isLarge?createCache():null,result=[];seen?(indexOf=cacheIndexOf,isCommon=!1):(isLarge=!1,seen=iteratee?[]:result);outer:for(;++index<length;){var value=array[index],computed=iteratee?iteratee(value,index,array):value;if(isCommon&&value===value){for(var seenIndex=seen.length;seenIndex--;)if(seen[seenIndex]===computed)continue outer;iteratee&&seen.push(computed),result.push(value)}else indexOf(seen,computed,0)<0&&((iteratee||isLarge)&&seen.push(computed),result.push(value))}return result}function baseValues(object,props){for(var index=-1,length=props.length,result=Array(length);++index<length;)result[index]=object[props[index]];return result}function baseWhile(array,predicate,isDrop,fromRight){for(var length=array.length,index=fromRight?length:-1;(fromRight?index--:++index<length)&&predicate(array[index],index,array););return isDrop?baseSlice(array,fromRight?0:index,fromRight?index+1:length):baseSlice(array,fromRight?index+1:0,fromRight?length:index)}function baseWrapperValue(value,actions){var result=value;result instanceof LazyWrapper&&(result=result.value());for(var index=-1,length=actions.length;++index<length;){var action=actions[index];result=action.func.apply(action.thisArg,arrayPush([result],action.args))}return result}function binaryIndex(array,value,retHighest){var low=0,high=array?array.length:low;if("number"==typeof value&&value===value&&high<=HALF_MAX_ARRAY_LENGTH){for(;low<high;){var mid=low+high>>>1,computed=array[mid];(retHighest?computed<=value:computed<value)&&null!==computed?low=mid+1:high=mid}return high}return binaryIndexBy(array,value,identity,retHighest)}function binaryIndexBy(array,value,iteratee,retHighest){value=iteratee(value);for(var low=0,high=array?array.length:0,valIsNaN=value!==value,valIsNull=null===value,valIsUndef=value===undefined;low<high;){var mid=nativeFloor((low+high)/2),computed=iteratee(array[mid]),isDef=computed!==undefined,isReflexive=computed===computed;if(valIsNaN)var setLow=isReflexive||retHighest;else setLow=valIsNull?isReflexive&&isDef&&(retHighest||null!=computed):valIsUndef?isReflexive&&(retHighest||isDef):null!=computed&&(retHighest?computed<=value:computed<value);setLow?low=mid+1:high=mid}return nativeMin(high,MAX_ARRAY_INDEX)}function bindCallback(func,thisArg,argCount){if("function"!=typeof func)return identity;
if(thisArg===undefined)return func;switch(argCount){case 1:return function(value){return func.call(thisArg,value)};case 3:return function(value,index,collection){return func.call(thisArg,value,index,collection)};case 4:return function(accumulator,value,index,collection){return func.call(thisArg,accumulator,value,index,collection)};case 5:return function(value,other,key,object,source){return func.call(thisArg,value,other,key,object,source)}}return function(){return func.apply(thisArg,arguments)}}function bufferClone(buffer){var result=new ArrayBuffer(buffer.byteLength),view=new Uint8Array(result);return view.set(new Uint8Array(buffer)),result}function composeArgs(args,partials,holders){for(var holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),leftIndex=-1,leftLength=partials.length,result=Array(leftLength+argsLength);++leftIndex<leftLength;)result[leftIndex]=partials[leftIndex];for(;++argsIndex<holdersLength;)result[holders[argsIndex]]=args[argsIndex];for(;argsLength--;)result[leftIndex++]=args[argsIndex++];return result}function composeArgsRight(args,partials,holders){for(var holdersIndex=-1,holdersLength=holders.length,argsIndex=-1,argsLength=nativeMax(args.length-holdersLength,0),rightIndex=-1,rightLength=partials.length,result=Array(argsLength+rightLength);++argsIndex<argsLength;)result[argsIndex]=args[argsIndex];for(var offset=argsIndex;++rightIndex<rightLength;)result[offset+rightIndex]=partials[rightIndex];for(;++holdersIndex<holdersLength;)result[offset+holders[holdersIndex]]=args[argsIndex++];return result}function createAggregator(setter,initializer){return function(collection,iteratee,thisArg){var result=initializer?initializer():{};if(iteratee=getCallback(iteratee,thisArg,3),isArray(collection))for(var index=-1,length=collection.length;++index<length;){var value=collection[index];setter(result,value,iteratee(value,index,collection),collection)}else baseEach(collection,function(value,key,collection){setter(result,value,iteratee(value,key,collection),collection)});return result}}function createAssigner(assigner){return restParam(function(object,sources){var index=-1,length=null==object?0:sources.length,customizer=length>2?sources[length-2]:undefined,guard=length>2?sources[2]:undefined,thisArg=length>1?sources[length-1]:undefined;for("function"==typeof customizer?(customizer=bindCallback(customizer,thisArg,5),length-=2):(customizer="function"==typeof thisArg?thisArg:undefined,length-=customizer?1:0),guard&&isIterateeCall(sources[0],sources[1],guard)&&(customizer=length<3?undefined:customizer,length=1);++index<length;){var source=sources[index];source&&assigner(object,source,customizer)}return object})}function createBaseEach(eachFunc,fromRight){return function(collection,iteratee){var length=collection?getLength(collection):0;if(!isLength(length))return eachFunc(collection,iteratee);for(var index=fromRight?length:-1,iterable=toObject(collection);(fromRight?index--:++index<length)&&iteratee(iterable[index],index,iterable)!==!1;);return collection}}function createBaseFor(fromRight){return function(object,iteratee,keysFunc){for(var iterable=toObject(object),props=keysFunc(object),length=props.length,index=fromRight?length:-1;fromRight?index--:++index<length;){var key=props[index];if(iteratee(iterable[key],key,iterable)===!1)break}return object}}function createBindWrapper(func,thisArg){function wrapper(){var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(thisArg,arguments)}var Ctor=createCtorWrapper(func);return wrapper}function createCache(values){return nativeCreate&&Set?new SetCache(values):null}function createCompounder(callback){return function(string){for(var index=-1,array=words(deburr(string)),length=array.length,result="";++index<length;)result=callback(result,array[index],index);return result}}function createCtorWrapper(Ctor){return function(){var args=arguments;switch(args.length){case 0:return new Ctor;case 1:return new Ctor(args[0]);case 2:return new Ctor(args[0],args[1]);case 3:return new Ctor(args[0],args[1],args[2]);case 4:return new Ctor(args[0],args[1],args[2],args[3]);case 5:return new Ctor(args[0],args[1],args[2],args[3],args[4]);case 6:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5]);case 7:return new Ctor(args[0],args[1],args[2],args[3],args[4],args[5],args[6])}var thisBinding=baseCreate(Ctor.prototype),result=Ctor.apply(thisBinding,args);return isObject(result)?result:thisBinding}}function createCurry(flag){function curryFunc(func,arity,guard){guard&&isIterateeCall(func,arity,guard)&&(arity=undefined);var result=createWrapper(func,flag,undefined,undefined,undefined,undefined,undefined,arity);return result.placeholder=curryFunc.placeholder,result}return curryFunc}function createDefaults(assigner,customizer){return restParam(function(args){var object=args[0];return null==object?object:(args.push(customizer),assigner.apply(undefined,args))})}function createExtremum(comparator,exValue){return function(collection,iteratee,thisArg){if(thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length){collection=isArray(collection)?collection:toIterable(collection);var result=arrayExtremum(collection,iteratee,comparator,exValue);if(!collection.length||result!==exValue)return result}return baseExtremum(collection,iteratee,comparator,exValue)}}function createFind(eachFunc,fromRight){return function(collection,predicate,thisArg){if(predicate=getCallback(predicate,thisArg,3),isArray(collection)){var index=baseFindIndex(collection,predicate,fromRight);return index>-1?collection[index]:undefined}return baseFind(collection,predicate,eachFunc)}}function createFindIndex(fromRight){return function(array,predicate,thisArg){return array&&array.length?(predicate=getCallback(predicate,thisArg,3),baseFindIndex(array,predicate,fromRight)):-1}}function createFindKey(objectFunc){return function(object,predicate,thisArg){return predicate=getCallback(predicate,thisArg,3),baseFind(object,predicate,objectFunc,!0)}}function createFlow(fromRight){return function(){for(var wrapper,length=arguments.length,index=fromRight?length:-1,leftIndex=0,funcs=Array(length);fromRight?index--:++index<length;){var func=funcs[leftIndex++]=arguments[index];if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);!wrapper&&LodashWrapper.prototype.thru&&"wrapper"==getFuncName(func)&&(wrapper=new LodashWrapper([],(!0)))}for(index=wrapper?-1:length;++index<length;){func=funcs[index];var funcName=getFuncName(func),data="wrapper"==funcName?getData(func):undefined;wrapper=data&&isLaziable(data[0])&&data[1]==(ARY_FLAG|CURRY_FLAG|PARTIAL_FLAG|REARG_FLAG)&&!data[4].length&&1==data[9]?wrapper[getFuncName(data[0])].apply(wrapper,data[3]):1==func.length&&isLaziable(func)?wrapper[funcName]():wrapper.thru(func)}return function(){var args=arguments,value=args[0];if(wrapper&&1==args.length&&isArray(value)&&value.length>=LARGE_ARRAY_SIZE)return wrapper.plant(value).value();for(var index=0,result=length?funcs[index].apply(this,args):value;++index<length;)result=funcs[index].call(this,result);return result}}}function createForEach(arrayFunc,eachFunc){return function(collection,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee):eachFunc(collection,bindCallback(iteratee,thisArg,3))}}function createForIn(objectFunc){return function(object,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined||(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee,keysIn)}}function createForOwn(objectFunc){return function(object,iteratee,thisArg){return"function"==typeof iteratee&&thisArg===undefined||(iteratee=bindCallback(iteratee,thisArg,3)),objectFunc(object,iteratee)}}function createObjectMapper(isMapKeys){return function(object,iteratee,thisArg){var result={};return iteratee=getCallback(iteratee,thisArg,3),baseForOwn(object,function(value,key,object){var mapped=iteratee(value,key,object);key=isMapKeys?mapped:key,value=isMapKeys?value:mapped,result[key]=value}),result}}function createPadDir(fromRight){return function(string,length,chars){return string=baseToString(string),(fromRight?string:"")+createPadding(string,length,chars)+(fromRight?"":string)}}function createPartial(flag){var partialFunc=restParam(function(func,partials){var holders=replaceHolders(partials,partialFunc.placeholder);return createWrapper(func,flag,undefined,partials,holders)});return partialFunc}function createReduce(arrayFunc,eachFunc){return function(collection,iteratee,accumulator,thisArg){var initFromArray=arguments.length<3;return"function"==typeof iteratee&&thisArg===undefined&&isArray(collection)?arrayFunc(collection,iteratee,accumulator,initFromArray):baseReduce(collection,getCallback(iteratee,thisArg,4),accumulator,initFromArray,eachFunc)}}function createHybridWrapper(func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity){function wrapper(){for(var length=arguments.length,index=length,args=Array(length);index--;)args[index]=arguments[index];if(partials&&(args=composeArgs(args,partials,holders)),partialsRight&&(args=composeArgsRight(args,partialsRight,holdersRight)),isCurry||isCurryRight){var placeholder=wrapper.placeholder,argsHolders=replaceHolders(args,placeholder);if(length-=argsHolders.length,length<arity){var newArgPos=argPos?arrayCopy(argPos):undefined,newArity=nativeMax(arity-length,0),newsHolders=isCurry?argsHolders:undefined,newHoldersRight=isCurry?undefined:argsHolders,newPartials=isCurry?args:undefined,newPartialsRight=isCurry?undefined:args;bitmask|=isCurry?PARTIAL_FLAG:PARTIAL_RIGHT_FLAG,bitmask&=~(isCurry?PARTIAL_RIGHT_FLAG:PARTIAL_FLAG),isCurryBound||(bitmask&=~(BIND_FLAG|BIND_KEY_FLAG));var newData=[func,bitmask,thisArg,newPartials,newsHolders,newPartialsRight,newHoldersRight,newArgPos,ary,newArity],result=createHybridWrapper.apply(undefined,newData);return isLaziable(func)&&setData(result,newData),result.placeholder=placeholder,result}}var thisBinding=isBind?thisArg:this,fn=isBindKey?thisBinding[func]:func;return argPos&&(args=reorder(args,argPos)),isAry&&ary<args.length&&(args.length=ary),this&&this!==root&&this instanceof wrapper&&(fn=Ctor||createCtorWrapper(func)),fn.apply(thisBinding,args)}var isAry=bitmask&ARY_FLAG,isBind=bitmask&BIND_FLAG,isBindKey=bitmask&BIND_KEY_FLAG,isCurry=bitmask&CURRY_FLAG,isCurryBound=bitmask&CURRY_BOUND_FLAG,isCurryRight=bitmask&CURRY_RIGHT_FLAG,Ctor=isBindKey?undefined:createCtorWrapper(func);return wrapper}function createPadding(string,length,chars){var strLength=string.length;if(length=+length,strLength>=length||!nativeIsFinite(length))return"";var padLength=length-strLength;return chars=null==chars?" ":chars+"",repeat(chars,nativeCeil(padLength/chars.length)).slice(0,padLength)}function createPartialWrapper(func,bitmask,thisArg,partials){function wrapper(){for(var argsIndex=-1,argsLength=arguments.length,leftIndex=-1,leftLength=partials.length,args=Array(leftLength+argsLength);++leftIndex<leftLength;)args[leftIndex]=partials[leftIndex];for(;argsLength--;)args[leftIndex++]=arguments[++argsIndex];var fn=this&&this!==root&&this instanceof wrapper?Ctor:func;return fn.apply(isBind?thisArg:this,args)}var isBind=bitmask&BIND_FLAG,Ctor=createCtorWrapper(func);return wrapper}function createRound(methodName){var func=Math[methodName];return function(number,precision){return precision=precision===undefined?0:+precision||0,precision?(precision=pow(10,precision),func(number*precision)/precision):func(number)}}function createSortedIndex(retHighest){return function(array,value,iteratee,thisArg){var callback=getCallback(iteratee);return null==iteratee&&callback===baseCallback?binaryIndex(array,value,retHighest):binaryIndexBy(array,value,callback(iteratee,thisArg,1),retHighest)}}function createWrapper(func,bitmask,thisArg,partials,holders,argPos,ary,arity){var isBindKey=bitmask&BIND_KEY_FLAG;if(!isBindKey&&"function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);var length=partials?partials.length:0;if(length||(bitmask&=~(PARTIAL_FLAG|PARTIAL_RIGHT_FLAG),partials=holders=undefined),length-=holders?holders.length:0,bitmask&PARTIAL_RIGHT_FLAG){var partialsRight=partials,holdersRight=holders;partials=holders=undefined}var data=isBindKey?undefined:getData(func),newData=[func,bitmask,thisArg,partials,holders,partialsRight,holdersRight,argPos,ary,arity];if(data&&(mergeData(newData,data),bitmask=newData[1],arity=newData[9]),newData[9]=null==arity?isBindKey?0:func.length:nativeMax(arity-length,0)||0,bitmask==BIND_FLAG)var result=createBindWrapper(newData[0],newData[2]);else result=bitmask!=PARTIAL_FLAG&&bitmask!=(BIND_FLAG|PARTIAL_FLAG)||newData[4].length?createHybridWrapper.apply(undefined,newData):createPartialWrapper.apply(undefined,newData);var setter=data?baseSetData:setData;return setter(result,newData)}function equalArrays(array,other,equalFunc,customizer,isLoose,stackA,stackB){var index=-1,arrLength=array.length,othLength=other.length;if(arrLength!=othLength&&!(isLoose&&othLength>arrLength))return!1;for(;++index<arrLength;){var arrValue=array[index],othValue=other[index],result=customizer?customizer(isLoose?othValue:arrValue,isLoose?arrValue:othValue,index):undefined;if(result!==undefined){if(result)continue;return!1}if(isLoose){if(!arraySome(other,function(othValue){return arrValue===othValue||equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB)}))return!1}else if(arrValue!==othValue&&!equalFunc(arrValue,othValue,customizer,isLoose,stackA,stackB))return!1}return!0}function equalByTag(object,other,tag){switch(tag){case boolTag:case dateTag:return+object==+other;case errorTag:return object.name==other.name&&object.message==other.message;case numberTag:return object!=+object?other!=+other:object==+other;case regexpTag:case stringTag:return object==other+""}return!1}function equalObjects(object,other,equalFunc,customizer,isLoose,stackA,stackB){var objProps=keys(object),objLength=objProps.length,othProps=keys(other),othLength=othProps.length;if(objLength!=othLength&&!isLoose)return!1;for(var index=objLength;index--;){var key=objProps[index];if(!(isLoose?key in other:hasOwnProperty.call(other,key)))return!1}for(var skipCtor=isLoose;++index<objLength;){key=objProps[index];var objValue=object[key],othValue=other[key],result=customizer?customizer(isLoose?othValue:objValue,isLoose?objValue:othValue,key):undefined;if(!(result===undefined?equalFunc(objValue,othValue,customizer,isLoose,stackA,stackB):result))return!1;skipCtor||(skipCtor="constructor"==key)}if(!skipCtor){var objCtor=object.constructor,othCtor=other.constructor;if(objCtor!=othCtor&&"constructor"in object&&"constructor"in other&&!("function"==typeof objCtor&&objCtor instanceof objCtor&&"function"==typeof othCtor&&othCtor instanceof othCtor))return!1}return!0}function getCallback(func,thisArg,argCount){var result=lodash.callback||callback;return result=result===callback?baseCallback:result,argCount?result(func,thisArg,argCount):result}function getFuncName(func){for(var result=func.name,array=realNames[result],length=array?array.length:0;length--;){var data=array[length],otherFunc=data.func;if(null==otherFunc||otherFunc==func)return data.name}return result}function getIndexOf(collection,target,fromIndex){var result=lodash.indexOf||indexOf;return result=result===indexOf?baseIndexOf:result,collection?result(collection,target,fromIndex):result}function getMatchData(object){for(var result=pairs(object),length=result.length;length--;)result[length][2]=isStrictComparable(result[length][1]);return result}function getNative(object,key){var value=null==object?undefined:object[key];return isNative(value)?value:undefined}function getView(start,end,transforms){for(var index=-1,length=transforms.length;++index<length;){var data=transforms[index],size=data.size;switch(data.type){case"drop":start+=size;break;case"dropRight":end-=size;break;case"take":end=nativeMin(end,start+size);break;case"takeRight":start=nativeMax(start,end-size)}}return{start:start,end:end}}function initCloneArray(array){var length=array.length,result=new array.constructor(length);return length&&"string"==typeof array[0]&&hasOwnProperty.call(array,"index")&&(result.index=array.index,result.input=array.input),result}function initCloneObject(object){var Ctor=object.constructor;return"function"==typeof Ctor&&Ctor instanceof Ctor||(Ctor=Object),new Ctor}function initCloneByTag(object,tag,isDeep){var Ctor=object.constructor;switch(tag){case arrayBufferTag:return bufferClone(object);case boolTag:case dateTag:return new Ctor((+object));case float32Tag:case float64Tag:case int8Tag:case int16Tag:case int32Tag:case uint8Tag:case uint8ClampedTag:case uint16Tag:case uint32Tag:var buffer=object.buffer;return new Ctor(isDeep?bufferClone(buffer):buffer,object.byteOffset,object.length);case numberTag:case stringTag:return new Ctor(object);case regexpTag:var result=new Ctor(object.source,reFlags.exec(object));result.lastIndex=object.lastIndex}return result}function invokePath(object,path,args){null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),path=last(path));var func=null==object?object:object[path];return null==func?undefined:func.apply(object,args)}function isArrayLike(value){return null!=value&&isLength(getLength(value))}function isIndex(value,length){return value="number"==typeof value||reIsUint.test(value)?+value:-1,length=null==length?MAX_SAFE_INTEGER:length,value>-1&&value%1==0&&value<length}function isIterateeCall(value,index,object){if(!isObject(object))return!1;var type=typeof index;if("number"==type?isArrayLike(object)&&isIndex(index,object.length):"string"==type&&index in object){var other=object[index];return value===value?value===other:other!==other}return!1}function isKey(value,object){var type=typeof value;if("string"==type&&reIsPlainProp.test(value)||"number"==type)return!0;if(isArray(value))return!1;var result=!reIsDeepProp.test(value);return result||null!=object&&value in toObject(object)}function isLaziable(func){var funcName=getFuncName(func);if(!(funcName in LazyWrapper.prototype))return!1;var other=lodash[funcName];if(func===other)return!0;var data=getData(other);return!!data&&func===data[0]}function isLength(value){return"number"==typeof value&&value>-1&&value%1==0&&value<=MAX_SAFE_INTEGER}function isStrictComparable(value){return value===value&&!isObject(value)}function mergeData(data,source){var bitmask=data[1],srcBitmask=source[1],newBitmask=bitmask|srcBitmask,isCommon=newBitmask<ARY_FLAG,isCombo=srcBitmask==ARY_FLAG&&bitmask==CURRY_FLAG||srcBitmask==ARY_FLAG&&bitmask==REARG_FLAG&&data[7].length<=source[8]||srcBitmask==(ARY_FLAG|REARG_FLAG)&&bitmask==CURRY_FLAG;if(!isCommon&&!isCombo)return data;srcBitmask&BIND_FLAG&&(data[2]=source[2],newBitmask|=bitmask&BIND_FLAG?0:CURRY_BOUND_FLAG);var value=source[3];if(value){var partials=data[3];data[3]=partials?composeArgs(partials,value,source[4]):arrayCopy(value),data[4]=partials?replaceHolders(data[3],PLACEHOLDER):arrayCopy(source[4])}return value=source[5],value&&(partials=data[5],data[5]=partials?composeArgsRight(partials,value,source[6]):arrayCopy(value),data[6]=partials?replaceHolders(data[5],PLACEHOLDER):arrayCopy(source[6])),value=source[7],value&&(data[7]=arrayCopy(value)),srcBitmask&ARY_FLAG&&(data[8]=null==data[8]?source[8]:nativeMin(data[8],source[8])),null==data[9]&&(data[9]=source[9]),data[0]=source[0],data[1]=newBitmask,data}function mergeDefaults(objectValue,sourceValue){return objectValue===undefined?sourceValue:merge(objectValue,sourceValue,mergeDefaults)}function pickByArray(object,props){object=toObject(object);for(var index=-1,length=props.length,result={};++index<length;){var key=props[index];key in object&&(result[key]=object[key])}return result}function pickByCallback(object,predicate){var result={};return baseForIn(object,function(value,key,object){predicate(value,key,object)&&(result[key]=value)}),result}function reorder(array,indexes){for(var arrLength=array.length,length=nativeMin(indexes.length,arrLength),oldArray=arrayCopy(array);length--;){var index=indexes[length];array[length]=isIndex(index,arrLength)?oldArray[index]:undefined}return array}function shimKeys(object){for(var props=keysIn(object),propsLength=props.length,length=propsLength&&object.length,allowIndexes=!!length&&isLength(length)&&(isArray(object)||isArguments(object)),index=-1,result=[];++index<propsLength;){var key=props[index];(allowIndexes&&isIndex(key,length)||hasOwnProperty.call(object,key))&&result.push(key)}return result}function toIterable(value){return null==value?[]:isArrayLike(value)?isObject(value)?value:Object(value):values(value)}function toObject(value){return isObject(value)?value:Object(value)}function toPath(value){if(isArray(value))return value;var result=[];return baseToString(value).replace(rePropName,function(match,number,quote,string){result.push(quote?string.replace(reEscapeChar,"$1"):number||match)}),result}function wrapperClone(wrapper){return wrapper instanceof LazyWrapper?wrapper.clone():new LodashWrapper(wrapper.__wrapped__,wrapper.__chain__,arrayCopy(wrapper.__actions__))}function chunk(array,size,guard){size=(guard?isIterateeCall(array,size,guard):null==size)?1:nativeMax(nativeFloor(size)||1,1);for(var index=0,length=array?array.length:0,resIndex=-1,result=Array(nativeCeil(length/size));index<length;)result[++resIndex]=baseSlice(array,index,index+=size);return result}function compact(array){for(var index=-1,length=array?array.length:0,resIndex=-1,result=[];++index<length;){var value=array[index];value&&(result[++resIndex]=value)}return result}function drop(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,n<0?0:n)):[]}function dropRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,0,n<0?0:n)):[]}function dropRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0,!0):[]}function dropWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!0):[]}function fill(array,value,start,end){var length=array?array.length:0;return length?(start&&"number"!=typeof start&&isIterateeCall(array,value,start)&&(start=0,end=length),baseFill(array,value,start,end)):[]}function first(array){return array?array[0]:undefined}function flatten(array,isDeep,guard){var length=array?array.length:0;return guard&&isIterateeCall(array,isDeep,guard)&&(isDeep=!1),length?baseFlatten(array,isDeep):[]}function flattenDeep(array){var length=array?array.length:0;return length?baseFlatten(array,!0):[]}function indexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;if("number"==typeof fromIndex)fromIndex=fromIndex<0?nativeMax(length+fromIndex,0):fromIndex;else if(fromIndex){var index=binaryIndex(array,value);return index<length&&(value===value?value===array[index]:array[index]!==array[index])?index:-1}return baseIndexOf(array,value,fromIndex||0)}function initial(array){return dropRight(array,1)}function last(array){var length=array?array.length:0;return length?array[length-1]:undefined}function lastIndexOf(array,value,fromIndex){var length=array?array.length:0;if(!length)return-1;var index=length;if("number"==typeof fromIndex)index=(fromIndex<0?nativeMax(length+fromIndex,0):nativeMin(fromIndex||0,length-1))+1;else if(fromIndex){index=binaryIndex(array,value,!0)-1;var other=array[index];return(value===value?value===other:other!==other)?index:-1}if(value!==value)return indexOfNaN(array,index,!0);for(;index--;)if(array[index]===value)return index;return-1}function pull(){var args=arguments,array=args[0];if(!array||!array.length)return array;for(var index=0,indexOf=getIndexOf(),length=args.length;++index<length;)for(var fromIndex=0,value=args[index];(fromIndex=indexOf(array,value,fromIndex))>-1;)splice.call(array,fromIndex,1);return array}function remove(array,predicate,thisArg){var result=[];if(!array||!array.length)return result;var index=-1,indexes=[],length=array.length;for(predicate=getCallback(predicate,thisArg,3);++index<length;){var value=array[index];predicate(value,index,array)&&(result.push(value),indexes.push(index))}return basePullAt(array,indexes),result}function rest(array){return drop(array,1)}function slice(array,start,end){var length=array?array.length:0;return length?(end&&"number"!=typeof end&&isIterateeCall(array,start,end)&&(start=0,end=length),baseSlice(array,start,end)):[]}function take(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),baseSlice(array,0,n<0?0:n)):[]}function takeRight(array,n,guard){var length=array?array.length:0;return length?((guard?isIterateeCall(array,n,guard):null==n)&&(n=1),n=length-(+n||0),baseSlice(array,n<0?0:n)):[]}function takeRightWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3),!1,!0):[]}function takeWhile(array,predicate,thisArg){return array&&array.length?baseWhile(array,getCallback(predicate,thisArg,3)):[]}function uniq(array,isSorted,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];null!=isSorted&&"boolean"!=typeof isSorted&&(thisArg=iteratee,iteratee=isIterateeCall(array,isSorted,thisArg)?undefined:isSorted,isSorted=!1);var callback=getCallback();return null==iteratee&&callback===baseCallback||(iteratee=callback(iteratee,thisArg,3)),isSorted&&getIndexOf()==baseIndexOf?sortedUniq(array,iteratee):baseUniq(array,iteratee)}function unzip(array){if(!array||!array.length)return[];var index=-1,length=0;array=arrayFilter(array,function(group){if(isArrayLike(group))return length=nativeMax(group.length,length),!0});for(var result=Array(length);++index<length;)result[index]=arrayMap(array,baseProperty(index));return result}function unzipWith(array,iteratee,thisArg){var length=array?array.length:0;if(!length)return[];var result=unzip(array);return null==iteratee?result:(iteratee=bindCallback(iteratee,thisArg,4),arrayMap(result,function(group){return arrayReduce(group,iteratee,undefined,!0)}))}function xor(){for(var index=-1,length=arguments.length;++index<length;){var array=arguments[index];if(isArrayLike(array))var result=result?arrayPush(baseDifference(result,array),baseDifference(array,result)):array}return result?baseUniq(result):[]}function zipObject(props,values){var index=-1,length=props?props.length:0,result={};for(!length||values||isArray(props[0])||(values=[]);++index<length;){var key=props[index];values?result[key]=values[index]:key&&(result[key[0]]=key[1])}return result}function chain(value){var result=lodash(value);return result.__chain__=!0,result}function tap(value,interceptor,thisArg){return interceptor.call(thisArg,value),value}function thru(value,interceptor,thisArg){return interceptor.call(thisArg,value)}function wrapperChain(){return chain(this)}function wrapperCommit(){return new LodashWrapper(this.value(),this.__chain__)}function wrapperPlant(value){for(var result,parent=this;parent instanceof baseLodash;){var clone=wrapperClone(parent);result?previous.__wrapped__=clone:result=clone;var previous=clone;parent=parent.__wrapped__}return previous.__wrapped__=value,result}function wrapperReverse(){var value=this.__wrapped__,interceptor=function(value){return wrapped&&wrapped.__dir__<0?value:value.reverse()};if(value instanceof LazyWrapper){var wrapped=value;return this.__actions__.length&&(wrapped=new LazyWrapper(this)),wrapped=wrapped.reverse(),wrapped.__actions__.push({func:thru,args:[interceptor],thisArg:undefined}),new LodashWrapper(wrapped,this.__chain__)}return this.thru(interceptor)}function wrapperToString(){return this.value()+""}function wrapperValue(){return baseWrapperValue(this.__wrapped__,this.__actions__)}function every(collection,predicate,thisArg){var func=isArray(collection)?arrayEvery:baseEvery;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),"function"==typeof predicate&&thisArg===undefined||(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function filter(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,predicate)}function findWhere(collection,source){return find(collection,baseMatches(source))}function includes(collection,target,fromIndex,guard){var length=collection?getLength(collection):0;return isLength(length)||(collection=values(collection),length=collection.length),fromIndex="number"!=typeof fromIndex||guard&&isIterateeCall(target,fromIndex,guard)?0:fromIndex<0?nativeMax(length+fromIndex,0):fromIndex||0,"string"==typeof collection||!isArray(collection)&&isString(collection)?fromIndex<=length&&collection.indexOf(target,fromIndex)>-1:!!length&&getIndexOf(collection,target,fromIndex)>-1}function map(collection,iteratee,thisArg){var func=isArray(collection)?arrayMap:baseMap;return iteratee=getCallback(iteratee,thisArg,3),func(collection,iteratee)}function pluck(collection,path){return map(collection,property(path))}function reject(collection,predicate,thisArg){var func=isArray(collection)?arrayFilter:baseFilter;return predicate=getCallback(predicate,thisArg,3),func(collection,function(value,index,collection){return!predicate(value,index,collection)})}function sample(collection,n,guard){if(guard?isIterateeCall(collection,n,guard):null==n){collection=toIterable(collection);var length=collection.length;return length>0?collection[baseRandom(0,length-1)]:undefined}var index=-1,result=toArray(collection),length=result.length,lastIndex=length-1;for(n=nativeMin(n<0?0:+n||0,length);++index<n;){var rand=baseRandom(index,lastIndex),value=result[rand];result[rand]=result[index],result[index]=value}return result.length=n,result}function shuffle(collection){return sample(collection,POSITIVE_INFINITY)}function size(collection){var length=collection?getLength(collection):0;return isLength(length)?length:keys(collection).length}function some(collection,predicate,thisArg){var func=isArray(collection)?arraySome:baseSome;return thisArg&&isIterateeCall(collection,predicate,thisArg)&&(predicate=undefined),"function"==typeof predicate&&thisArg===undefined||(predicate=getCallback(predicate,thisArg,3)),func(collection,predicate)}function sortBy(collection,iteratee,thisArg){if(null==collection)return[];thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined);var index=-1;iteratee=getCallback(iteratee,thisArg,3);var result=baseMap(collection,function(value,key,collection){return{criteria:iteratee(value,key,collection),index:++index,value:value}});return baseSortBy(result,compareAscending)}function sortByOrder(collection,iteratees,orders,guard){return null==collection?[]:(guard&&isIterateeCall(iteratees,orders,guard)&&(orders=undefined),isArray(iteratees)||(iteratees=null==iteratees?[]:[iteratees]),isArray(orders)||(orders=null==orders?[]:[orders]),baseSortByOrder(collection,iteratees,orders))}function where(collection,source){return filter(collection,baseMatches(source))}function after(n,func){if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return n=nativeIsFinite(n=+n)?n:0,function(){if(--n<1)return func.apply(this,arguments)}}function ary(func,n,guard){return guard&&isIterateeCall(func,n,guard)&&(n=undefined),n=func&&null==n?func.length:nativeMax(+n||0,0),createWrapper(func,ARY_FLAG,undefined,undefined,undefined,undefined,n)}function before(n,func){var result;if("function"!=typeof func){if("function"!=typeof n)throw new TypeError(FUNC_ERROR_TEXT);var temp=n;n=func,func=temp}return function(){return--n>0&&(result=func.apply(this,arguments)),n<=1&&(func=undefined),result}}function debounce(func,wait,options){function cancel(){timeoutId&&clearTimeout(timeoutId),
maxTimeoutId&&clearTimeout(maxTimeoutId),lastCalled=0,maxTimeoutId=timeoutId=trailingCall=undefined}function complete(isCalled,id){id&&clearTimeout(id),maxTimeoutId=timeoutId=trailingCall=undefined,isCalled&&(lastCalled=now(),result=func.apply(thisArg,args),timeoutId||maxTimeoutId||(args=thisArg=undefined))}function delayed(){var remaining=wait-(now()-stamp);remaining<=0||remaining>wait?complete(trailingCall,maxTimeoutId):timeoutId=setTimeout(delayed,remaining)}function maxDelayed(){complete(trailing,timeoutId)}function debounced(){if(args=arguments,stamp=now(),thisArg=this,trailingCall=trailing&&(timeoutId||!leading),maxWait===!1)var leadingCall=leading&&!timeoutId;else{maxTimeoutId||leading||(lastCalled=stamp);var remaining=maxWait-(stamp-lastCalled),isCalled=remaining<=0||remaining>maxWait;isCalled?(maxTimeoutId&&(maxTimeoutId=clearTimeout(maxTimeoutId)),lastCalled=stamp,result=func.apply(thisArg,args)):maxTimeoutId||(maxTimeoutId=setTimeout(maxDelayed,remaining))}return isCalled&&timeoutId?timeoutId=clearTimeout(timeoutId):timeoutId||wait===maxWait||(timeoutId=setTimeout(delayed,wait)),leadingCall&&(isCalled=!0,result=func.apply(thisArg,args)),!isCalled||timeoutId||maxTimeoutId||(args=thisArg=undefined),result}var args,maxTimeoutId,result,stamp,thisArg,timeoutId,trailingCall,lastCalled=0,maxWait=!1,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);if(wait=wait<0?0:+wait||0,options===!0){var leading=!0;trailing=!1}else isObject(options)&&(leading=!!options.leading,maxWait="maxWait"in options&&nativeMax(+options.maxWait||0,wait),trailing="trailing"in options?!!options.trailing:trailing);return debounced.cancel=cancel,debounced}function memoize(func,resolver){if("function"!=typeof func||resolver&&"function"!=typeof resolver)throw new TypeError(FUNC_ERROR_TEXT);var memoized=function(){var args=arguments,key=resolver?resolver.apply(this,args):args[0],cache=memoized.cache;if(cache.has(key))return cache.get(key);var result=func.apply(this,args);return memoized.cache=cache.set(key,result),result};return memoized.cache=new memoize.Cache,memoized}function negate(predicate){if("function"!=typeof predicate)throw new TypeError(FUNC_ERROR_TEXT);return function(){return!predicate.apply(this,arguments)}}function once(func){return before(2,func)}function restParam(func,start){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return start=nativeMax(start===undefined?func.length-1:+start||0,0),function(){for(var args=arguments,index=-1,length=nativeMax(args.length-start,0),rest=Array(length);++index<length;)rest[index]=args[start+index];switch(start){case 0:return func.call(this,rest);case 1:return func.call(this,args[0],rest);case 2:return func.call(this,args[0],args[1],rest)}var otherArgs=Array(start+1);for(index=-1;++index<start;)otherArgs[index]=args[index];return otherArgs[start]=rest,func.apply(this,otherArgs)}}function spread(func){if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return function(array){return func.apply(this,array)}}function throttle(func,wait,options){var leading=!0,trailing=!0;if("function"!=typeof func)throw new TypeError(FUNC_ERROR_TEXT);return options===!1?leading=!1:isObject(options)&&(leading="leading"in options?!!options.leading:leading,trailing="trailing"in options?!!options.trailing:trailing),debounce(func,wait,{leading:leading,maxWait:+wait,trailing:trailing})}function wrap(value,wrapper){return wrapper=null==wrapper?identity:wrapper,createWrapper(wrapper,PARTIAL_FLAG,undefined,[value],[])}function clone(value,isDeep,customizer,thisArg){return isDeep&&"boolean"!=typeof isDeep&&isIterateeCall(value,isDeep,customizer)?isDeep=!1:"function"==typeof isDeep&&(thisArg=customizer,customizer=isDeep,isDeep=!1),"function"==typeof customizer?baseClone(value,isDeep,bindCallback(customizer,thisArg,1)):baseClone(value,isDeep)}function cloneDeep(value,customizer,thisArg){return"function"==typeof customizer?baseClone(value,!0,bindCallback(customizer,thisArg,1)):baseClone(value,!0)}function gt(value,other){return value>other}function gte(value,other){return value>=other}function isArguments(value){return isObjectLike(value)&&isArrayLike(value)&&hasOwnProperty.call(value,"callee")&&!propertyIsEnumerable.call(value,"callee")}function isBoolean(value){return value===!0||value===!1||isObjectLike(value)&&objToString.call(value)==boolTag}function isDate(value){return isObjectLike(value)&&objToString.call(value)==dateTag}function isElement(value){return!!value&&1===value.nodeType&&isObjectLike(value)&&!isPlainObject(value)}function isEmpty(value){return null==value||(isArrayLike(value)&&(isArray(value)||isString(value)||isArguments(value)||isObjectLike(value)&&isFunction(value.splice))?!value.length:!keys(value).length)}function isEqual(value,other,customizer,thisArg){customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined;var result=customizer?customizer(value,other):undefined;return result===undefined?baseIsEqual(value,other,customizer):!!result}function isError(value){return isObjectLike(value)&&"string"==typeof value.message&&objToString.call(value)==errorTag}function isFinite(value){return"number"==typeof value&&nativeIsFinite(value)}function isFunction(value){return isObject(value)&&objToString.call(value)==funcTag}function isObject(value){var type=typeof value;return!!value&&("object"==type||"function"==type)}function isMatch(object,source,customizer,thisArg){return customizer="function"==typeof customizer?bindCallback(customizer,thisArg,3):undefined,baseIsMatch(object,getMatchData(source),customizer)}function isNaN(value){return isNumber(value)&&value!=+value}function isNative(value){return null!=value&&(isFunction(value)?reIsNative.test(fnToString.call(value)):isObjectLike(value)&&reIsHostCtor.test(value))}function isNull(value){return null===value}function isNumber(value){return"number"==typeof value||isObjectLike(value)&&objToString.call(value)==numberTag}function isPlainObject(value){var Ctor;if(!isObjectLike(value)||objToString.call(value)!=objectTag||isArguments(value)||!hasOwnProperty.call(value,"constructor")&&(Ctor=value.constructor,"function"==typeof Ctor&&!(Ctor instanceof Ctor)))return!1;var result;return baseForIn(value,function(subValue,key){result=key}),result===undefined||hasOwnProperty.call(value,result)}function isRegExp(value){return isObject(value)&&objToString.call(value)==regexpTag}function isString(value){return"string"==typeof value||isObjectLike(value)&&objToString.call(value)==stringTag}function isTypedArray(value){return isObjectLike(value)&&isLength(value.length)&&!!typedArrayTags[objToString.call(value)]}function isUndefined(value){return value===undefined}function lt(value,other){return value<other}function lte(value,other){return value<=other}function toArray(value){var length=value?getLength(value):0;return isLength(length)?length?arrayCopy(value):[]:values(value)}function toPlainObject(value){return baseCopy(value,keysIn(value))}function create(prototype,properties,guard){var result=baseCreate(prototype);return guard&&isIterateeCall(prototype,properties,guard)&&(properties=undefined),properties?baseAssign(result,properties):result}function functions(object){return baseFunctions(object,keysIn(object))}function get(object,path,defaultValue){var result=null==object?undefined:baseGet(object,toPath(path),path+"");return result===undefined?defaultValue:result}function has(object,path){if(null==object)return!1;var result=hasOwnProperty.call(object,path);if(!result&&!isKey(path)){if(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),null==object)return!1;path=last(path),result=hasOwnProperty.call(object,path)}return result||isLength(object.length)&&isIndex(path,object.length)&&(isArray(object)||isArguments(object))}function invert(object,multiValue,guard){guard&&isIterateeCall(object,multiValue,guard)&&(multiValue=undefined);for(var index=-1,props=keys(object),length=props.length,result={};++index<length;){var key=props[index],value=object[key];multiValue?hasOwnProperty.call(result,value)?result[value].push(key):result[value]=[key]:result[value]=key}return result}function keysIn(object){if(null==object)return[];isObject(object)||(object=Object(object));var length=object.length;length=length&&isLength(length)&&(isArray(object)||isArguments(object))&&length||0;for(var Ctor=object.constructor,index=-1,isProto="function"==typeof Ctor&&Ctor.prototype===object,result=Array(length),skipIndexes=length>0;++index<length;)result[index]=index+"";for(var key in object)skipIndexes&&isIndex(key,length)||"constructor"==key&&(isProto||!hasOwnProperty.call(object,key))||result.push(key);return result}function pairs(object){object=toObject(object);for(var index=-1,props=keys(object),length=props.length,result=Array(length);++index<length;){var key=props[index];result[index]=[key,object[key]]}return result}function result(object,path,defaultValue){var result=null==object?undefined:object[path];return result===undefined&&(null==object||isKey(path,object)||(path=toPath(path),object=1==path.length?object:baseGet(object,baseSlice(path,0,-1)),result=null==object?undefined:object[last(path)]),result=result===undefined?defaultValue:result),isFunction(result)?result.call(object):result}function set(object,path,value){if(null==object)return object;var pathKey=path+"";path=null!=object[pathKey]||isKey(path,object)?[pathKey]:toPath(path);for(var index=-1,length=path.length,lastIndex=length-1,nested=object;null!=nested&&++index<length;){var key=path[index];isObject(nested)&&(index==lastIndex?nested[key]=value:null==nested[key]&&(nested[key]=isIndex(path[index+1])?[]:{})),nested=nested[key]}return object}function transform(object,iteratee,accumulator,thisArg){var isArr=isArray(object)||isTypedArray(object);if(iteratee=getCallback(iteratee,thisArg,4),null==accumulator)if(isArr||isObject(object)){var Ctor=object.constructor;accumulator=isArr?isArray(object)?new Ctor:[]:baseCreate(isFunction(Ctor)?Ctor.prototype:undefined)}else accumulator={};return(isArr?arrayEach:baseForOwn)(object,function(value,index,object){return iteratee(accumulator,value,index,object)}),accumulator}function values(object){return baseValues(object,keys(object))}function valuesIn(object){return baseValues(object,keysIn(object))}function inRange(value,start,end){return start=+start||0,end===undefined?(end=start,start=0):end=+end||0,value>=nativeMin(start,end)&&value<nativeMax(start,end)}function random(min,max,floating){floating&&isIterateeCall(min,max,floating)&&(max=floating=undefined);var noMin=null==min,noMax=null==max;if(null==floating&&(noMax&&"boolean"==typeof min?(floating=min,min=1):"boolean"==typeof max&&(floating=max,noMax=!0)),noMin&&noMax&&(max=1,noMax=!1),min=+min||0,noMax?(max=min,min=0):max=+max||0,floating||min%1||max%1){var rand=nativeRandom();return nativeMin(min+rand*(max-min+parseFloat("1e-"+((rand+"").length-1))),max)}return baseRandom(min,max)}function capitalize(string){return string=baseToString(string),string&&string.charAt(0).toUpperCase()+string.slice(1)}function deburr(string){return string=baseToString(string),string&&string.replace(reLatin1,deburrLetter).replace(reComboMark,"")}function endsWith(string,target,position){string=baseToString(string),target+="";var length=string.length;return position=position===undefined?length:nativeMin(position<0?0:+position||0,length),position-=target.length,position>=0&&string.indexOf(target,position)==position}function escape(string){return string=baseToString(string),string&&reHasUnescapedHtml.test(string)?string.replace(reUnescapedHtml,escapeHtmlChar):string}function escapeRegExp(string){return string=baseToString(string),string&&reHasRegExpChars.test(string)?string.replace(reRegExpChars,escapeRegExpChar):string||"(?:)"}function pad(string,length,chars){string=baseToString(string),length=+length;var strLength=string.length;if(strLength>=length||!nativeIsFinite(length))return string;var mid=(length-strLength)/2,leftLength=nativeFloor(mid),rightLength=nativeCeil(mid);return chars=createPadding("",rightLength,chars),chars.slice(0,leftLength)+string+chars}function parseInt(string,radix,guard){return(guard?isIterateeCall(string,radix,guard):null==radix)?radix=0:radix&&(radix=+radix),string=trim(string),nativeParseInt(string,radix||(reHasHexPrefix.test(string)?16:10))}function repeat(string,n){var result="";if(string=baseToString(string),n=+n,n<1||!string||!nativeIsFinite(n))return result;do n%2&&(result+=string),n=nativeFloor(n/2),string+=string;while(n);return result}function startsWith(string,target,position){return string=baseToString(string),position=null==position?0:nativeMin(position<0?0:+position||0,string.length),string.lastIndexOf(target,position)==position}function template(string,options,otherOptions){var settings=lodash.templateSettings;otherOptions&&isIterateeCall(string,options,otherOptions)&&(options=otherOptions=undefined),string=baseToString(string),options=assignWith(baseAssign({},otherOptions||options),settings,assignOwnDefaults);var isEscaping,isEvaluating,imports=assignWith(baseAssign({},options.imports),settings.imports,assignOwnDefaults),importsKeys=keys(imports),importsValues=baseValues(imports,importsKeys),index=0,interpolate=options.interpolate||reNoMatch,source="__p += '",reDelimiters=RegExp((options.escape||reNoMatch).source+"|"+interpolate.source+"|"+(interpolate===reInterpolate?reEsTemplate:reNoMatch).source+"|"+(options.evaluate||reNoMatch).source+"|$","g"),sourceURL="//# sourceURL="+("sourceURL"in options?options.sourceURL:"lodash.templateSources["+ ++templateCounter+"]")+"\n";string.replace(reDelimiters,function(match,escapeValue,interpolateValue,esTemplateValue,evaluateValue,offset){return interpolateValue||(interpolateValue=esTemplateValue),source+=string.slice(index,offset).replace(reUnescapedString,escapeStringChar),escapeValue&&(isEscaping=!0,source+="' +\n__e("+escapeValue+") +\n'"),evaluateValue&&(isEvaluating=!0,source+="';\n"+evaluateValue+";\n__p += '"),interpolateValue&&(source+="' +\n((__t = ("+interpolateValue+")) == null ? '' : __t) +\n'"),index=offset+match.length,match}),source+="';\n";var variable=options.variable;variable||(source="with (obj) {\n"+source+"\n}\n"),source=(isEvaluating?source.replace(reEmptyStringLeading,""):source).replace(reEmptyStringMiddle,"$1").replace(reEmptyStringTrailing,"$1;"),source="function("+(variable||"obj")+") {\n"+(variable?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(isEscaping?", __e = _.escape":"")+(isEvaluating?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+source+"return __p\n}";var result=attempt(function(){return Function(importsKeys,sourceURL+"return "+source).apply(undefined,importsValues)});if(result.source=source,isError(result))throw result;return result}function trim(string,chars,guard){var value=string;return(string=baseToString(string))?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string),trimmedRightIndex(string)+1):(chars+="",string.slice(charsLeftIndex(string,chars),charsRightIndex(string,chars)+1)):string}function trimLeft(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(trimmedLeftIndex(string)):string.slice(charsLeftIndex(string,chars+"")):string}function trimRight(string,chars,guard){var value=string;return string=baseToString(string),string?(guard?isIterateeCall(value,chars,guard):null==chars)?string.slice(0,trimmedRightIndex(string)+1):string.slice(0,charsRightIndex(string,chars+"")+1):string}function trunc(string,options,guard){guard&&isIterateeCall(string,options,guard)&&(options=undefined);var length=DEFAULT_TRUNC_LENGTH,omission=DEFAULT_TRUNC_OMISSION;if(null!=options)if(isObject(options)){var separator="separator"in options?options.separator:separator;length="length"in options?+options.length||0:length,omission="omission"in options?baseToString(options.omission):omission}else length=+options||0;if(string=baseToString(string),length>=string.length)return string;var end=length-omission.length;if(end<1)return omission;var result=string.slice(0,end);if(null==separator)return result+omission;if(isRegExp(separator)){if(string.slice(end).search(separator)){var match,newEnd,substring=string.slice(0,end);for(separator.global||(separator=RegExp(separator.source,(reFlags.exec(separator)||"")+"g")),separator.lastIndex=0;match=separator.exec(substring);)newEnd=match.index;result=result.slice(0,null==newEnd?end:newEnd)}}else if(string.indexOf(separator,end)!=end){var index=result.lastIndexOf(separator);index>-1&&(result=result.slice(0,index))}return result+omission}function unescape(string){return string=baseToString(string),string&&reHasEscapedHtml.test(string)?string.replace(reEscapedHtml,unescapeHtmlChar):string}function words(string,pattern,guard){return guard&&isIterateeCall(string,pattern,guard)&&(pattern=undefined),string=baseToString(string),string.match(pattern||reWords)||[]}function callback(func,thisArg,guard){return guard&&isIterateeCall(func,thisArg,guard)&&(thisArg=undefined),isObjectLike(func)?matches(func):baseCallback(func,thisArg)}function constant(value){return function(){return value}}function identity(value){return value}function matches(source){return baseMatches(baseClone(source,!0))}function matchesProperty(path,srcValue){return baseMatchesProperty(path,baseClone(srcValue,!0))}function mixin(object,source,options){if(null==options){var isObj=isObject(source),props=isObj?keys(source):undefined,methodNames=props&&props.length?baseFunctions(source,props):undefined;(methodNames?methodNames.length:isObj)||(methodNames=!1,options=source,source=object,object=this)}methodNames||(methodNames=baseFunctions(source,keys(source)));var chain=!0,index=-1,isFunc=isFunction(object),length=methodNames.length;options===!1?chain=!1:isObject(options)&&"chain"in options&&(chain=options.chain);for(;++index<length;){var methodName=methodNames[index],func=source[methodName];object[methodName]=func,isFunc&&(object.prototype[methodName]=function(func){return function(){var chainAll=this.__chain__;if(chain||chainAll){var result=object(this.__wrapped__),actions=result.__actions__=arrayCopy(this.__actions__);return actions.push({func:func,args:arguments,thisArg:object}),result.__chain__=chainAll,result}return func.apply(object,arrayPush([this.value()],arguments))}}(func))}return object}function noConflict(){return root._=oldDash,this}function noop(){}function property(path){return isKey(path)?baseProperty(path):basePropertyDeep(path)}function propertyOf(object){return function(path){return baseGet(object,toPath(path),path+"")}}function range(start,end,step){step&&isIterateeCall(start,end,step)&&(end=step=undefined),start=+start||0,step=null==step?1:+step||0,null==end?(end=start,start=0):end=+end||0;for(var index=-1,length=nativeMax(nativeCeil((end-start)/(step||1)),0),result=Array(length);++index<length;)result[index]=start,start+=step;return result}function times(n,iteratee,thisArg){if(n=nativeFloor(n),n<1||!nativeIsFinite(n))return[];var index=-1,result=Array(nativeMin(n,MAX_ARRAY_LENGTH));for(iteratee=bindCallback(iteratee,thisArg,1);++index<n;)index<MAX_ARRAY_LENGTH?result[index]=iteratee(index):iteratee(index);return result}function uniqueId(prefix){var id=++idCounter;return baseToString(prefix)+id}function add(augend,addend){return(+augend||0)+(+addend||0)}function sum(collection,iteratee,thisArg){return thisArg&&isIterateeCall(collection,iteratee,thisArg)&&(iteratee=undefined),iteratee=getCallback(iteratee,thisArg,3),1==iteratee.length?arraySum(isArray(collection)?collection:toIterable(collection),iteratee):baseSum(collection,iteratee)}context=context?_.defaults(root.Object(),context,_.pick(root,contextProps)):root;var Array=context.Array,Date=context.Date,Error=context.Error,Function=context.Function,Math=context.Math,Number=context.Number,Object=context.Object,RegExp=context.RegExp,String=context.String,TypeError=context.TypeError,arrayProto=Array.prototype,objectProto=Object.prototype,stringProto=String.prototype,fnToString=Function.prototype.toString,hasOwnProperty=objectProto.hasOwnProperty,idCounter=0,objToString=objectProto.toString,oldDash=root._,reIsNative=RegExp("^"+fnToString.call(hasOwnProperty).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),ArrayBuffer=context.ArrayBuffer,clearTimeout=context.clearTimeout,parseFloat=context.parseFloat,pow=Math.pow,propertyIsEnumerable=objectProto.propertyIsEnumerable,Set=getNative(context,"Set"),setTimeout=context.setTimeout,splice=arrayProto.splice,Uint8Array=context.Uint8Array,WeakMap=getNative(context,"WeakMap"),nativeCeil=Math.ceil,nativeCreate=getNative(Object,"create"),nativeFloor=Math.floor,nativeIsArray=getNative(Array,"isArray"),nativeIsFinite=context.isFinite,nativeKeys=getNative(Object,"keys"),nativeMax=Math.max,nativeMin=Math.min,nativeNow=getNative(Date,"now"),nativeParseInt=context.parseInt,nativeRandom=Math.random,NEGATIVE_INFINITY=Number.NEGATIVE_INFINITY,POSITIVE_INFINITY=Number.POSITIVE_INFINITY,MAX_ARRAY_LENGTH=4294967295,MAX_ARRAY_INDEX=MAX_ARRAY_LENGTH-1,HALF_MAX_ARRAY_LENGTH=MAX_ARRAY_LENGTH>>>1,MAX_SAFE_INTEGER=9007199254740991,metaMap=WeakMap&&new WeakMap,realNames={};lodash.support={};lodash.templateSettings={escape:reEscape,evaluate:reEvaluate,interpolate:reInterpolate,variable:"",imports:{_:lodash}};var baseCreate=function(){function object(){}return function(prototype){if(isObject(prototype)){object.prototype=prototype;var result=new object;object.prototype=undefined}return result||{}}}(),baseEach=createBaseEach(baseForOwn),baseEachRight=createBaseEach(baseForOwnRight,!0),baseFor=createBaseFor(),baseForRight=createBaseFor(!0),baseSetData=metaMap?function(func,data){return metaMap.set(func,data),func}:identity,getData=metaMap?function(func){return metaMap.get(func)}:noop,getLength=baseProperty("length"),setData=function(){var count=0,lastCalled=0;return function(key,value){var stamp=now(),remaining=HOT_SPAN-(stamp-lastCalled);if(lastCalled=stamp,remaining>0){if(++count>=HOT_COUNT)return key}else count=0;return baseSetData(key,value)}}(),difference=restParam(function(array,values){return isObjectLike(array)&&isArrayLike(array)?baseDifference(array,baseFlatten(values,!1,!0)):[]}),findIndex=createFindIndex(),findLastIndex=createFindIndex(!0),intersection=restParam(function(arrays){for(var othLength=arrays.length,othIndex=othLength,caches=Array(length),indexOf=getIndexOf(),isCommon=indexOf==baseIndexOf,result=[];othIndex--;){var value=arrays[othIndex]=isArrayLike(value=arrays[othIndex])?value:[];caches[othIndex]=isCommon&&value.length>=120?createCache(othIndex&&value):null}var array=arrays[0],index=-1,length=array?array.length:0,seen=caches[0];outer:for(;++index<length;)if(value=array[index],(seen?cacheIndexOf(seen,value):indexOf(result,value,0))<0){for(var othIndex=othLength;--othIndex;){var cache=caches[othIndex];if((cache?cacheIndexOf(cache,value):indexOf(arrays[othIndex],value,0))<0)continue outer}seen&&seen.push(value),result.push(value)}return result}),pullAt=restParam(function(array,indexes){indexes=baseFlatten(indexes);var result=baseAt(array,indexes);return basePullAt(array,indexes.sort(baseCompareAscending)),result}),sortedIndex=createSortedIndex(),sortedLastIndex=createSortedIndex(!0),union=restParam(function(arrays){return baseUniq(baseFlatten(arrays,!1,!0))}),without=restParam(function(array,values){return isArrayLike(array)?baseDifference(array,values):[]}),zip=restParam(unzip),zipWith=restParam(function(arrays){var length=arrays.length,iteratee=length>2?arrays[length-2]:undefined,thisArg=length>1?arrays[length-1]:undefined;return length>2&&"function"==typeof iteratee?length-=2:(iteratee=length>1&&"function"==typeof thisArg?(--length,thisArg):undefined,thisArg=undefined),arrays.length=length,unzipWith(arrays,iteratee,thisArg)}),wrapperConcat=restParam(function(values){return values=baseFlatten(values),this.thru(function(array){return arrayConcat(isArray(array)?array:[toObject(array)],values)})}),at=restParam(function(collection,props){return baseAt(collection,baseFlatten(props))}),countBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?++result[key]:result[key]=1}),find=createFind(baseEach),findLast=createFind(baseEachRight,!0),forEach=createForEach(arrayEach,baseEach),forEachRight=createForEach(arrayEachRight,baseEachRight),groupBy=createAggregator(function(result,value,key){hasOwnProperty.call(result,key)?result[key].push(value):result[key]=[value]}),indexBy=createAggregator(function(result,value,key){result[key]=value}),invoke=restParam(function(collection,path,args){var index=-1,isFunc="function"==typeof path,isProp=isKey(path),result=isArrayLike(collection)?Array(collection.length):[];return baseEach(collection,function(value){var func=isFunc?path:isProp&&null!=value?value[path]:undefined;result[++index]=func?func.apply(value,args):invokePath(value,path,args)}),result}),partition=createAggregator(function(result,value,key){result[key?0:1].push(value)},function(){return[[],[]]}),reduce=createReduce(arrayReduce,baseEach),reduceRight=createReduce(arrayReduceRight,baseEachRight),sortByAll=restParam(function(collection,iteratees){if(null==collection)return[];var guard=iteratees[2];return guard&&isIterateeCall(iteratees[0],iteratees[1],guard)&&(iteratees.length=1),baseSortByOrder(collection,baseFlatten(iteratees),[])}),now=nativeNow||function(){return(new Date).getTime()},bind=restParam(function(func,thisArg,partials){var bitmask=BIND_FLAG;if(partials.length){var holders=replaceHolders(partials,bind.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(func,bitmask,thisArg,partials,holders)}),bindAll=restParam(function(object,methodNames){methodNames=methodNames.length?baseFlatten(methodNames):functions(object);for(var index=-1,length=methodNames.length;++index<length;){var key=methodNames[index];object[key]=createWrapper(object[key],BIND_FLAG,object)}return object}),bindKey=restParam(function(object,key,partials){var bitmask=BIND_FLAG|BIND_KEY_FLAG;if(partials.length){var holders=replaceHolders(partials,bindKey.placeholder);bitmask|=PARTIAL_FLAG}return createWrapper(key,bitmask,object,partials,holders)}),curry=createCurry(CURRY_FLAG),curryRight=createCurry(CURRY_RIGHT_FLAG),defer=restParam(function(func,args){return baseDelay(func,1,args)}),delay=restParam(function(func,wait,args){return baseDelay(func,wait,args)}),flow=createFlow(),flowRight=createFlow(!0),modArgs=restParam(function(func,transforms){if(transforms=baseFlatten(transforms),"function"!=typeof func||!arrayEvery(transforms,baseIsFunction))throw new TypeError(FUNC_ERROR_TEXT);var length=transforms.length;return restParam(function(args){for(var index=nativeMin(args.length,length);index--;)args[index]=transforms[index](args[index]);return func.apply(this,args)})}),partial=createPartial(PARTIAL_FLAG),partialRight=createPartial(PARTIAL_RIGHT_FLAG),rearg=restParam(function(func,indexes){return createWrapper(func,REARG_FLAG,undefined,undefined,undefined,baseFlatten(indexes))}),isArray=nativeIsArray||function(value){return isObjectLike(value)&&isLength(value.length)&&objToString.call(value)==arrayTag},merge=createAssigner(baseMerge),assign=createAssigner(function(object,source,customizer){return customizer?assignWith(object,source,customizer):baseAssign(object,source)}),defaults=createDefaults(assign,assignDefaults),defaultsDeep=createDefaults(merge,mergeDefaults),findKey=createFindKey(baseForOwn),findLastKey=createFindKey(baseForOwnRight),forIn=createForIn(baseFor),forInRight=createForIn(baseForRight),forOwn=createForOwn(baseForOwn),forOwnRight=createForOwn(baseForOwnRight),keys=nativeKeys?function(object){var Ctor=null==object?undefined:object.constructor;return"function"==typeof Ctor&&Ctor.prototype===object||"function"!=typeof object&&isArrayLike(object)?shimKeys(object):isObject(object)?nativeKeys(object):[]}:shimKeys,mapKeys=createObjectMapper(!0),mapValues=createObjectMapper(),omit=restParam(function(object,props){if(null==object)return{};if("function"!=typeof props[0]){var props=arrayMap(baseFlatten(props),String);return pickByArray(object,baseDifference(keysIn(object),props))}var predicate=bindCallback(props[0],props[1],3);return pickByCallback(object,function(value,key,object){return!predicate(value,key,object)})}),pick=restParam(function(object,props){return null==object?{}:"function"==typeof props[0]?pickByCallback(object,bindCallback(props[0],props[1],3)):pickByArray(object,baseFlatten(props))}),camelCase=createCompounder(function(result,word,index){return word=word.toLowerCase(),result+(index?word.charAt(0).toUpperCase()+word.slice(1):word)}),kebabCase=createCompounder(function(result,word,index){return result+(index?"-":"")+word.toLowerCase()}),padLeft=createPadDir(),padRight=createPadDir(!0),snakeCase=createCompounder(function(result,word,index){return result+(index?"_":"")+word.toLowerCase()}),startCase=createCompounder(function(result,word,index){return result+(index?" ":"")+(word.charAt(0).toUpperCase()+word.slice(1))}),attempt=restParam(function(func,args){try{return func.apply(undefined,args)}catch(e){return isError(e)?e:new Error(e)}}),method=restParam(function(path,args){return function(object){return invokePath(object,path,args)}}),methodOf=restParam(function(object,args){return function(path){return invokePath(object,path,args)}}),ceil=createRound("ceil"),floor=createRound("floor"),max=createExtremum(gt,NEGATIVE_INFINITY),min=createExtremum(lt,POSITIVE_INFINITY),round=createRound("round");return lodash.prototype=baseLodash.prototype,LodashWrapper.prototype=baseCreate(baseLodash.prototype),LodashWrapper.prototype.constructor=LodashWrapper,LazyWrapper.prototype=baseCreate(baseLodash.prototype),LazyWrapper.prototype.constructor=LazyWrapper,MapCache.prototype["delete"]=mapDelete,MapCache.prototype.get=mapGet,MapCache.prototype.has=mapHas,MapCache.prototype.set=mapSet,SetCache.prototype.push=cachePush,memoize.Cache=MapCache,lodash.after=after,lodash.ary=ary,lodash.assign=assign,lodash.at=at,lodash.before=before,lodash.bind=bind,lodash.bindAll=bindAll,lodash.bindKey=bindKey,lodash.callback=callback,lodash.chain=chain,lodash.chunk=chunk,lodash.compact=compact,lodash.constant=constant,lodash.countBy=countBy,lodash.create=create,lodash.curry=curry,lodash.curryRight=curryRight,lodash.debounce=debounce,lodash.defaults=defaults,lodash.defaultsDeep=defaultsDeep,lodash.defer=defer,lodash.delay=delay,lodash.difference=difference,lodash.drop=drop,lodash.dropRight=dropRight,lodash.dropRightWhile=dropRightWhile,lodash.dropWhile=dropWhile,lodash.fill=fill,lodash.filter=filter,lodash.flatten=flatten,lodash.flattenDeep=flattenDeep,lodash.flow=flow,lodash.flowRight=flowRight,lodash.forEach=forEach,lodash.forEachRight=forEachRight,lodash.forIn=forIn,lodash.forInRight=forInRight,lodash.forOwn=forOwn,lodash.forOwnRight=forOwnRight,lodash.functions=functions,lodash.groupBy=groupBy,lodash.indexBy=indexBy,lodash.initial=initial,lodash.intersection=intersection,lodash.invert=invert,lodash.invoke=invoke,lodash.keys=keys,lodash.keysIn=keysIn,lodash.map=map,lodash.mapKeys=mapKeys,lodash.mapValues=mapValues,lodash.matches=matches,lodash.matchesProperty=matchesProperty,lodash.memoize=memoize,lodash.merge=merge,lodash.method=method,lodash.methodOf=methodOf,lodash.mixin=mixin,lodash.modArgs=modArgs,lodash.negate=negate,lodash.omit=omit,lodash.once=once,lodash.pairs=pairs,lodash.partial=partial,lodash.partialRight=partialRight,lodash.partition=partition,lodash.pick=pick,lodash.pluck=pluck,lodash.property=property,lodash.propertyOf=propertyOf,lodash.pull=pull,lodash.pullAt=pullAt,lodash.range=range,lodash.rearg=rearg,lodash.reject=reject,lodash.remove=remove,lodash.rest=rest,lodash.restParam=restParam,lodash.set=set,lodash.shuffle=shuffle,lodash.slice=slice,lodash.sortBy=sortBy,lodash.sortByAll=sortByAll,lodash.sortByOrder=sortByOrder,lodash.spread=spread,
lodash.take=take,lodash.takeRight=takeRight,lodash.takeRightWhile=takeRightWhile,lodash.takeWhile=takeWhile,lodash.tap=tap,lodash.throttle=throttle,lodash.thru=thru,lodash.times=times,lodash.toArray=toArray,lodash.toPlainObject=toPlainObject,lodash.transform=transform,lodash.union=union,lodash.uniq=uniq,lodash.unzip=unzip,lodash.unzipWith=unzipWith,lodash.values=values,lodash.valuesIn=valuesIn,lodash.where=where,lodash.without=without,lodash.wrap=wrap,lodash.xor=xor,lodash.zip=zip,lodash.zipObject=zipObject,lodash.zipWith=zipWith,lodash.backflow=flowRight,lodash.collect=map,lodash.compose=flowRight,lodash.each=forEach,lodash.eachRight=forEachRight,lodash.extend=assign,lodash.iteratee=callback,lodash.methods=functions,lodash.object=zipObject,lodash.select=filter,lodash.tail=rest,lodash.unique=uniq,mixin(lodash,lodash),lodash.add=add,lodash.attempt=attempt,lodash.camelCase=camelCase,lodash.capitalize=capitalize,lodash.ceil=ceil,lodash.clone=clone,lodash.cloneDeep=cloneDeep,lodash.deburr=deburr,lodash.endsWith=endsWith,lodash.escape=escape,lodash.escapeRegExp=escapeRegExp,lodash.every=every,lodash.find=find,lodash.findIndex=findIndex,lodash.findKey=findKey,lodash.findLast=findLast,lodash.findLastIndex=findLastIndex,lodash.findLastKey=findLastKey,lodash.findWhere=findWhere,lodash.first=first,lodash.floor=floor,lodash.get=get,lodash.gt=gt,lodash.gte=gte,lodash.has=has,lodash.identity=identity,lodash.includes=includes,lodash.indexOf=indexOf,lodash.inRange=inRange,lodash.isArguments=isArguments,lodash.isArray=isArray,lodash.isBoolean=isBoolean,lodash.isDate=isDate,lodash.isElement=isElement,lodash.isEmpty=isEmpty,lodash.isEqual=isEqual,lodash.isError=isError,lodash.isFinite=isFinite,lodash.isFunction=isFunction,lodash.isMatch=isMatch,lodash.isNaN=isNaN,lodash.isNative=isNative,lodash.isNull=isNull,lodash.isNumber=isNumber,lodash.isObject=isObject,lodash.isPlainObject=isPlainObject,lodash.isRegExp=isRegExp,lodash.isString=isString,lodash.isTypedArray=isTypedArray,lodash.isUndefined=isUndefined,lodash.kebabCase=kebabCase,lodash.last=last,lodash.lastIndexOf=lastIndexOf,lodash.lt=lt,lodash.lte=lte,lodash.max=max,lodash.min=min,lodash.noConflict=noConflict,lodash.noop=noop,lodash.now=now,lodash.pad=pad,lodash.padLeft=padLeft,lodash.padRight=padRight,lodash.parseInt=parseInt,lodash.random=random,lodash.reduce=reduce,lodash.reduceRight=reduceRight,lodash.repeat=repeat,lodash.result=result,lodash.round=round,lodash.runInContext=runInContext,lodash.size=size,lodash.snakeCase=snakeCase,lodash.some=some,lodash.sortedIndex=sortedIndex,lodash.sortedLastIndex=sortedLastIndex,lodash.startCase=startCase,lodash.startsWith=startsWith,lodash.sum=sum,lodash.template=template,lodash.trim=trim,lodash.trimLeft=trimLeft,lodash.trimRight=trimRight,lodash.trunc=trunc,lodash.unescape=unescape,lodash.uniqueId=uniqueId,lodash.words=words,lodash.all=every,lodash.any=some,lodash.contains=includes,lodash.eq=isEqual,lodash.detect=find,lodash.foldl=reduce,lodash.foldr=reduceRight,lodash.head=first,lodash.include=includes,lodash.inject=reduce,mixin(lodash,function(){var source={};return baseForOwn(lodash,function(func,methodName){lodash.prototype[methodName]||(source[methodName]=func)}),source}(),!1),lodash.sample=sample,lodash.prototype.sample=function(n){return this.__chain__||null!=n?this.thru(function(value){return sample(value,n)}):sample(this.value())},lodash.VERSION=VERSION,arrayEach(["bind","bindKey","curry","curryRight","partial","partialRight"],function(methodName){lodash[methodName].placeholder=lodash}),arrayEach(["drop","take"],function(methodName,index){LazyWrapper.prototype[methodName]=function(n){var filtered=this.__filtered__;if(filtered&&!index)return new LazyWrapper(this);n=null==n?1:nativeMax(nativeFloor(n)||0,0);var result=this.clone();return filtered?result.__takeCount__=nativeMin(result.__takeCount__,n):result.__views__.push({size:n,type:methodName+(result.__dir__<0?"Right":"")}),result},LazyWrapper.prototype[methodName+"Right"]=function(n){return this.reverse()[methodName](n).reverse()}}),arrayEach(["filter","map","takeWhile"],function(methodName,index){var type=index+1,isFilter=type!=LAZY_MAP_FLAG;LazyWrapper.prototype[methodName]=function(iteratee,thisArg){var result=this.clone();return result.__iteratees__.push({iteratee:getCallback(iteratee,thisArg,1),type:type}),result.__filtered__=result.__filtered__||isFilter,result}}),arrayEach(["first","last"],function(methodName,index){var takeName="take"+(index?"Right":"");LazyWrapper.prototype[methodName]=function(){return this[takeName](1).value()[0]}}),arrayEach(["initial","rest"],function(methodName,index){var dropName="drop"+(index?"":"Right");LazyWrapper.prototype[methodName]=function(){return this.__filtered__?new LazyWrapper(this):this[dropName](1)}}),arrayEach(["pluck","where"],function(methodName,index){var operationName=index?"filter":"map",createCallback=index?baseMatches:property;LazyWrapper.prototype[methodName]=function(value){return this[operationName](createCallback(value))}}),LazyWrapper.prototype.compact=function(){return this.filter(identity)},LazyWrapper.prototype.reject=function(predicate,thisArg){return predicate=getCallback(predicate,thisArg,1),this.filter(function(value){return!predicate(value)})},LazyWrapper.prototype.slice=function(start,end){start=null==start?0:+start||0;var result=this;return result.__filtered__&&(start>0||end<0)?new LazyWrapper(result):(start<0?result=result.takeRight(-start):start&&(result=result.drop(start)),end!==undefined&&(end=+end||0,result=end<0?result.dropRight(-end):result.take(end-start)),result)},LazyWrapper.prototype.takeRightWhile=function(predicate,thisArg){return this.reverse().takeWhile(predicate,thisArg).reverse()},LazyWrapper.prototype.toArray=function(){return this.take(POSITIVE_INFINITY)},baseForOwn(LazyWrapper.prototype,function(func,methodName){var checkIteratee=/^(?:filter|map|reject)|While$/.test(methodName),retUnwrapped=/^(?:first|last)$/.test(methodName),lodashFunc=lodash[retUnwrapped?"take"+("last"==methodName?"Right":""):methodName];lodashFunc&&(lodash.prototype[methodName]=function(){var args=retUnwrapped?[1]:arguments,chainAll=this.__chain__,value=this.__wrapped__,isHybrid=!!this.__actions__.length,isLazy=value instanceof LazyWrapper,iteratee=args[0],useLazy=isLazy||isArray(value);useLazy&&checkIteratee&&"function"==typeof iteratee&&1!=iteratee.length&&(isLazy=useLazy=!1);var interceptor=function(value){return retUnwrapped&&chainAll?lodashFunc(value,1)[0]:lodashFunc.apply(undefined,arrayPush([value],args))},action={func:thru,args:[interceptor],thisArg:undefined},onlyLazy=isLazy&&!isHybrid;if(retUnwrapped&&!chainAll)return onlyLazy?(value=value.clone(),value.__actions__.push(action),func.call(value)):lodashFunc.call(undefined,this.value())[0];if(!retUnwrapped&&useLazy){value=onlyLazy?value:new LazyWrapper(this);var result=func.apply(value,args);return result.__actions__.push(action),new LodashWrapper(result,chainAll)}return this.thru(interceptor)})}),arrayEach(["join","pop","push","replace","shift","sort","splice","split","unshift"],function(methodName){var func=(/^(?:replace|split)$/.test(methodName)?stringProto:arrayProto)[methodName],chainName=/^(?:push|sort|unshift)$/.test(methodName)?"tap":"thru",retUnwrapped=/^(?:join|pop|replace|shift)$/.test(methodName);lodash.prototype[methodName]=function(){var args=arguments;return retUnwrapped&&!this.__chain__?func.apply(this.value(),args):this[chainName](function(value){return func.apply(value,args)})}}),baseForOwn(LazyWrapper.prototype,function(func,methodName){var lodashFunc=lodash[methodName];if(lodashFunc){var key=lodashFunc.name,names=realNames[key]||(realNames[key]=[]);names.push({name:methodName,func:lodashFunc})}}),realNames[createHybridWrapper(undefined,BIND_KEY_FLAG).name]=[{name:"wrapper",func:undefined}],LazyWrapper.prototype.clone=lazyClone,LazyWrapper.prototype.reverse=lazyReverse,LazyWrapper.prototype.value=lazyValue,lodash.prototype.chain=wrapperChain,lodash.prototype.commit=wrapperCommit,lodash.prototype.concat=wrapperConcat,lodash.prototype.plant=wrapperPlant,lodash.prototype.reverse=wrapperReverse,lodash.prototype.toString=wrapperToString,lodash.prototype.run=lodash.prototype.toJSON=lodash.prototype.valueOf=lodash.prototype.value=wrapperValue,lodash.prototype.collect=lodash.prototype.map,lodash.prototype.head=lodash.prototype.first,lodash.prototype.select=lodash.prototype.filter,lodash.prototype.tail=lodash.prototype.rest,lodash}var undefined,VERSION="3.10.1",BIND_FLAG=1,BIND_KEY_FLAG=2,CURRY_BOUND_FLAG=4,CURRY_FLAG=8,CURRY_RIGHT_FLAG=16,PARTIAL_FLAG=32,PARTIAL_RIGHT_FLAG=64,ARY_FLAG=128,REARG_FLAG=256,DEFAULT_TRUNC_LENGTH=30,DEFAULT_TRUNC_OMISSION="...",HOT_COUNT=150,HOT_SPAN=16,LARGE_ARRAY_SIZE=200,LAZY_FILTER_FLAG=1,LAZY_MAP_FLAG=2,FUNC_ERROR_TEXT="Expected a function",PLACEHOLDER="__lodash_placeholder__",argsTag="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",reEmptyStringLeading=/\b__p \+= '';/g,reEmptyStringMiddle=/\b(__p \+=) '' \+/g,reEmptyStringTrailing=/(__e\(.*?\)|\b__t\)) \+\n'';/g,reEscapedHtml=/&(?:amp|lt|gt|quot|#39|#96);/g,reUnescapedHtml=/[&<>"'`]/g,reHasEscapedHtml=RegExp(reEscapedHtml.source),reHasUnescapedHtml=RegExp(reUnescapedHtml.source),reEscape=/<%-([\s\S]+?)%>/g,reEvaluate=/<%([\s\S]+?)%>/g,reInterpolate=/<%=([\s\S]+?)%>/g,reIsDeepProp=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\n\\]|\\.)*?\1)\]/,reIsPlainProp=/^\w*$/,rePropName=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\n\\]|\\.)*?)\2)\]/g,reRegExpChars=/^[:!,]|[\\^$.*+?()[\]{}|\/]|(^[0-9a-fA-Fnrtuvx])|([\n\r\u2028\u2029])/g,reHasRegExpChars=RegExp(reRegExpChars.source),reComboMark=/[\u0300-\u036f\ufe20-\ufe23]/g,reEscapeChar=/\\(\\)?/g,reEsTemplate=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,reFlags=/\w*$/,reHasHexPrefix=/^0[xX]/,reIsHostCtor=/^\[object .+?Constructor\]$/,reIsUint=/^\d+$/,reLatin1=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,reNoMatch=/($^)/,reUnescapedString=/['\n\r\u2028\u2029\\]/g,reWords=function(){var upper="[A-Z\\xc0-\\xd6\\xd8-\\xde]",lower="[a-z\\xdf-\\xf6\\xf8-\\xff]+";return RegExp(upper+"+(?="+upper+lower+")|"+upper+"?"+lower+"|"+upper+"+|[0-9]+","g")}(),contextProps=["Array","ArrayBuffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Math","Number","Object","RegExp","Set","String","_","clearTimeout","isFinite","parseFloat","parseInt","setTimeout","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap"],templateCounter=-1,typedArrayTags={};typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var cloneableTags={};cloneableTags[argsTag]=cloneableTags[arrayTag]=cloneableTags[arrayBufferTag]=cloneableTags[boolTag]=cloneableTags[dateTag]=cloneableTags[float32Tag]=cloneableTags[float64Tag]=cloneableTags[int8Tag]=cloneableTags[int16Tag]=cloneableTags[int32Tag]=cloneableTags[numberTag]=cloneableTags[objectTag]=cloneableTags[regexpTag]=cloneableTags[stringTag]=cloneableTags[uint8Tag]=cloneableTags[uint8ClampedTag]=cloneableTags[uint16Tag]=cloneableTags[uint32Tag]=!0,cloneableTags[errorTag]=cloneableTags[funcTag]=cloneableTags[mapTag]=cloneableTags[setTag]=cloneableTags[weakMapTag]=!1;var deburredLetters={"":"A","":"A","":"A","":"A","":"A","":"A","":"a","":"a","":"a","":"a","":"a","":"a","":"C","":"c","":"D","":"d","":"E","":"E","":"E","":"E","":"e","":"e","":"e","":"e","":"I","":"I","":"I","":"I","":"i","":"i","":"i","":"i","":"N","":"n","":"O","":"O","":"O","":"O","":"O","":"O","":"o","":"o","":"o","":"o","":"o","":"o","":"U","":"U","":"U","":"U","":"u","":"u","":"u","":"u","":"Y","":"y","":"y","":"Ae","":"ae","":"Th","":"th","":"ss"},htmlEscapes={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},htmlUnescapes={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},objectTypes={"function":!0,object:!0},regexpEscapes={0:"x30",1:"x31",2:"x32",3:"x33",4:"x34",5:"x35",6:"x36",7:"x37",8:"x38",9:"x39",A:"x41",B:"x42",C:"x43",D:"x44",E:"x45",F:"x46",a:"x61",b:"x62",c:"x63",d:"x64",e:"x65",f:"x66",n:"x6e",r:"x72",t:"x74",u:"x75",v:"x76",x:"x78"},stringEscapes={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},freeExports=objectTypes[typeof exports]&&exports&&!exports.nodeType&&exports,freeModule=objectTypes[typeof module]&&module&&!module.nodeType&&module,freeGlobal=freeExports&&freeModule&&"object"==typeof global&&global&&global.Object&&global,freeSelf=objectTypes[typeof self]&&self&&self.Object&&self,freeWindow=objectTypes[typeof window]&&window&&window.Object&&window,moduleExports=freeModule&&freeModule.exports===freeExports&&freeExports,root=freeGlobal||freeWindow!==(this&&this.window)&&freeWindow||freeSelf||this,_=runInContext();"function"==typeof define&&"object"==typeof define.amd&&define.amd?(root._=_,define(function(){return _})):freeExports&&freeModule?moduleExports?(freeModule.exports=_)._=_:freeExports._=_:root._=_}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],20:[function(_dereq_,module,exports){"use strict";var elementsDefinitions={Group:_dereq_("./elements/Group.js"),Box:_dereq_("./elements/Box.js"),SvgSymbol:_dereq_("./elements/SvgSymbol.js"),Input2:_dereq_("./elements/Input2.js"),AndroidGear:_dereq_("./elements/AndroidGear.js"),AndroidIcon:_dereq_("./elements/AndroidIcon.js"),Arrow:_dereq_("./elements/Arrow.js"),Banner:_dereq_("./elements/Banner.js"),Button:_dereq_("./elements/Button.js"),Canvas:_dereq_("./elements/Canvas.js"),Checkbox:_dereq_("./elements/Checkbox.js"),Circle:_dereq_("./elements/Circle.js"),Clipart:_dereq_("./elements/Clipart.js"),Component:_dereq_("./elements/Component.js"),CostcoIcon:_dereq_("./elements/CostcoIcon.js"),Dialog:_dereq_("./elements/Dialog.js"),FontAwesome:_dereq_("./elements/FontAwesome.js"),GeoSvg:_dereq_("./elements/GeoSvg.js"),GlassCanvas:_dereq_("./elements/GlassCanvas.js"),GroupingInstance:_dereq_("./elements/GroupingInstance.js"),HorizontalScrollbar:_dereq_("./elements/HorizontalScrollbar.js"),Hotspot:_dereq_("./elements/Hotspot.js"),Image:_dereq_("./elements/Image.js"),ImageCrop:_dereq_("./elements/ui/ImageCrop.js"),InputWithLabel:_dereq_("./elements/InputWithLabel.js"),iOS7:_dereq_("./elements/iOS7.js"),iOS8:_dereq_("./elements/iOS8.js"),Label:_dereq_("./elements/Label.js"),Line:_dereq_("./elements/Line.js"),Link:_dereq_("./elements/Link.js"),LinkList:_dereq_("./elements/LinkList.js"),MaterialIcon:_dereq_("./elements/MaterialIcon.js"),Menu:_dereq_("./elements/Menu.js"),MobileSymbol:_dereq_("./elements/MobileSymbol.js"),Multistate:_dereq_("./elements/Multistate.js"),Navigation:_dereq_("./elements/Navigation.js"),Password:_dereq_("./elements/Password.js"),PixleIcon:_dereq_("./elements/PixleIcon.js"),Radio:_dereq_("./elements/Radio.js"),RetinaIcon:_dereq_("./elements/RetinaIcon.js"),Scrollbar:_dereq_("./elements/Scrollbar.js"),Selectlist:_dereq_("./elements/Selectlist.js"),SvgIconLegacy:_dereq_("./elements/SvgIconLegacy.js"),Table:_dereq_("./elements/Table.js"),Tab:_dereq_("./elements/Tab.js"),Tag:_dereq_("./elements/Tag.js"),Textarea:_dereq_("./elements/Textarea.js"),TextElement:_dereq_("./elements/TextElement.js"),Tooltip:_dereq_("./elements/Tooltip.js"),UniSvg:_dereq_("./elements/UniSvg.js"),UXPinIconSet:_dereq_("./elements/UXPinIconSet.js"),Video:_dereq_("./elements/Video.js"),VirtualGroup:_dereq_("./elements/VirtualGroup.js")},_=_dereq_("lodash"),ElementTypes=_dereq_("./enums/ElementTypes.js"),Properties=_dereq_("./enums/Properties.js"),ImageEditor=_dereq_("./elements/helpers/ImageEditor.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),LegacyMap=_dereq_("./LegacyMap.js"),Logger=_dereq_("./utils/Logger");module.exports=function(){function translateIdsOnDuplicate(serialized,idsMap){return ElementsHelper.TranslateIds(serialized,idsMap)}function getElementsByType(elements,type){return _.filter(elements,function(element){return element.type===type&&element.name})}function getCopyIndex(name){var result=REGEXP_DUPLICATED_NAME.exec(name);return _.isArray(result)?_.isNaN(parseInt(result[2]))?1:parseInt(result[2]):0}function getNameIndexForDuplicated(type,elements,name){var nameStripped=stripCopyFromName(name),elementsByType=getElementsByType(elements,type);return _.reduce(elementsByType,function(index,element){return nameStripped===stripCopyFromName(element.name)?Math.max(index,getCopyIndex(element.name)):index},0)}function stripCopyFromName(name){return name.replace(REGEXP_DUPLICATED_NAME,"")}function generateNameForDuplicated(type,elements,nameToDuplicate){var index=getNameIndexForDuplicated(type,elements,nameToDuplicate);return index?stripCopyFromName(nameToDuplicate)+" "+COPY_SUFFIX+" "+(index+1):nameToDuplicate+" "+COPY_SUFFIX}function getNameIndex(name,namePrefix){var regexp=new RegExp(namePrefix+" (\\d+)( "+COPY_SUFFIX+"( \\d*))?"),result=regexp.exec(name);return _.isArray(result)&&!_.isNaN(parseInt(result[1]))?parseInt(result[1]):null}function generateName(type,elements,namePrefix){var elementsByType=getElementsByType(elements,type),index=_.reduce(elementsByType,function(index,element){var nextNameIndex=getNameIndex(element.name,namePrefix);return"number"==typeof nextNameIndex?Math.max(index,nextNameIndex+1):index},1);return namePrefix+" "+index}function getElementsWithoutCanvasReversed(serializedList){return _.filter(serializedList,function(element){return element.type!==ElementTypes.CANVAS}).reverse()}function GetNewElement(type,id,Page){if(type=LegacyMap.MapType(type),"function"!=typeof elementsDefinitions[type])throw Error("Element "+type+" not supported");return new elementsDefinitions[type](id,Page)}function CreateElement(type,props,Page){var id=ElementsHelper.GetUniqueId(type),element=GetNewElement(type,id,Page),elements=Page.getAllElements(),namePrefix=props[Properties.LABEL]||type;return element.initProperties(_.defaults(props,{name:generateName(type,elements,namePrefix)})),element}function CreateElementFromCollaboration(id,type,props,Page,componentInstance){var element=GetNewElement(type,id,Page);return componentInstance&&(element.componentInstance=componentInstance,componentInstance._elements[id]=element),element.initProperties(props),element}function CreateCanvas(containerEl,Page){var element=new elementsDefinitions.Canvas(ElementsHelper.CANVAS_ID,Page);return element.createCanvas(containerEl),element.initProperties({}),element}function CreateGroupedElements(serialized,x,y,Page){return _.map(serialized,function(elementSerialized){var elementProps=elementSerialized.props;return elementProps[Properties.X]=x+(elementProps[Properties.X]||0),elementProps[Properties.Y]=y+(elementProps[Properties.Y]||0),CreateElement(elementSerialized.type,elementProps,Page)})}function CreateComponentElements(serialized,component){serialized=LegacyMap.ParseElements(serialized);var elements=_.reduce(ElementsHelper.GetElementsWithoutCanvas(serialized),function(elements,elementSerialized,elementId){try{var element=GetNewElement(elementSerialized.type,elementId,component.Page);return element.componentInstance=component,component._elements[elementId]=element,elements.concat(element)}catch(e){return Logger.error(e),elements}},[]);return _.forEach(elements,function(element){try{element.initProperties(serialized[element.id].props)}catch(e){Logger.error(e)}}),_.map(serialized[ElementsHelper.CANVAS_ID].props.storedElements,function(elementId){return component._elements[elementId]})}function CreateComponentForNormalisation(Page){var element=GetNewElement(ElementTypes.COMPONENT,null,Page);return element.initProperties({}),element}function DuplicateElement(element,props){var id=ElementsHelper.GetUniqueId(element.type),duplicated=GetNewElement(element.type,id,element.Page);return duplicated.componentInstance=element.componentInstance,duplicated.initProperties(_.extend(element.serialize().props,props,{name:generateNameForDuplicated(duplicated.type,element.Page.getAllElements(),element.name)})),duplicated}function DuplicateElementsFromClipboard(clipboard,Page,preserveNames){var clipboardMap=ElementsHelper.ConvertListToMap(clipboard),oldNewIdsMap={},newOldIdsMap={},elements=_.map(getElementsWithoutCanvasReversed(clipboard),function(elementSerialized){var id=ElementsHelper.GetUniqueId(elementSerialized.type),element=GetNewElement(elementSerialized.type,id,Page);return oldNewIdsMap[elementSerialized.id]=id,newOldIdsMap[id]=elementSerialized.id,element}),elementsMap=ElementsHelper.ConvertListToMap(elements),allElements=_.union(Page.getAllElements(),elements);return _.forEach(elements,function(element){var serialized=clipboardMap[newOldIdsMap[element.id]];element.componentInstance=Page.ElementsManager.getEditingComponent(),element.initProperties(_.extend(translateIdsOnDuplicate(serialized,oldNewIdsMap).props,{name:preserveNames?serialized.props.name:generateNameForDuplicated(element.type,allElements,serialized.props.name)})),Page.ElementsManager.addElement(element)}),_.map(clipboardMap[ElementsHelper.CANVAS_ID].props.storedElements,function(id){return elementsMap[oldNewIdsMap[id]]})}function FromSerialized(serialized,componentInstanceId,Page){var element=GetNewElement(serialized.type,serialized.id,Page);return element.componentInstance=Page.ElementsManager.getElementById(componentInstanceId),element.initProperties(serialized.props),element}function FromRawImageBlobSrc(src,props,Page){return new Promise(function(resolve){ImageEditor.GetImageSize(src).then(function(size){resolve(CreateElement(ElementTypes.IMAGE,_.extend({x:0,y:0,width:size.width,height:size.height,src:src},props),Page))})})}function setPastedElementsCoordinates(elements,canvas,position,boundingBox,newPage){var viewPortCenterPoint,activeElement=canvas.Page.getSelectedElement(),pastedElementOffset={x:0,y:10},dx=0,dy=0;newPage&&activeElement.type===ElementTypes.CANVAS&&!position||(activeElement.type===ElementTypes.CANVAS||position?(viewPortCenterPoint=getViewPortCenterPoint(canvas),dx=(position?position.x:viewPortCenterPoint.x-boundingBox.width/2)-boundingBox.left,dy=(position?position.y:viewPortCenterPoint.y-boundingBox.height/2)-boundingBox.top):position||(dx=activeElement.x+pastedElementOffset.x-boundingBox.left,dy=activeElement.y+activeElement.height+pastedElementOffset.y-boundingBox.top),_.each(elements,function(element){element._updateProperty(Properties.X,dx+element.x,!0),element._updateProperty(Properties.Y,dy+element.y,!0)}))}function getViewPortCenterPoint(canvas){var viewPortCenterPoint={},workbenchCoordinates=canvas.view.workbenchDomElement.getBoundingClientRect(),domElementCoordinates=canvas.view.domElement.getBoundingClientRect();return viewPortCenterPoint.x=workbenchCoordinates.width/2+workbenchCoordinates.left-domElementCoordinates.left,viewPortCenterPoint.y=workbenchCoordinates.height/2+workbenchCoordinates.top-domElementCoordinates.top,viewPortCenterPoint}var COPY_SUFFIX="copy",REGEXP_DUPLICATED_NAME=new RegExp("( "+COPY_SUFFIX+"( \\d+)?)$"),ElementsFactory={GetNewElement:GetNewElement,CreateElement:CreateElement,CreateElementFromCollaboration:CreateElementFromCollaboration,CreateCanvas:CreateCanvas,CreateGroupedElements:CreateGroupedElements,CreateComponentElements:CreateComponentElements,CreateComponentForNormalisation:CreateComponentForNormalisation,DuplicateElement:DuplicateElement,DuplicateElementsFromClipboard:DuplicateElementsFromClipboard,FromSerialized:FromSerialized,FromRawImageBlobSrc:FromRawImageBlobSrc,setPastedElementsCoordinates:setPastedElementsCoordinates,getViewPortCenterPoint:getViewPortCenterPoint};return ElementsFactory}()},{"./LegacyMap.js":22,"./elements/AndroidGear.js":25,"./elements/AndroidIcon.js":26,"./elements/Arrow.js":27,"./elements/Banner.js":28,"./elements/Box.js":29,"./elements/Button.js":30,"./elements/Canvas.js":31,"./elements/Checkbox.js":32,"./elements/Circle.js":33,"./elements/Clipart.js":34,"./elements/Component.js":35,"./elements/CostcoIcon.js":36,"./elements/Dialog.js":37,"./elements/FontAwesome.js":38,"./elements/GeoSvg.js":40,"./elements/GlassCanvas.js":41,"./elements/Group.js":42,"./elements/GroupingInstance.js":43,"./elements/HorizontalScrollbar.js":44,"./elements/Hotspot.js":45,"./elements/Image.js":46,"./elements/Input2.js":47,"./elements/InputWithLabel.js":48,"./elements/Label.js":49,"./elements/Line.js":50,"./elements/Link.js":51,"./elements/LinkList.js":52,"./elements/MaterialIcon.js":53,"./elements/Menu.js":54,"./elements/MobileSymbol.js":55,"./elements/Multistate.js":56,"./elements/Navigation.js":57,"./elements/Password.js":58,"./elements/PixleIcon.js":59,"./elements/Radio.js":60,"./elements/RetinaIcon.js":61,"./elements/Scrollbar.js":62,"./elements/Selectlist.js":63,"./elements/SvgIconLegacy.js":65,"./elements/SvgSymbol.js":66,"./elements/Tab.js":67,"./elements/Table.js":68,"./elements/Tag.js":69,"./elements/TextElement.js":70,"./elements/Textarea.js":71,"./elements/Tooltip.js":72,"./elements/UXPinIconSet.js":73,"./elements/UniSvg.js":74,"./elements/Video.js":75,"./elements/VirtualGroup.js":76,"./elements/helpers/ElementsHelper.js":97,"./elements/helpers/ImageEditor.js":98,"./elements/iOS7.js":108,"./elements/iOS8.js":109,"./elements/ui/ImageCrop.js":122,"./enums/ElementTypes.js":184,"./enums/Properties.js":195,"./utils/Logger":218,lodash:19}],21:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ArrangeHelper=_dereq_("./elements/helpers/ArrangeHelper.js"),Batch=_dereq_("./history/Batch.js"),DuplicateHelper=_dereq_("./elements/helpers/DuplicateHelper.js"),ElementTypes=_dereq_("./enums/ElementTypes.js"),ElementsFactory=_dereq_("./ElementsFactory.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),EventEmitter=_dereq_("event-emitter"),Events=_dereq_("./enums/Events.js"),Group=_dereq_("./elements/Group"),HistoryManager=_dereq_("./history/HistoryManager.js"),ImageEditor=_dereq_("./elements/helpers/ImageEditor.js"),Logger=_dereq_("./utils/Logger.js"),Parse=_dereq_("./utils/Parse.js"),Properties=_dereq_("./enums/Properties.js"),RemoveHelper=_dereq_("./elements/helpers/RemoveHelper.js"),SelectionHelper=_dereq_("./elements/helpers/SelectionHelper.js"),Tree=_dereq_("./utils/Tree.js");module.exports=function(){function getSerializedElements(elementsMap){return _.mapValues(elementsMap,serializeElement)}function getElementsWithComponentCanvas(serialized,component){return serialized[ElementsHelper.CANVAS_ID]||(serialized[ElementsHelper.CANVAS_ID]=ElementsHelper.GetSerializedCanvas(component.children)),serialized}function updateComponentInstances(elements,componentId,componentInstanceIdToSkip){_.forEach(elements,function(element){!element.isComponent()||element.idComponent!==componentId||componentInstanceIdToSkip&&componentInstanceIdToSkip===element.id||(element.shouldUpdateElements=!0)})}function normalizeChanges(changes,oldComponent,newComponent){function hasPositionChange(element){return element&&_.size(_.pick(element.props,POSITION_PROPERTIES))}function isPosition(property){return POSITION_PROPERTIES.indexOf(property)>-1}var positionChanges,POSITION_PROPERTIES=[Properties.X,Properties.Y,Properties.CLIP];return _.forEach(changes,function(elementChanges,elementId){_.forEach(elementChanges.props,function(propertyValue,propertyName){elementChanges.props[propertyName]=newComponent[elementId].props[propertyName]})}),positionChanges=_.reduce(_.cloneDeep(newComponent),function(positionChanges,element,elementId){return element.props=_.pick(element.props,function(value,property){return isPosition(property)&&oldComponent[elementId]&&!_.isEqual(value,oldComponent[elementId].props[property])&&!hasPositionChange(changes[elementId])}),_.isEmpty(element.props)||(positionChanges[elementId]=element),positionChanges},{}),_.extend(changes,positionChanges),_.isEqual(oldComponent[ElementsHelper.CANVAS_ID],newComponent[ElementsHelper.CANVAS_ID])||(changes[ElementsHelper.CANVAS_ID]=_.cloneDeep(newComponent[ElementsHelper.CANVAS_ID])),!_.isEmpty(positionChanges)}function serializeElement(element){return element.serialize()}function isLegacyFormat(serialized){return!(serialized[ElementsHelper.CANVAS_ID]&&serialized[ElementsHelper.CANVAS_ID].v)}function hasComponent(elements,componentId){return _.some(elements,function(element){return element.idComponent===componentId})}function applyPositionDeltaToProperties(properties,delta){return delta&&delta.x&&delta.y&&(properties.x+=delta.x,properties.y+=delta.y),properties}function setGhostSize(element,size,scale){element.style.width=size.width+"px",element.style.height=size.height+"px",element.style.transform="scale("+scale+", "+scale+")"}function ElementsManager(Page){this.Page=Page,this.batch=null,this.elements={},this.components={},this.componentElementsMap={},this.componentsAvailableIds=[],this.editingComponent=null,this.emitter=new EventEmitter}return ElementsManager.prototype.setComponentsAvailableIds=function(componentsIds){this.componentsAvailableIds=componentsIds},ElementsManager.prototype.inBatch=function(calls){"function"==typeof calls&&(this.startBatch(),calls.apply(),this.endBatch())},ElementsManager.prototype.startBatch=function(updateOnBatchEnd,addToHistory){"undefined"==typeof addToHistory&&(addToHistory=!0),this.batch=new Batch(this.Page,updateOnBatchEnd,addToHistory)},ElementsManager.prototype.endBatch=function(){var changes,componentId,oldComponent,newComponent,isComponentWithOneElementAndOnCanvas,batch=this.batch,updateComponentInstance=!1;return!!batch&&(this.batch.end(),this.batch=null,void(batch.hasChanges()&&(changes=batch.getChanges(),componentId=batch.getComponentId(),componentId&&(oldComponent=_.cloneDeep(this.getComponentById(componentId)),this.updateComponent(componentId,this.editingComponent.id),newComponent=this.getComponentById(componentId),isComponentWithOneElementAndOnCanvas=2===Object.keys(newComponent).length&&this.getElementById(batch.getComponentInstanceId()),updateComponentInstance=isComponentWithOneElementAndOnCanvas||normalizeChanges(changes.changed_elements,oldComponent,newComponent)),batch.addToHistory&&HistoryManager.Add(batch),_.isEmpty(changes.deleted_elements)||(changes.components_used=this.getComponentsUsed()),this.emitter.emit(Events.ELEMENTS_CHANGE,changes,componentId||this.Page.pageId),updateComponentInstance&&this._updateComponentPosition(batch))))},ElementsManager.prototype.createElement=function(type,props){var element=ElementsFactory.CreateElement(type,props,this.Page);return this.addElement(element),element},ElementsManager.prototype.createElementFromCollaboration=function(id,type,props){var element=ElementsFactory.CreateElementFromCollaboration(id,type,props,this.Page);return this.elements[element.id]=element,element.isComponent()&&this.getComponentDefinition(element.idComponent,element.id),element},ElementsManager.prototype.createElementComponentFromCollaboration=function(id,data,componentInstance){var element=ElementsFactory.CreateElementFromCollaboration(id,data.type,data.props,this.Page,componentInstance);
return this.componentElementsMap[id]=componentInstance.idComponent,element.isComponent()&&this.getComponentDefinition(element.idComponent,element.id),element},ElementsManager.prototype.createCanvas=function(containerEl){var element=ElementsFactory.CreateCanvas(containerEl,this.Page);return this.addElement(element),element},ElementsManager.prototype.createMultistate=function(elements,stateName,props){var element=ElementsFactory.CreateElement(ElementTypes.MULTISTATE,props||{},this.Page);element.componentInstance=this.editingComponent,element[Properties.STATES]=[element.createInitialState(elements)];var states=_.clone(element[Properties.STATES]);return states.push(element.createNewState(stateName)),element[Properties.STATES]=states,this.addElement(element),element},ElementsManager.prototype.createComponentElements=function(component,componentId){var serialized=this.getComponentById(componentId);return ElementsFactory.CreateComponentElements(serialized,component)},ElementsManager.prototype.createGroupedElements=function(serialized,x,y){var elements=ElementsFactory.CreateGroupedElements(serialized,x,y,this.Page);return _.forEach(elements,function(element){this.addElement(element)}.bind(this)),elements},ElementsManager.prototype.duplicateElement=function(element,props){var duplicated=ElementsFactory.DuplicateElement(element,props);return this.addElement(duplicated),duplicated},ElementsManager.prototype.duplicateElementsFromClipboard=function(clipboard,preserveNames){return ElementsFactory.DuplicateElementsFromClipboard(ElementsHelper.GetSortedPageElements(clipboard),this.Page,preserveNames)},ElementsManager.prototype.createUploadingImages=function(files,x,y){var DELTA_POSITION=15,elements=[];return x=x||0,y=y||0,_.forEach(files,function(file,index){var element=this.createElement(ElementTypes.IMAGE,{x:x+index*DELTA_POSITION,y:y+index*DELTA_POSITION,width:file.width,height:file.height,src:file.finalUrl});elements.push(element)}.bind(this)),elements},ElementsManager.prototype.addElement=function(element,componentInstanceId){var component;this.editingComponent&&(componentInstanceId=this.editingComponent.id),componentInstanceId?(component=this.getElementById(componentInstanceId),this.componentElementsMap[element.id]=component.idComponent,component._elements[element.id]=element,element.componentInstance=component):this.elements[element.id]=element,element.isComponent()&&(this.getComponentDefinition(element.idComponent,element.id),HistoryManager.AddToComponentsMap(element.idComponent,element.id)),this.batch&&this.batch.addElement(element.id,componentInstanceId,element.serialize())},ElementsManager.prototype.addElementSerialized=function(serialized,componentInstanceId){var element=ElementsFactory.FromSerialized(serialized,componentInstanceId,this.Page);return this.addElement(element),element},ElementsManager.prototype.loadPageElements=function(serialized,position){for(var element,sorted=ElementsHelper.GetSortedPageElements(serialized),i=sorted.length;i-- >0;)if(sorted[i].type!==ElementTypes.CANVAS)try{element=ElementsFactory.GetNewElement(sorted[i].type,sorted[i].id,this.Page),element.initProperties(applyPositionDeltaToProperties(sorted[i].props,position)),this.addElement(element)}catch(e){Logger.error(e)}},ElementsManager.prototype.cantRemoveElement=function(element){if(this.Page.collaboration.isElementEditing(element.id))return!0;var isElementEditingInGroup=element.isGroup()&&_.some(Tree.GetAllDescendants(element),function(element){return this.Page.collaboration.isElementEditing(element.id)}.bind(this));return isElementEditingInGroup||element.isComponent()&&_.some(element._elements,function(element){return this.cantRemoveElement(element)}.bind(this))},ElementsManager.prototype.removeElementById=function(elementId){var element=this.getElementById(elementId);return!!element&&this.removeElement(element)},ElementsManager.prototype.removeElement=function(element,componentInstanceId){var component,selectedElementIndex=this.Page.canvas.selectedElements.indexOf(element);return componentInstanceId=this.getComponentInstanceIdByElementId(element.id)||componentInstanceId,selectedElementIndex!==-1&&this.Page.canvas.deselect(),componentInstanceId?(component=this.getElementById(componentInstanceId),delete this.componentElementsMap[element.id],delete component._elements[element.id]):delete this.elements[element.id],element.isComponent()&&this._updateComponentElementsMap(element.idComponent),this.onRemoveElement(element,componentInstanceId),this.batch&&this.batch.removeElement(element.id,componentInstanceId,element.serialize()),!0},ElementsManager.prototype.onRemoveElement=function(element,componentInstanceId){var elements=_.extend({},this.getElements(componentInstanceId),componentInstanceId?{}:{canvas:this.Page.canvas});RemoveHelper.updateActions(element,elements),element.deleteLinkedElements()},ElementsManager.prototype.clear=function(){this.elements=_.pick(this.elements,ElementsHelper.CANVAS_ID),this.components={},this.componentElementsMap={}},ElementsManager.prototype.destroy=function(){this.elements=null,this.components=null,this.componentElementsMap=null},ElementsManager.prototype.getElementById=function(id,componentInstanceId){return componentInstanceId?this.elements[componentInstanceId]._elements[id]:this.elements[id]},ElementsManager.prototype.save=function(element){this.batch&&this.batch.addSaveOperation(element)},ElementsManager.prototype.update=function(element,property,value,addToHistory){var prevSerialized,componentInstanceId;!this.batch||this.batch.updateOnBatchEnd&&!this.batch.canUpdate(element.id,property)?addToHistory&&(element[property]=value):(this.batch.updateOnBatchEnd&&this.batch.setUpdated(element.id,property),prevSerialized=element.serialize(),addToHistory&&(componentInstanceId=this.getComponentInstanceIdByElementId(element.id),element[property]=value,this.batch.changeProperty(element.id,componentInstanceId,element.serialize(),prevSerialized,property)))},ElementsManager.prototype.createComponent=function(name,elements){return new Promise(function(resolve,reject){var normalized=this._normalizeComponentContent(this.getElementsSerializedWithCanvas(elements));this.Page.emit(Events.COMPONENT_CREATED,{content:normalized,onComplete:function(componentId){var componentsElements={};componentId=componentId.toString(),componentsElements[componentId]=normalized,this.addComponent(componentId,componentsElements),resolve(componentId)}.bind(this),onError:function(){reject()}})}.bind(this))},ElementsManager.prototype.createComponentFromCollaboration=function(componentId,elements){var componentsElements={};componentId=componentId.toString(),componentsElements[componentId]=elements,this.addComponent(componentId,componentsElements)},ElementsManager.prototype.editComponent=function(component){this.editingComponent=component},ElementsManager.prototype.getEditingComponent=function(){return this.editingComponent},ElementsManager.prototype.updateComponent=function(componentId,componentInstanceId){var componentInstance=this.getElementById(componentInstanceId),serialized=getSerializedElements(componentInstance._elements),normalized=this._normalizeComponentContent(getElementsWithComponentCanvas(serialized,componentInstance));this.components[componentId]=normalized,updateComponentInstances(this.elements,componentId,componentInstanceId)},ElementsManager.prototype.finishEditingComponent=function(){var componentId=this.editingComponent.idComponent,serialized=getSerializedElements(this.editingComponent._elements),normalized=this._normalizeComponentContent(getElementsWithComponentCanvas(serialized,this.editingComponent));this.editingComponent=null,this.components[componentId]=normalized,updateComponentInstances(this.elements,componentId)},ElementsManager.prototype.addComponent=function(componentId,elements){this.componentsAvailableIds.push(componentId),this.addComponentsElements(elements)},ElementsManager.prototype.addComponentsElements=function(value){var components=_.mapValues(value,function(serialized){return _.isEmpty(serialized)?{}:isLegacyFormat(serialized)?this._normalizeComponentContent(serialized):serialized}.bind(this)),componentElementsMap=_.reduce(components,function(elementsMap,component,id){return _.extend(elementsMap,_.mapValues(ElementsHelper.GetElementsWithoutCanvas(component),function(){return id}))},{});this.components=_.extend(this.components,components),this.componentElementsMap=_.extend(this.componentElementsMap,componentElementsMap)},ElementsManager.prototype.removeComponent=function(componentId){var componentInstances=this.getElementsByComponentId(componentId);SelectionHelper.DeleteElements(componentInstances),this.componentsAvailableIds.splice(this.componentsAvailableIds.indexOf(componentId),1),this._updateComponentElementsMap(componentId),HistoryManager.ValidateAndStore(this.Page)},ElementsManager.prototype.getComponentById=function(id){return this.components[id]},ElementsManager.prototype.getComponentIdByElementId=function(elementId){return this.componentElementsMap[elementId]},ElementsManager.prototype.getComponentInstanceIdByElementId=function(elementId){return this.editingComponent&&this.editingComponent.idComponent===this.getComponentIdByElementId(elementId)?this.editingComponent.id:""},ElementsManager.prototype.getElementsByComponentId=function(componentId){return componentId=parseInt(componentId),_.reduce(this.elements,function(elements,element){return element.isComponent()&&parseInt(element.idComponent)===componentId&&elements.push(element),elements}.bind(this),[])},ElementsManager.prototype.getComponentsUsed=function(){return _.reduce(this.getElements(),function(usedComponents,element){return element.isComponent()&&(usedComponents[element.idComponent]=!0),usedComponents},{})},ElementsManager.prototype.getElements=function(componentInstanceId){return componentInstanceId?this.elements[componentInstanceId]._elements:this.elements},ElementsManager.prototype.getElementsSerializedWithCanvas=function(elements){var allElements=_.reduce(elements,function(allElements,element){return allElements.push(element),allElements.concat(Tree.GetAllDescendants(element))},[]),elementsSerialized=_.mapValues(Parse.getElementsMap(allElements),serializeElement);return ArrangeHelper.ZSortSelectedElements(elements),elementsSerialized[ElementsHelper.CANVAS_ID]=ElementsHelper.GetSerializedCanvas(elements),elementsSerialized},ElementsManager.prototype.translateIds=function(map){var elements=this.editingComponent?this.editingComponent._elements:this.elements;_.forEach(elements,function(element){var serialized=element.serialize();_.forEach(_.keys(serialized.props),function(property){"function"==typeof DuplicateHelper[property]&&(DuplicateHelper[property](serialized.props,map),element._updateProperty(property,serialized.props[property],!0))})})},ElementsManager.prototype.getComponentDefinition=function(componentId,elementId,componentInstanceId){this.getComponentById(componentId)||(HistoryManager.Lock(!0),this.Page.emit(Events.COMPONENT_ADDED,componentId,function(componentId){var element=this.getElementById(elementId,componentInstanceId);element.idComponent=componentId,HistoryManager.Lock(!1)}.bind(this),function(){HistoryManager.Lock(!1)}))},ElementsManager.prototype.addListener=function(event,callback){this.emitter.on(event,callback)},ElementsManager.prototype.renderGhostElement=function(type,properties){var element=this._getGhostElementInstance(type,_.omit(properties,Properties.SRC)),bb=element.getBoundingBox(),scale=this.Page.canvas.scale;return setGhostSize(element.view.domElement,bb,scale),element.view.domElement.classList.add("temporary-element"),type===ElementTypes.IMAGE&&(element.view.domElement.classList.add("ghost-element","ghost-image"),element.view.domElement.style.opacity=.5,ImageEditor.PreloadImage(properties.src).then(function(){element.view.domElement.src=properties.src})),element.view.domElement},ElementsManager.prototype.renderMultiElementGhost=function(serialized){var elements=_.reduce(serialized,function(elements,serializedElement){var element;return serializedElement.props.storedElements||serializedElement.props.states||(element=this._getGhostElementInstance(serializedElement.type,serializedElement.props),elements.push(element)),elements}.bind(this),[]),domElement=document.createElement("div"),scale=this.Page.canvas.scale,bb=_.reduce(_.rest(elements),function(mergedBB,element){return mergedBB.add(element.getBoundingBox())},_.first(elements).getBoundingBox());return setGhostSize(domElement,bb,scale),domElement.classList.add("ng-element","ghost-element","temporary-element"),domElement},ElementsManager.prototype.setPastedElementsCoordinates=function(elements,canvas,position,boundingBox,newPage){return ElementsFactory.setPastedElementsCoordinates(elements,canvas,position,boundingBox,newPage)},ElementsManager.prototype._getGhostElementInstance=function(type,properties){var element=ElementsFactory.GetNewElement(type,ElementsHelper.GetUniqueId(type),this.Page);return element.initProperties(properties),element.update(),element},ElementsManager.prototype._normalizeComponentContent=function(serialized){var component=ElementsFactory.CreateComponentForNormalisation(this.Page);return component.addChildren(ElementsFactory.CreateComponentElements(serialized,component)),component._updateBoundingBox(),component.x=0,component.y=0,getElementsWithComponentCanvas(getSerializedElements(component._elements),component)},ElementsManager.prototype._updateComponentElementsMap=function(deletedComponentId){hasComponent(this.elements,deletedComponentId)||(delete this.components[deletedComponentId],this.componentElementsMap=_.omit(this.componentElementsMap,function(id){return id===deletedComponentId}))},ElementsManager.prototype._updateComponentPosition=function(batch){var serialized,componentInstanceId=batch.getComponentInstanceId(),componentInstance=this.getElementById(componentInstanceId),prevSerialized=batch.getSerializedComponent(componentInstanceId);componentInstance.update(),serialized=componentInstance.serialize(),this.startBatch(!1,!1),this.batch.addSaveOperation(componentInstance,prevSerialized),this.batch.changeProperty(componentInstanceId,"",serialized,prevSerialized,Properties.X),this.batch.changeProperty(componentInstanceId,"",serialized,prevSerialized,Properties.Y),this.endBatch()},ElementsManager.prototype.tintElementsExcept=function(elements,elementSkipped,value){_.forEach(elements,function(element){element instanceof Group&&(!element.isComponent()||element===elementSkipped)||element.view.setOpacity(value?.1:element.opacity/100)})},ElementsManager}()},{"./ElementsFactory.js":20,"./elements/Group":42,"./elements/helpers/ArrangeHelper.js":92,"./elements/helpers/DuplicateHelper.js":96,"./elements/helpers/ElementsHelper.js":97,"./elements/helpers/ImageEditor.js":98,"./elements/helpers/RemoveHelper.js":101,"./elements/helpers/SelectionHelper.js":102,"./enums/ElementTypes.js":184,"./enums/Events.js":185,"./enums/Properties.js":195,"./history/Batch.js":200,"./history/HistoryManager.js":202,"./utils/Logger.js":218,"./utils/Parse.js":220,"./utils/Tree.js":223,"event-emitter":3,lodash:19}],22:[function(_dereq_,module,exports){"use strict";var ElementTypes=_dereq_("./enums/ElementTypes.js"),Properties=_dereq_("./enums/Properties.js"),Calc=_dereq_("./utils/Calc.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),Point=_dereq_("./primitives/Point.js"),_=_dereq_("lodash");module.exports=function(){function getAngle(props){return parseInt(props.rotation)?parseInt(props.rotation):-props.angle}function isSvg(type){return[ElementTypes.ANDROID_ICON,ElementTypes.FONT_AWESOME,ElementTypes.GEO_SVG,ElementTypes.COSTCO_ICON,ElementTypes.PIXLE_ICON,ElementTypes.MATERIAL_ICON,ElementTypes.RETINA_ICON,ElementTypes.SVG_SYMBOL,ElementTypes.UNI_SVG,ElementTypes.UXPIN_ICON_SET].indexOf(MapType(type))>-1}function getRotatedPoint(props){var angle=getAngle(props),point=new Point(props.left,props.top);return point.rotate(new Point(props.left+props.width/2,props.top+props.height/2),angle),point}function toCamelCase(str){return str.replace(/[-|_]([a-z])/g,function(match,p1){return p1.toUpperCase()})}function hasZIndex(element){return"undefined"!=typeof element.props.zIndex||"undefined"!=typeof element.props["z-index"]}function sortElementIds(serialized,elementIds){return serialized&&_.every(_.pick(serialized,elementIds),hasZIndex)?_.sortBy(elementIds,function(elementId){return parseInt(serialized[elementId].props.zIndex||serialized[elementId].props["z-index"])}):elementIds}function getRootElementIds(serialized){var childrenMap=getChildrenMap(serialized);return sortElementIds(serialized,_.reduce(serialized,function(elements,elementSerialized,elementId){return childrenMap[elementId]||elements.push(elementId),elements},[]))}function getSerializedCanvas(serialized){return{type:ElementTypes.CANVAS,props:{storedElements:getRootElementIds(serialized)}}}function getChildrenMap(serialized){return _.reduce(serialized,function(childrenMap,elementSerialized,elementId){return elementSerialized.type===ElementTypes.GROUP?_.forEach(elementSerialized.props.storedElements,function(childId){childrenMap[childId]=elementId}):elementSerialized.type===ElementTypes.MULTISTATE&&_.forEach(elementSerialized.props.states,function(state){_.forEach(state.elements,function(childId){childrenMap[childId]=elementId})}),childrenMap},{})}function getLegacyElements(serialized){return _.omit(serialized,function(elementSerialized){return!!elementSerialized.v})}function isLegacyProperty(property){return LEGACY_PROPERTIES.hasOwnProperty(property)}function mapProperty(property,value,elementType,elementProps,serialized){var mapped={};return isLegacyProperty(property)?"function"==typeof LEGACY_PROPERTIES[property]?mapped=LEGACY_PROPERTIES[property].call(null,value,elementType,elementProps,serialized):mapped[LEGACY_PROPERTIES[property]]=value:mapped[property]=value,mapped}function mapStyles(properties,elementType){var textLines,fragment=document.createDocumentFragment();if("undefined"==typeof properties[Properties.INPUT_VALUE])return properties;var addNodeOnTop=function(nodeName){var i,node=document.createElement(nodeName),childNodes=[];for(i=fragment.childNodes.length;--i>=0;)childNodes.push(fragment.childNodes[i]),fragment.removeChild(fragment.childNodes[i]);for(i=childNodes.length;--i>=0;)node.appendChild(childNodes[i]);return fragment.appendChild(node),node};textLines=(properties[Properties.INPUT_VALUE]||"").replace("\n","\n<br>\n").split("\n"),_.forEach(textLines,function(nodeContent){var node;node="<br>"===nodeContent?document.createElement("br"):document.createTextNode(nodeContent),fragment.appendChild(node)}),properties[Properties.COLOR]&&(addNodeOnTop("span").style[Properties.COLOR]=properties[Properties.COLOR]),properties[Properties.FONT_WEIGHT]&&"normal"!==properties[Properties.FONT_WEIGHT]&&(addNodeOnTop("span").style[Properties.FONT_WEIGHT]=properties[Properties.FONT_WEIGHT]),properties[Properties.FONT_STYLE]&&"normal"!==properties[Properties.FONT_STYLE]&&(addNodeOnTop("span").style[Properties.FONT_STYLE]=properties[Properties.FONT_STYLE]),properties[Properties.TEXT_DECORATION]&&"none"!==properties[Properties.TEXT_DECORATION]&&(addNodeOnTop("span").style[Properties.TEXT_DECORATION]=properties[Properties.TEXT_DECORATION]),properties[Properties.FONT_FAMILY]&&(addNodeOnTop("span").className="wysiwyg-font-type-"+properties[Properties.FONT_FAMILY].replace(/[^\w]/g,"")),properties[Properties.FONT_SIZE]&&elementType!==ElementTypes.TEXT&&(addNodeOnTop("span").style[Properties.FONT_SIZE]=properties[Properties.FONT_SIZE]),addNodeOnTop("span").style[Properties.VERTICAL_ALIGN]="top";var mainNode=addNodeOnTop("p");return properties[Properties.TEXT_ALIGN]&&(mainNode.style[Properties.TEXT_ALIGN]=properties[Properties.TEXT_ALIGN]),properties[Properties.FONT_SIZE]&&elementType===ElementTypes.TEXT&&(mainNode.style[Properties.FONT_SIZE]=properties[Properties.FONT_SIZE]),properties[Properties.LINE_HEIGHT]&&(mainNode.style[Properties.LINE_HEIGHT]=properties[Properties.LINE_HEIGHT]),properties[Properties.INPUT_VALUE]=fragment.firstChild.outerHTML.replace("&amp;","&"),properties}function ParseElementProps(elementProps,elementType,serialized){var data=_.reduce(elementProps,function(data,value,key){return isLegacyProperty(key)?_.extend(data,mapProperty(key,value,elementType,elementProps,serialized)):data[toCamelCase(key)]=value,data},{});return LEGACY_TEXT_EDITABLE.indexOf(elementType)>-1&&(data=mapStyles(data,elementType)),data}function ParseElements(serialized){return _.forEach(getLegacyElements(ElementsHelper.GetElementsWithoutCanvas(serialized)),function(elementSerialized){elementSerialized.props=ParseElementProps(elementSerialized.props,elementSerialized.type,serialized)}),serialized[ElementsHelper.CANVAS_ID]||(serialized[ElementsHelper.CANVAS_ID]=getSerializedCanvas(serialized)),serialized}function MapType(type){return LEGACY_TYPES[type]&&(type=LEGACY_TYPES[type]),type}function IsLegacy(serialized){return _.some(serialized,function(element){return!element.v})}var LEGACY_INPUT_TYPES=[ElementTypes.INPUT2,ElementTypes.INPUT_WITH_LABEL],LEGACY_TEXT_EDITABLE=[ElementTypes.BOX,ElementTypes.CHECKBOX,ElementTypes.CIRCLE,ElementTypes.LABEL,ElementTypes.LINK,ElementTypes.RADIO,ElementTypes.TEXT,ElementTypes.TOOLTIP],LEGACY_BOXABLE=[ElementTypes.BOX,ElementTypes.BUTTON,ElementTypes.TEXTAREA,ElementTypes.GLASS_CANVAS],LEGACY_TYPES={SocialButtons:ElementTypes.GROUPING_INSTANCE,UIKit:ElementTypes.GROUPING_INSTANCE,Bootstrap:ElementTypes.GROUPING_INSTANCE,Foundation:ElementTypes.GROUPING_INSTANCE,Newui:ElementTypes.GROUPING_INSTANCE,Flatui:ElementTypes.GROUPING_INSTANCE,Semanticui:ElementTypes.GROUPING_INSTANCE,GlassPattern:ElementTypes.GROUPING_INSTANCE,GeoSVG:ElementTypes.GEO_SVG,UniSVG:ElementTypes.UNI_SVG,PixleGesty:ElementTypes.UNI_SVG,LineHorizontal:ElementTypes.LINE,LineVertical:ElementTypes.LINE,StickyNote:ElementTypes.BOX,Tab:ElementTypes.TAB,Text:ElementTypes.TEXT_ELEMENT,Text2:ElementTypes.TEXT_ELEMENT,Input:ElementTypes.INPUT2,SvgIcon:ElementTypes.SVG_ICON_LEGACY},LEGACY_PROPERTIES={caption:Properties.INPUT_VALUE,"textarea-value":Properties.INPUT_VALUE,"list-font-size":Properties.FONT_SIZE,"list-font-weight":Properties.FONT_WEIGHT,"list-font-style":Properties.FONT_STYLE,"list-font-family":Properties.FONT_FAMILY,"list-text-decoration":Properties.TEXT_DECORATION,"list-text-align":Properties.TEXT_ALIGN,"list-color":Properties.COLOR,"note-color":Properties.BACKGROUND_COLOR,"header-text":Properties.HEADER_TEXT,"header-color":Properties.HEADER_COLOR,"header-font-weight":Properties.HEADER_FONT_WEIGHT,"header-font-style":Properties.HEADER_FONT_STYLE,"header-font-size":Properties.HEADER_FONT_SIZE,"header-font-family":Properties.HEADER_FONT_FAMILY,"header-text-decoration":Properties.HEADER_TEXT_DECORATION,"header-text-align":Properties.HEADER_TEXT_ALIGN,"header-display":function(value,elementType){elementType===ElementTypes.LINK_LIST&&("block"===value?value=1:"none"===value&&(value=0));var returnable={};return returnable[Properties.HEADER_DISPLAY]=value,returnable},left:function(x,elementType,elementProps){return getAngle(elementProps)&&(x=getRotatedPoint(elementProps).x),{x:x}},top:function(y,elementType,elementProps){var delta,LINE_HEIGHT=18;return isSvg(elementType)&&(delta=Math.ceil(LINE_HEIGHT/2)-elementProps.height+3,delta>0&&(y+=delta*Math.cos(Calc.DegToRad(elementProps.angle)),elementProps.top=y)),getAngle(elementProps)&&(y=getRotatedPoint(elementProps).y),{y:y}},angle:function(angle,elementType,elementProps){return{angle:getAngle(elementProps)}},rotation:function(rotation,elementType,elementProps){return{angle:getAngle(elementProps)}},id_component:function(idComponent){return{idComponent:idComponent.toString()}},states:function(states,elementType,elementProps,serialized){return{states:_.map(states,function(state){return state.elements=sortElementIds(serialized,_.map(state.elements,function(element){return element.toString()})),state})}},type:function(type,elementType){return elementType===ElementTypes.TAB?{tabType:type}:_.contains(LEGACY_INPUT_TYPES,elementType)?{inputType:type}:elementType===ElementTypes.LINE?{lineType:type}:elementType===ElementTypes.NAVIGATION?{orientation:type}:{type:type}},"border-width":function(value,elementType){return _.contains([ElementTypes.INPUT,ElementTypes.TABLE],elementType)||_.contains(LEGACY_BOXABLE,elementType)?{borderTopWidth:value,borderRightWidth:value,borderBottomWidth:value,borderLeftWidth:value}:{borderWidth:value}},"border-radius":function(value,elementType){return _.contains(LEGACY_INPUT_TYPES,elementType)||_.contains(LEGACY_BOXABLE,elementType)?{borderTopLeftRadius:value,borderTopRightRadius:value,borderBottomRightRadius:value,borderBottomLeftRadius:value}:{borderRadius:value}},"border-bottom":function(value,elementType){return elementType===ElementTypes.LINE_HORIZONTAL?{stroke:value,lineOrientation:"horizontal"}:{borderBottom:value}},"border-right":function(value,elementType){return elementType===ElementTypes.LINE_VERTICAL?{stroke:value,lineOrientation:"vertical"}:{borderRight:value}},stored_elements:function(storedElements,elementType,elementProps,serialized){return elementType===ElementTypes.COMPONENT?{}:{storedElements:sortElementIds(serialized,_.unique(_.map(storedElements,function(element){return element.toString()})))}},"input-value":function(value,elementType){if(elementType===ElementTypes.TAG){var content=value.split("\n"),title=content.shift(),text=content.join("\n");return{title:title,text:text}}return elementType===ElementTypes.PASSWORD?{inputValue:value,inputType:"password"}:elementType===ElementTypes.STICKY_NOTE?{caption:value}:{inputValue:value}},color:function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{color:value}},"font-size":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{fontSize:value}},"font-style":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{fontStyle:value}},"font-weight":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{fontWeight:value}},"line-height":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{lineHeight:value}},"text-align":function(value,elementType){return elementType===ElementTypes.TEXT_ELEMENT?{}:{textAlign:value}},value:function(value,elementType){return ElementTypes.INPUT2===elementType?{inputValue:value}:{value:value}},"label-text":function(value,elementType){return elementType===ElementTypes.INPUT_WITH_LABEL?{labelText:value}:{inputValue:value}},"table-value":function(value){var rows=_.map(value.split("\n"),function(row){return row.split(";")});return{tableValue:rows}},cells_styles:function(value,elementType){return{cellsStyles:_.mapValues(value,function(styles){return ParseElementProps(styles,elementType)})}},init_elements:function(value){return{initElements:JSON.stringify(ParseElements(JSON.parse(value)))}},"inactive-background-color":function(value,elementType){return elementType===ElementTypes.NAVIGATION?{backgroundColor:value}:{inactiveBackgroundColor:value}},original_width:function(value){return{originalWidth:parseInt(value)}},width:function(value){return{width:parseInt(value)}},original_height:function(value){return{originalHeight:parseInt(value)}},height:function(value){return{height:parseInt(value)}},data:function(value,elementType){return elementType===ElementTypes.SVG_ICON_LEGACY?{data:"https://app.uxpin.com"+value}:{data:value}},is_clip:function(value,elementType,elementProps){return value?{isClip:value,clip:{x:elementProps.left,y:elementProps.top,width:elementProps.width,height:elementProps.height,angle:0}}:{isClip:value}},zebra:function(value,elementType,elementProps){return{zebra:elementProps.oddBackgroundColor?value:0}}},LegacyMap={ParseElementProps:ParseElementProps,ParseElements:ParseElements,MapType:MapType,IsLegacy:IsLegacy};return LegacyMap}()},{"./elements/helpers/ElementsHelper.js":97,"./enums/ElementTypes.js":184,"./enums/Properties.js":195,"./primitives/Point.js":211,"./utils/Calc.js":215,lodash:19}],23:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),EventEmitter=_dereq_("event-emitter"),LegacyMap=_dereq_("./LegacyMap.js"),ElementsManager=_dereq_("./ElementsManager.js"),InteractionsManager=_dereq_("./interactions/InteractionsManager.js"),HistoryManager=_dereq_("./history/HistoryManager.js"),Events=_dereq_("./enums/Events.js"),ElementTypes=_dereq_("./enums/ElementTypes.js"),RestrictModes=_dereq_("./enums/RestrictModes.js"),ElementsHelper=_dereq_("./elements/helpers/ElementsHelper.js"),VideoHelper=_dereq_("./elements/helpers/VideoHelper"),InteractionTriggers=_dereq_("./enums/InteractionTriggers.js"),SelectionHelper=_dereq_("./elements/helpers/SelectionHelper.js"),PageModes=_dereq_("./enums/PageModes.js"),Properties=_dereq_("./enums/Properties.js"),TextStyleHelper=_dereq_("./elements/helpers/TextStyleHelper.js"),CDNHelper=_dereq_("./utils/CDNHelper.js"),CollaborationUtils=_dereq_("./utils/Collaboration.js");module.exports=function(){function refreshElement(element){element.type===ElementTypes.TEXT_ELEMENT&&(element.shouldUpdateHeight=!0)}function Page(options){this.setOptions(options),this.MODE=this.options.mode,this.restrictMode=RestrictModes.NONE,this.ElementsManager=new ElementsManager(this),this.InteractionsManager=new InteractionsManager(this.ElementsManager),this.canvas=this.ElementsManager.createCanvas(this.options),this.canvas.initProperties({}),HistoryManager.AddListener(Events.HISTORY_CHANGE,function(data){this.emit(Events.HISTORY_CHANGE,data)}.bind(this)),this.ElementsManager.addListener(Events.ELEMENTS_CHANGE,function(changes,pageId){this.emit(Events.ELEMENTS_CHANGE,changes,pageId)}.bind(this)),this.interactWithElementThrottled=_.throttle(this.InteractionsManager.interactWithElement,50).bind(this.InteractionsManager),this.collaboration=new CollaborationUtils(this.canvas,this)}var defaultOptions={containerEl:".ng-canvas-container",rulerElClass:"ng-ruler",mode:PageModes.DESIGN,enableGuides:!0,enableGuidesSnapping:!0,enableSmartGuides:!0,enableSmartGuidesSnapping:!0},defaultNewElementPosition={x:100,y:100};return Page.FromSerialized=function(){var p=new Page;return p},Page.Events=Events,Page.Modes=PageModes,Page.prototype=Object.create(new EventEmitter),Page.constructor=Page,Page.prototype.setOptions=function(options){this.options=_.extend(this.options||_.clone(defaultOptions),options),CDNHelper.Init(this.options),this.canvas&&options&&options.hasOwnProperty("enableGuides")&&this.canvas.displayGuides(options.enableGuides)},Page.prototype.toggleMode=function(value){value||(value=this.isDesignMode()?PageModes.PREVIEW:PageModes.DESIGN),this.MODE=value,this.emit(Events.MODE_CHANGE,this.MODE),this.emit(this.isDesignMode()?Events.ENABLED_DESIGN_MODE:Events.ENABLED_PREVIEW_MODE),this.isPreviewMode()&&this._updateOffset(this.ElementsManager.getElements())},Page.prototype.isDesignMode=function(){return this.MODE===PageModes.DESIGN},Page.prototype.isPreviewMode=function(){return _.includes([PageModes.PREVIEW,PageModes.EXPORT],this.MODE)},Page.prototype.isExportMode=function(){return this.MODE===PageModes.EXPORT},Page.prototype.setComponentsIds=function(componentsIds){this.ElementsManager.setComponentsAvailableIds(componentsIds)},Page.prototype.addElement=function(element){this.canvas.addElement(element)},Page.prototype.addComponent=function(componentId,component){if(!this.ElementsManager.getComponentById(componentId)){var componentsElements={};componentsElements[componentId]=component,this.ElementsManager.addComponentsElements(componentsElements)}},Page.prototype.removeComponent=function(componentId){this.ElementsManager.removeComponent(componentId)},Page.prototype.bulkCreateElements=function(elementsList,position,selectElement){var idsMap=ElementsHelper.GenerateIdsMap(_.map(elementsList,function(element){return element.id}));LegacyMap.IsLegacy(elementsList)&&(elementsList=ElementsHelper.GenerateZIndicesInList(elementsList));
var elements,serialized=LegacyMap.ParseElements(ElementsHelper.ConvertListToMap(elementsList)),translated=ElementsHelper.TranslateAllIds(serialized,idsMap);this.ElementsManager.startBatch(),this.ElementsManager.loadPageElements(translated,position),elements=_.map(translated[ElementsHelper.CANVAS_ID].props.storedElements,function(elementId){return this.getElementById(elementId)}.bind(this)),this.canvas.addChildren(elements),this.ElementsManager.endBatch(),selectElement&&this.canvas._select(elements)},Page.prototype.createElement=function(type,props,selectElement){props=_.defaults(LegacyMap.ParseElementProps(props),defaultNewElementPosition),TextStyleHelper.IsTextEditable(type)&&(props=TextStyleHelper.UseDefaultStyle(props)),this.ElementsManager.startBatch();var element=this.ElementsManager.createElement(type,props);return this.addElement(element),this.ElementsManager.endBatch(),selectElement&&this.canvas.select(element,!0),element},Page.prototype.createUploadingImages=function(data){var elements;return this.ElementsManager.startBatch(),data.target?(data.target.setImageSrc(_.first(data.files).finalUrl,!0),elements=[data.target]):(elements=this.ElementsManager.createUploadingImages(data.files,data.point.x,data.point.y),_.forEach(elements,this.addElement.bind(this))),this.ElementsManager.endBatch(),_.forEach(elements,function(element,i){var file=data.files[i];element.showProgress(),element.setTemporaryImageSrc(file.src),file.onProgress=element.setProgress.bind(element),file.onComplete=element.setCompleted.bind(element,file.finalUrl),file.onError=element.setFailed.bind(element)}),this.canvas._select(elements),data.files},Page.prototype.createMultistateFromSelection=function(){this.canvas.createMultistate()},Page.prototype.createComponentFromSelection=function(){this.canvas.createComponent()},Page.prototype.zoomIn=function(){this.emit(Events.ZOOM_IN)},Page.prototype.zoomOut=function(){this.emit(Events.ZOOM_OUT)},Page.prototype.zoomReset=function(){this.emit(Events.ZOOM_RESET)},Page.prototype.getScale=function(){return this.canvas.scale},Page.prototype.setScale=function(value){this.canvas.setScale(value)},Page.prototype.undo=function(){HistoryManager.CanUndo()&&HistoryManager.Undo()},Page.prototype.redo=function(){HistoryManager.CanRedo()&&HistoryManager.Redo()},Page.prototype.canUndo=function(){return HistoryManager.CanUndo()},Page.prototype.canRedo=function(){return HistoryManager.CanRedo()},Page.prototype.getCanvas=function(){return this.canvas},Page.prototype.getElementById=function(id){var component=this.ElementsManager.getEditingComponent();return component?this.ElementsManager.getElementById(id,component.id):this.ElementsManager.getElementById(id)},Page.prototype.getAllElements=function(withCanvas){var component=this.ElementsManager.getEditingComponent(),elements=component?component.getElements():this.ElementsManager.getElements();return withCanvas?elements:_.reject(elements,function(element){return element.isCanvas()})},Page.prototype.getRootElement=function(){return this.ElementsManager.getEditingComponent()||this.canvas},Page.prototype.getElementsByIds=function(ids){return _.compact(_.map(ids,this.getElementById.bind(this)))},Page.prototype.getSelectedElements=function(){return this.mapSelectedElements(this.canvas.selectedElements)},Page.prototype.getSelectedElement=function(){return _.first(this.mapSelectedElements([this.canvas.getSelectedElement()]))},Page.prototype.selectElement=function(id,replaceSelection,edit){var element=this.getElementById(id);element&&replaceSelection?this.canvas.select(element,edit):element&&this.canvas.addToSelection(element)},Page.prototype.selectAllElements=function(){return this.canvas.selectAll()},Page.prototype.deselectElement=function(id){var element=this.getElementById(id);element&&this.canvas.removeFromSelection(element)},Page.prototype.deselectAllElements=function(){this.canvas.deselect()},Page.prototype.highlightElement=function(id,interactive){var element=this.getElementById(id);element&&this.canvas.highlight.show(element,interactive||this.canvas.pickMode)},Page.prototype.removeHighlight=function(){this.canvas.highlight.hide()},Page.prototype.alignSelectedElements=function(axis){0!==this.canvas.selectedElements.length&&this.canvas.align(axis)},Page.prototype.distributeSelectedElements=function(orientation){0!==this.canvas.selectedElements.length&&this.canvas.distribute(orientation)},Page.prototype.groupSelectedElements=function(){this.canvas.group()},Page.prototype.ungroupSelectedElements=function(){this.canvas.ungroup()},Page.prototype.moveElements=function(elementsIds,target,direction){var elements=this.getElementsByIds(elementsIds);target=this.getElementById(target),target&&0!==elements.length&&(direction>0?this.canvas.moveElementsBefore(elements,target):direction<0?this.canvas.moveElementsAfter(elements,target):0===direction&&this.canvas.moveElementsBefore(elements,target.children[0]))},Page.prototype.moveSelectedElementsForward=function(){this.canvas.moveForward()},Page.prototype.moveSelectedElementsBehind=function(){this.canvas.moveBehind()},Page.prototype.moveSelectedElementsToFront=function(){this.canvas.moveToFront()},Page.prototype.moveSelectedElementsToBack=function(){this.canvas.moveToBack()},Page.prototype.lockSelectedElements=function(){this.canvas.lock()},Page.prototype.unlockSelectedElements=function(){this.canvas.unlock()},Page.prototype.showElements=function(elements){this.canvas.setElementsVisibility(!0,elements)},Page.prototype.hideElements=function(elements){this.canvas.setElementsVisibility(!1,elements)},Page.prototype.updateElement=function(id,update,addToHistory){var element=this.getElementById(id);element&&(this.ElementsManager.startBatch(),_.forEach(update,function(value,property){var validated=element.validateProperty(property,value);element._updateProperty(property,validated,"undefined"==typeof addToHistory||addToHistory),TextStyleHelper.IsStyleProperty(element.type,property)&&TextStyleHelper.SetDefaultStyle(property,validated)}.bind(this)),this.ElementsManager.endBatch())},Page.prototype.collaborationUpdateElement=function(id,data){var element=this.ElementsManager.getElementById(id);return element?(_.forEach(data.props,function(value,property){return property===Properties.ANGLE&&[ElementTypes.GROUP,ElementTypes.MULTISTATE].indexOf(element.type)!==-1?element.collaborationUpdateAngle(value):void element._updateProperty(property,value,!0)}),void refreshElement(element)):(element=this.ElementsManager.createElementFromCollaboration(id,data.type,data.props),this.canvas.addChild(element),void(this.isComponentEditMode()&&this.ElementsManager.tintElementsExcept([element],[],!0)))},Page.prototype.collaborationCreateComponent=function(data){this.ElementsManager.createComponentFromCollaboration(data.id_page,data.changed_elements)},Page.prototype.addElementState=function(id,stateName){var element=this.getElementById(id);return!!element&&void(element.isMultistate()?(this.ElementsManager.startBatch(),element.addState(stateName),this.ElementsManager.endBatch()):(element=SelectionHelper.CreateOrConvertToMultistate([element],stateName),this.canvas._select([element])))},Page.prototype.removeElementState=function(id,stateId){var element=this.getElementById(id);if(element&&element.isMultistate()){var editByCollaborator=_.some(element.getStateChildrenById(stateId),function(child){return child.isEditByCollaborator()});if(editByCollaborator)return this.emit(Events.CANT_DELETE_ELEMENT);this.ElementsManager.startBatch(),element.removeState(stateId),1===element.getStatesCount()&&this.canvas._select(SelectionHelper.ConvertFromMultistate(element)),this.ElementsManager.endBatch()}},Page.prototype.renameElementState=function(id,stateId,stateName){var element=this.getElementById(id);element&&element.isMultistate()&&(this.ElementsManager.startBatch(),element.renameState(stateId,stateName),this.ElementsManager.endBatch())},Page.prototype.getElementState=function(id){var element=this.getElementById(id);if(element&&element.isMultistate())return element.activeState.id},Page.prototype.setElementState=function(id,stateId){var element=this.getElementById(id);if(element&&element.isMultistate()&&(this.ElementsManager.startBatch(),element.showState(stateId),this.ElementsManager.endBatch(),this.canvas.editingGroup===element)){var stateFirstElement=element.getStateFirstElement(stateId);stateFirstElement?this.canvas.select(this.getElementById(stateFirstElement)):this.canvas.refreshEmptyState(element)}},Page.prototype.setElementDefaultState=function(id,stateId){var element=this.getElementById(id);element&&element.isMultistate()&&(this.ElementsManager.startBatch(),element.setDefaultState(stateId),this.ElementsManager.endBatch())},Page.prototype.editGroup=function(id){var element=this.getElementById(id);element&&element.isGroup()&&this.canvas.editGroup(element)},Page.prototype.enableImageCrop=function(id){var element=this.getElementById(id);return element&&element.type===ElementTypes.IMAGE?this.canvas.crop(element):Promise.reject("No Image element with id "+id)},Page.prototype.disableImageCrop=function(){this.canvas._cancelImageCrop()},Page.prototype.isActiveImageCrop=function(id){return this.canvas.imageCrop&&this.canvas.imageCrop.image.id===id},Page.prototype.applyImageCrop=function(){if(!this.canvas.imageCrop)throw Error("No active ImageCrop available");this.canvas.onCrop()},Page.prototype.getCropSettings=function(){if(this.canvas.imageCrop)return this.canvas.imageCrop.getCropSettings();throw Error("No active ImageCrop available")},Page.prototype.setCropSettings=function(settings){if(!this.canvas.imageCrop)throw Error("No active ImageCrop available");this.canvas.imageCrop.setCropSettings(settings)},Page.prototype.enableImageAdjustments=function(id){var element=this.getElementById(id);return element&&element.type===ElementTypes.IMAGE?this.canvas.editImage(element):Promise.reject("No Image element with id "+id)},Page.prototype.disableImageAdjustments=function(){this.canvas._cancelImageEdit()},Page.prototype.isActiveImageAdjustments=function(id){return this.canvas.imageEdit&&this.canvas.imageEdit.image.id===id},Page.prototype.applyImageAdjustments=function(){if(!this.canvas.imageEdit)throw Error("No active ImageEdit available");this.canvas.onApplyAdjustments()},Page.prototype.getAdjustmentsSettings=function(){if(this.canvas.imageEdit)return this.canvas.imageEdit.getAdjustments();throw Error("No active ImageCrop available")},Page.prototype.setAdjustmentsSettings=function(settings){if(!this.canvas.imageEdit)throw Error("No active ImageCrop available");this.canvas.imageEdit.setAdjustments(settings)},Page.prototype.load=function(serialized){this.pageId=serialized.pageId,this.isComponent=serialized.isComponent,this.zoomReset(),serialized.page&&Object.keys(serialized.page).length>0&&(ElementsHelper.RemoveNonexistingElementsFromActions(serialized.page),ElementsHelper.RemoveInvalidActionsFromElements(serialized.page),_.forEach(serialized.components,function(component){ElementsHelper.RemoveNonexistingElementsFromActions(component)}),this.ElementsManager.addComponentsElements(serialized.components),this.ElementsManager.loadPageElements(LegacyMap.ParseElements(serialized.page)),this.canvas.initProperties(serialized.page[ElementsHelper.CANVAS_ID].props)),this.isPreviewMode()?(this.InteractionsManager.loadInteractions(this.getAllElements().concat(this.canvas)),this.triggerWindowLoad()):HistoryManager.Load(this),this.emit(Events.LOAD_FUNCTION_FINISHED)},Page.prototype.getBoundingBox=function(immediateUpdate){return immediateUpdate&&this.canvas._updateBoundingBox(),this.canvas.getBoundingBox()},Page.prototype.addComponentsElements=function(componentsElements){this.ElementsManager.addComponentsElements(componentsElements)},Page.prototype.getComponentById=function(componentId){return this.ElementsManager.getComponentById(componentId)},Page.prototype.getGridOptions=function(option){return"undefined"==typeof option?this.canvas.getAllGridOptions():this.canvas.getGridOption(option)},Page.prototype.updateGrid=function(options){_.forEach(options,function(value,key){this.canvas.setGridOption(key,value)}.bind(this))},Page.prototype.setGridOptions=function(options){this.updateGrid(options),this.emit(Events.GRID_UPDATE,this.canvas.getAllGridOptions())},Page.prototype.setGuides=function(guides){this.canvas.resetGuides(),setTimeout(function(){_.forEach(guides,function(guide){this.canvas.createGuide(guide.orientation,guide.x,guide.y)}.bind(this))}.bind(this),0)},Page.prototype.updateSize=function(){this.canvas.resized=!0},Page.prototype.clipGroup=function(element,value){element.isGroup()&&(this.ElementsManager.startBatch(),element.clipGroup(value),this.ElementsManager.endBatch(),this.canvas._select([element]))},Page.prototype.clear=function(){this.isDesignMode()&&(this.exitMultistateEditMode(),this.exitComponentEditMode()),this.canvas.clear(),this.ElementsManager.clear()},Page.prototype.destroy=function(){this.restrictMode=RestrictModes.NONE,this.canvas.destroy(),this.ElementsManager.destroy(),this.InteractionsManager.destroy()},Page.prototype.setOffset=function(x,y){this.canvas.offsetPoint.x=x,this.canvas.offsetPoint.y=y,this.isPreviewMode()&&this._updateOffset(this.ElementsManager.getElements())},Page.prototype.showOverlay=function(){this.canvas.view.showOverlay()},Page.prototype.hideOverlay=function(){this.canvas.view.hideOverlay()},Page.prototype.canAddDeleteElements=function(){return this.restrictMode===RestrictModes.NONE},Page.prototype.canChangeElements=function(){return this.restrictMode!==RestrictModes.ALL},Page.prototype.setRestrictMode=function(mode){this.restrictMode=mode},Page.prototype.storeAndClearHistory=function(){HistoryManager.StoreAndClear()},Page.prototype.restoreHistory=function(){HistoryManager.Restore()},Page.prototype.clearHistory=function(){HistoryManager.Clear()},Page.prototype.emitSelection=function(elements){this.emit(Events.ELEMENTS_SELECTED,this.mapSelectedElements(elements))},Page.prototype.isPickMode=function(){return this.canvas.isPickMode()},Page.prototype.pickElementId=function(id){return this.canvas.pickElementId(id)},Page.prototype.startPickMode=function(validator,ignoreMultistateChildren){return this.canvas.startPickMode(validator,ignoreMultistateChildren)},Page.prototype.endPickMode=function(){return this.canvas.endPickMode()},Page.prototype.exitMultistateEditMode=function(){this.canvas.setGroupEditable(!1)},Page.prototype.setMultistateEditMode=function(value,multistateId){this.emit(value?Events.MULTISTATE_ELEMENT_OPENED:Events.MULTISTATE_ELEMENT_CLOSED,multistateId)},Page.prototype.mapSelectedElements=function(elements){return _.some(elements)?1===elements.length&&_.first(elements).type===ElementTypes.IMAGE_CROP?[_.first(elements).image]:_.clone(elements):[this.canvas]},Page.prototype.triggerWindowLoad=function(){this.InteractionsManager.hasOnPageLoadInteractions()&&this.canvas.onUpdate(),this.InteractionsManager.interactWithElement(this.canvas.id,null,InteractionTriggers.WINDOW_LOAD)},Page.prototype.triggerKeyDown=function(e){this.InteractionsManager.interactWithElement(this.canvas.id,null,InteractionTriggers.WINDOW_KEYDOWN,e)},Page.prototype.triggerScroll=function(e){this.interactWithElementThrottled(this.canvas.id,null,InteractionTriggers.WINDOW_SCROLL,e)},Page.prototype.detectVideoServiceByUrl=function(url){return VideoHelper.detectServiceByUrl(url)},Page.prototype.isComponentInSelection=function(){return ElementsHelper.ContainsComponent(this.canvas.selectedElements)},Page.prototype.isComponentEditMode=function(){return this.isComponent||!!this.ElementsManager.getEditingComponent()},Page.prototype.isTableEditMode=function(){return!(!this.canvas.editingMultipart||this.canvas.editingMultipart.type!==ElementTypes.TABLE)},Page.prototype.canMoveRowsUp=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveRows(-1)},Page.prototype.canMoveRowsDown=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveRows(1)},Page.prototype.canMoveColsLeft=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveCols(-1)},Page.prototype.canMoveColsRight=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canMoveCols(1)},Page.prototype.canDeleteCols=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canDeleteCols()},Page.prototype.canDeleteRows=function(){return this.isTableEditMode()&&this.canvas.editingMultipart.canDeleteRows()},Page.prototype.moveRowsUp=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveRows(-1),this.canvas.deselectMultipartSelection())},Page.prototype.moveRowsDown=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveRows(1),this.canvas.deselectMultipartSelection())},Page.prototype.moveColsLeft=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveCols(-1),this.canvas.deselectMultipartSelection())},Page.prototype.moveColsRight=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionMoveCols(1),this.canvas.deselectMultipartSelection())},Page.prototype.insertRowBefore=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertRow(-1)},Page.prototype.insertRowAfter=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertRow(1)},Page.prototype.insertColBefore=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertCol(-1)},Page.prototype.insertColAfter=function(){this.isTableEditMode()&&this.canvas.editingMultipart.selectionInsertCol(1)},Page.prototype.deleteRows=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionDeleteRows(),this.canvas.deselectMultipartSelection())},Page.prototype.deleteCols=function(){this.isTableEditMode()&&(this.canvas.editingMultipart.selectionDeleteCols(),this.canvas.deselectMultipartSelection())},Page.prototype.distributeColumnsEvenly=function(){this.isTableEditMode()&&this.canvas.editingMultipart.distributeColumnsEvenly()},Page.prototype.exitComponentEditMode=function(){this.ElementsManager.getEditingComponent()&&this.canvas.finishEditingComponent()},Page.prototype.renderGhostElement=function(type,properties){var serializedElements;return properties&&properties.init_elements?(serializedElements=JSON.parse(properties.init_elements),this.ElementsManager.renderMultiElementGhost(serializedElements)):(properties=LegacyMap.ParseElementProps(properties,type),type=LegacyMap.MapType(type),TextStyleHelper.IsTextEditable(type)&&(properties=TextStyleHelper.UseDefaultStyle(properties)),this.ElementsManager.renderGhostElement(type,properties))},Page.prototype.getCanvasTopLeftCorner=function(){var topLeftCorner={},workbenchCoordinates=this.canvas.view.workbenchDomElement.getBoundingClientRect(),canvasCoordinates=this.canvas.view.domElement.getBoundingClientRect();return topLeftCorner.x=workbenchCoordinates.left-canvasCoordinates.left,topLeftCorner.y=workbenchCoordinates.top-canvasCoordinates.top,topLeftCorner},Page.prototype.getElementsSortedFromRoot=function(rootElement){return ElementsHelper.GetElementsSortedFromRoot(rootElement)},Page.prototype.getAllElementDescendants=function(element){return ElementsHelper.GetAllElementDescendants(element)},Page.prototype._updateOffset=function(elements){_.forEach(elements,function(element){element.fixed&&ElementsHelper.canBeFixed(element)&&element.setFixedOffset(this.canvas.offsetPoint),element.isComponent()&&this._updateOffset(element.getElements())}.bind(this))},Page}()},{"./ElementsManager.js":21,"./LegacyMap.js":22,"./elements/helpers/ElementsHelper.js":97,"./elements/helpers/SelectionHelper.js":102,"./elements/helpers/TextStyleHelper.js":106,"./elements/helpers/VideoHelper":107,"./enums/ElementTypes.js":184,"./enums/Events.js":185,"./enums/InteractionTriggers.js":188,"./enums/PageModes.js":194,"./enums/Properties.js":195,"./enums/RestrictModes.js":196,"./history/HistoryManager.js":202,"./interactions/InteractionsManager.js":209,"./utils/CDNHelper.js":214,"./utils/Collaboration.js":216,"event-emitter":3,lodash:19}],24:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Linkable=_dereq_("./behaviors/Linkable.js"),Indicative=_dereq_("./behaviors/Indicative.js"),Interactable=_dereq_("./behaviors/Interactable.js"),Base=_dereq_("../utils/Base.js"),FrameworkElement=_dereq_("./FrameworkElement.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),Events=_dereq_("../enums/Events.js"),Calc=_dereq_("../utils/Calc.js"),ElementsHelper=_dereq_("./helpers/ElementsHelper.js"),CDNHelper=_dereq_("../utils/CDNHelper.js"),Rectangle=_dereq_("../primitives/Rectangle.js");module.exports=function(){function getHighlight(page){var Highlight=_dereq_("./ui/Highlight.js");return new Highlight(null,page)}function isAncestorFixed(element){for(;element.parent&&element.parent.type!==ElementTypes.CANVAS;){if(element.parent.fixed)return!0;element=element.parent}return!1}function roundAngle(angle){var modulo=360,roundAngles=[0,90,180,270];return angle=(angle%modulo+modulo)%modulo,roundAngles.indexOf(parseInt(angle))!==-1?parseInt(angle):angle}function AbstractElement(id,Page){FrameworkElement.call(this),this.id=id,this.Page=Page,this.type=ElementTypes.ABSTRACT_ELEMENT,this.view=null,this.parent=null,this.highlight=null,this._rect=new Rectangle,this._dirty=!1,this._name=null,this._anchorX=null,this._anchorY=null,this._opacity=null,this._shouldUpdateFixed=!1,this.onParentReorderRef=this._onParentReorder.bind(this),this.Page.on(Events.ENABLED_DESIGN_MODE,function(){this.disablePreviewMode(),this.enableDesignMode()}.bind(this)),this.Page.on(Events.ENABLED_PREVIEW_MODE,function(){this.disableDesignMode(),this.enablePreviewMode()}.bind(this))}return AbstractElement.DefaultProperties={name:{value:""},width:{value:300,min:1,max:1e4},height:{value:100,min:1,max:1e4},keepRatio:{value:!1},angle:{value:0},x:{value:0,min:-1e4,max:1e4},y:{value:0,min:-1e4,max:1e4},opacity:{value:100,min:0,max:100},anchorX:{value:0,min:0,max:1},anchorY:{value:0,min:0,max:1},locked:{value:0},stateIa:{value:"visible"},fixed:{value:0}},Base.Extend(AbstractElement,FrameworkElement),Base.ApplyBehavior(AbstractElement,Linkable),Base.ApplyBehavior(AbstractElement,Indicative),Base.ApplyBehavior(AbstractElement,Interactable),Object.defineProperties(AbstractElement.prototype,{name:{get:function(){return this._name},set:function(value){this._saveProperty(),this._name=value}},dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,this.parent&&(this.parent.dirty=value)}},rect:{get:function(){return this._rect}},width:{get:function(){return this.rect.width},set:function(value){_.forEach(this._calculateWidthRelatedProperties(value,this.x,this.y),function(relatedValue,property){this[property]=relatedValue}.bind(this)),this._saveProperty(),this.rect.width=value,this.dirty=!0,this.dirtyPosition=!0}},height:{get:function(){return this.rect.height},set:function(value){_.forEach(this._calculateHeightRelatedProperties(value,this.x,this.y),function(relatedValue,property){this[property]=relatedValue}.bind(this)),this._saveProperty(),this.rect.height=value,this.dirty=!0,this.dirtyPosition=!0}},aspectRatio:{get:function(){return this.rect.aspectRatio}},keepRatio:{get:function(){return this._keepRatio},set:function(value){this._keepRatio=value}},angle:{get:function(){return this.rect.angle},set:function(value){this._saveProperty(),this.rect.angle=roundAngle(value),this.x=this.rect.x,this.y=this.rect.y,this.dirty=!0,this.dirtyPosition=!0}},x:{get:function(){return this.rect.x},set:function(value){this._saveProperty(),this.rect.x=value,this.dirty=!0,this.dirtyPosition=!0}},y:{get:function(){return this.rect.y},set:function(value){this._saveProperty(),this.rect.y=value,this.dirty=!0,this.dirtyPosition=!0}},opacity:{get:function(){return this._opacity},set:function(value){this._saveProperty(),this._opacity=value,this.view.setOpacity(value/100)}},anchorX:{get:function(){return this._anchorX},set:function(value){this._saveProperty(Properties.ANCHOR_X),this._anchorX=value}},anchorY:{get:function(){return this._anchorY},set:function(value){this._saveProperty(Properties.ANCHOR_Y),this._anchorY=value}},locked:{get:function(){return this._locked},set:function(value){this._saveProperty(),this._locked=value}},stateIa:{get:function(){return this._stateIa},set:function(value){this._saveProperty(),this._stateIa=value,this.view.setVisibility("visible"===value),this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0}},fixed:{get:function(){return this._fixed},set:function(value){this._saveProperty(),this._fixed=value?1:0,this.Page.isPreviewMode()?value&&(this._shouldUpdateFixed=!0):this.shouldUpdateFixedIcon=!0}},componentInstance:{get:function(){return this._componentInstance},set:function(value){this._componentInstance=value}},dirtyOrder:{get:function(){return this._drityOrder},set:function(value){this._drityOrder=value}},isTransformationDisabled:{get:function(){return this._isTransformationDisabled}}}),AbstractElement.prototype._calculateWidthRelatedProperties=function(value,x,y){var delta,rad,related={};return this.anchorX&&(delta=this.anchorX*(value-this.width),this.angle?(rad=Calc.DegToRad(this.angle),related.x=x-delta*Math.cos(rad),related.y=y-delta*Math.sin(rad)):related.x=x-delta),related},AbstractElement.prototype._calculateHeightRelatedProperties=function(value,x,y){var delta,rad,related={};return this.anchorY&&(delta=this.anchorY*(value-this.height),this.angle?(rad=Calc.DegToRad(this.angle)+Math.PI/2,related.x=x-delta*Math.cos(rad),related.y=y-delta*Math.sin(rad)):related.y=y-delta),related},AbstractElement.prototype.createView=function(ViewClass){return new ViewClass(this.id,this.Page.MODE)},AbstractElement.prototype.setParent=function(parent){this.parent&&this.parent.off(Events.GROUP_REORDER,this.onParentReorderRef),this.parent=parent,this.parent&&this.parent.on(Events.GROUP_REORDER,this.onParentReorderRef)},AbstractElement.prototype.update=function(){this._shouldUpdateFixed&&(this._shouldUpdateFixed=!1,ElementsHelper.canBeFixed(this)&&(this.view.setFixed(this.fixed),this.setFixedOffset(this.Page.canvas.offsetPoint))),this.updateIndicators(),this.updateLinkedElements(),this.view.updateTransform(this)},AbstractElement.prototype.resizeFromPoint=function(scaleX,scaleY,point){this._saveProperty(),this.rect.resizeFromPoint(scaleX,scaleY,point),this.dirtyPosition=!0,this.dirty=!0},AbstractElement.prototype.rotateByFromPoint=function(point,angle){this._saveProperty(),this.rect.rotateBy(point,angle),this.dirty=!0},AbstractElement.prototype.getBoundingBox=function(projected){return this.rect.getBoundingBox(projected)},AbstractElement.prototype.hitTest=function(p,disableCollaborationCheck){return this.isVisible()&&(disableCollaborationCheck||!this.isEditByCollaborator())&&this.rect.hitTest(p)?this:null},AbstractElement.prototype.isVisible=function(){return"visible"===this.stateIa},AbstractElement.prototype.isEditByCollaborator=function(){return this.Page.collaboration.isElementEditing(this.id)},AbstractElement.prototype.isUnlocked=function(){return!this.locked},AbstractElement.prototype.isSelectable=function(){return"visible"===this.stateIa},AbstractElement.prototype.isSelected=function(){return this.Page.getSelectedElement()===this},AbstractElement.prototype.setFixedOffset=function(point){isAncestorFixed(this)||this.view.setFixedOffset(point)},AbstractElement.prototype.isGroup=function(){return!1},AbstractElement.prototype.isMultistate=function(){return!1},AbstractElement.prototype.isComponent=function(){return!1},AbstractElement.prototype.isVirtualGroup=function(){return!1},AbstractElement.prototype.isCanvas=function(){return!1},AbstractElement.prototype.isTextEditable=function(){return!1},AbstractElement.prototype.isRichTextEditable=function(){return!1},AbstractElement.prototype.isTextInput=function(){return!1},AbstractElement.prototype.isMultipart=function(){return!1},AbstractElement.prototype.isUploadable=function(){return!1},AbstractElement.prototype.adjustHeightToText=function(){return!1},AbstractElement.prototype.isFixable=function(){return ElementsHelper.canBeFixed(this)},AbstractElement.prototype.getFixedChildren=function(){return ElementsHelper.getFixedChildren(this)},AbstractElement.prototype.getUnfixableParentElement=function(){return ElementsHelper.getUnfixableParentElement(this)},AbstractElement.prototype.containsRotatedElement=function(){return!!this.angle},AbstractElement.prototype.initProperties=function(props){_.forEach(this.DefaultProperties,function(propValue,propName){this._isPropertySerializable(propName)&&(this[propName]="undefined"!=typeof props[propName]?props[propName]:propValue.value)}.bind(this))},AbstractElement.prototype.getProperties=function(){return this.DefaultProperties},AbstractElement.prototype.getLayerChildren=function(){return this.children},AbstractElement.prototype.hasProperty=function(property){return this.getProperties().hasOwnProperty(property)},AbstractElement.prototype.highlightSelect=function(value){if(value){if(this.highlight)return;this.highlight=getHighlight(this.Page),this.addLinkedElement(this.highlight),this.highlight.link(this),this.Page.canvas.view.domElement.appendChild(this.highlight.view.domElement)}else this.highlight&&(this.Page.canvas.view.domElement.removeChild(this.highlight.view.domElement),this.highlight.unlink(this),this.removeLinkedElement(this.highlight),this.highlight=null)},AbstractElement.prototype.select=function(){this.isVisible()||(this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0)},AbstractElement.prototype.deselect=function(){this.isVisible()||(this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0),this.highlightSelect(!1)},AbstractElement.prototype.clone=function(props){return this.Page.ElementsManager.duplicateElement(this,props)},AbstractElement.prototype.getPropsForSerialize=function(){return _.mapValues(this.DefaultProperties,function(propValue,propName){return _.cloneDeep(this[propName])}.bind(this))},AbstractElement.prototype.serialize=function(){var serialized={};return serialized.id=this.id,serialized.type=this.type,serialized.props=this.getPropsForSerialize(),serialized.v="2.0",serialized},AbstractElement.prototype.updateProperty=function(property,value){return value=this.validateProperty(property,value),this.Page.ElementsManager.startBatch(),this._updateProperty(property,value,!0),this.Page.ElementsManager.endBatch(),value},AbstractElement.prototype.validateProperty=function(property,value){var propDefinition=this.DefaultProperties[property];return propDefinition?propDefinition.hasOwnProperty("min")&&value<propDefinition.min?value=propDefinition.min:propDefinition.hasOwnProperty("max")&&value>propDefinition.max?value=propDefinition.max:propDefinition.hasOwnProperty("options")&&propDefinition.options.indexOf(value)===-1&&(value=propDefinition.value):value=!1,value},AbstractElement.prototype.validateProperties=function(properties){return _.mapValues(properties,function(value,property){return this.validateProperty(property,value)}.bind(this))},AbstractElement.prototype.enableDesignMode=function(){},AbstractElement.prototype.disableDesignMode=function(){},AbstractElement.prototype.enablePreviewMode=function(){this.view.domElement.style.pointerEvents="all"},AbstractElement.prototype.disablePreviewMode=function(){this.view.domElement.style.removeProperty("pointerEvents")},AbstractElement.prototype.getDomElement=function(){return this.view.domElement},AbstractElement.prototype.getDomFocusableElement=function(){return this.view.getDomFocusableElement()},AbstractElement.prototype._saveProperty=function(property,value){this.Page.ElementsManager.save(this,property,value)},AbstractElement.prototype._updateProperty=function(property,value,addToHistory){this.Page.ElementsManager.update(this,property,value,addToHistory)},AbstractElement.prototype._isPropertySerializable=function(property){return!this.ExcludedProperties.hasOwnProperty(property)||("function"==typeof this.ExcludedProperties[property]?!this.ExcludedProperties[property].call(this):!this.ExcludedProperties[property]);
},AbstractElement.prototype._getGroupRotation=function(){for(var element=this.parent,angle=0;element;){if(element.isGroup()&&element.isClip||element.Page.isPreviewMode()&&element.isMultistate()){angle=element.angle;break}element=element.parent}return"rotate("+-angle+"deg)"},AbstractElement.prototype._getGroupTranslates=function(){for(var bb,translates=[],element=this.parent;element;){if(element.isGroup()&&element.isClip){bb=element.getBoundingBox(),translates.push("translate("+-bb.x+"px ,"+-bb.y+"px)");break}if(element.Page.isPreviewMode()&&element.isMultistate()){bb=element.isInAnimatingState(this)?element.getStateBoundingBox(this):element.getBoundingBox(),translates.push("translate("+-bb.x+"px ,"+-bb.y+"px)");break}element=element.parent}return translates.join(" ")},AbstractElement.prototype._onParentReorder=function(){this.dirtyOrder=!0,this.updateLinkedElements()},AbstractElement.prototype._getCdnUrl=function(url){return CDNHelper.IsStatic(url)?CDNHelper.GetStaticUrl(url):CDNHelper.IsUserContent(url)?CDNHelper.GetUserContentUrl(url):url},AbstractElement.prototype._disableTransformation=function(){this._isTransformationDisabled=!0},AbstractElement.prototype._enableTransformation=function(){this._isTransformationDisabled=!1},AbstractElement}()},{"../enums/ElementTypes.js":184,"../enums/Events.js":185,"../enums/Properties.js":195,"../primitives/Rectangle.js":212,"../utils/Base.js":213,"../utils/CDNHelper.js":214,"../utils/Calc.js":215,"./FrameworkElement.js":39,"./behaviors/Indicative.js":80,"./behaviors/Interactable.js":81,"./behaviors/Linkable.js":82,"./helpers/ElementsHelper.js":97,"./ui/Highlight.js":116,lodash:19}],25:[function(_dereq_,module,exports){"use strict";var GroupingInstance=_dereq_("./GroupingInstance.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function AndroidGear(){GroupingInstance.apply(this,arguments),this.type=ElementTypes.ANDROID_GEAR}return Base.Extend(AndroidGear,GroupingInstance),AndroidGear}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./GroupingInstance.js":43}],26:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function AndroidIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.ANDROID_ICON}return Base.Extend(AndroidIcon,SvgIcon),AndroidIcon}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],27:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),ArrowView=_dereq_("./views/ArrowView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function Arrow(){AbstractElement.apply(this,arguments),this.type=ElementTypes.ARROW,this.view=this.createView(ArrowView),this._shouldUpdateSvgPath=!1}return Arrow.HORIZONTAL="horizontal",Arrow.VERTICAL="vertical",Arrow.CURVE_NONE="0",Arrow.CURVE_UPPER="1",Arrow.CURVE_LOWER="2",Arrow.MARK_NONE="0",Arrow.MARK_ARROW="1",Arrow.DefaultProperties={width:{value:200},height:{value:100},color:{value:"#D9D9D9"},arrowOrientation:{value:Arrow.HORIZONTAL,options:[Arrow.HORIZONTAL,Arrow.VERTICAL]},arrowCurve:{value:Arrow.CURVE_LOWER,options:[Arrow.CURVE_NONE,Arrow.CURVE_UPPER,Arrow.CURVE_LOWER]},arrowStartMarker:{value:Arrow.MARK_NONE,options:[Arrow.MARK_NONE,Arrow.MARK_ARROW]},arrowEndMarker:{value:Arrow.MARK_ARROW,options:[Arrow.MARK_NONE,Arrow.MARK_ARROW]},stroke:{value:3,min:1,max:100}},Base.Extend(Arrow,AbstractElement),Object.defineProperties(Arrow.prototype,{shouldUpdateSvgPath:{get:function(){return this._shouldUpdateSvgPath},set:function(value){this._shouldUpdateSvgPath=value,value&&(this.dirty=value)}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this.shouldUpdateSvgPath=!0}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value),this.shouldUpdateSvgPath=!0}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},stroke:{get:function(){return this._stroke},set:function(value){this._saveProperty(),this._stroke=value,this.shouldUpdateSvgPath=!0}},arrowOrientation:{get:function(){return this._arrowOrientation},set:function(value){this._saveProperty(),this._arrowOrientation=value,this.shouldUpdateSvgPath=!0}},arrowCurve:{get:function(){return this._arrowCurve},set:function(value){value=value.toString(),this._saveProperty(),this._arrowCurve=value,this.shouldUpdateSvgPath=!0}},arrowStartMarker:{get:function(){return this._arrowStartMarker},set:function(value){value=value.toString(),this._saveProperty(),this._arrowStartMarker=value,this.view.toggleArrowStartMarker(value===Arrow.MARK_ARROW)}},arrowEndMarker:{get:function(){return this._arrowEndMarker},set:function(value){value=value.toString(),this._saveProperty(),this._arrowEndMarker=value,this.view.toggleArrowEndMarker(value===Arrow.MARK_ARROW)}}}),Arrow.prototype.isHorizontal=function(){return this.arrowOrientation===Arrow.HORIZONTAL},Arrow.prototype.isVertical=function(){return this.arrowOrientation===Arrow.VERTICAL},Arrow.prototype.isNoCurve=function(){return this.arrowCurve===Arrow.CURVE_NONE},Arrow.prototype.isUpperCurve=function(){return this.arrowCurve===Arrow.CURVE_UPPER},Arrow.prototype.isLowerCurve=function(){return this.arrowCurve===Arrow.CURVE_LOWER},Arrow.prototype.update=function(){this.shouldUpdateSvgPath&&(this.view.updateSvgPath(this),this.shouldUpdateSvgPath=!1),AbstractElement.prototype.update.call(this)},Arrow.prototype.resizeFromPoint=function(){this.shouldUpdateSvgPath=!0,AbstractElement.prototype.resizeFromPoint.apply(this,arguments)},Arrow}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/ArrowView.js":143}],28:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),BannerView=_dereq_("./views/BannerView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Banner(){AbstractElement.apply(this,arguments),this.type=ElementTypes.BANNER,this.view=this.createView(BannerView)}return Banner.DefaultProperties={backgroundImage:{value:""},clickIdPage:{value:""}},Base.Extend(Banner,AbstractElement),Object.defineProperties(Banner.prototype,{backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}}}),Banner}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/BannerView.js":144}],29:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),Boxable=_dereq_("./behaviors/Boxable.js"),Uploadable=_dereq_("./behaviors/Uploadable.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),BoxView=_dereq_("./views/BoxView.js");module.exports=function(){function Box(){AbstractElement.apply(this,arguments),this.type=ElementTypes.BOX,this.view=this.createView(BoxView)}return Box.DefaultProperties={paddingTop:{value:0},paddingRight:{value:0},paddingBottom:{value:0},paddingLeft:{value:0},paddingLock:{value:!0}},Base.Extend(Box,AbstractElement),Base.ApplyBehavior(Box,TextEditable),Base.ApplyBehavior(Box,Boxable),Base.ApplyBehavior(Box,Uploadable),Object.defineProperties(Box.prototype,{paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}},paddingLock:{get:function(){return this._paddingLock},set:function(value){this._saveProperty(),this._paddingLock=value}}}),Box.prototype.deselect=function(){this.view.setInputValue(this.inputValue),TextEditable.prototype.deselect.apply(this,arguments)},Box}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/Boxable.js":77,"./behaviors/TextEditable.js":88,"./behaviors/Uploadable.js":90,"./views/BoxView.js":145}],30:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Boxable=_dereq_("./behaviors/Boxable.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ButtonView=_dereq_("./views/ButtonView.js");module.exports=function(){function Button(){AbstractElement.apply(this,arguments),this.type=ElementTypes.BUTTON,this.view=this.createView(ButtonView)}return Button.DefaultProperties={width:{value:120},height:{value:30},inputValue:{value:"Search"},shadowEnabled:{value:!1},boxShadow:{value:""},state:{value:"active"},borderLock:{value:!0},radiusLock:{value:!0},borderColor:{value:"#DDDDDD"},backgroundColor:{value:"#3498db"},backgroundColorGradient:{value:0},color:{value:"#FFFFFF"},fontWeight:{value:"bold"},paddingTop:{value:6},paddingBottom:{value:6},paddingLeft:{value:10},paddingRight:{value:10}},Base.Extend(Button,AbstractElement),Base.ApplyBehavior(Button,Boxable),Base.ApplyBehavior(Button,SimpleTextEditable),Object.defineProperties(Button.prototype,{backgroundColorGradient:{get:function(){return this._backgroundColorGradient},set:function(value){this._saveProperty(),this._backgroundColorGradient=value,this.view.setBackgroundColorGradient(value?this.backgroundColor:null)}},boxShadow:{get:function(){return this._boxShadow},set:function(value){this._saveProperty(),this._boxShadow=value,this.view.setBoxShadow(value)}},shadowEnabled:{get:function(){return this._shadowEnabled},set:function(value){this._saveProperty(),this._shadowEnabled=value}},state:{get:function(){return this._state},set:function(value){this._saveProperty(),this._state=value,this.view.setState(value)}},paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}}}),Button}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/Boxable.js":77,"./behaviors/SimpleTextEditable.js":87,"./views/ButtonView.js":146}],31:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Group=_dereq_("./Group.js"),Guideable=_dereq_("./behaviors/Guideable.js"),Pickable=_dereq_("./behaviors/Pickable.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),Events=_dereq_("../enums/Events.js"),CanvasView=_dereq_("./views/CanvasView.js"),Collaborator=_dereq_("./ui/Collaborator.js"),Point=_dereq_("../primitives/Point.js"),Rectangle=_dereq_("../primitives/Rectangle.js"),Highlight=_dereq_("./ui/Highlight.js"),HighlightEdit=_dereq_("./ui/HighlightEdit.js"),HighlightEditClipped=_dereq_("./ui/HighlightEditClipped.js"),HighlightSelect=_dereq_("./ui/HighlightSelect.js"),HighlightPart=_dereq_("./ui/HighlightPart.js"),HighlightCellResizer=_dereq_("./ui/HighlightCellResizer.js"),MultiSelect=_dereq_("./ui/MultiSelect.js"),ElementIndicator=_dereq_("./ui/ElementIndicator.js"),ElementName=_dereq_("./ui/ElementName.js"),GuidePosition=_dereq_("./ui/GuidePosition.js"),Smartguide=_dereq_("./ui/Smartguide.js"),Gridable=_dereq_("./behaviors/Gridable.js"),Base=_dereq_("../utils/Base.js"),ArrangeHelper=_dereq_("./helpers/ArrangeHelper.js"),AlignHelper=_dereq_("./helpers/AlignHelper.js"),Tree=_dereq_("../utils/Tree.js"),ImageEditor=_dereq_("./helpers/ImageEditor.js"),ClipboardHelper=_dereq_("./helpers/ClipboardHelper.js"),DragAndDropHelper=_dereq_("./helpers/DragAndDropHelper.js"),SelectionHelper=_dereq_("./helpers/SelectionHelper.js"),TextEditor=_dereq_("./helpers/TextEditor.js"),ElementsHelper=_dereq_("./helpers/ElementsHelper.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),Orientations=_dereq_("../enums/Orientations.js"),PageModes=_dereq_("../enums/PageModes.js"),Keys=_dereq_("../enums/Keys.js"),SnappingHelper=_dereq_("./helpers/SnappingHelper.js"),Mouse=_dereq_("./helpers/MouseHelper.js");module.exports=function(){function getSelectionRectangle(p1,p2){var x=Math.min(p1.x,p2.x),y=Math.min(p1.y,p2.y);return new Rectangle(x,y,Math.abs(p2.x-p1.x),Math.abs(p2.y-p1.y))}function getImageSizePromise(imageData){return ImageEditor.GetImageSize(imageData.src).then(function(size){return _.extend(imageData,size)})}function isTransformatorPointClick(e){return e.target.classList.contains("ng-resizer")||e.target.classList.contains("ng-rotator")}function isEventTriggeredInInputElement(e){return _.contains(["INPUT","TEXTELEMENT"],e.target.tagName)}function canDragImageInto(element){return element&&(element.type===ElementTypes.BOX||element.type===ElementTypes.IMAGE)}function Canvas(id,Page){Group.call(this,id||ElementsHelper.CANVAS_ID,Page),this.type=ElementTypes.CANVAS,this.scale=1,this.clickPoint=new Point,this.offsetPoint=new Point,this.selectedElements=[],this.editingGroup=null,this.imageCrop=null,this.imageEdit=null,this.mouseMoved=!1,this.rulersRef={},this._resized=!1,this.editingMultipart=null}var INDICATOR_POSITION_DELTA=25,KeydownPreventNodes=["input","select","textarea"];return Canvas.DefaultProperties={backgroundColor:{value:"#ffffff"},backgroundImage:{value:""},backgroundSize:{value:"auto"},backgroundRepeat:{value:"repeat"},backgroundPosition:{value:"center center"}},Canvas.ExcludedProperties={name:!0,width:!0,height:!0,keepRatio:!0,angle:!0,x:!0,y:!0,opacity:!0,anchorX:!0,anchorY:!0,locked:!0,stateIa:!0,fixed:!0,isClip:!0,clip:!0,isClipScrollX:!0,isClipScrollY:!0},Base.Extend(Canvas,Group),Base.ApplyBehavior(Canvas,Gridable),Base.ApplyBehavior(Canvas,Guideable),Base.ApplyBehavior(Canvas,Pickable),Object.defineProperties(Canvas.prototype,{resized:{get:function(){return this._resized},set:function(value){this._resized=value}},backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(),this._backgroundColor=value,this.view.setBackgroundColor(value)}},backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}},backgroundSize:{get:function(){return this._backgroundSize},set:function(value){this._saveProperty(),this._backgroundSize=value,this.view.setBackgroundSize(value)}},backgroundRepeat:{get:function(){return this._backgroundRepeat},set:function(value){this._saveProperty(),this._backgroundRepeat=value,this.view.setBackgroundRepeat(value)}},backgroundPosition:{get:function(){return this._backgroundPosition},set:function(value){this._saveProperty(),this._backgroundPosition=value,this.view.setBackgroundPosition(value)}}}),Canvas.prototype.createCanvas=function(options){if(this.view=this.createView(CanvasView.bind(null,options.containerEl)),this.eventsRef=this.getEventsRef(options.mode),options.mode===PageModes.DESIGN){this.highlightEdit=new HighlightEdit(null,this.Page),this.highlightEditClipped=new HighlightEditClipped(null,this.Page),this.highlight=new Highlight(null,this.Page),this.highlightSelect=new HighlightSelect(null,this.Page),this.highlightPart=new HighlightPart(null,this.Page),this.highlightSelectedPart=new HighlightPart(null,this.Page),this.highlightCellResizer=new HighlightCellResizer(null,this.Page),this.collaborators={},this.multiSelect=new MultiSelect(null,this.Page),this.elementIndicator=new ElementIndicator(null,this.Page),this.elementName=new ElementName(null,this.Page),this.guidePosition=new GuidePosition(null,this.Page),this.smartguideHorizontal=new Smartguide(null,this.Page,Orientations.HORIZONTAL),this.smartguideVertical=new Smartguide(null,this.Page,Orientations.VERTICAL);var overlayChildren=[this.highlightEdit.view.domElement,this.highlightEditClipped.view.domElement,this.highlight.view.domElement,this.highlightSelect.view.domElement,this.highlightSelectedPart.view.domElement,this.highlightPart.view.domElement,this.multiSelect.view.domElement,this.highlightCellResizer.view.domElement,this.elementIndicator.view.domElement,this.elementName.view.domElement,this.guidePosition.view.domElement,this.smartguideHorizontal.view.domElement,this.smartguideVertical.view.domElement];this.view.appendToOverlay(overlayChildren),this.view.setScale(this.scale),SnappingHelper.AddListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.AddListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide)}this._addEvents(),this._updateRelativeRectangle(),TextEditor.AddListener(Events.TEXT_SELECTION_CHANGED,function(textFormat){this.Page.emit(Events.TEXT_SELECTION_CHANGED,textFormat)}.bind(this)),window.requestAnimationFrame(this.eventsRef.onUpdate),this.view.containerDomElement.parentNode.addEventListener("scroll",this.eventsRef.onUpdateRelativeRect)},Canvas.prototype.getEventsRef=function(mode){var eventsRef={};return mode===PageModes.DESIGN?eventsRef=this._getDesignSpecificEventsRef():mode===PageModes.PREVIEW&&(eventsRef=this._getPreviewSpecificEventsRef()),eventsRef.onUpdateRelativeRect=_.debounce(this._updateRelativeRectangle.bind(this),150),eventsRef.onUpdate=this.onUpdate.bind(this),eventsRef},Canvas.prototype._getPreviewSpecificEventsRef=function(){return{}},Canvas.prototype._getDesignSpecificEventsRef=function(){return{onStartDrag:this.onStartDrag.bind(this),onEndDrag:null,onEndGuideDrag:this.onEndGuideDrag.bind(this),onDrag:this.onDrag.bind(this),onGuideDrag:this.onGuideDrag.bind(this),onResize:this.onResize.bind(this),onRotate:this.onRotate.bind(this),onHighlightElement:this.onHighlightElement.bind(this),onMouseDown:this.onMouseDown.bind(this),onDoubleClick:this.onDoubleClick.bind(this),onBlockHighlightElement:this.onBlockHighlightElement.bind(this),onKeyDown:this.onKeyDown.bind(this),onCrop:this.onCrop.bind(this),onPaste:this.onPaste.bind(this),onFinishEditingTextElement:null,onFinishEditingTextInput:null,onDragenter:this.onDragenter.bind(this),onDragover:this.onDragover.bind(this),onDragleave:this.onDragleave.bind(this),onDrop:this.onDrop.bind(this),onMultiSelect:this.onMultiSelect.bind(this),onEndMultiSelect:this.onEndMultiSelect.bind(this),onScroll:this.onScroll.bind(this),onGuideShow:this.onSetGuideVisibility.bind(this,!0),onGuideHide:this.onSetGuideVisibility.bind(this,!1),onMultipartMove:this.onMultipartMove.bind(this),onMultipartUp:this.onMultipartUp.bind(this),onTableSelect:this.onTableSelect.bind(this),onStartCellResize:this.onStartCellResize.bind(this),onMoveResizer:this.onMoveResizer.bind(this),onCellResizeEnd:this.onCellResizeEnd.bind(this)}},Canvas.prototype.disablePreviewMode=function(){Group.prototype.disablePreviewMode.call(this),this.view.showOverlay()},Canvas.prototype.enablePreviewMode=function(){Group.prototype.enablePreviewMode.call(this),this.view.hideOverlay()},Canvas.prototype.isCanvas=function(){return!0},Canvas.prototype.getCollaborator=function(id){return this.collaborators[id]||null},Canvas.prototype.setCollaborators=function(collaborators){_.forEach(_.difference(Object.keys(this.collaborators),Object.keys(collaborators)),function(id){this.collaborators[id].destroy(),delete this.collaborators[id]}.bind(this)),_.forEach(collaborators,function(collaboratorData,id){return this.collaborators[id]?void this.collaborators[id].setData(collaboratorData,this.scale):void(this.collaborators[id]=new Collaborator(null,this.Page,collaboratorData,this.scale))}.bind(this)),this.view.appendToOverlay(_.map(this.collaborators,function(collaborator){return collaborator.view.domElement}))},Canvas.prototype.select=function(element,edit){this._select([element]),edit&&element.type===ElementTypes.TEXT_ELEMENT&&this.editTextElement(element)},Canvas.prototype.selectAll=function(){var all=this.editingGroup?this.editingGroup.getLayerChildren():this._getChildren();this._select(_.clone(this._getVisibleAndUnlockedElements(all)))},Canvas.prototype.getSelectedElement=function(){return this.highlightSelect.element},Canvas.prototype.getAllSelectedElements=function(){return this.selectedElements},Canvas.prototype.deselect=function(){this._select([]),this.highlightSelect.hide(),this.highlightCellResizer.hide(),this.clearMultipartSelection()},Canvas.prototype.addToSelection=function(element){this.selectedElements.indexOf(element)===-1&&this._updateSelection(element)},Canvas.prototype.removeFromSelection=function(element){this.selectedElements.indexOf(element)>-1&&this._updateSelection(element)},Canvas.prototype.addElement=function(element){var target=this.editingGroup||this.Page.ElementsManager.getEditingComponent()||this;target.addChild(element)},Canvas.prototype.group=function(){if(this.Page.canAddDeleteElements()){var group,elements;this.getSelectedElement().isVirtualGroup()&&(elements=_.clone(this.getAllSelectedElements()),group=SelectionHelper.Group(elements),this.deselect(),this._select([group]))}},Canvas.prototype.createMultistate=function(){if(this.Page.canAddDeleteElements()){var multistate,elements,selectedElement=this.getSelectedElement();if(selectedElement.isMultistate())return!1;elements=_.clone(this.getAllSelectedElements()),multistate=SelectionHelper.CreateOrConvertToMultistate(elements),this._select([multistate])}},Canvas.prototype.ungroup=function(){if(this.Page.canAddDeleteElements()){var ungroupedElements,element=this.highlightSelect.element;!element.isGroup()||element.isMultistate()||element.isVirtualGroup()||(ungroupedElements=SelectionHelper.Ungroup(element),this.deselect(),this._select(ungroupedElements))}},Canvas.prototype.lock=function(){this.Page.canAddDeleteElements()&&this._setPropertyForElements(this.getAllSelectedElements(),Properties.LOCKED,1,!0,function(affectedElements){1===affectedElements.length?this.highlightSelect.show(affectedElements[0]):this.deselect()}.bind(this))},Canvas.prototype.unlock=function(){this.Page.canAddDeleteElements()&&this._setPropertyForElements(this.getAllSelectedElements(),Properties.LOCKED,0,!0,function(affectedElements){affectedElements.length&&this.highlightSelect.show(affectedElements[0])}.bind(this))},Canvas.prototype.setElementsVisibility=function(visible,elements){var selectedElements=this.getAllSelectedElements();this._setPropertyForElements(elements||selectedElements,Properties.STATE_IA,visible?"hidden":"visible",!0,function(){this.highlightSelect.showElements(selectedElements)}.bind(this))},Canvas.prototype["delete"]=function(){if(this.Page.canAddDeleteElements()){var remove=function(){var elements=_.clone(this.selectedElements);_.contains(elements,this.highlight.element)&&this.highlight.hide();var elementsParent=elements[0].parent;SelectionHelper.Delete(elements),this.selectRemainingElements(elementsParent)}.bind(this);if(this.selectedElements.length){if(_.some(this.selectedElements,"locked"))return this.Page.emit(Events.ELEMENT_DELETE_CONFIRMATION,{onSuccess:remove});remove()}}},Canvas.prototype.selectRemainingElements=function(parent){var remainingElements=[];parent.isGroup()&&!parent.isCanvas()&&(remainingElements=parent.getLayerChildren()),remainingElements.length?this._select([remainingElements[0]]):parent.isMultistate()&&parent.storedElements.length?this.refreshEmptyState(parent):this.deselect()},Canvas.prototype.duplicateInPlace=function(){var boundingBox=this.highlightSelect.element.getBoundingBox(!1);this.copy(!1,!1),this.pasteInPlace({x:boundingBox.x,y:boundingBox.y},!0)},Canvas.prototype.copy=function(isCut,store){if(this.Page.canAddDeleteElements()){var elements;this.selectedElements.length&&(elements=_.clone(this.selectedElements),ClipboardHelper.CopyElements(elements,this.Page.pageId,isCut,this.highlightSelect.element.getBoundingBox(!1),store))}},Canvas.prototype.pasteInPlace=function(position){if(this.Page.canAddDeleteElements()){var target=this.editingGroup||this.Page.ElementsManager.getEditingComponent()||this;this._select(ClipboardHelper.PasteInPlace(target,position,!0)),this.Page.emit(Events.ELEMENT_PASTE)}},Canvas.prototype.paste=function(position){if(this.Page.canAddDeleteElements()){var target=this.editingGroup||this.Page.ElementsManager.getEditingComponent()||this;ClipboardHelper.PasteElements(target,position).then(function(elements){this.Page.emit(Events.ELEMENT_PASTE),this._select(elements)}.bind(this))}},Canvas.prototype.cut=function(){this.copy(!0),this["delete"]()},Canvas.prototype.crop=function(image){if(this.Page.canAddDeleteElements())return image.setLoading(!0),this.highlightSelect.view.domElement.addEventListener("dblclick",this.eventsRef.onCrop),ImageEditor.GetImageCrop(image,this.Page).then(function(imageCrop){image.setLoading(!1),this.imageCrop=imageCrop,this.view.insertNodeAfter(imageCrop.view.domElement,image.view.domElement),this._select([imageCrop])}.bind(this))},Canvas.prototype.editImage=function(image){if(this.Page.canAddDeleteElements())return image.setLoading(!0),ImageEditor.GetImageEdit(image,this.Page).then(function(imageEdit){image.setLoading(!1),image.addLinkedElement(imageEdit),this.imageEdit=imageEdit,this.view.insertNodeAfter(imageEdit.view.domElement,image.view.domElement)}.bind(this))},Canvas.prototype.clipGroup=function(){this.Page.canAddDeleteElements()&&1===this.selectedElements.length&&this.Page.clipGroup(this.selectedElements[0],!this.selectedElements[0].isClip)},Canvas.prototype.createComponent=function(name){if(this.Page.canAddDeleteElements()){var bb,elements;this.selectedElements.length&&(elements=_.clone(this.selectedElements),bb=this.highlightSelect.getBoundingBox(!0),this.deselect(),SelectionHelper.CreateComponent(name,elements,bb.x,bb.y).then(function(component){this._select([component])}.bind(this))["catch"](function(){this._select(elements)}.bind(this)))}},Canvas.prototype.finishEditingComponent=function(){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.tintElementsExcept(this.Page.ElementsManager.getElements(),this.Page.ElementsManager.getEditingComponent(),!1),this.Page.ElementsManager.finishEditingComponent(),this.deselect(),this.Page.emit(Events.COMPONENT_EDIT_MODE,!1))},Canvas.prototype.editComponent=function(component){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.tintElementsExcept(this.Page.ElementsManager.getElements(),component,!0),this.Page.ElementsManager.editComponent(component),this.deselect(),this.Page.emit(Events.COMPONENT_EDIT_MODE,!0,component.idComponent))},Canvas.prototype.editGroup=function(group,select){var collidedElement=null;select&&(collidedElement=this.getCollidedElement([group],!0),this._select([collidedElement])),collidedElement&&collidedElement!==group&&collidedElement.hitTest(this.clickPoint)||!group.isMultistate()||this.refreshEmptyState(group)},Canvas.prototype.refreshEmptyState=function(multistate){var activeState=multistate.activeState.id;this.deselect(),multistate.showState(activeState),this.editingGroup=multistate,this.setGroupEditable(!0)},Canvas.prototype.onFinishEditingTextElement=function(element,e){var editableElementDOM=element.view.domElement;(!editableElementDOM.contains(e.target)||element.type!==ElementTypes.BUTTON&&editableElementDOM===e.target)&&(e.stopPropagation(),this.finishEditingTextElement())},Canvas.prototype.finishEditingTextElement=function(){TextEditor.GetEditingElement()&&(TextEditor.FinishEditing(),this._addEvents(),this.highlightSelect.showView(),this.view.overlayDomElement.style.pointerEvents="auto",this.view.containerDomElement.removeEventListener("mousedown",this.eventsRef.onFinishEditingTextElement,!0))},Canvas.prototype.onFinishEditingTextInput=function(element,e){element.view.domElement.contains(e.target)&&!this.clickedOutsideActivePart(element,e.target)||(e.stopPropagation(),element.setEditing(!1),element.updateProperty(Properties.INPUT_VALUE,element.view.getInputValue()),this._addEvents(),this.highlightSelect.showView(),this.highlightSelectedPart.showView(),this.highlightPart.showView(),this.view.overlayDomElement.style.pointerEvents="auto",this.view.containerDomElement.removeEventListener("mousedown",this.eventsRef.onFinishEditingTextInput,!0))},Canvas.prototype.editTextElement=function(element){this.Page.canAddDeleteElements()&&TextEditor.Edit(element,function(){this.eventsRef.onFinishEditingTextElement=this.onFinishEditingTextElement.bind(this,element),this.highlightSelect.hideView(),this._removeEvents(),this.view.overlayDomElement.style.pointerEvents="none",this.view.containerDomElement.addEventListener("mousedown",this.eventsRef.onFinishEditingTextElement,!0)}.bind(this))},Canvas.prototype.editTextInput=function(element){this.Page.canAddDeleteElements()&&(this.eventsRef.onFinishEditingTextInput=this.onFinishEditingTextInput.bind(this,element),this.highlightSelect.hideView(),this.highlightSelectedPart.hideView(),this.highlightPart.hideView(),this._removeEvents(),this.view.overlayDomElement.style.pointerEvents="none",this.view.containerDomElement.addEventListener("mousedown",this.eventsRef.onFinishEditingTextInput,!0),element.setEditing(!0))},Canvas.prototype.clickedOutsideActivePart=function(element,target){return element.activeParts&&element.getPart(element.activeParts[0])&&!element.getPart(element.activeParts[0]).domElement.contains(target)},Canvas.prototype.moveToFront=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveToFront(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveToBack=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveToBack(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveForward=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveForward(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveBehind=function(){this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveBehind(this.selectedElements),this.Page.ElementsManager.endBatch()},Canvas.prototype.moveElementsBefore=function(elements,target){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveBefore(elements,target),this.Page.ElementsManager.endBatch())},Canvas.prototype.moveElementsAfter=function(elements,target){this.Page.canAddDeleteElements()&&(this.Page.ElementsManager.startBatch(),ArrangeHelper.MoveAfter(elements,target),this.Page.ElementsManager.endBatch())},Canvas.prototype.align=function(axis){this.Page.ElementsManager.startBatch(),AlignHelper.Align(axis,this.selectedElements),this.Page.ElementsManager.endBatch(),this.getSelectedElement().dirty=!0},Canvas.prototype.distribute=function(orientation){this.Page.ElementsManager.startBatch(),AlignHelper.Distribute(orientation,this.selectedElements),this.Page.ElementsManager.endBatch(),this.getSelectedElement().dirty=!0},Canvas.prototype.getCollidedElement=function(elements,searchInsideGroup,skipGroups){for(var element,hit,i=elements.length;i-- >0;)if(element=elements[i],
hit=element.hitTest(this.clickPoint))return skipGroups?hit:this.getElementInsideGroup(hit,searchInsideGroup);return null},Canvas.prototype.getElementInsideGroup=function(element,searchInsideGroup){var editingComponent=this.Page.ElementsManager.getEditingComponent(),editingGroup=this.editingGroup||editingComponent;return editingComponent&&!Tree.IsDescendantOf(editingComponent,element)?null:(searchInsideGroup?editingGroup=editingGroup&&Tree.IsDescendantOf(editingGroup,element)?Tree.GetAncestorGroup(element,editingGroup):Tree.GetAncestorGroup(element,null):editingGroup&&Tree.IsDescendantOf(editingGroup,element)||(editingGroup=null),Tree.GetRootElement(element,editingGroup))},Canvas.prototype.setGroupEditable=function(value,elements){var editingComponent=this.Page.ElementsManager.getEditingComponent();this.editingGroup&&(this.editingGroup.setEditable(value?this.editingGroup:editingComponent,elements),this.editingGroup.isMultistate()&&(this.Page.setMultistateEditMode(value,this.editingGroup.id),value||editingComponent&&Tree.IsDescendantOf(this.editingGroup,editingComponent)||this.editingGroup.showState())),value?(this.highlightEdit.show(this.editingGroup,this.editingGroup.isMultistate()),this.highlightEditClipped.show(this.editingGroup)):(this.highlightEdit.hide(),this.highlightEditClipped.hide())},Canvas.prototype.setScale=function(value){value!==this.scale&&(this.scale=value,this.highlightEdit.setScale(value),this.highlightEditClipped.setScale(value),this.highlight.setScale(value),this.highlightSelect.setScale(value),this.highlightPart.setScale(value),this.highlightSelectedPart.setScale(value),this.highlightCellResizer.setScale(value),this.multiSelect.setScale(value),this.setGuidesScale(value),this.view.setScale(value),this.Page.collaboration.refreshCollaborators(this.scale),this.emit(Events.SET_SCALE,this.scale))},Canvas.prototype.clear=function(){for(var i=this.children.length;i-- >0;)this.removeChild(this.children[i]);this.selectedElements=[],this.editingGroup=null,this.imageCrop=null,this.imageEdit=null,this.Page.isDesignMode()&&(this.highlightEdit.hide(!0),this.highlightEditClipped.hide(!0),this.highlight.hide(!0),this.highlightSelect.hide(!0),this.highlightPart.hide(!0),this.highlightSelectedPart.hide(!0),this.highlightCellResizer.hide(!0),this.multiSelect.hide(!0)),this.initProperties({}),this.view.clearCanvas()},Canvas.prototype.destroy=function(){this.clear(),this._removeEvents(),SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_SHOW,this.eventsRef.onGuideShow),SnappingHelper.RemoveListener(Events.SNAPPING_GUIDE_HIDE,this.eventsRef.onGuideHide)},Canvas.prototype.onUpdate=function(){for(var child,updated=!1,i=0,len=this.children.length;i<len;i++)child=this.children[i],child._dirty&&(updated=!0,child._dirty=!1,child.update());this.imageCrop&&this.imageCrop._dirty&&(updated=!0,this.imageCrop._dirty=!1,this.imageCrop.update()),this.imageEdit&&this.imageEdit._dirty&&(updated=!0,this.imageEdit._dirty=!1,this.imageEdit.update()),updated&&this.Page.isDesignMode()&&(this.highlightEdit.update(!0),this.highlightEditClipped.update(!0),this.highlight.update(!0),this.highlightSelect.update(!0),this.highlightPart.update(!0),this.highlightSelectedPart.update(!0),this.highlightCellResizer.update(!0),this.multiSelect.update(!0),this.highlightSelect.element&&this.elementIndicator.update()),this.shouldUpdateGrid&&(this.view.updateGrid(this),this.shouldUpdateGrid=!1),this.updateGuides(),this.resized&&(this.eventsRef.onUpdateRelativeRect(),this.resized=!1),window.requestAnimationFrame(this.eventsRef.onUpdate)},Canvas.prototype.onHighlightElement=function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getCollidedElement(this.children);element?(this.highlight.show(element),this._elementNameShow(element,e)):(this.highlight.hide(),this.highlightPart.hide(),this._elementNameHide())},Canvas.prototype.onDoubleClick=function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getCollidedElement(this.children);return!(!element||element.locked)&&void(element.isComponent()?this.editComponent(element):element.isGroup()?this.editGroup(element,!0):element.isTextInput()?this.editTextInput(element):element.isTextEditable()?this.editTextElement(element):element.isMultipart()?(this.enablePartSelection(element),this.onBlockHighlightElement(e)):element.type===ElementTypes.IMAGE&&this.openUploadDialog())},Canvas.prototype.openUploadDialog=function(){this.Page.emit(Events.OPEN_IMAGE_UPLOAD_DIALOG)},Canvas.prototype.enablePartSelection=function(element){this.editingMultipart=element},Canvas.prototype.disablePartSelection=function(){this.editingMultipart=null},Canvas.prototype.showContextMenu=function(e){e.preventDefault(),this.Page.emit(Events.SHOW_CONTEXT_MENU,{element:this.selectedElements,e:e})},Canvas.prototype.onMouseDown=function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var actions=[this.onSelectGuide,this.onSelectElement,this.onDeselectElement,this.onStartMultiSelect];_.some(actions,function(action){return action.call(this,e)}.bind(this))},Canvas.prototype.onSelectGuide=function(e){if(!this.Page.options.enableGuides)return!1;var guide=this.getCollidedElement(this.guides),ruler=e.target.classList.contains(this.Page.options.rulerElClass)?e.target:null;return guide?(this.activeGuide=guide,this.onStartDrag(e),!0):ruler?(this.activeGuide=this.createGuide(ruler.classList.contains(Orientations.HORIZONTAL)?Orientations.HORIZONTAL:Orientations.VERTICAL,this.clickPoint.x,this.clickPoint.y),this.onStartDrag({target:this.activeGuide.view.domElement}),!0):void 0},Canvas.prototype.onSelectElement=function(e){var addToSelection=Mouse.addToSelection(e),element=this.getCollidedElement(this.children);return!(!element||addToSelection&&(element.locked||this._isLockedElementOnElementsList(this.selectedElements)))&&(this.editingMultipart===element?(Mouse.rightButtonPressed(e)?element.getActiveParts().indexOf(this.highlightPart.partId)===-1&&this.editingMultipartSelect(element,!1):(this.highlightSelect.view.domElement.addEventListener("mousemove",this.eventsRef.onMultipartMove),this.highlightSelect.view.domElement.addEventListener("mouseup",this.eventsRef.onMultipartUp),this.editingMultipartSelect(element,addToSelection)),!0):(this.onStartDrag(e),element.type===ElementTypes.TABLE&&this.onTableSelect(e),!0))},Canvas.prototype.editingMultipartSelect=function(element,addToSelection){element&&(addToSelection&&element.anyPartsSelected()&&element.addActivePart?(element.addActivePart(this.highlightPart.partId),this.highlightSelectedPart.show(element,element.getActiveParts())):(element.setActiveParts([this.highlightPart.partId]),this.highlightSelectedPart.show(element,this.highlightPart.partId)),this.Page.emit(Events.ELEMENTS_SELECTED,_.clone(this.selectedElements)))},Canvas.prototype.onMultipartMove=function(){this.editingMultipartSelect(this.editingMultipart,!0)},Canvas.prototype.onMultipartUp=function(){this.highlightSelect.view.domElement.removeEventListener("mousemove",this.eventsRef.onMultipartMove),this.highlightSelect.view.domElement.removeEventListener("mouseup",this.eventsRef.onMultipartUp),this.editingMultipartSelect(this.editingMultipart,!0)},Canvas.prototype.onStartMultiSelect=function(e){if(!Mouse.rightButtonPressed(e)){if(this.multiSelect.hasSelection())return this.onEndMultiSelect(this.multiSelect.startPoint,e);var startMultiSelectPoint=Point.FromObject(this._getRelativeScaledMousePosition(e));this.eventsRef.onEndMultiSelect=this.onEndMultiSelect.bind(this,startMultiSelectPoint),this.eventsRef.onMultiSelect=this.onMultiSelect.bind(this,startMultiSelectPoint),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onEndMultiSelect),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onMultiSelect),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onHighlightElement),this.mouseMoved=!1}},Canvas.prototype.onMultiSelect=function(startMultiSelectPoint,e){this.mouseMoved||(this.mouseMoved=!0);var endMultiSelectPoint=Point.FromObject(this._getRelativeScaledMousePosition(e)),selection=getSelectionRectangle(startMultiSelectPoint,endMultiSelectPoint);this.multiSelect.show(selection),this.multiSelect.startPoint=startMultiSelectPoint},Canvas.prototype.onEndMultiSelect=function(startMultiSelectPoint,e){var endMultiSelectPoint,selection,elements;this.mouseMoved&&(this.mouseMoved=!1,endMultiSelectPoint=Point.FromObject(this._getRelativeScaledMousePosition(e)),selection=getSelectionRectangle(startMultiSelectPoint,endMultiSelectPoint),elements=_.filter(this._getChildren(),function(element){return element.isVisible()&&element.isUnlocked()&&!element.isEditByCollaborator()&&element.getBoundingBox(!0).overlaps(selection)}),this._select(Mouse.addToSelection(e)?_.union(this.selectedElements,elements):elements)),this.multiSelect.hide(),this.view.containerDomElement.removeEventListener("mouseup",this.eventsRef.onEndMultiSelect),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onMultiSelect),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onHighlightElement)},Canvas.prototype.onDeselectElement=function(e){if(Mouse.addToSelection(e)||(this.deselect(),this.setGroupEditable(!1),this.editingGroup=null,this.editingMultipart&&this.disablePartSelection()),Mouse.rightButtonPressed(e))return this.showContextMenu(e),!0},Canvas.prototype.changeSelection=function(element,e){var addToSelection=Mouse.addToSelection(e),shouldDeselect=!1;return element&&(this.selectedElements.indexOf(element)===-1?addToSelection?this._updateSelection(element):this._select([element]):addToSelection&&(shouldDeselect=!0)),addToSelection&&e.stopImmediatePropagation(),shouldDeselect},Canvas.prototype.onStartDrag=function(e){if(Mouse.rightButtonPressed(e))return this.showContextMenu(e),this.editingMultipart||e.stopImmediatePropagation(),!1;if(this.editingMultipart)return!1;var mousePosition,element,shouldDeselect,transformatorPointClick=isTransformatorPointClick(e),isGuide=e.target.classList.contains("ng-guide");return this.clickPoint=this._getRelativeScaledMousePosition(e),Mouse.leftButtonPressed(e)&&e.altKey&&this.duplicateInPlace(),element=this.getCollidedElement(this.children),shouldDeselect=!(isGuide||transformatorPointClick||!element)&&this.changeSelection(element,e),!(!(isGuide||transformatorPointClick||element)||element&&(element.locked||element.isTransformationDisabled)||!this.Page.canChangeElements())&&(this.mouseMoved=!1,this.eventsRef.onEndDrag=this.onEndDrag.bind(this,element,shouldDeselect,transformatorPointClick),void(e.target.classList.contains("ng-highlight-select")||e.target.classList.contains("ng-highlight")?(mousePosition=this._getRelativeMousePosition(e),this.highlightSelect.startDrag(mousePosition.x,mousePosition.y),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onDrag),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onEndDrag),this._removeEvents()):e.target.classList.contains("ng-resizer")?(this.highlightSelect.startResize(),this.eventsRef.onResize=this.onResize.bind(this,e.target.getAttribute("data-direction")),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onResize),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onEndDrag),this._removeEvents()):e.target.classList.contains("ng-rotator")?(mousePosition=this._getRelativeMousePosition(e),this.highlightSelect.startRotate(mousePosition.x,mousePosition.y),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onRotate),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onEndDrag),this._removeEvents()):isGuide&&(this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onGuideDrag),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onEndGuideDrag),this._removeEvents())))},Canvas.prototype.onTableSelect=function(e){e.stopImmediatePropagation(),this._addEventsOnTableResizers()},Canvas.prototype._addEventsOnTableResizers=function(){_.each(this.highlightCellResizer.getResizers(),function(resizer){resizer.addEventListener("mousedown",this.eventsRef.onStartCellResize)},this)},Canvas.prototype.onStartCellResize=function(e){this._cellResizer=e.target,this.highlightCellResizer.startDrag(this._cellResizer),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onMoveResizer),this.view.containerDomElement.addEventListener("mouseup",this.eventsRef.onCellResizeEnd),this._removeEvents()},Canvas.prototype.onMoveResizer=function(e){var mousePosition=this._getRelativeMousePosition(e);this.highlightCellResizer.dragResizer(mousePosition.x,mousePosition.y,this._cellResizer)},Canvas.prototype.onCellResizeEnd=function(){this.highlightCellResizer.commitCellResize(this._cellResizer),this._cellResizer=null,this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onMoveResizer),this.view.containerDomElement.removeEventListener("mouseup",this.eventsRef.onCellResizeEnd),this._addEventsOnTableResizers(),this._addEvents()},Canvas.prototype.onResize=function(direction,e){var lockRatio=e.shiftKey||this.getSelectedElement().keepRatio,useAnchor=e.altKey,mousePosition=this._getRelativeMousePosition(e);e.preventDefault(),this.mouseMoved||this._mouseMove(),this.highlightSelect.resize(mousePosition.x,mousePosition.y,direction,lockRatio,useAnchor),this.elementIndicator.showDimensions(this.highlightSelect.element),this.Page.emit(Events.ELEMENT_RESIZE)},Canvas.prototype.onDrag=function(e){var mousePosition=this._getRelativeMousePosition(e);e.preventDefault(),this.mouseMoved||this._mouseMove(),Mouse.leftButtonPressed(e)&&this.highlightSelect.drag(mousePosition.x,mousePosition.y,e.shiftKey),this.Page.emit(Events.ELEMENT_DRAG),this.elementIndicator.showCoordinates(this.highlightSelect.element)},Canvas.prototype.onRotate=function(e){var mousePosition=this._getRelativeMousePosition(e);e.preventDefault(),this.mouseMoved||this._mouseMove(),this.highlightSelect.rotate(mousePosition.x,mousePosition.y,e.shiftKey),this.elementIndicator.showRotation(this.highlightSelect.element),this.Page.emit(Events.ELEMENT_ROTATE)},Canvas.prototype.onEndDrag=function(element,shouldDeselect,transformatorPointClick,e){this.mouseMoved||transformatorPointClick||(element?shouldDeselect?this._updateSelection(element):!Mouse.addToSelection(e)&&this.selectedElements.length>1&&this._select([element]):this.onDeselectElement(e)),this.Page.ElementsManager.endBatch(),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onDrag),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onResize),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onRotate),this.view.containerDomElement.removeEventListener("mouseup",this.eventsRef.onEndDrag),this.smartguideHorizontal.visibility=!1,this.smartguideVertical.visibility=!1,this.Page.emit(Events.ELEMENT_DRAG_END),this._addEvents()},Canvas.prototype.onGuideDrag=function(e){if(this.activeGuide){var mousePosition=this._getRelativeMousePosition(e);this.activeGuide.x=mousePosition.x,this.activeGuide.y=mousePosition.y,this.guidePosition.setPosition(mousePosition.x,mousePosition.y+INDICATOR_POSITION_DELTA),this.guidePosition.show(this.activeGuide)}},Canvas.prototype.onEndGuideDrag=function(e){var ruler=this._getRulerRef(this.activeGuide.orientation);Mouse.isEventOnElement(e,ruler)&&this.removeGuide(this.activeGuide),this.activeGuide=null,this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onGuideDrag),this.view.containerDomElement.removeEventListener("mouseup",this.eventsRef.onEndGuideDrag),this.Page.emit(Events.GUIDES_UPDATE,this.serializeGuides()),this._addEvents()},Canvas.prototype.onBlockHighlightElement=function(e){var point,relativePoint,partId,element=this.highlightSelect.element;return!!element.isMultipart()&&(point=Point.FromObject(this._getRelativeScaledMousePosition(e)),relativePoint=new Point(point.x-element.x,point.y-element.y),void(element.hitTest(point)?(partId=this.editingMultipart&&element.isMultipart()?element.partHitTest(relativePoint):null,partId?this.highlightPart.show(element,partId):this.highlightPart.hide(),e.stopPropagation(),this.highlight.hide()):this.highlightPart.hide()))},Canvas.prototype.isClipboardEmpty=function(){return ClipboardHelper.IsClipboardEmpty()},Canvas.prototype.onPaste=function(e){if(this.Page.canAddDeleteElements()&&ClipboardHelper.IsRawImage(e.clipboardData)){this.Page.ElementsManager.startBatch();var src=ClipboardHelper.GetRawImageBlobSrc(e.clipboardData);this.Page.ElementsManager.createImagesFromSrc([src]).then(function(elements){this.addChildren(elements),this.Page.ElementsManager.endBatch(),this._select(elements)}.bind(this))}},Canvas.prototype.onCrop=function(){ImageEditor.Crop(this.imageCrop).then(this._cancelImageCrop.bind(this))["catch"](this._cancelImageCrop.bind(this))},Canvas.prototype.onApplyAdjustments=function(){ImageEditor.ApplyEdit(this.imageEdit).then(function(){this._cancelImageEdit()}.bind(this))},Canvas.prototype.onDragenter=function(e){e.preventDefault()},Canvas.prototype.onDragover=function(e){if(this.Page.canAddDeleteElements()){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getCollidedElement(this.children,!1,!0);e.preventDefault(),canDragImageInto(element)?this.highlight.show(element,!1,!0):this.highlight.hide()}},Canvas.prototype.onDragleave=function(e){e.preventDefault()},Canvas.prototype.onDrop=function(e){if(this.Page.canAddDeleteElements()){var targetElement,dropPoint=Point.FromObject(this._getRelativeScaledMousePosition(e)),element=this.getCollidedElement(this.children,!1,!0),imagesData=[];e.preventDefault(),DragAndDropHelper.ContainsImageFile(e.dataTransfer)&&(imagesData=DragAndDropHelper.GetImages(e.dataTransfer),element&&element.isUploadable()&&(targetElement=element,imagesData=[_.first(imagesData)]),Promise.all(_.map(imagesData,getImageSizePromise)).then(function(readyImagesData){this.Page.emit(Events.IMAGES_DROP,{files:readyImagesData,target:targetElement,point:dropPoint,nativeEvent:e})}.bind(this)))}},Canvas.prototype.onScroll=function(e){this.Page.isPreviewMode()&&this.Page.InteractionsManager.interactWithElement(this.id,null,InteractionTriggers.WINDOW_SCROLL,e)},Canvas.prototype.onKeyDown=function(e){var delta,selectedElement=this.getSelectedElement(),preventListener=KeydownPreventNodes.indexOf(e.target.nodeName.toLowerCase())>-1,cmdKey=e.metaKey||e.ctrlKey;if(!isEventTriggeredInInputElement(e)&&(e.which===Keys.KEY_V&&cmdKey?this.paste():e.which===Keys.KEY_A&&cmdKey?(e.preventDefault(),this.selectAll()):e.which===Keys.EQUALS&&cmdKey?(e.preventDefault(),this.Page.zoomIn()):e.which===Keys.DASH&&cmdKey?(e.preventDefault(),this.Page.zoomOut()):e.which===Keys.KEY_0&&cmdKey?(e.preventDefault(),this.Page.zoomReset()):e.which===Keys.KEY_Z&&cmdKey?(e.preventDefault(),this.Page.undo()):e.which===Keys.KEY_Y&&cmdKey?(e.preventDefault(),this.Page.redo()):e.which===Keys.KEY_G&&e.altKey?(e.preventDefault(),this.setGridOption("gridDisplay",!this.getGridOption("gridDisplay"))):e.which===Keys.KEY_S&&e.altKey?(e.preventDefault(),this.Page.ElementsManager.getEditingComponent()&&this.finishEditingComponent()):e.which!==Keys.BACKSPACE||document.activeElement!==document.body&&document.activeElement!==document.body.parentElement||e.preventDefault(),selectedElement&&!preventListener)){if(delta=e.shiftKey?10:1,!selectedElement.locked&&this.Page.canChangeElements())if(e.which===Keys.LEFT_ARROW)e.preventDefault(),this.Page.ElementsManager.startBatch(),this.highlightSelect.moveOnX(-delta),this.Page.ElementsManager.endBatch();else if(e.which===Keys.UP_ARROW)e.preventDefault(),this.Page.ElementsManager.startBatch(),this.highlightSelect.moveOnY(-delta),this.Page.ElementsManager.endBatch();else if(e.which===Keys.RIGHT_ARROW)e.preventDefault(),this.Page.ElementsManager.startBatch(),this.highlightSelect.moveOnX(delta),this.Page.ElementsManager.endBatch();else if(e.which===Keys.DOWN_ARROW)e.preventDefault(),this.Page.ElementsManager.startBatch(),this.highlightSelect.moveOnY(delta),this.Page.ElementsManager.endBatch();else if(e.which===Keys.KEY_G&&cmdKey&&!e.shiftKey)e.preventDefault(),this.group();else if(e.which===Keys.KEY_G&&cmdKey&&e.shiftKey)e.preventDefault(),this.ungroup();else if(e.which===Keys.KEY_K&&cmdKey&&!e.shiftKey)e.preventDefault(),this.lock();else if(e.keyCode===Keys.ESCAPE){if(e.preventDefault(),this.editingMultipart)return this.clearMultipartSelection(),void this.disablePartSelection();this.deselect(),e.stopImmediatePropagation()}else e.keyCode===Keys.ENTER&&this.imageCrop&&this.Page.applyImageCrop();else e.preventDefault();e.which===Keys.KEY_K&&cmdKey&&e.shiftKey?(e.preventDefault(),this.unlock()):e.which===Keys.BACKSPACE||e.which===Keys.DELETE?(e.preventDefault(),this["delete"]()):e.which===Keys.KEY_E&&e.altKey?(e.preventDefault(),1===this.selectedElements.length&&this.selectedElements[0].isComponent()&&this.editComponent(this.selectedElements[0])):e.which===Keys.CLOSE_BRACKET&&cmdKey&&!e.altKey?(e.preventDefault(),this.moveForward()):e.which===Keys.OPEN_BRACKET&&cmdKey&&!e.altKey?(e.preventDefault(),this.moveBehind()):e.which===Keys.CLOSE_BRACKET&&cmdKey&&e.altKey?(e.preventDefault(),this.moveToFront()):e.which===Keys.OPEN_BRACKET&&cmdKey&&e.altKey&&(e.preventDefault(),this.moveToBack()),selectedElement.isUnlocked()&&(e.which===Keys.KEY_S&&e.altKey?(e.preventDefault(),this.Page.isComponentEditMode()||this.Page.isComponentInSelection()||this.createComponent()):e.which===Keys.KEY_C&&cmdKey?(e.preventDefault(),this.copy()):e.which===Keys.KEY_X&&cmdKey?(e.preventDefault(),this.cut()):e.which===Keys.KEY_S&&cmdKey&&e.shiftKey&&(e.preventDefault(),selectedElement.isMultistate()?(this.Page.ElementsManager.startBatch(),selectedElement.addState(),this.Page.ElementsManager.endBatch()):this.createMultistate(),this.Page.emit(Events.SHORTCUT_ADD_NEW_STATE,selectedElement))),selectedElement.isTextEditable()&&(e.which===Keys.KEY_B&&cmdKey?(this.Page.ElementsManager.startBatch(),selectedElement.toggleBold(),this.Page.ElementsManager.endBatch()):e.which===Keys.KEY_I&&cmdKey?(this.Page.ElementsManager.startBatch(),selectedElement.toggleItalic(),this.Page.ElementsManager.endBatch()):e.which===Keys.KEY_U&&cmdKey&&(this.Page.ElementsManager.startBatch(),selectedElement.toggleUnderline(),this.Page.ElementsManager.endBatch()))}},Canvas.prototype.onSetGuideVisibility=function(visible,data){var guide=data.axis===Properties.X?this.smartguideVertical:this.smartguideHorizontal;guide.visibility=visible,visible&&(guide[data.axis]=data.value*this.scale)},Canvas.prototype.deselectMultipartSelection=function(){this.editingMultipart&&(this.editingMultipart.setActiveParts([]),this.highlightSelectedPart.hide(),this.highlightPart.hide())},Canvas.prototype.clearMultipartSelection=function(){this.editingMultipart&&(this.editingMultipart=null,this.highlightSelectedPart.hide(),this.highlightPart.hide())},Canvas.prototype.getRelativeScaledMousePosition=function(mousePosition){return{x:(mousePosition.x-this.domElementRect.left)/this.scale,y:(mousePosition.y-this.domElementRect.top)/this.scale}},Canvas.prototype.updateHighlightSelect=function(){this.selectedElements.length>1&&this.highlightSelect.updateElements()},Canvas.prototype._updateSelection=function(element){this.clearMultipartSelection();var elements=_.clone(this.selectedElements),index=elements.indexOf(element),lockedInSelection=this._isLockedElementOnElementsList(elements),shouldAddToSelection=!lockedInSelection&&!element.locked||_.isEmpty(elements);index>-1?elements.splice(index,1):shouldAddToSelection&&elements.push(element),_.isEmpty(elements)?this.deselect():this._select(elements)},Canvas.prototype._select=function(elements){this.clearMultipartSelection();var multiple=elements.length>1;this._shouldCancelImageCrop(elements)&&this._cancelImageCrop(),_.forEach(_.difference(this.selectedElements,elements),function(element){element.deselect()}),this._selectParent(elements),_.forEach(_.difference(elements,this.selectedElements),function(element){element.select()}),_.forEach(elements,function(element){element.highlightSelect(multiple)}),1===elements.length&&elements[0].type===ElementTypes.TABLE?(this.highlightCellResizer.show(elements[0]),this._addEventsOnTableResizers()):this.highlightCellResizer.hide(),this.selectedElements=elements,this.highlightSelect.showElements(elements),this.elementIndicator.hide(),this.Page.emitSelection(this.selectedElements)},Canvas.prototype._selectParent=function(elements){var editingGroup=null;_.forEach(elements,function(element){element.type===ElementTypes.IMAGE_CROP&&(element=element.image);var ancestorGroup=Tree.GetFirstAncestorGroup(element);ancestorGroup&&(editingGroup=ancestorGroup)}.bind(this)),this.editingGroup!==editingGroup&&(this.setGroupEditable(!1),this.editingGroup=editingGroup,this.setGroupEditable(!!editingGroup,elements))},Canvas.prototype._setPropertyForElements=function(elements,property,value,addToHistory,callback){_.isEmpty(elements)||(this.Page.ElementsManager.startBatch(),_.forEach(elements,function(element){element._updateProperty(property,value,addToHistory)}),this.Page.ElementsManager.endBatch(),"function"==typeof callback&&callback(elements))},Canvas.prototype._shouldCancelImageCrop=function(elements){return this.imageCrop&&(1!==elements.length||elements[0].type!==ElementTypes.IMAGE_CROP)},Canvas.prototype._cancelImageCrop=function(){var image;this.imageCrop&&(image=this.imageCrop.image,image.onCancelCrop(),this.view.removeNode(this.imageCrop.view.domElement),this.imageCrop=null,this._select([image]),this.highlightSelect.view.domElement.removeEventListener("dblclick",this.eventsRef.onCrop),this.Page.emit(Events.CROP_DEACTIVATE))},Canvas.prototype._cancelImageEdit=function(){var image;this.imageEdit&&(image=this.imageEdit.image,image.removeLinkedElement(this.imageEdit),this.view.removeNode(this.imageEdit.view.domElement),this.imageEdit.destroy(),this.imageEdit=null)},Canvas.prototype._addDesignModeEvents=function(){this.highlightPart.view.domElement.addEventListener("mousedown",function(){this.highlightSelectedPart.show()}.bind(this)),this.highlightSelect.view.domElement.addEventListener("mousedown",this.eventsRef.onStartDrag),this.highlightSelect.view.domElement.addEventListener("mousemove",this.eventsRef.onBlockHighlightElement),this.view.containerDomElement.addEventListener("mousemove",this.eventsRef.onHighlightElement),this.view.containerDomElement.addEventListener("mousedown",this.eventsRef.onMouseDown),this.view.containerDomElement.addEventListener("dblclick",this.eventsRef.onDoubleClick),this.view.containerDomElement.addEventListener("dragenter",this.eventsRef.onDragenter),this.view.containerDomElement.addEventListener("dragover",this.eventsRef.onDragover),this.view.containerDomElement.addEventListener("dragleave",this.eventsRef.onDragleave),this.view.containerDomElement.addEventListener("drop",this.eventsRef.onDrop),this.view.containerDomElement.addEventListener("scroll",this.eventsRef.onScroll)},Canvas.prototype._removeDesignModeEvents=function(){this.highlightSelect.view.domElement.removeEventListener("mousedown",this.eventsRef.onStartDrag),this.highlightSelect.view.domElement.removeEventListener("mousemove",this.eventsRef.onBlockHighlightElement),this.view.containerDomElement.removeEventListener("mousemove",this.eventsRef.onHighlightElement),this.view.containerDomElement.removeEventListener("mousedown",this.eventsRef.onMouseDown),this.view.containerDomElement.removeEventListener("dblclick",this.eventsRef.onDoubleClick),this.view.containerDomElement.removeEventListener("dragenter",this.eventsRef.onDragenter),this.view.containerDomElement.removeEventListener("dragover",this.eventsRef.onDragover),this.view.containerDomElement.removeEventListener("dragleave",this.eventsRef.onDragleave),this.view.containerDomElement.removeEventListener("drop",this.eventsRef.onDrop),this.view.containerDomElement.removeEventListener("scroll",this.eventsRef.onScroll)},Canvas.prototype._addEvents=function(){this.Page.isDesignMode()&&this._addDesignModeEvents(),document.addEventListener("keydown",this.eventsRef.onKeyDown,!0)},Canvas.prototype._removeEvents=function(){this.Page.isDesignMode()&&this._removeDesignModeEvents(),document.removeEventListener("keydown",this.eventsRef.onKeyDown,!0)},Canvas.prototype._updateRelativeRectangle=function(){this.domElementRect=this.view.domElement.getClientRects()[0]},Canvas.prototype._getRelativeMousePosition=function(e){var position={x:e.pageX-this.domElementRect.left,y:e.pageY-this.domElementRect.top};return position},Canvas.prototype._getRelativeScaledMousePosition=function(e){var mousePosition=this._getRelativeMousePosition(e);return{x:mousePosition.x/this.scale,y:mousePosition.y/this.scale}},Canvas.prototype._getChildren=function(){var editingComponent=this.Page.ElementsManager.getEditingComponent();return editingComponent?editingComponent.children:this.children},Canvas.prototype._getVisibleAndUnlockedElements=function(elements){return _.filter(elements,function(element){return element.isVisible()&&element.isUnlocked()&&!element.isEditByCollaborator()})},Canvas.prototype._isLockedElementOnElementsList=function(elements){return _.some(elements,function(element){return element.locked})},Canvas.prototype._getRulerRef=function(orientation){return this.rulersRef[orientation]||(this.rulersRef[orientation]=document.querySelector("."+this.Page.options.rulerElClass+"."+orientation)),this.rulersRef[orientation]},Canvas.prototype._elementNameHide=function(){this.elementName.hide()},Canvas.prototype._elementNameShow=function(element,e){var mousePosition=this._getRelativeMousePosition(e);this.elementName.setName(element.name),this.elementName.setPosition(mousePosition.x+INDICATOR_POSITION_DELTA,mousePosition.y+INDICATOR_POSITION_DELTA),this.elementName.show()},Canvas.prototype._mouseMove=function(){this.elementName.hide(),this.highlight.hide(),this.mouseMoved=!0,this.Page.ElementsManager.startBatch(!0)},Canvas}()},{"../enums/ElementTypes.js":184,"../enums/Events.js":185,"../enums/InteractionTriggers.js":188,"../enums/Keys.js":190,"../enums/Orientations.js":193,"../enums/PageModes.js":194,"../enums/Properties.js":195,"../primitives/Point.js":211,"../primitives/Rectangle.js":212,"../utils/Base.js":213,"../utils/Tree.js":223,"./Group.js":42,"./behaviors/Gridable.js":78,"./behaviors/Guideable.js":79,"./behaviors/Pickable.js":85,"./helpers/AlignHelper.js":91,"./helpers/ArrangeHelper.js":92,"./helpers/ClipboardHelper.js":94,"./helpers/DragAndDropHelper.js":95,"./helpers/ElementsHelper.js":97,"./helpers/ImageEditor.js":98,"./helpers/MouseHelper.js":99,"./helpers/SelectionHelper.js":102,"./helpers/SnappingHelper.js":103,"./helpers/TextEditor.js":105,"./ui/Collaborator.js":111,"./ui/ElementIndicator.js":112,"./ui/ElementName.js":113,"./ui/GuidePosition.js":115,"./ui/Highlight.js":116,"./ui/HighlightCellResizer.js":117,"./ui/HighlightEdit.js":118,"./ui/HighlightEditClipped.js":119,"./ui/HighlightPart.js":120,"./ui/HighlightSelect.js":121,"./ui/MultiSelect.js":125,"./ui/Smartguide.js":126,"./views/CanvasView.js":147,lodash:19}],32:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),CheckboxView=_dereq_("./views/CheckboxView.js");module.exports=function(){function Checkbox(){AbstractElement.apply(this,arguments),this.type=ElementTypes.CHECKBOX,this.view=this.createView(CheckboxView)}return Checkbox.DefaultProperties={width:{value:150},height:{value:17,min:17},disabled:{value:0},checked:{value:!1},elementPosition:{value:"left"},inputValue:{value:"label"},textAlign:{value:"left"},color:{value:"#000000"}},Base.Extend(Checkbox,AbstractElement),Base.ApplyBehavior(Checkbox,TextEditable),Object.defineProperties(Checkbox.prototype,{checked:{
get:function(){return this._checked},set:function(value){this._saveProperty(),this._checked=value,this.view.setChecked(value)}},disabled:{get:function(){return this._disabled},set:function(value){this._saveProperty(),this._disabled=value,this.view.setDisabled(value)}},elementPosition:{get:function(){return this._elementPosition},set:function(value){this._saveProperty(),this._elementPosition=value,this.view.setPosition(value)}}}),Checkbox}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/TextEditable.js":88,"./views/CheckboxView.js":148}],33:[function(_dereq_,module,exports){"use strict";var Box=_dereq_("./Box.js"),CircleView=_dereq_("./views/CircleView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Circle(){Box.apply(this,arguments),this.type=ElementTypes.CIRCLE,this.view=this.createView(CircleView)}return Circle.DefaultProperties={width:{value:200},height:{value:200}},Circle.ExcludedProperties={borderTopLeftRadius:!0,borderTopRightRadius:!0,borderBottomRightRadius:!0,borderBottomLeftRadius:!0},Base.Extend(Circle,Box),Circle}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./Box.js":29,"./views/CircleView.js":149}],34:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),ClipartView=_dereq_("./views/ClipartView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Clipart(){AbstractElement.apply(this,arguments),this.type=ElementTypes.CLIPART,this.view=this.createView(ClipartView)}return Clipart.DefaultProperties={src:{value:""},idStoredFile:{value:""},clickIdPage:{value:""}},Base.Extend(Clipart,AbstractElement),Object.defineProperties(Clipart.prototype,{src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this.view.setSrc(this._getCdnUrl(value))}},idStoredFile:{get:function(){return this._idStoredFile},set:function(value){this._saveProperty(),this._idStoredFile=value}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}}}),Clipart}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/ClipartView.js":150}],35:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),AbstractElement=_dereq_("./AbstractElement.js"),Group=_dereq_("./Group.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ElementsHelper=(_dereq_("../ElementsFactory"),_dereq_("./helpers/ElementsHelper")),ComponentView=_dereq_("./views/ComponentView.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function Component(){Group.apply(this,arguments),this.type=ElementTypes.COMPONENT,this.view=this.createView(ComponentView),this._shouldUpdateElements=!1,this._elements={}}return Component.DefaultProperties={idComponent:{value:""}},Component.ExcludedProperties={storedElements:!0,x:!1,y:!1},Base.Extend(Component,Group),Object.defineProperties(Component.prototype,{shouldUpdateElements:{get:function(){return this._shouldUpdateElements},set:function(value){this._shouldUpdateElements=value,value&&(this.dirty=value)}},idComponent:{get:function(){return this._idComponent},set:function(value){this._saveProperty(),value=value.toString(),value&&this.Page.ElementsManager.getComponentById(value)&&(this.shouldUpdateElements=!0),this._idComponent=value}}}),Component.prototype.isGroup=function(){return!1},Component.prototype.isComponent=function(){return!0},Component.prototype.update=function(){this.shouldUpdateElements&&(this.shouldUpdateElements=!1,this._updateElements(this.idComponent)),Group.prototype.update.call(this)},Component.prototype.serialize=function(){var serialized=Group.prototype.serialize.call(this);return serialized},Component.prototype.getElements=function(){return this._elements},Component.prototype.hitTest=function(p){return this._preventHit(p)?null:this.Page.isPickMode()&&this.rect.hitTest(p)?this:this._hitTestOverChildren(this.children,p)},Component.prototype.clone=function(props){return AbstractElement.prototype.clone.call(this,props)},Component.prototype.isEditByCollaborator=function(){return AbstractElement.prototype.isEditByCollaborator.call(this)||_.some(this.children,function(child){return child.isEditByCollaborator()})},Component.prototype.collaborationUpdateComponent=function(component,nextComponent,changedElements){var x=this.x,y=this.y,shouldExcludeProperty=function(element,propertyName){return(!element.isComponent()||"storedElements"!==propertyName)&&(element.ExcludedProperties&&!_.isUndefined(element.ExcludedProperties[propertyName]))},currentChildrenIds=Object.keys(component),nextChildrenIds=Object.keys(nextComponent),changedElementsIds=_.map(changedElements,"id"),toRemove=_.difference(currentChildrenIds,nextChildrenIds),toAdd=_.sortBy(_.difference(nextChildrenIds,currentChildrenIds),function(id){return changedElementsIds.indexOf(id)});toRemove.forEach(function(id){var child=this.Page.ElementsManager.getElementById(id,this.id);child&&child.parent&&child.parent.removeChild(child)}.bind(this)),toAdd.forEach(function(id){var element=this.Page.ElementsManager.createElementComponentFromCollaboration(id,nextComponent[id],this);this.addChildAt(element,nextChildrenIds.indexOf(id)),element.resetIndicators()}.bind(this)),_.intersection(nextChildrenIds,currentChildrenIds).forEach(function(id){var child=this.Page.ElementsManager.getElementById(id,this.id);!child||child instanceof Group||(child[Properties.X]=nextComponent[id].props[Properties.X],child[Properties.Y]=nextComponent[id].props[Properties.Y])}.bind(this)),_.forEach(changedElements,function(changedElement){var element=changedElement.id===ElementsHelper.CANVAS_ID?this:this.Page.ElementsManager.getElementById(changedElement.id,this.id);element&&(_.forEach(changedElement.data.props,function(value,property){shouldExcludeProperty(element,property)||element._updateProperty(property,value,!0)}),element.dirty=!0,element.resetIndicators())}.bind(this)),this._updateBoundingBox(),this.x=x,this.y=y,Group.prototype.update.call(this)},Component.prototype._updateElements=function(componentId){var x=this.x,y=this.y;this._clear(),this.addChildren(this.Page.ElementsManager.createComponentElements(this,componentId)),this._updateBoundingBox(),this.x=x,this.y=y},Component.prototype._clear=function(){for(this._elements={};this.children.length;)this.children.pop();for(;this.storedElements.length;)this.storedElements.pop();var range=document.createRange();range.selectNodeContents(this.view.domElement),range.deleteContents()},Component.prototype._getElementById=function(id){return this._elements[id]},Component}()},{"../ElementsFactory":20,"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./AbstractElement.js":24,"./Group.js":42,"./helpers/ElementsHelper":97,"./views/ComponentView.js":151,lodash:19}],36:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function CostcoIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.COSTCO_ICON}return Base.Extend(CostcoIcon,SvgIcon),CostcoIcon}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],37:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),DialogView=_dereq_("./views/DialogView.js");module.exports=function(){function Dialog(){AbstractElement.apply(this,arguments),this.type=ElementTypes.DIALOG,this.view=this.createView(DialogView)}return Dialog.DefaultProperties={width:{value:350},height:{value:200},backgroundColor:{value:"#F7F5F5"},borderColor:{value:"#C7C7C7"},borderStyle:{value:"solid"},borderRadius:{value:0},borderWidth:{value:1},contentBackgroundColor:{value:"#FFFFFF"},contentText:{value:"Lorem ipsum dolor sit amet interdum lacus tortor sociis a! Purus gravida Praesent tortor. Consequat a ultrices auctor! Adipiscing. Risus viverra. Augue Sed, et auctor vehicula Etiam consequat. Mus placerat Sed sit placerat. Ut."},contentColor:{value:"#666666"},contentFontWeight:{value:"normal"},contentFontStyle:{value:"normal"},contentFontSize:{value:"14px"},contentFontFamily:{value:"Arial"},contentTextAlign:{value:"none"},topbarDisplay:{value:"block"},topbarBackgroundColor:{value:"#C7C7C7"},topbarText:{value:"Dialog title"},topbarColor:{value:"#363636"},topbarFontWeight:{value:"bold"},topbarFontStyle:{value:"normal"},topbarFontSize:{value:"14px"},topbarFontFamily:{value:"Arial"},topbarTextAlign:{value:"normal"},bottombarDisplay:{value:"block"},bottombarBackgroundColor:{value:"#F7F5F5"},modalOverlayDisplay:{value:"none"}},Base.Extend(Dialog,AbstractElement),Object.defineProperties(Dialog.prototype,{backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(),this._backgroundColor=value,this.view.setBackgroundColor(value)}},borderColor:{get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderRadius:{get:function(){return this._borderRadius},set:function(value){this._saveProperty(),this._borderRadius=value,this.view.setBorderRadius(value)}},borderWidth:{get:function(){return this._borderWidth},set:function(value){this._saveProperty(),this._borderWidth=value,this.view.setBorderWidth(value)}},bottombarDisplay:{get:function(){return this._bottombarDisplay},set:function(value){this._saveProperty(),this._bottombarDisplay=value,this.view.setBottombarDisplay(value)}},bottombarBackgroundColor:{get:function(){return this._bottombarBackgroundColor},set:function(value){this._saveProperty(),this._bottombarBackgroundColor=value,this.view.setBottombarBackgroundColor(value)}},contentBackgroundColor:{get:function(){return this._contentBackgroundColor},set:function(value){this._saveProperty(),this._contentBackgroundColor=value,this.view.setContentBackgroundColor(value)}},contentText:{get:function(){return this._contentText},set:function(value){this._saveProperty(),this._contentText=value,this.view.setContentText(value)}},contentColor:{get:function(){return this._contentColor},set:function(value){this._saveProperty(),this._contentColor=value,this.view.setContentColor(value)}},contentFontWeight:{get:function(){return this._contentFontWeight},set:function(value){this._saveProperty(),this._contentFontWeight=value,this.view.setContentFontWeight(value)}},contentFontStyle:{get:function(){return this._contentFontStyle},set:function(value){this._saveProperty(),this._contentFontStyle=value,this.view.setContentFontStyle(value)}},contentFontSize:{get:function(){return this._contentFontSize},set:function(value){this._saveProperty(),this._contentFontSize=value,this.view.setContentFontSize(value)}},contentFontFamily:{get:function(){return this._contentFontFamily},set:function(value){this._saveProperty(),this._contentFontFamily=value,this.view.setContentFontFamily(value)}},contentTextAlign:{get:function(){return this._contentTextAlign},set:function(value){this._saveProperty(),this._contentTextAlign=value,this.view.setContentTextAlign(value)}},topbarDisplay:{get:function(){return this._topbarDisplay},set:function(value){this._saveProperty(),this._topbarDisplay=value,this.view.setTopbarDisplay(value)}},topbarBackgroundColor:{get:function(){return this._topbarBackgroundColor},set:function(value){this._saveProperty(),this._topbarBackgroundColor=value,this.view.setTopbarBackgroundColor(value)}},topbarText:{get:function(){return this._topbarText},set:function(value){this._saveProperty(),this._topbarText=value,this.view.setTopbarText(value)}},topbarColor:{get:function(){return this._topbarColor},set:function(value){this._saveProperty(),this._topbarColor=value,this.view.setTopbarColor(value)}},topbarFontWeight:{get:function(){return this._topbarFontWeight},set:function(value){this._saveProperty(),this._topbarFontWeight=value,this.view.setTopbarFontWeight(value)}},topbarFontStyle:{get:function(){return this._topbarFontStyle},set:function(value){this._saveProperty(),this._topbarFontStyle=value,this.view.setTopbarFontStyle(value)}},topbarFontSize:{get:function(){return this._topbarFontSize},set:function(value){this._saveProperty(),this._topbarFontSize=value,this.view.setTopbarFontSize(value)}},topbarFontFamily:{get:function(){return this._topbarFontFamily},set:function(value){this._saveProperty(),this._topbarFontFamily=value,this.view.setTopbarFontFamily(value)}},topbarTextAlign:{get:function(){return this._topbarTextAlign},set:function(value){this._saveProperty(),this._topbarTextAlign=value,this.view.setTopbarTextAlign(value)}},modalOverlayDisplay:{get:function(){return this._modalOverlayDisplay},set:function(value){this._saveProperty(),this._modalOverlayDisplay=value,this.view.setModalOverlayDisplay(value)}}}),Dialog}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/DialogView.js":152}],38:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function FontAwesome(){SvgIcon.apply(this,arguments),this.type=ElementTypes.FONT_AWESOME}return Base.Extend(FontAwesome,SvgIcon),FontAwesome}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],39:[function(_dereq_,module,exports){"use strict";var EventEmitter=_dereq_("event-emitter");module.exports=function(){function FrameworkElement(){this._callBehaviorsConstructors()}return FrameworkElement.prototype=Object.create(EventEmitter.methods),FrameworkElement.constructor=FrameworkElement,FrameworkElement.prototype.DefaultProperties={},FrameworkElement.prototype.ExcludedProperties={},FrameworkElement.prototype.AppliedBehaviors=[],FrameworkElement.prototype._callBehaviorsConstructors=function(){this.AppliedBehaviors.forEach(function(behavior){behavior.call(this)}.bind(this))},FrameworkElement}()},{"event-emitter":3}],40:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),GeoSvgView=_dereq_("./views/GeoSvgView.js");module.exports=function(){function GeoSvg(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GEO_SVG,this.view=this.createView(GeoSvgView)}var ELEMENTS={star:{tag:"polygon",data:[{attributeName:"points",attributeValue:"68,60 100,40 61,40 50,0 39,40 0,40 32,60 20,100 50,72 80,100"}]},rhombus:{tag:"polygon",data:[{attributeName:"points",attributeValue:"0,50 50,0 100,50, 50,100"}]},parallel:{tag:"polygon",data:[{attributeName:"points",attributeValue:"0,100 50,100 100,0 50,0"}]},ellipse:{tag:"ellipse",data:[{attributeName:"cx",attributeValue:"50"},{attributeName:"cy",attributeValue:"50"},{attributeName:"rx",attributeValue:"50"},{attributeName:"ry",attributeValue:"50"}]},triangle:{tag:"polygon",data:[{attributeName:"points",attributeValue:"0,100 50,0, 100,100"}]},triangle2:{tag:"polygon",data:[{attributeName:"points",attributeValue:"100,0 0,0, 0,100"}]}};return GeoSvg.DefaultProperties={color:{value:"#ebebeb"},element:{value:"triangle",options:Object.keys(ELEMENTS)},width:{value:100},height:{value:100}},Base.Extend(GeoSvg,AbstractElement),Object.defineProperties(GeoSvg.prototype,{color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},element:{get:function(){return this._element},set:function(value){this._saveProperty(),this._element=value,this.view.setElement(ELEMENTS[value])}}}),GeoSvg}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/GeoSvgView.js":154}],41:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),GlassCanvasView=_dereq_("./views/GlassCanvasView.js"),Boxable=_dereq_("./behaviors/Boxable.js");module.exports=function(){function GlassCanvas(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GLASS_CANVAS,this.view=this.createView(GlassCanvasView)}return GlassCanvas.DefaultProperties={width:{value:1280},height:{value:768},backgroundImage:{value:"/p/elements/googleglass/bg_los_angeles.jpg"},idStoredFile:{value:""}},Base.Extend(GlassCanvas,AbstractElement),Base.ApplyBehavior(GlassCanvas,Boxable),Object.defineProperties(GlassCanvas.prototype,{idStoredFile:{get:function(){return this._idStoredFile},set:function(value){this._saveProperty(),this._idStoredFile=value}}}),GlassCanvas}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/Boxable.js":77,"./views/GlassCanvasView.js":155}],42:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),_=_dereq_("lodash"),ElementTypes=_dereq_("../enums/ElementTypes.js"),GroupView=_dereq_("./views/GroupView.js"),Point=_dereq_("../primitives/Point.js"),Rectangle=_dereq_("../primitives/Rectangle.js"),Properties=_dereq_("../enums/Properties.js"),Events=_dereq_("../enums/Events.js"),Logger=_dereq_("../utils/Logger.js");module.exports=function(){function deleteLinkedElements(child){child.deleteLinkedElements()}function Group(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GROUP,this.view=this.createView(GroupView),this._storedElements=[],this._clippingRect=new Rectangle,this._isEditable=!1,this._isResizing=!1,this.children=[]}return Group.DefaultProperties={isClip:{value:!1},clip:{value:{}},isClipScrollX:{value:!1},isClipScrollY:{value:!1},storedElements:{value:[]}},Group.ExcludedProperties={x:!0,y:!0,width:!0,height:!0},Base.Extend(Group,AbstractElement),Object.defineProperties(Group.prototype,{rect:{get:function(){return this.isClip?this._clippingRect:this._rect}},isClip:{get:function(){return this._isClip},set:function(value){this._saveProperty(),this._isClip=value,this.view.setClip(value)}},clip:{get:function(){return this._clip},set:function(value){var changed=!_.isEqual(this._clip,value)&&!_.isEmpty(value)||!_.isEmpty(this._clip);this._saveProperty(),this._clip=value,changed&&this._updateClip(value)}},isClipScrollX:{get:function(){return this._isClipScrollX},set:function(value){this._saveProperty(),this._isClipScrollX=value,this.view.setClipScrollX(value)}},isClipScrollY:{get:function(){return this._isClipScrollY},set:function(value){this._saveProperty(),this._isClipScrollY=value,this.view.setClipScrollY(value)}},storedElements:{get:function(){return this._storedElements},set:function(value){this._saveProperty(),this._updateStoredElements(value),this._updateStoredElementsOrder(value),this.dirty=!0}},x:{get:function(){return this.rect.x},set:function(value){var child,delta=value-this.x;if(this._saveProperty(),this.rect.x=value,this.isClip&&this._updateProperty(Properties.CLIP,this.rect.serialize(),!0),!this.isClip||!this._isResizing)for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child.x+=delta;this.dirty=!0,this.dirtyPosition=!0}},y:{get:function(){return this.rect.y},set:function(value){var child,delta=value-this.y;if(this._saveProperty(),this.rect.y=value,this.isClip&&this._updateProperty(Properties.CLIP,this.rect.serialize(),!0),!this.isClip||!this._isResizing)for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child.y+=delta;this.dirty=!0,this.dirtyPosition=!0}},width:{get:function(){return this.rect.width},set:function(value){if(this.isClip)return this.rect.width=value,void this._updateProperty(Properties.CLIP,this.rect.serialize(),!0);var bb=this.getBoundingBox(),p=new Point(bb.x+this.anchorX*bb.width,bb.y+this.anchorY*bb.height),scaleX=value/bb.width,scaleY=1;this.containsRotatedElement()&&(scaleY=value*(bb.height/bb.width)/this.height),this.resizeFromPoint(scaleX,scaleY,p),this.dirtyPosition=!0}},height:{get:function(){return this.rect.height},set:function(value){if(this.isClip)return this.rect.height=value,void this._updateProperty(Properties.CLIP,this.rect.serialize(),!0);var bb=this.getBoundingBox(),p=new Point(bb.x+this.anchorX*bb.width,bb.y+this.anchorY*bb.height),scaleX=1,scaleY=value/bb.height;this.containsRotatedElement()&&(scaleX=value*(bb.width/bb.height)/this.width),this.resizeFromPoint(scaleX,scaleY,p),this.dirtyPosition=!0}},angle:{get:function(){return this.rect.angle},set:function(value){var delta=value-this.angle;this.rotateByFromPoint(this.rect.getCenterPoint(),delta)}}}),Group.prototype.isGroup=function(){return!0},Group.prototype.updateChildren=function(immediate){for(var child,i=0,len=this.children.length;i<len;i++)child=this.children[i],immediate?child.update():child._dirty=!0,child instanceof Group&&child.updateChildren(immediate)},Group.prototype.resizeFromPoint=function(scaleX,scaleY,point){for(var child,i=0,len=this.children.length;i<len;i++)child=this.children[i],child.resizeFromPoint(scaleX,scaleY,point);this.isClip&&this._saveProperty(),this._updateBoundingBox(),this.dirty=!0,this.dirtyPosition=!0},Group.prototype.rotateByFromPoint=function(point,delta,updateChildren){var child;if(updateChildren=!!_.isUndefined(updateChildren)||updateChildren,this.isClip)return this.rect.angle+=delta,void this._updateProperty(Properties.CLIP,this.rect.serialize(),!0);if(this._saveProperty(),this.rect.angle+=delta,updateChildren)for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child.rotateByFromPoint(point,delta);this.dirty=!0,this.dirtyPosition=!0},Group.prototype.collaborationUpdateAngle=function(value){var delta=value-this.angle;this.rotateByFromPoint(null,delta,!1)},Group.prototype.setEditable=function(group,selectedChildren){this.isClip&&(this._isEditable=!!group,group?this.view.domElement.classList.add("clipped-edit"):this.view.domElement.classList.remove("clipped-edit")),this.parent&&this.parent.setEditable(group?this:null,selectedChildren)},Group.prototype.selectChildren=function(elements){this.parent&&this.parent.selectChildren(elements)},Group.prototype.addChildren=function(children){for(var child,i=0,len=children.length;i<len;i++)child=children[i],this._add(child),child.resetIndicators();this.dirty=!0},Group.prototype.addChild=function(child){this._add(child),this.dirty=!0},Group.prototype.addChildAt=function(child,index){this._add(child,index),this.dirty=!0},Group.prototype.replaceChild=function(newChild,oldChild){var index=this.getChildIndex(oldChild);this._replace(newChild,index),this.dirty=!0},Group.prototype.getChildAt=function(index){return this.children[index]},Group.prototype.getFirstChild=function(){return this.getChildAt(0)},Group.prototype.getChildIndex=function(child){return this.children.indexOf(child)},Group.prototype.moveChildAt=function(child,index){var currentIndex=this.getChildIndex(child);this._remove(child,currentIndex),this._add(child,index),this.dirty=!0,this.emit(Events.GROUP_REORDER)},Group.prototype.removeChild=function(child){var index=this.getChildIndex(child);if(!(index>-1))throw new Error("Element "+child.name+" is not a child of Group "+this.name);deleteLinkedElements(child),this._remove(child,index),this.dirty=!0},Group.prototype.removeAllChildren=function(){_.forEach(this.children,deleteLinkedElements),this._removeAll(),this.dirty=!0},Group.prototype.hitTest=function(p){return this._preventHit(p)?null:this._hitTestOverChildren(this.children,p)},Group.prototype.update=function(){for(var child,i=0,len=this.children.length;i<len;i++)child=this.children[i],child._dirty&&(child._dirty=!1,child.update());this._updateBoundingBox(),AbstractElement.prototype.update.call(this)},Group.prototype.containsRotatedElement=function(){for(var containsRotatedElement,i=0;i<this.children.length;i++)if(containsRotatedElement=this.children[i].containsRotatedElement())return!0;return!1},Group.prototype.clone=function(props){var storedElements=_.map(this.children,function(child){return child.clone().id});return AbstractElement.prototype.clone.call(this,_.extend({storedElements:storedElements},props))},Group.prototype.initProperties=function(props){props.isClip&&(props.clip=props.clip||{x:props[Properties.X],y:props[Properties.Y],width:props[Properties.WIDTH],height:props[Properties.HEIGHT],angle:0},this._clippingRect=new Rectangle(props.clip.x,props.clip.y,props.clip.width,props.clip.height,props.clip.angle)),AbstractElement.prototype.initProperties.call(this,props)},Group.prototype.clipGroup=function(value){this._updateProperty(Properties.IS_CLIP,value,!0),this._updateProperty(Properties.CLIP,value?this._rect.serialize():{},!0)},Group.prototype._updateClip=function(value){_.isEmpty(value)?(this._clippingRect=new Rectangle,this._rect=new Rectangle):(this._clippingRect.x=value.x,this._clippingRect.y=value.y,this._clippingRect.width=value.width,this._clippingRect.height=value.height,this._clippingRect.angle=value.angle),this.dirty=!0,this.updateChildren()},Group.prototype._updateBoundingBox=function(){if(this.children.length){var bb,child,p=new Point(0,0),angle=this.angle;this._rect=null;for(var i=0,len=this.children.length;i<len;i++)child=this.children[i],child instanceof Group&&child._updateBoundingBox(),bb=child.getBoundingBox(!1).clone(),bb.rotateBy(p,-angle),this._rect?this._rect=this._rect.add(bb):this._rect=len>1?bb:bb.getBoundingBox(!0);this._rect.rotateBy(p,angle),this.dirtyPosition=!0}},Group.prototype._add=function(child,index){var storedElements=_.clone(this._storedElements);"undefined"!=typeof index&&index<this.children.length?storedElements.splice(index,0,child.id):storedElements.push(child.id),this._updateProperty(Properties.STORED_ELEMENTS,storedElements,!0)},Group.prototype._remove=function(child,index){var storedElements=_.clone(this._storedElements);storedElements.splice(index,1),this._updateProperty(Properties.STORED_ELEMENTS,storedElements,!0)},Group.prototype._removeAll=function(){this._updateProperty(Properties.STORED_ELEMENTS,[],!0)},Group.prototype._replace=function(newChild,index){var storedElements=_.clone(this._storedElements);storedElements[index]=newChild.id,this._updateProperty(Properties.STORED_ELEMENTS,storedElements,!0)},Group.prototype._updateStoredElements=function(elements){_.difference(elements,this._storedElements).length&&this._addToStoredElements(elements),_.difference(this._storedElements,elements).length&&this._removeFromStoredElements(elements)},Group.prototype._updateStoredElementsOrder=function(elements){var everyElementsInSameOrder=_.every(this._storedElements,function(elementId,index){return elements[index]===elementId});if(!everyElementsInSameOrder){var sortOrder=_.reduce(elements,function(sortOrder,elementId,order){return sortOrder[elementId]=order,sortOrder},{});this._storedElements.sort(function(value,other){return sortOrder[value]-sortOrder[other]}.bind(this)),this.children.sort(function(value,other){return sortOrder[value.id]-sortOrder[other.id]}.bind(this)),this._sortChildren()}},Group.prototype._sortChildren=function(){for(var length=this.children.length;--length>0;)this.view.domElement.insertBefore(this.children[length-1].view.domElement,this.children[length].view.domElement)},Group.prototype._addToStoredElements=function(elements){var child,index;_.forEach(_.difference(elements,this._storedElements),function(elementId){return child=this._getElementById(elementId),index=elements.indexOf(elementId),child?(child.parent&&child.parent.removeChild(child),child.setParent(this),void(index<this.children.length?(this.view.domElement.insertBefore(child.view.domElement,this.children[index].view.domElement),this.children.splice(index,0,child),this._storedElements.splice(index,0,elementId)):(this.view.domElement.appendChild(child.view.domElement),this.children.push(child),this._storedElements.push(elementId)))):Logger.error("Child (id: "+elementId+") not found in "+this.type+" (id: "+this.id+")")}.bind(this))},Group.prototype._removeFromStoredElements=function(elements){var child,index;_.forEach(_.difference(this._storedElements,elements),function(elementId){child=this._getElementById(elementId),index=this.getChildIndex(child),child.parent===this&&(child.setParent(null),this.view.domElement.removeChild(child.view.domElement)),this.children.splice(index,1),this._storedElements.splice(index,1)}.bind(this))},Group.prototype._preventHit=function(p){return!this.isVisible()||this.isClip&&!this._isEditable&&!this.rect.hitTest(p)},Group.prototype._hitTestOverChildren=function(children,p){for(var child,i=children.length;i-- >0;)if(child=children[i].hitTest(p))return child;return null},Group.prototype._getElementById=function(id){return this.componentInstance?this.componentInstance._getElementById(id):this.Page.ElementsManager.getElementById(id)},Group}()},{"../enums/ElementTypes.js":184,"../enums/Events.js":185,"../enums/Properties.js":195,"../primitives/Point.js":211,"../primitives/Rectangle.js":212,"../utils/Base.js":213,"../utils/Logger.js":218,"./AbstractElement.js":24,"./views/GroupView.js":156,lodash:19}],43:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Group=_dereq_("./Group.js"),Base=_dereq_("../utils/Base.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function GroupingInstance(){Group.apply(this,arguments)}return Base.Extend(GroupingInstance,Group),GroupingInstance.prototype.initProperties=function(props){props.initElements&&(props.storedElements=this._initChildren(props)),Group.prototype.initProperties.call(this,props)},GroupingInstance.prototype._initChildren=function(props){var elements=this.Page.ElementsManager.createGroupedElements(JSON.parse(props.initElements),props[Properties.X],props[Properties.Y]);return _.map(elements,function(element){return element.id})},GroupingInstance}()},{"../enums/Properties.js":195,"../utils/Base.js":213,"./Group.js":42,lodash:19}],44:[function(_dereq_,module,exports){"use strict";var Scrollbar=_dereq_("./Scrollbar.js"),HorizontalScrollbarView=_dereq_("./views/HorizontalScrollbarView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function HorizontalScrollbar(){Scrollbar.apply(this,arguments),this.type=ElementTypes.HORIZONTAL_SCROLLBAR,this.view=this.createView(HorizontalScrollbarView)}return HorizontalScrollbar.DefaultProperties={width:{value:150,min:2*Scrollbar.SCROLL_BUTTON_SIZE},height:{value:Scrollbar.SCROLL_BUTTON_SIZE,min:Scrollbar.SCROLL_BUTTON_SIZE}},Base.Extend(HorizontalScrollbar,Scrollbar),Object.defineProperties(HorizontalScrollbar.prototype,{scrollPosition:{get:function(){return this._scrollPosition},set:function(value){this._saveProperty(),this._scrollPosition=value,this.view.setScrollPosition(value,this.width)}}}),HorizontalScrollbar}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./Scrollbar.js":62,"./views/HorizontalScrollbarView.js":157}],45:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),HotspotView=_dereq_("./views/HotspotView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Hotspot(){AbstractElement.apply(this,arguments),this.type=ElementTypes.HOTSPOT,this.view=this.createView(HotspotView)}return Base.Extend(Hotspot,AbstractElement),Hotspot}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/HotspotView.js":158}],46:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),AbstractElement=_dereq_("./AbstractElement.js"),Uploadable=_dereq_("./behaviors/Uploadable.js"),ImageView=_dereq_("./views/ImageView.js"),ImageEditor=_dereq_("./helpers/ImageEditor.js"),Events=_dereq_("../enums/Events.js");
module.exports=function(){function extractFileNameFromPath(path){return path.replace(/^.*\//,"").replace(/\?.*$/,"")}function Image(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE,this.view=this.createView(ImageView),this._uploadCancelled=!1,this.isDuringProcessing=!1}var EMPTY_PLACEHOLDER="/p/imagepixel.png",adjustmentProperties=[Properties.BRIGHTNESS,Properties.CONTRAST,Properties.SATURATION,Properties.VIBRANCE,Properties.EXPOSURE,Properties.SHARPEN,Properties.BLUR];return Image.DefaultProperties={width:{value:150},height:{value:150},borderTopLeftRadius:{value:0},borderTopRightRadius:{value:0},borderBottomRightRadius:{value:0},borderBottomLeftRadius:{value:0},radiusLock:{value:!0},src:{value:EMPTY_PLACEHOLDER},srcMod:{value:""},brightness:{value:0},contrast:{value:0},saturation:{value:0},vibrance:{value:0},exposure:{value:0},sharpen:{value:0},blur:{value:0},crop:{value:[]}},Base.Extend(Image,AbstractElement),Base.ApplyBehavior(Image,Uploadable),Object.defineProperties(Image.prototype,{shouldUpdateSrc:{get:function(){return this._shouldUpdateSrc},set:function(value){this._shouldUpdateSrc=value,value&&(this.dirty=value)}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=value,this.view.setBorderTopLeftRadius(value)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=value,this.view.setBorderTopRightRadius(value)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=value,this.view.setBorderBottomRightRadius(value)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=value,this.view.setBorderBottomLeftRadius(value)}},radiusLock:{get:function(){return this._radiusLock},set:function(value){this._saveProperty(),this._radiusLock=value}},src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this._resetModifications(),this.shouldUpdateSrc=!0}},srcMod:{get:function(){return this._srcMod},set:function(value){this._saveProperty(),this._srcMod=value,this.shouldUpdateSrc=!0}},brightness:{get:function(){return this._brightness},set:function(value){this._saveProperty(),this._brightness=value,this.dirty=!0}},contrast:{get:function(){return this._contrast},set:function(value){this._saveProperty(),this._contrast=value,this.dirty=!0}},saturation:{get:function(){return this._saturation},set:function(value){this._saveProperty(),this._saturation=value,this.dirty=!0}},vibrance:{get:function(){return this._vibrance},set:function(value){this._saveProperty(),this._vibrance=value,this.dirty=!0}},exposure:{get:function(){return this._exposure},set:function(value){this._saveProperty(),this._exposure=value,this.dirty=!0}},sharpen:{get:function(){return this._sharpen},set:function(value){this._saveProperty(),this._sharpen=value,this.dirty=!0}},blur:{get:function(){return this._blur},set:function(value){this._saveProperty(),this._blur=value,this.dirty=!0}},crop:{get:function(){return this._crop},set:function(value){this._saveProperty(),this._crop=value,this.cancelUpload()}}}),Image.prototype.setLoading=function(value){this.view.setLoading(value)},Image.prototype.updateCrop=function(imageRect,cropRect,src){var crop=_.clone(this.crop);crop.push({left:cropRect.x,top:cropRect.y,width:cropRect.width,height:cropRect.height,prevWidth:this.width,prevHeight:this.height}),this.Page.ElementsManager.startBatch(),this._updateProperty(Properties.X,imageRect.x,!0),this._updateProperty(Properties.Y,imageRect.y,!0),this._updateProperty(Properties.WIDTH,imageRect.width,!0),this._updateProperty(Properties.HEIGHT,imageRect.height,!0),this._updateProperty(Properties.SRC_MOD,src,!0),this._updateProperty(Properties.CROP,crop,!0),this.Page.ElementsManager.endBatch()},Image.prototype.updateAdjustments=function(adjustments,src){this.Page.ElementsManager.startBatch(),_.forEach(adjustments,function(value,property){this._updateProperty(property,value,!0)}.bind(this)),this._updateProperty(Properties.SRC_MOD,src,!0),this.Page.ElementsManager.endBatch()},Image.prototype.isAdjusted=function(){return _.some(adjustmentProperties,function(property){return this[property]!==this.DefaultProperties[property].value}.bind(this))},Image.prototype.isCropped=function(){return!_.isEmpty(this.crop)},Image.prototype.onCompletedModifiedUpload=function(src){ImageEditor.PreloadImage(src).then(function(){this.updateModifiedImageSrc(src),this.setCompleted()}.bind(this))},Image.prototype.updateModifiedImageSrc=function(src){return!this._uploadCancelled&&(this.Page.ElementsManager.startBatch(!1,!1),this._updateProperty(Properties.SRC_MOD,src,!0),void this.Page.ElementsManager.endBatch())},Image.prototype.createModifiedFileName=function(){var pageId=this.Page.pageId,modififiedPrefix="uxpmod_"+this.id+"_"+pageId+"_",name=extractFileNameFromPath(this.src);return modififiedPrefix+name},Image.prototype.cancelUpload=function(){this._uploadCancelled=!0,this.hideProgress()},Image.prototype.enableUpload=function(){this._uploadCancelled=!1},Image.prototype.onStartCrop=function(imageCropElement){imageCropElement&&(this._imageCropElement=imageCropElement)},Image.prototype.onCancelCrop=function(){this._imageCropElement=null},Image.prototype.hitTest=function(p){return this._imageCropElement?this._imageCropElement.hitTest(p):AbstractElement.prototype.hitTest.call(this,p)},Image.prototype.update=function(){var src;this.shouldUpdateSrc&&(this.shouldUpdateSrc=!1,src=_.isEmpty(this.srcMod)?this.src:this.srcMod,this.view.setSrc(this._getCdnUrl(src),!this.Page.isExportMode())),AbstractElement.prototype.update.call(this)},Image.prototype.isEmpty=function(){return this.src===EMPTY_PLACEHOLDER},Image.prototype.isSmall=function(){return this.width<225||this.height<145},Image.prototype.imageProcessingStart=function(){this.isDuringProcessing=!0,this.Page.emit(Events.IMAGE_PROCESSING,!0)},Image.prototype.imageProcessingEnd=function(){this.isDuringProcessing=!1,this.Page.emit(Events.IMAGE_PROCESSING,!1)},Image.prototype._resetModifications=function(){this._srcMod="",this._crop=[],this._brightness=0,this._contrast=0,this._saturation=0,this._vibrance=0,this._exposure=0,this._sharpen=0,this._blur=0},Image}()},{"../enums/ElementTypes.js":184,"../enums/Events.js":185,"../enums/Properties.js":195,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/Uploadable.js":90,"./helpers/ImageEditor.js":98,"./views/ImageView.js":160,lodash:19}],47:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Input2View=_dereq_("./views/Input2View.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Boxable=_dereq_("./behaviors/Boxable.js");module.exports=function(){function Input2(){AbstractElement.apply(this,arguments),this.type=ElementTypes.INPUT2,this.view=this.createView(Input2View)}return Input2.DefaultProperties={width:{value:300},height:{value:30},backgroundColor:{value:"#FFFFFF"},borderColor:{value:"#c8c8c8"},borderTopWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderRightWidth:{value:1},inactive:{value:0},inputType:{value:"text"},required:{value:0},clickIdPage:{value:""},boxShadow:{value:""},color:{value:"#474747"},paddingTop:{value:0},paddingRight:{value:10},paddingBottom:{value:0},paddingLeft:{value:10},textAlign:{value:"left"}},Base.Extend(Input2,AbstractElement),Base.ApplyBehavior(Input2,SimpleTextEditable),Base.ApplyBehavior(Input2,Boxable),Object.defineProperties(Input2.prototype,{inactive:{get:function(){return this._inactive},set:function(value){this._saveProperty(),this._inactive=value,this.view.setInactive(value)}},inputType:{get:function(){return this._inputType},set:function(value){this._saveProperty(),this._inputType=value,this.view.setInputType(value)}},required:{get:function(){return this._required},set:function(value){this._saveProperty(),this._required=value,this.view.setRequired(value)}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}},boxShadow:{get:function(){return this._boxShadow},set:function(value){this._saveProperty(),this._boxShadow=value,this.view.setBoxShadow(value)}},paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}}}),Input2.prototype.isTextInput=function(){return!0},Input2}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/Boxable.js":77,"./behaviors/SimpleTextEditable.js":87,"./views/Input2View.js":161}],48:[function(_dereq_,module,exports){"use strict";var Base=_dereq_("../utils/Base.js"),AbstractElement=_dereq_("./AbstractElement.js"),InputWithLabelView=_dereq_("./views/InputWithLabelView.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function InputWithLabel(){AbstractElement.apply(this,arguments),this.type=ElementTypes.INPUT_WITH_LABEL,this.view=this.createView(InputWithLabelView)}return InputWithLabel.DefaultProperties={height:{value:100,min:20},labelPosition:{value:"left"},labelText:{value:""},inputValue:{value:""},labelWidth:{value:50},inputWidth:{value:130},fontWeight:{value:"normal"},fontStyle:{value:"normal"},fontSize:{value:"14px"},fontFamily:{value:"Arial"},textDecoration:{value:""},textAlign:{value:"none"},color:{value:"#474747"},inactive:{value:0},required:{value:0},inputType:{value:"text"},borderTopLeftRadius:{value:0},borderTopRightRadius:{value:0},borderBottomRightRadius:{value:0},borderBottomLeftRadius:{value:0},clickIdPage:{value:""}},Base.Extend(InputWithLabel,AbstractElement),Object.defineProperties(InputWithLabel.prototype,{labelPosition:{get:function(){return this._labelPosition},set:function(value){this._saveProperty(),this._labelPosition=value,this.view.setLabelPosition(value)}},labelText:{get:function(){return this._labelText},set:function(value){this._saveProperty(),this._labelText=value,this.view.setLabelText(value)}},inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value,this.view.setInputValue(value)}},labelWidth:{get:function(){return this._labelWidth},set:function(value){this._saveProperty(),this._labelWidth=value,this.view.setLabelWidth(value)}},inputWidth:{get:function(){return this._inputWidth},set:function(value){this._saveProperty(),this._inputWidth=value,this.view.setInputWidth(value)}},fontSize:{get:function(){return this._fontSize},set:function(value){this._saveProperty(),this._fontSize=value,this.view.setFontSize(value)}},fontWeight:{get:function(){return this._fontWeight},set:function(value){this._saveProperty(),this._fontWeight=value,this.view.setFontWeight(value)}},fontStyle:{get:function(){return this._fontStyle},set:function(value){this._saveProperty(),this._fontStyle=value,this.view.setFontStyle(value)}},fontFamily:{get:function(){return this._fontFamily},set:function(value){this._saveProperty(),this._fontFamily=value,this.view.setFontFamily(value)}},textDecoration:{get:function(){return this._textDecoration},set:function(value){this._saveProperty(),this._textDecoration=value,this.view.setTextDecoration(value)}},textAlign:{get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value,this.view.setTextAlign(value)}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},inactive:{get:function(){return this._inactive},set:function(value){this._saveProperty(),this._inactive=value,this.view.setInactive(value)}},inputType:{get:function(){return this._inputType},set:function(value){this._saveProperty(),this._inputType=value,this.view.setInputType(value)}},required:{get:function(){return this._required},set:function(value){this._saveProperty(),this._required=value,this.view.setRequired(value)}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=value,this.view.setBorderTopLeftRadius(value)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=value,this.view.setBorderTopRightRadius(value)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=value,this.view.setBorderBottomRightRadius(value)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=value,this.view.setBorderBottomLeftRadius(value)}}}),InputWithLabel}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/InputWithLabelView.js":162}],49:[function(_dereq_,module,exports){"use strict";var TextElement=_dereq_("./TextElement.js"),LabelView=_dereq_("./views/LabelView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Label(){TextElement.apply(this,arguments),this.type=ElementTypes.LABEL,this.view=this.createView(LabelView)}return Base.Extend(Label,TextElement),Label}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./TextElement.js":70,"./views/LabelView.js":163}],50:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),LineView=_dereq_("./views/LineView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function Line(){AbstractElement.apply(this,arguments),this.type=ElementTypes.LINE,this.view=this.createView(LineView),this.shouldUpdateLineSvg=!1}var LINE_BORDER_SPACE=10;return Line.HORIZONTAL="horizontal",Line.VERTICAL="vertical",Line.DefaultProperties={lineOrientation:{value:Line.HORIZONTAL,options:[Line.HORIZONTAL,Line.VERTICAL]},color:{value:"#8A8A8A"},stroke:{value:1,min:1},lineType:{value:"solid",options:["solid","dotted","dashed"]}},Base.Extend(Line,AbstractElement),Object.defineProperties(Line.prototype,{width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){this.lineOrientation===Line.VERTICAL&&value>LINE_BORDER_SPACE&&(this._stroke=value-LINE_BORDER_SPACE),this.shouldUpdateLineSvg=!0,Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){this.lineOrientation===Line.HORIZONTAL&&value>LINE_BORDER_SPACE&&(this._stroke=value-LINE_BORDER_SPACE),this.shouldUpdateLineSvg=!0,Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value)}},lineOrientation:{get:function(){return this._lineOrientation},set:function(value){var width=this.width,height=this.height;this.lineOrientation&&value!==this.lineOrientation&&(width=this.height,height=this.width),this._saveProperty(),this._lineOrientation=value,width!==this.width&&(this.width=width),height!==this.height&&(this.height=height),this.shouldUpdateLineSvg=!0}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setStroke(value)}},stroke:{get:function(){return this._stroke},set:function(value){var elementSize=parseInt(value)+LINE_BORDER_SPACE;this._saveProperty(),this._stroke=value,this.lineOrientation===Line.HORIZONTAL?this.height=elementSize:this.width=elementSize,this.shouldUpdateLineSvg=!0}},lineType:{get:function(){return this._lineType},set:function(value){this._saveProperty(),this._lineType=value,this.shouldUpdateLineSvg=!0}},shouldUpdateLineSvg:{get:function(){return this._shouldUpdateLineSvg},set:function(value){this._shouldUpdateLineSvg=value,value&&(this.dirty=value)}}}),Line.prototype.update=function(){this.shouldUpdateLineSvg&&(this.view.updateLineSvg(this),this.shouldUpdateLineSvg=!1),AbstractElement.prototype.update.call(this)},Line.prototype.isHorizontal=function(){return this.lineOrientation===Line.HORIZONTAL},Line.prototype.isVertical=function(){return this.lineOrientation===Line.VERTICAL},Line.prototype.validateProperty=function(property,value){return property===Properties.WIDTH&&this.isVertical()||property===Properties.HEIGHT&&this.isHorizontal()?value>this.DefaultProperties.stroke.max+LINE_BORDER_SPACE?value=this.DefaultProperties.stroke.max+LINE_BORDER_SPACE:value<this.DefaultProperties.stroke.min+LINE_BORDER_SPACE&&(value=this.DefaultProperties.stroke.min+LINE_BORDER_SPACE):value=AbstractElement.prototype.validateProperty.call(this,property,value),value},Line}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/LineView.js":164}],51:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),LinkView=_dereq_("./views/LinkView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Link(){AbstractElement.apply(this,arguments),this.type=ElementTypes.LINK,this.view=this.createView(LinkView)}return Link.DefaultProperties={width:{value:160},height:{value:20},clickIdPage:{value:""},inputValue:{value:'<span style="text-decoration: underline;"><span style="color: #3498db;">link</span></span>'},textAlign:{value:"left"}},Base.Extend(Link,AbstractElement),Base.ApplyBehavior(Link,TextEditable),Object.defineProperties(Link.prototype,{clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}}}),Link.prototype.adjustHeightToText=function(){return!0},Link}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/TextEditable.js":88,"./views/LinkView.js":166}],52:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),LinkListView=_dereq_("./views/LinkListView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),InteractionsHelper=_dereq_("../interactions/InteractionsHelper.js"),InteractionsActions=_dereq_("../enums/InteractionActions.js");module.exports=function(){function LinkList(){AbstractElement.apply(this,arguments),this.type=ElementTypes.LINK_LIST,this.view=this.createView(LinkListView),this.Page.isPreviewMode()&&this.addLinkEvent(),this._shouldRestyleAnchors=!1}return LinkList.DefaultProperties={width:{value:70},height:{value:40},headerDisplay:{value:0,options:[1,0]},headerText:{value:"Header"},inputValue:{value:[{text:"Link 1"},{text:"Link 2"}]},headerColor:{value:"#000000"},headerFontWeight:{value:"bold"},headerFontStyle:{value:"normal"},headerFontSize:{value:"14px"},headerFontFamily:{value:"Arial"},headerTextDecoration:{value:"none"},headerTextAlign:{value:"left"},color:{value:"#3498db"},textAlign:{value:"left"}},Base.Extend(LinkList,AbstractElement),Base.ApplyBehavior(LinkList,SimpleTextEditable),Object.defineProperties(LinkList.prototype,{shouldRestyleAnchors:{get:function(){return this._shouldRestyleAnchors},set:function(value){this._shouldRestyleAnchors=value,value&&(this.dirty=value)}},inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value,this.view.setInputValue(value),this.shouldRestyleAnchors=!0}},headerDisplay:{get:function(){return this._headerDisplay},set:function(value){this._saveProperty(),this._headerDisplay=value,this.view.setHeaderDisplay(value)}},headerText:{get:function(){return this._headerText},set:function(value){this._saveProperty(),this._headerText=value,this.view.setHeaderText(value)}},headerColor:{get:function(){return this._headerColor},set:function(value){this._saveProperty(),this._headerColor=value,this.view.setHeaderColor(value)}},headerFontWeight:{get:function(){return this._headerFontWeight},set:function(value){this._saveProperty(),this._headerFontWeight=value,this.view.setHeaderFontWeight(value)}},headerFontStyle:{get:function(){return this._headerFontStyle},set:function(value){this._saveProperty(),this._headerFontStyle=value,this.view.setHeaderFontStyle(value)}},headerFontSize:{get:function(){return this._headerFontSize},set:function(value){this._saveProperty(),this._headerFontSize=value,this.view.setHeaderFontSize(value)}},headerFontFamily:{get:function(){return this._headerFontFamily},set:function(value){this._saveProperty(),this._headerFontFamily=value,this.view.setHeaderFontFamily(value)}},headerTextDecoration:{get:function(){return this._headerTextDecoration},set:function(value){this._saveProperty(),this._headerTextDecoration=value,this.view.setHeaderTextDecoration(value)}},headerTextAlign:{get:function(){return this._headerTextAlign},set:function(value){this._saveProperty(),this._headerTextAlign=value,this.view.setHeaderTextAlign(value)}}}),LinkList.prototype.isTextEditable=function(){return!1},LinkList.prototype.addLinkEvent=function(){this.view.domElement.addEventListener("click",this.mouseDownHandler.bind(this))},LinkList.prototype.mouseDownHandler=function(e){e.target.dataset.pageId&&InteractionsHelper.ApplyInteractionEffect(this,{action:InteractionsActions.LINK_PAGE,value:{id_page:e.target.dataset.pageId,target:!1}})},LinkList.prototype.update=function(){this.shouldRestyleAnchors&&(this.view.setColor(this.color),this.shouldRestyleAnchors=!1),AbstractElement.prototype.update.call(this)},LinkList}()},{"../enums/ElementTypes.js":184,"../enums/InteractionActions.js":187,"../interactions/InteractionsHelper.js":208,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/SimpleTextEditable.js":87,"./views/LinkListView.js":165}],53:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function MaterialIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.MATERIAL_ICON}return Base.Extend(MaterialIcon,SvgIcon),MaterialIcon}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],54:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Box=_dereq_("./Box.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function menuValueToString(value){return _.map(value,function(item){return item.label}).join(" | ")}function Menu(){Box.apply(this,arguments),this.type=ElementTypes.MENU}return Menu.DefaultProperties={menuValue:{value:[]}},Base.Extend(Menu,Box),Object.defineProperties(Menu.prototype,{menuValue:{get:function(){return this._menuValue},set:function(value){this._saveProperty(),this._menuValue=value,this.view.setInputValue(menuValueToString(value))}}}),Menu.prototype.isTextEditable=function(){return!1},Menu.prototype.isRichTextEditable=function(){return!1},Menu}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./Box.js":29,lodash:19}],55:[function(_dereq_,module,exports){"use strict";var SvgSymbol=_dereq_("./SvgSymbol.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js"),MobileSymbolView=_dereq_("./views/MobileSymbolView.js"),ImageEditor=_dereq_("./helpers/ImageEditor.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function createSvgSrc(element){var svgSrc=element.svgSrc;return!svgSrc&&element.data&&element.originalHeight&&element.originalWidth&&(svgSrc=ImageEditor.GetBlobSrcFromSvg(element.data,element.originalWidth,element.originalHeight)),svgSrc}function MobileSymbol(){SvgSymbol.apply(this,arguments),this.type=ElementTypes.MOBILE_SYMBOL,this.view=this.createView(MobileSymbolView),this._shouldUpdateSvgSrc=!1,this._shouldUpdateCssClass=!1}return MobileSymbol.DefaultProperties={elementsConfig:{value:""},cssClass:{value:""},svgSrc:{value:""}},Base.Extend(MobileSymbol,SvgSymbol),Object.defineProperties(MobileSymbol.prototype,{shouldUpdateSvgSrc:{get:function(){return this._shouldUpdateSvgSrc},set:function(value){this._shouldUpdateSvgSrc=value,value&&(this.dirty=value)}},shouldUpdateCssClass:{get:function(){return this._shouldUpdateCssClass},set:function(value){this._shouldUpdateCssClass=value,value&&(this.dirty=value)}},elementsConfig:{get:function(){return this._elementsConfig},set:function(value){this._saveProperty(),this._elementsConfig=value}},cssClass:{get:function(){return this._cssClass},set:function(value){this._saveProperty(),this._cssClass=value,this.shouldUpdateCssClass=!0}},svgSrc:{get:function(){return this._svgSrc},set:function(value){this._saveProperty(),this._svgSrc=value,this.shouldUpdateSvgSrc=!0}},data:{get:function(){return this._data},set:function(value){this._saveProperty(),this._data=value,this.shouldUpdateSvgSrc=!0}}}),MobileSymbol.prototype.update=function(){this.shouldUpdateSvgSrc&&(this.view.setSvgSrc(this._getCdnUrl(createSvgSrc(this))),this.shouldUpdateSvgSrc=!1),this.shouldUpdateCssClass&&(this.view.setCssClass(this.cssClass),this.shouldUpdateCssClass=!1),SvgSymbol.prototype.update.call(this)},MobileSymbol.prototype.setSymbol=function(id,props){var width=this.width,height=this.height,ratio=width/height,width2=props.width,height2=props.height,ratio2=width2/height2;this.Page.ElementsManager.startBatch(),(ratio>1&&ratio2<1||ratio<1&&ratio2>1)&&(this._updateProperty(Properties.WIDTH,height,!0),this._updateProperty(Properties.HEIGHT,width,!0)),this._updateProperty(Properties.SVG_SRC,props.svgSrc,!0),this._updateProperty(Properties.CURRENT_ELEMENT_ID,id,!0),this.Page.ElementsManager.endBatch()},MobileSymbol}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./SvgSymbol.js":66,"./helpers/ImageEditor.js":98,"./views/MobileSymbolView.js":167}],56:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../utils/Base.js"),Tree=_dereq_("../utils/Tree.js"),Group=_dereq_("./Group.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),MultistateView=_dereq_("./views/MultistateView.js"),Properties=_dereq_("../enums/Properties.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),Point=_dereq_("../primitives/Point.js"),Rectangle=_dereq_("../primitives/Rectangle.js"),AbstractElement=_dereq_("./AbstractElement.js"),SelectionHelper=_dereq_("./helpers/SelectionHelper.js");module.exports=function(){function getDefaultState(states){return _.find(states,{type:DEFAULT})}function getState(states,stateId){return _.find(states,function(state){return state.id===stateId})}function getStateIndex(states,state){return states.indexOf(state)}function getNextId(states){return _.reduce(states,function(id,state){return Math.max(id,state.id)},0)+1}function getElementsForAllStates(states){return _.reduce(states,function(elements,state){return elements.concat(state.elements)},[])}function canAnimate(animatingToState,activeStateId,stateId){return"number"!=typeof animatingToState&&activeStateId!==stateId||"number"==typeof animatingToState&&animatingToState!==stateId}function getNextState(states,currentStateId){var stateIndex=getStateIndex(states,getState(states,currentStateId));return states[stateIndex>=states.length-1?0:stateIndex+1].id}function getPreviousState(states,currentStateId){var stateIndex=getStateIndex(states,getState(states,currentStateId));return states[stateIndex<1?states.length-1:stateIndex-1].id}function getStateForElement(states,elementId){return _.find(states,function(state){return state.elements.indexOf(elementId)>-1})}function removeElementFromState(state,elementId){state.elements=_.filter(state.elements,function(childId){return childId!==elementId})}function Multistate(){Group.apply(this,arguments),this.type=ElementTypes.MULTISTATE,this.view=this.createView(MultistateView),this._animatingToState=null}var DEFAULT="default",DEFAULT_STATE_NAME="First state",DEFAULT_BB={x:0,y:0,width:100,height:100};return Multistate.DefaultProperties={states:{value:[]},multistateOrigin:{value:""}},Multistate.ExcludedProperties={storedElements:!0},Base.Extend(Multistate,Group),Object.defineProperties(Multistate.prototype,{states:{get:function(){return this._states},set:function(value){var currentDefaultState=_.find(this._states,{type:DEFAULT}),nextDefaultState=_.find(value,{type:DEFAULT});0===value.length&&value.push(this.createInitialState([])),this._saveProperty(),this._updateActiveState(value),this._updateStoredElements(getElementsForAllStates(value)),this._states=value,this.dirty=!0,!nextDefaultState||_.isEqual(currentDefaultState,nextDefaultState)||this._editModeActive||this.showState(nextDefaultState.id)}},activeState:{get:function(){return this._activeState},set:function(value){this._activeState=value,this._displayActiveState(value),this.dirty=!0}},multistateOrigin:{get:function(){return this._multistateOrigin},set:function(value){this._saveProperty(),this._multistateOrigin=value}}}),Multistate.prototype.isMultistate=function(){return!0},Multistate.prototype.enablePreviewMode=function(){AbstractElement.prototype.enablePreviewMode.call(this),this.view.state.style.backfaceVisibility="hidden"},Multistate.prototype.disablePreviewMode=function(){AbstractElement.prototype.disablePreviewMode.call(this),this.view.state.style.removeProperty("backfaceVisibility")},Multistate.prototype.getStatesCount=function(){return this.states.length},Multistate.prototype.isCreatedFromGroup=function(){return this.multistateOrigin===ElementTypes.GROUP},Multistate.prototype.getLayerChildren=function(){return _.filter(Group.prototype.getLayerChildren.call(this),this._isDescendantInActiveState.bind(this))},Multistate.prototype.getStateChildren=function(state){return _.map(state.elements,function(elementId){return _.find(this.children,{id:elementId})}.bind(this))},Multistate.prototype.getStateChildrenById=function(stateId){var state=getState(this.states,stateId);return state?_.map(state.elements,function(elementId){return _.find(this.children,{id:elementId})}.bind(this)):[]},Multistate.prototype.setEditable=function(group,selectedChildren){var state;this._editModeActive=!!group,state=selectedChildren&&selectedChildren.length>0?this._getStateByChildren(selectedChildren):group?getStateForElement(this.states,group.id):this.activeState?this.activeState:getDefaultState(this.states),state&&this.showState(state.id),Group.prototype.setEditable.call(this,group,selectedChildren)},Multistate.prototype.selectChildren=function(elements){this.showStateByChildren(elements),Group.prototype.selectChildren.call(this,elements)},Multistate.prototype.deselect=function(){AbstractElement.prototype.deselect.call(this),this._editModeActive||this.showState()},Multistate.prototype.getStateFirstElement=function(stateId){var elements=(_.find(this.states,function(state){return state.id===stateId})||{}).elements;return _.find(elements,function(id){var element=this._getElementById(id);return!element.isEditByCollaborator()}.bind(this))},Multistate.prototype.createInitialState=function(elements){
return{id:1,name:DEFAULT_STATE_NAME,type:DEFAULT,elements:_.map(elements,"id")}},Multistate.prototype.createNewState=function(name){var elementsToDuplicate=this.activeState?this.activeState.elements:this.storedElements;return{id:getNextId(this.states),name:name||"New state",type:"",elements:_.map(elementsToDuplicate,function(elementId){return this._getElementById(elementId).clone().id}.bind(this))}},Multistate.prototype.addInitialState=function(elements){var states=[this.createInitialState(elements)];this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype.addState=function(name){var states=_.clone(this.states);states.push(this.createNewState(name)),this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype.removeState=function(stateId){if(this.states.length<2)return!1;var stateToRemove=getState(this.states,stateId),states=_.filter(_.cloneDeep(this.states),function(state){return state.id!==stateId});stateToRemove.type===DEFAULT?this._setDefaultState(states,_.first(states).id):this._updateProperty(Properties.STATES,states,!0),SelectionHelper.DeleteElements(_.map(stateToRemove.elements,this._getElementById.bind(this)),!0)},Multistate.prototype.renameState=function(stateId,name){var states=_.cloneDeep(this.states);getState(states,stateId).name=name,this.updateProperty(Properties.STATES,states)},Multistate.prototype.reorderState=function(stateId,position){var states=_.cloneDeep(this.states),state=getState(states,stateId),index=states.indexOf(state);return!(index===position||position>=states.length)&&(states.splice(index,1),states.splice(position,0,state),void this.updateProperty(Properties.STATES,states))},Multistate.prototype.showState=function(stateId){stateId=stateId||getDefaultState(this.states).id,this.activeState.id!==stateId&&(this.activeState=getState(this.states,stateId))},Multistate.prototype.setDefaultState=function(stateId){return getDefaultState(this.states).id!==stateId&&(this._setDefaultState(_.cloneDeep(this.states),stateId),void this.showState(stateId))},Multistate.prototype.hitTest=function(p,ignoreChildren){if(this._preventHit(p))return null;var stateChildren=this.getStateChildren(this.activeState);return(0===stateChildren.length||ignoreChildren)&&this.rect.hitTest(p)?this:this._hitTestOverChildren(stateChildren,p)},Multistate.prototype._hitTestOverChildren=function(children,p){for(var child,i=children.length;i-- >0;)if(child=children[i].hitTest(p,!this._editModeActive))return child;return null},Multistate.prototype.animateNextState=function(animation,reversed){var stateId="number"!=typeof this._animatingToState?this.activeState.id:this._animatingToState,newStateId=reversed?getPreviousState(this.states,stateId):getNextState(this.states,stateId);this._animateToState(newStateId,animation,reversed)},Multistate.prototype.animatePreviousState=function(animation,reversed){var stateId="number"!=typeof this._animatingToState?this.activeState.id:this._animatingToState,newStateId=reversed?getNextState(this.states,stateId):getPreviousState(this.states,stateId);this._animateToState(newStateId,animation,reversed)},Multistate.prototype.isBogusTrigger=function(lastInteraction,currentInteraction){var lastReversed=lastInteraction[1],currentReversed=currentInteraction[1];return currentInteraction=currentInteraction[0],lastInteraction=lastInteraction[0],lastReversed===currentReversed&&lastInteraction.id===currentInteraction.id&&lastInteraction.action===currentInteraction.action&&lastInteraction.value===currentInteraction.value},Multistate.prototype.animateChangeState=function(stateId,animation,reversed,interactionDetail){if(this._lastInteraction&&this.isBogusTrigger(this._lastInteraction,[interactionDetail,reversed]))return!1;reversed||interactionDetail.trigger!==InteractionTriggers.HOVER||(this._originalState=getState(this.states,this._animatingToState)||this.activeState);var state;reversed&&interactionDetail.trigger===InteractionTriggers.HOVER&&this._originalState?(state=this._originalState,this._originalState=null):state=getState(this.states,parseInt(stateId)),state&&(this._animateToState(state.id,animation,reversed),this._lastInteraction=[interactionDetail,reversed])},Multistate.prototype.isInAnimatingState=function(element){return"number"==typeof this._animatingToState&&this._animatingToState===this._getDescendantState(element).id},Multistate.prototype.getStateBoundingBox=function(element){return this._getBoundingBoxForState(this._getDescendantState(element).id)},Multistate.prototype.update=function(){Group.prototype.update.call(this),this.Page.isPreviewMode()&&this.updateChildren(!0)},Multistate.prototype.clone=function(props){var states=_.cloneDeep(this.states);return _.forEach(states,function(state){state.elements=_.map(state.elements,function(elementId){return this._getElementById(elementId).clone().id}.bind(this))}.bind(this)),AbstractElement.prototype.clone.call(this,_.extend({states:states},props))},Multistate.prototype._add=function(child,index){var stateElements=_.clone(this.activeState.elements),stateIndex=this.states.indexOf(this.activeState),states=_.cloneDeep(this.states);"undefined"!=typeof index&&index<stateElements.length?stateElements.splice(index,0,child.id):stateElements.push(child.id),states[stateIndex].elements=stateElements,this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._remove=function(child){var states=_.cloneDeep(this.states);removeElementFromState(getStateForElement(states,child.id),child.id),this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._removeAll=function(){this._updateProperty(Properties.STATES,[],!0)},Multistate.prototype._setDefaultState=function(states,stateId){var defaultState=getDefaultState(states);defaultState&&(defaultState.type=""),getState(states,stateId).type=DEFAULT,this._updateProperty(Properties.STATES,states,!0)},Multistate.prototype._isChildInActiveState=function(childId){return this.activeState&&this.activeState.elements.indexOf(childId)>-1},Multistate.prototype._isDescendantInActiveState=function(child){return this._isChildInActiveState(Tree.GetRootElement(child,this).id)},Multistate.prototype._getDescendantState=function(child){var directChild=Tree.GetRootElement(child,this);return _.find(this.states,function(state){return state.elements.indexOf(directChild.id)>-1})},Multistate.prototype._getStateByChildren=function(elements){return _.reduce(elements,function(state,element){return this._getDescendantState(element)||state}.bind(this),getDefaultState(this.states))},Multistate.prototype._updateBoundingBox=function(){this._rect=this._getBoundingBoxForState(this.activeState.id),this.dirtyPosition=!0},Multistate.prototype._getElementsForBoundingBox=function(stateId){for(var state=getState(this.states,stateId);0===state.elements.length&&getStateIndex(this.states,state)>0;)state=getState(this.states,getPreviousState(this.states,state.id));for(;0===state.elements.length&&getStateIndex(this.states,state)<this.states.length-1;)state=getState(this.states,getNextState(this.states,state.id));return this.getStateChildren(state)},Multistate.prototype._getBoundingBoxForState=function(stateId){for(var bb,child,p=new Point(0,0),angle=this.angle,bbElements=this._getElementsForBoundingBox(stateId),stateBB=null,i=0,len=bbElements.length;i<len;i++)child=bbElements[i],child instanceof Group&&child._updateBoundingBox(),bb=child.getBoundingBox(!1).clone(),bb.rotateBy(p,-angle),stateBB=stateBB?stateBB.add(bb):len>1?bb:bb.getBoundingBox(!0);return stateBB||(stateBB=new Rectangle(DEFAULT_BB.x,DEFAULT_BB.y,DEFAULT_BB.width,DEFAULT_BB.height)),stateBB.rotateBy(p,angle),stateBB},Multistate.prototype._updateActiveState=function(states){var id=this.activeState&&getState(states,this.activeState.id)?this.activeState.id:null;this.activeState=id?getState(states,id):getDefaultState(states)},Multistate.prototype._displayActiveState=function(){var range=document.createRange();range.selectNodeContents(this.view.state),range.deleteContents(),_.forEach(this.children,function(child){this._isChildInActiveState(child.id)&&(this.view.state.appendChild(child.view.domElement),child.resetIndicators())}.bind(this))},Multistate.prototype._addToStoredElements=function(elements){_.forEach(_.difference(elements,this._storedElements),function(elementId){var child=this._getElementById(elementId),index=elements.indexOf(elementId),isChildInActiveState=this._isChildInActiveState(elementId),indexOfState=this.activeState.elements.indexOf(elementId);child.parent&&child.parent.removeChild(child),child.setParent(this),index<this.children.length?(isChildInActiveState&&(indexOfState>=this.view.state.children.length?this.view.state.appendChild(child.view.domElement):this.view.state.insertBefore(child.view.domElement,this.view.state.children[indexOfState])),this.children.splice(index,0,child),this._storedElements.splice(index,0,elementId)):(isChildInActiveState&&this.view.state.appendChild(child.view.domElement),this.children.push(child),this._storedElements.push(elementId))}.bind(this))},Multistate.prototype._removeFromStoredElements=function(elements){var child,index;_.forEach(_.difference(this._storedElements,elements),function(elementId){child=this._getElementById(elementId),index=this.getChildIndex(child),child.setParent(null),this._isChildInActiveState(elementId)&&this.view.state.removeChild(child.view.domElement),this.children.splice(index,1),this._storedElements.splice(index,1)}.bind(this))},Multistate.prototype._animateToState=function(stateId,animation,reversed){if(canAnimate(this._animatingToState,this.activeState.id,stateId)){var container=this.view.createNextStateContainer(stateId,this._getBoundingBoxForState(stateId),this.isClip);"number"==typeof this._animatingToState&&(this.view.resetAnimation(),this.showState(this._animatingToState),this._animatingToState=null),this._animatingToState=stateId,_.forEach(getState(this.states,stateId).elements,function(elementId){var child=this._getElementById(elementId);container.appendChild(child.view.domElement)}.bind(this)),this.updateChildren(!0),this.view.animateChangeState(container,animation,reversed).then(function(){this._animatingToState=null,this.showState(stateId),this.update(),this.updateChildren(!0)}.bind(this))}},Multistate}()},{"../enums/ElementTypes.js":184,"../enums/InteractionTriggers.js":188,"../enums/Properties.js":195,"../primitives/Point.js":211,"../primitives/Rectangle.js":212,"../utils/Base.js":213,"../utils/Tree.js":223,"./AbstractElement.js":24,"./Group.js":42,"./helpers/SelectionHelper.js":102,"./views/MultistateView.js":168,lodash:19}],57:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),NavigationView=_dereq_("./views/NavigationView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),InteractionsHelper=_dereq_("../interactions/InteractionsHelper.js"),InteractionsActions=_dereq_("../enums/InteractionActions.js");module.exports=function(){function Navigation(){AbstractElement.apply(this,arguments),this.type=ElementTypes.NAVIGATION,this.view=this.createView(NavigationView),this.Page.isPreviewMode()&&this.addLinkEvent(),this._shouldRepaintElement=!1}return Navigation.DefaultProperties={width:{value:600},height:{value:40},orientation:{value:"horizontal"},inputValue:{value:["Home","* This is active","This is dropdown","/ shhh...","// we  you","Last one"].map(function(pLine){return{text:pLine,page_id:null}})},textAlign:{value:"center"},color:{value:"#666666"},backgroundColor:{value:"#EBEBEB"},activeBackgroundColor:{value:"#FFFFFF"},elementBorderWidth:{value:1},elementBorderColor:{value:"#DEDEDE"}},Base.Extend(Navigation,AbstractElement),Base.ApplyBehavior(Navigation,SimpleTextEditable),Object.defineProperties(Navigation.prototype,{shouldRepaintElement:{get:function(){return this._shouldRepaintElement},set:function(value){this._shouldRepaintElement=value,value&&(this.dirty=value)}},inputValue:{get:function(){return this._inputValue},set:function(value){_.isString(value)&&(value=JSON.parse(value)),this._saveProperty(),this._inputValue=value,this.view.setInputValue(value),this.shouldRepaintElement=!0}},orientation:{get:function(){return this._orientation},set:function(value){this._saveProperty(),this.adjustDimensions(value),this._orientation=value,this.view.setOrientation(value)}},backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(value),this._backgroundColor=value,this.view.setBackgroundColor(value)}},activeBackgroundColor:{get:function(){return this._activeBackgroundColor},set:function(value){this._saveProperty(value),this._activeBackgroundColor=value,this.view.setActiveBackgroundColor(value)}},elementBorderWidth:{get:function(){return this._elementBorderWidth},set:function(value){this._saveProperty(value),this._elementBorderWidth=value,this.view.setElementBorder(value,this.elementBorderColor)}},elementBorderColor:{get:function(){return this._elementBorderColor},set:function(value){this._saveProperty(value),this._elementBorderColor=value,this.view.setElementBorder(this.elementBorderWidth,value)}}}),Navigation.prototype.isTextEditable=function(){return!1},Navigation.prototype.adjustDimensions=function(value){if("horizontal"===this._orientation&&"vertical"===value||"vertical"===this._orientation&&"horizontal"===value){var navMainElements=this.view.domElement.children,elementWidth=navMainElements[0].offsetWidth,elementHeight=navMainElements[0].offsetHeight;"horizontal"===this._orientation?(this.width=elementWidth,this.height=navMainElements.length*elementHeight):"vertical"===this._orientation&&(this.width=navMainElements.length*elementWidth,this.height=elementHeight)}},Navigation.prototype.addLinkEvent=function(){this.view.domElement.addEventListener("click",this.mouseDownHandler.bind(this))},Navigation.prototype.addHoverEffects=function(){var items=this.view.domElement.getElementsByTagName("li");Array.prototype.forEach.call(items,function(item){item.classList.contains("active")||(item.addEventListener("mouseover",this.handleHoverEffect.bind(this,item,!0)),item.addEventListener("mouseout",this.handleHoverEffect.bind(this,item,!1)))},this)},Navigation.prototype.mouseDownHandler=function(e){e.target.dataset.pageId&&InteractionsHelper.ApplyInteractionEffect(this,{action:InteractionsActions.LINK_PAGE,value:{id_page:e.target.dataset.pageId,target:!1}})},Navigation.prototype.handleHoverEffect=function(element,isHovered){isHovered?this.view.setElementBackgroundColor(element,this._activeBackgroundColor):this.view.setElementBackgroundColor(element,this._backgroundColor)},Navigation.prototype.update=function(){this.shouldRepaintElement&&(this.view.setBackgroundColor(this.backgroundColor),this.view.setActiveBackgroundColor(this.activeBackgroundColor),this.view.setElementBorder(this.elementBorderWidth,this.elementBorderColor),this.addHoverEffects(),this.shouldRepaintElement=!1),AbstractElement.prototype.update.call(this)},Navigation}()},{"../enums/ElementTypes.js":184,"../enums/InteractionActions.js":187,"../interactions/InteractionsHelper.js":208,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/SimpleTextEditable.js":87,"./views/NavigationView.js":169,lodash:19}],58:[function(_dereq_,module,exports){"use strict";var Input2=_dereq_("./Input2.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function Password(){Input2.apply(this,arguments)}return Password.DefaultProperties={inputValue:{value:"password"},inputType:{value:"password"}},Base.Extend(Password,Input2),Password}()},{"../utils/Base.js":213,"./Input2.js":47}],59:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function PixleIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.PIXLE_ICON}return Base.Extend(PixleIcon,SvgIcon),PixleIcon}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],60:[function(_dereq_,module,exports){"use strict";var Checkbox=_dereq_("./Checkbox.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),RadioView=_dereq_("./views/RadioView.js");module.exports=function(){function Radio(){Checkbox.apply(this,arguments),this.type=ElementTypes.RADIO,this.view=this.createView(RadioView)}return Radio.DefaultProperties={formGroupName:{value:"Group 1"}},Base.Extend(Radio,Checkbox),Object.defineProperties(Radio.prototype,{formGroupName:{get:function(){return this._formGroupName},set:function(value){this._saveProperty(),this._formGroupName=value,this.view.setFormGroupName(value)}}}),Radio}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./Checkbox.js":32,"./views/RadioView.js":170}],61:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function RetinaIcon(){SvgIcon.apply(this,arguments),this.type=ElementTypes.RETINA_ICON}return Base.Extend(RetinaIcon,SvgIcon),RetinaIcon}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],62:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),ScrollbarView=_dereq_("./views/ScrollbarView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Scrollbar(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SCROLLBAR,this.view=this.createView(ScrollbarView)}return Scrollbar.SCROLL_BUTTON_SIZE=18,Scrollbar.DefaultProperties={width:{value:Scrollbar.SCROLL_BUTTON_SIZE,min:Scrollbar.SCROLL_BUTTON_SIZE},height:{value:150,min:2*Scrollbar.SCROLL_BUTTON_SIZE},scrollPosition:{value:30,min:0,max:100}},Base.Extend(Scrollbar,AbstractElement),Object.defineProperties(Scrollbar.prototype,{scrollPosition:{get:function(){return this._scrollPosition},set:function(value){this._saveProperty(),this._scrollPosition=value,this.view.setScrollPosition(value,this.height)}}}),Scrollbar}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/ScrollbarView.js":171}],63:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),SelectlistView=_dereq_("./views/SelectlistView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Selectlist(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SELECTLIST,this.view=this.createView(SelectlistView)}return Selectlist.DefaultProperties={width:{value:200},height:{value:20},multiple:{value:!1},selectlistValue:{value:[{id:"id-1",text:"UX"},{id:"id-2",text:"UI"}]},color:{value:"#666666"},clickIdPage:{value:""}},Selectlist.ExcludedProperties={inputValue:!0},Base.Extend(Selectlist,AbstractElement),Base.ApplyBehavior(Selectlist,SimpleTextEditable),Object.defineProperties(Selectlist.prototype,{multiple:{get:function(){return this._multiple},set:function(value){this._saveProperty(),this._multiple=value,this.view.setMultiple("enabled"===value)}},clickIdPage:{get:function(){return this._clickIdPage},set:function(value){this._saveProperty(),this._clickIdPage=value}},selectlistValue:{get:function(){return this._selectlistValue},set:function(value){this._saveProperty(),this._selectlistValue=value,this.view.setOptions(value)}}}),Selectlist.prototype.isTextEditable=function(){return!1},Selectlist}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/SimpleTextEditable.js":87,"./views/SelectlistView.js":172}],64:[function(_dereq_,module,exports){"use strict";var Properties=_dereq_("../enums/Properties.js"),SvgSymbol=_dereq_("./SvgSymbol.js"),SvgIconView=_dereq_("./views/SvgIconView.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function SvgIcon(){SvgSymbol.apply(this,arguments),this.view=this.createView(SvgIconView)}return SvgIcon.DefaultProperties={color:{value:"#000000"}},Base.Extend(SvgIcon,SvgSymbol),SvgIcon.prototype.setSymbol=function(id,categoryId,iconData,originalWidth,originalHeight,originalRatio){this.Page.ElementsManager.startBatch(),this._updateProperty(Properties.CURRENT_ELEMENT_ID,id,!0),this._updateProperty(Properties.CURRENT_ELEMENT_CATEGORY_ID,categoryId,!0),this._updateProperty(Properties.ORIGINAL_HEIGHT,parseInt(originalHeight),!0),this._updateProperty(Properties.ORIGINAL_WIDTH,parseInt(originalWidth),!0),this._updateProperty(Properties.ORIGINAL_RATIO,originalRatio||1,!0),this._updateProperty(Properties.DATA,iconData,!0),this.Page.ElementsManager.endBatch()},SvgIcon}()},{"../enums/Properties.js":195,"../utils/Base.js":213,"./SvgSymbol.js":66,"./views/SvgIconView.js":173}],65:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ImageView=_dereq_("./views/ImageView.js");module.exports=function(){function SvgIconLegacy(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SVG_ICON_LEGACY,this.view=this.createView(ImageView)}return SvgIconLegacy.DefaultProperties={data:{value:""}},Base.Extend(SvgIconLegacy,AbstractElement),Object.defineProperties(SvgIconLegacy.prototype,{data:{get:function(){return this._data},set:function(value){this._saveProperty(),this._data=value,this.view.setSrc(this._getCdnUrl(value))}}}),SvgIconLegacy}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/ImageView.js":160}],66:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),SvgSymbolView=_dereq_("./views/SvgSymbolView.js");module.exports=function(){function SvgSymbol(){AbstractElement.apply(this,arguments),this.type=ElementTypes.SVG_SYMBOL,this.view=this.createView(SvgSymbolView),this._shouldUpdateViewBox=!1}return SvgSymbol.DefaultProperties={data:{value:""},color:{value:"#ebebeb"},currentElementCategoryId:{value:""},currentElementId:{value:""},originalWidth:{value:""},originalHeight:{value:""},originalRatio:{value:1}},Base.Extend(SvgSymbol,AbstractElement),Object.defineProperties(SvgSymbol.prototype,{shouldUpdateViewBox:{get:function(){return this._shouldUpdateViewBox},set:function(value){this._shouldUpdateViewBox=value,value&&(this.dirty=value)}},data:{get:function(){return this._data},set:function(value){this._saveProperty(),this._data=value,this.view.setData(value),this.shouldUpdateViewBox=!0}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},currentElementCategoryId:{get:function(){return this._currentElementCategoryId},set:function(value){this._saveProperty(),this._currentElementCategoryId=value}},currentElementId:{get:function(){return this._currentElementId},set:function(value){this._saveProperty(),this._currentElementId=value}},originalWidth:{get:function(){return this._originalWidth},set:function(value){this._saveProperty(),this._originalWidth=value,this.shouldUpdateViewBox=!0}},originalHeight:{get:function(){return this._originalHeight},set:function(value){this._saveProperty(),this._originalHeight=value,this.shouldUpdateViewBox=!0}},originalRatio:{get:function(){return this._originalRatio},set:function(value){this._saveProperty(),this._originalRatio=value||1,this.shouldUpdateViewBox=!0}}}),SvgSymbol.prototype.update=function(){this.shouldUpdateViewBox&&(this.view.updateViewBox(this.originalWidth,this.originalHeight,this.originalRatio),this.shouldUpdateViewBox=!1),AbstractElement.prototype.update.call(this)},SvgSymbol}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/SvgSymbolView.js":174}],67:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TabView=_dereq_("./views/TabView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Orientations=_dereq_("../enums/Orientations.js");module.exports=function(){function Tab(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TAB,this.view=this.createView(TabView),this._renderInitially=!0}return Tab.DefaultProperties={elementBorderColor:{value:"#dedede"},elementBorderRadius:{value:2,min:0,max:100},elementBorderWidth:{value:1,min:0,max:100},color:{value:"#666666"},elementBorderStyle:{value:"solid",options:["solid","dashed","dotted","double","groove","ridge","inset","outset"]},inputValue:{value:["Home","*Active tab","Third tab"].map(function(line){return{text:line,page_id:null}})},tabType:{value:Orientations.HORIZONTAL,options:[Orientations.HORIZONTAL,Orientations.VERTICAL]},typeHorizontal:{value:"top",options:["top","bottom"]},typeVertical:{value:"left",options:["left","right"]},fontSize:{value:"14px",options:["8px","9px","10px","11px","12px","14px","18px","24px","30px","36px","48px","60px","72px"]},fontFamily:{value:"Arial",options:["Arial","Comic Sans MS","Courier New","Georgia","Tahoma","Times New Roman","Trebuchet MS","Verdana"]},fontWeight:{value:"normal"},fontStyle:{value:""},textDecoration:{value:""},textAlign:{value:"center"},activeBackgroundColor:{value:"#ffffff"},inactiveBackgroundColor:{value:"#ebebeb"},width:{value:400},height:{value:40}},Base.Extend(Tab,AbstractElement),Object.defineProperties(Tab.prototype,{inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),this._inputValue=value}},tabType:{get:function(){return this._tabType},set:function(value){this._saveProperty(),this._tabType=value}},typeHorizontal:{get:function(){return this._typeHorizontal},set:function(value){this._saveProperty(),this._typeHorizontal=value}},typeVertical:{get:function(){return this._typeVertical},set:function(value){this._saveProperty(),this._typeVertical=value}},fontSize:{get:function(){return this._fontSize},set:function(value){this._saveProperty(),this._fontSize=value}},fontFamily:{get:function(){return this._fontFamily},set:function(value){this._saveProperty(),this._fontFamily=value}},fontWeight:{get:function(){return this._fontWeight},set:function(value){this._saveProperty(),this._fontWeight=value}},fontStyle:{get:function(){return this._fontStyle},set:function(value){this._saveProperty(),this._fontStyle=value}},textDecoration:{get:function(){return this._textDecoration},set:function(value){this._saveProperty(),this._textDecoration=value}},textAlign:{get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value}},color:{get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value}},activeBackgroundColor:{get:function(){return this._activeBackgroundColor},set:function(value){this._saveProperty(),this._activeBackgroundColor=value}},inactiveBackgroundColor:{get:function(){return this._inactiveBackgroundColor},set:function(value){this._saveProperty(),this._inactiveBackgroundColor=value}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,"width").get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,"width").set.call(this,value),this.view.setTabSizes(this)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,"height").get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,"height").set.call(this,value),this.view.setTabSizes(this)}}}),Tab.prototype.update=function(){this._renderInitially&&(this._renderInitially=!1,this.view.renderTabs(this)),AbstractElement.prototype.update.call(this)},Tab}()},{"../enums/ElementTypes.js":184,"../enums/Orientations.js":193,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/TabView.js":175}],68:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("./AbstractElement.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Multipart=_dereq_("./behaviors/Multipart.js"),TableView=_dereq_("./views/TableView.js"),Base=_dereq_("../utils/Base.js"),Parse=_dereq_("../utils/Parse.js"),Color=_dereq_("../utils/Color.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TableHelper=_dereq_("./helpers/TableHelper.js"),SimpleBorder=_dereq_("./behaviors/SimpleBorder.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function updateStyles(styles,cellIndex,cellNewIndex){var style=styles[cellIndex],styleNew=styles[cellNewIndex];style&&styleNew?(styles[cellIndex]=styleNew,styles[cellNewIndex]=style):style&&!styleNew?(styles[cellNewIndex]=style,delete styles[cellIndex]):!style&&styleNew&&(styles[cellIndex]=styleNew,delete styles[cellNewIndex])}function getCompensatedWidths(widths,width){var sum=_.reduce(widths,function(sum,w){return sum+parseInt(w)},0),ratio=width/sum;return _.map(widths,function(w){return Parse.toPx(Math.round(parseInt(w)*ratio))}.bind(this))}function Table(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TABLE,this.view=this.createView(TableView),this._shouldUpdateStyles=!1,this.editable=!1,this.allowMultiplePartsSelected=!0,this.eventsRef={},this.debouncedColumnWidths=_.debounce(function(){this.updateColumnWidths()}.bind(this),1e3)}var minColumnWidth=10,headerBackground="#666666",headerFontWeight="bold",headerColor="#FFFFFF",directPropsMap={backgroundColor:"_backgroundColor",columnWidths:"_columnWidths",borderColor:"_borderColor",borderBottomWidth:"_borderBottomWidth",borderTopWidth:"_borderTopWidth",borderRightWidth:"_borderRightWidth",borderLeftWidth:"_borderLeftWidth",borderStyle:"_borderStyle"};return Table.DefaultProperties={width:{value:500},height:{value:210},zebra:{value:1},borderTopWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderRightWidth:{value:1},borderColor:{value:"#DEDEDE"},borderStyle:{value:"solid"},backgroundColor:{value:"#F0F0F0"},tableValue:{value:[["","",""],["","",""],["","",""],["","",""],["","",""]]},columnWidths:{value:["166px","166px","167px"]},cellsStyles:{value:{A0:{backgroundColor:headerBackground,fontWeight:headerFontWeight,color:headerColor},B0:{backgroundColor:headerBackground,fontWeight:headerFontWeight,color:headerColor},C0:{backgroundColor:headerBackground,fontWeight:headerFontWeight,color:headerColor}}}},Base.Extend(Table,AbstractElement),Base.ApplyBehavior(Table,SimpleTextEditable),Base.ApplyBehavior(Table,Multipart),Base.ApplyBehavior(Table,SimpleBorder),Table.prototype.getPropsForSerialize=function(){return _.mapValues(this.DefaultProperties,function(propValue,propName){return propName=directPropsMap[propName]||propName,_.cloneDeep(this[propName])}.bind(this))},Table.prototype.initProperties=function(props){this.beforeInitProperties&&this.beforeInitProperties(),_.forEach(this.DefaultProperties,function(propValue,propName){this._isPropertySerializable(propName)&&(this[propName]="undefined"!=typeof props[propName]?props[propName]:propValue.value)}.bind(this)),this._propertiesInitialized=!0},Table.prototype.beforeInitProperties=function(){var simpleTextProps=Object.keys(SimpleTextEditable.DefaultProperties);_.each(simpleTextProps,function(prop){directPropsMap[prop]="_"+prop,Object.defineProperty(Table.prototype,prop,{set:function(value){this.multipartSet(prop,value)},get:function(){return this.multipartGet(prop)}})})},Table.prototype.getMulitpleSelectionCells=function(firstPart,secondPart){for(var firstRow=TableHelper.GetRowIndex(firstPart),firstColumn=TableHelper.GetColumnIndex(firstPart),secondRow=TableHelper.GetRowIndex(secondPart),secondColumn=TableHelper.GetColumnIndex(secondPart),rows=_.sortBy([firstRow,secondRow]),cols=_.sortBy([firstColumn,secondColumn]),parts=[],r=rows[0];r<=rows[1];r++)for(var c=cols[0];c<=cols[1];c++)parts.push(TableHelper.GetCellCoordinates(r,c));
return parts},Table.prototype.addActivePart=function(onePartId){var parts=this.getMulitpleSelectionCells(this.firstPartSelected,onePartId);this.activeParts=parts},Table.prototype.updateColumnWidths=function(){var widths=this.getRealCellWidths();this.updateProperty(Properties.COLUMNWIDTHS,widths,!0)},Table.prototype.multipartSet=function(prop,value,updateStyles,beforeViewCallback){updateStyles=void 0===updateStyles||updateStyles;var applied=!1,save=function(prop,value,beforeViewCallback){var propUpFirst=prop.charAt(0).toUpperCase()+prop.slice(1);this._saveProperty(),this["_"+prop]=value,beforeViewCallback&&beforeViewCallback(),this.view["set"+propUpFirst](value),this.shouldUpdateStyles=updateStyles}.bind(this);if(this._propertiesInitialized)if(this.anyPartsSelected())this.applyStyleToCells(this.getActiveParts(),prop,value);else{if(this._cellsStyles){var cells=Object.keys(this._cellsStyles);applied=this.applyStyleToCells(cells,prop,void 0)}save(prop,value,beforeViewCallback),this.view.setCellsStyles(this._mergeCellsStyles(applied))}else save(prop,value,beforeViewCallback)},Table.prototype.multipartGet=function(prop){return this._propertiesInitialized?this.anyPartsSelected()&&this.cellsStyles[this.firstPartSelected]&&this.cellsStyles[this.firstPartSelected][prop]?this.cellsStyles[this.firstPartSelected][prop]:this["_"+prop]?this["_"+prop]:void 0:this["_"+prop]},Table.prototype.getRealCellWidths=function(){for(var tds=this.view.getTableElement().querySelector("tr").querySelectorAll("td"),widths=[],i=0,len=tds.length;i<len;i++){var styles=window.getComputedStyle(tds[i]);widths[i]=styles.width}return widths},Table.prototype.getRealHeight=function(){return parseInt(window.getComputedStyle(this.view.getTableElement()).height)},Object.defineProperties(Table.prototype,{width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this._propertiesInitialized&&this.debouncedColumnWidths()}},shouldUpdateStyles:{get:function(){return this._shouldUpdateStyles},set:function(value){this._shouldUpdateStyles=value,value&&(this.dirty=value)}},zebra:{get:function(){return this._zebra},set:function(value){this._saveProperty(),this._zebra=parseInt(value),this.shouldUpdateStyles=!0}},borderLeftWidth:{get:function(){return this.multipartGet("borderLeftWidth")},set:function(value){this.multipartSet("borderLeftWidth",value)}},borderBottomWidth:{get:function(){return this.multipartGet("borderBottomWidth")},set:function(value){this.multipartSet("borderBottomWidth",value)}},borderRightWidth:{get:function(){return this.multipartGet("borderRightWidth")},set:function(value){this.multipartSet("borderRightWidth",value)}},borderTopWidth:{get:function(){return this.multipartGet("borderTopWidth")},set:function(value){this.multipartSet("borderTopWidth",value)}},borderColor:{get:function(){return this.multipartGet("borderColor")},set:function(value){this.multipartSet("borderColor",value)}},backgroundColor:{get:function(){return this.multipartGet("backgroundColor")},set:function(value){return this.multipartSet("backgroundColor",value,!1,function(){this._oddBackgroundColor=this.zebra?Color.illuminate(value,.15):value}.bind(this))}},tableValue:{get:function(){return this._tableValue},set:function(value){this._saveProperty(),this._tableValue=value,this.view.setTableValue(value),this.shouldUpdateStyles=!0,this.resetParts(),_.forEach(TableHelper.GetAllCellsCoordinates(value),function(coords){this.addPart(coords,this.view.getCell(coords))}.bind(this))}},columnWidths:{get:function(){if(this.firstPartSelected){var columnIndex=TableHelper.GetColumnIndex(this.firstPartSelected);return parseInt(this._columnWidths[columnIndex])}return this._columnWidths},set:function(width){if(!this._propertiesInitialized||Array.isArray(width))return this._saveProperty(),this._columnWidths=width,void(this.shouldUpdateStyles=!0);var columnWidths=_.cloneDeep(this._columnWidths);if(width=parseInt(width),this.anyPartsSelected()){var indexes=_.uniq(this.activeParts.map(TableHelper.GetColumnIndex));columnWidths=this.computeCellWidths(indexes,width,columnWidths)}else for(var i=0,len=columnWidths.length;i<len;i++)columnWidths[i]=width;this._saveProperty(),this._columnWidths=columnWidths,this.view.setCellsStyles(this._mergeCellsStyles());var realWidths=this.getRealCellWidths();this._columnWidths=realWidths,this.shouldUpdateStyles=!0}},cellsStyles:{get:function(){return this._cellsStyles},set:function(value){this._saveProperty(),this._cellsStyles=value,this.shouldUpdateStyles=!0}}}),Table.prototype.getColumnWidths=function(){return this._columnWidths},Table.prototype.computeCellWidths=function(indexes,width,columnWidths,removing){var selectedTotal=indexes.map(function(i){return parseInt(columnWidths[i]||0)}.bind(this)).reduce(function(a,b){return parseInt(a)+parseInt(b)}.bind(this)),requested=indexes.length*width,toFind=requested-selectedTotal,tableTotal=columnWidths.reduce(function(a,b){return parseInt(a)+parseInt(b)}.bind(this));return removing&&(indexes=indexes.sort().reverse(),indexes.forEach(function(index){columnWidths.splice(index,1)}),indexes=[]),columnWidths.forEach(function(columnWidth,index){if(!_.includes(indexes,index)){var prop=parseInt(columnWidth)/(tableTotal-selectedTotal);columnWidths[index]=parseInt(columnWidths[index])-Math.round(toFind*prop)+"px"}}),indexes.forEach(function(index){columnWidths[index]=width+"px"}),columnWidths},Table.prototype.getColumnWidth=function(){if(this.firstPartSelected){var columnIndex=TableHelper.GetColumnIndex(this.firstPartSelected);return this.columnWidths[columnIndex]}return this.areAllColumnsEqual()?this.columnWidths[0]:""},Table.prototype.areAllColumnsEqual=function(){return!!this.columnWidths.reduce(function(a,b){return a===b&&a})},Table.prototype.getColsNumber=function(){return this.tableValue[0].length},Table.prototype.getRowsNumber=function(){return this.tableValue.length},Table.prototype.setRowsNumber=function(newRowsAmount){var i,currentRowsAmount=this.getRowsNumber(),diff=newRowsAmount-currentRowsAmount,values=_.cloneDeep(this.tableValue),columns=this.tableValue[0].length,cellStyles=_.cloneDeep(this._cellsStyles);if(diff>0){for(i=0;i<diff;i++){for(var row=[],newRowIndex=values.length,j=0;j<columns;j++){var newColIndex=row.push("")-1,newCellCoords=TableHelper.GetCellCoordinates(newRowIndex,newColIndex),adjacentCellCoords=TableHelper.GetCellCoordinates(newRowIndex-1,newColIndex);cellStyles[adjacentCellCoords]&&(cellStyles[newCellCoords]=cellStyles[adjacentCellCoords])}values.push(row)}this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.CELLSSTYLES,cellStyles,!0),this._updateProperty(Properties.TABLEVALUE,values,!0)}.bind(this))}else if(diff<0){for(i=0;i<Math.abs(diff);i++)values.pop();this.updateProperty(Properties.TABLEVALUE,values,!0)}},Table.prototype.setColsNumber=function(newColsAmount,copyText){var currentColsAmount=this.getColsNumber(),diff=newColsAmount-currentColsAmount,values=_.cloneDeep(this.tableValue),widths=_.cloneDeep(this._columnWidths),columnIndexes=[],cellStyles=_.cloneDeep(this._cellsStyles);0!==diff&&(values.forEach(function(row,rowIndex){for(var i=0;i<Math.abs(diff);i++)if(diff>0){var newColIndex=row.push(copyText?row[row.length-1]:"")-1;columnIndexes.push(newColIndex);var newCellCoords=TableHelper.GetCellCoordinates(rowIndex,newColIndex),adjacentCellCoords=TableHelper.GetCellCoordinates(rowIndex,newColIndex-1);cellStyles[adjacentCellCoords]&&(cellStyles[newCellCoords]=cellStyles[adjacentCellCoords])}else row.pop(),columnIndexes.push(row.length)}),widths=diff>0?this.computeCellWidths(_.uniq(columnIndexes),minColumnWidth,widths):this.computeCellWidths(_.uniq(columnIndexes),0,widths,!0),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.CELLSSTYLES,cellStyles,!0),this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.COLUMNWIDTHS,widths,!0)}.bind(this)))},Table.prototype.deleteColumns=function(indices){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles),widths=_.cloneDeep(this._columnWidths),movedStyles={};_.forEach(_.sortBy(indices).reverse(),function(index){values.forEach(function(row){row.splice(index,1)}),widths.splice(index,1),_.each(styles,function(styleData,key){var column=TableHelper.GetColumnIndex(key);if(column===index)delete styles[key];else if(column>=index){var row=TableHelper.GetRowIndex(key);movedStyles[TableHelper.GetCellCoordinates(row,column-1)]=_.cloneDeep(styles[key]),delete styles[key]}})}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0),this._updateProperty(Properties.COLUMNWIDTHS,this.getRealCellWidths(),!0)}.bind(this))},Table.prototype.moveColumns=function(colIndices,direction){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles);_.forEach(direction>0?_.sortBy(colIndices).reverse():_.sortBy(colIndices),function(colIndex){var colNewIndex=colIndex+direction;_.forEach(values,function(row,rowIndex){var cell=row[colIndex],cellNew=row[colNewIndex],cellIndex=TableHelper.GetCellCoordinates(rowIndex,colIndex),cellNewIndex=TableHelper.GetCellCoordinates(rowIndex,colNewIndex);updateStyles(styles,cellIndex,cellNewIndex),row[colIndex]=cellNew,row[colNewIndex]=cell})}),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.insertColumn=function(index,duplicate){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles),widths=_.cloneDeep(this._columnWidths),movedStyles={};widths.splice(index,0,"undefined"!=typeof duplicate?widths[duplicate]:minColumnWidth),widths=getCompensatedWidths(widths,this.width),values.forEach(function(row){var newColumn;newColumn=void 0!==duplicate?_.cloneDeep(row[duplicate]):"",row.splice(index,0,newColumn)}),_.each(styles,function(styleData,key){var row=TableHelper.GetRowIndex(key),column=TableHelper.GetColumnIndex(key);column===duplicate&&(movedStyles[TableHelper.GetCellCoordinates(row,index)]=_.cloneDeep(styles[key])),column>=index&&(movedStyles[TableHelper.GetCellCoordinates(row,column+1)]=_.cloneDeep(styles[key]),delete styles[key])}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0),this._updateProperty(Properties.COLUMNWIDTHS,widths,!0)}.bind(this))},Table.prototype.insertRow=function(index,duplicate){var newRow,values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles);newRow=void 0!==duplicate?_.cloneDeep(values[duplicate]):Array(values[0].length).join("x").split("x"),values.splice(index,0,newRow);var movedStyles={};_.each(styles,function(styleData,key){var row=TableHelper.GetRowIndex(key),column=TableHelper.GetColumnIndex(key);row===duplicate&&(movedStyles[TableHelper.GetCellCoordinates(index,column)]=_.cloneDeep(styles[key])),row>=index&&(movedStyles[TableHelper.GetCellCoordinates(row+1,column)]=_.cloneDeep(styles[key]),delete styles[key])}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.moveRows=function(rowIndices,direction){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles);_.forEach(direction>0?_.sortBy(rowIndices).reverse():_.sortBy(rowIndices),function(rowIndex){var rowNewIndex=rowIndex+direction,row=values[rowIndex],rowNew=values[rowNewIndex];_.forEach(row,function(cell,colIndex){var cellIndex=TableHelper.GetCellCoordinates(rowIndex,colIndex),cellNewIndex=TableHelper.GetCellCoordinates(rowNewIndex,colIndex);updateStyles(styles,cellIndex,cellNewIndex)}),values[rowIndex]=rowNew,values[rowNewIndex]=row}),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.deleteRows=function(indices){var values=_.cloneDeep(this._tableValue),styles=_.cloneDeep(this._cellsStyles),movedStyles={};_.forEach(_.sortBy(indices).reverse(),function(index){values.splice(index,1),_.each(styles,function(styleData,key){var row=TableHelper.GetRowIndex(key);if(row===index)delete styles[key];else if(row>index){var column=TableHelper.GetColumnIndex(key);movedStyles[TableHelper.GetCellCoordinates(row-1,column)]=_.cloneDeep(styles[key]),delete styles[key]}})}),Object.assign(styles,movedStyles),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.TABLEVALUE,values,!0),this._updateProperty(Properties.CELLSSTYLES,styles,!0)}.bind(this))},Table.prototype.setColumnWidth=function(index,columnWidth){var siblingColumnWidth,columnWidths=_.clone(this.getRealCellWidths()),maxColumnWidth=this._calculateSiblingColumnWidth(parseInt(columnWidths[index]),parseInt(columnWidths[index+1]),minColumnWidth);columnWidth<minColumnWidth?columnWidth=minColumnWidth:columnWidth>maxColumnWidth&&(columnWidth=maxColumnWidth),siblingColumnWidth=this._calculateSiblingColumnWidth(parseInt(columnWidths[index]),parseInt(columnWidths[index+1]),columnWidth),columnWidths.splice(index,2,Parse.toPx(columnWidth),Parse.toPx(siblingColumnWidth)),this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.COLUMNWIDTHS,columnWidths,!0)}.bind(this))},Table.prototype._calculateSiblingColumnWidth=function(oldColumnWidth,oldSiblingColumnWidth,newColumnWidth){return parseInt(oldColumnWidth)+parseInt(oldSiblingColumnWidth)-parseInt(newColumnWidth)},Table.prototype.isTextInput=function(){return this.editable},Table.prototype.isTextEditable=function(){return!1},Table.prototype.applyStyleToCells=function(cells,property,value){var cellsStyles=_.cloneDeep(this.cellsStyles);return _.each(cells,function(cell){return void 0===value&&cellsStyles[cell]&&cellsStyles[cell].hasOwnProperty(property)?void delete cellsStyles[cell][property]:void(void 0!==value&&(cellsStyles[cell]||(cellsStyles[cell]={}),cellsStyles[cell][property]=value))}),this._updateProperty(Properties.CELLSSTYLES,cellsStyles,!0),cellsStyles},Table.prototype.update=function(){this.shouldUpdateStyles&&(this.shouldUpdateStyles=!1,this.view.setCellsStyles(this._mergeCellsStyles())),AbstractElement.prototype.update.call(this),this.updateParts(this.Page.canvas.scale)},Table.prototype._mergeCellsStyles=function(newStyles){var cellsCoordinates=TableHelper.GetAllCellsCoordinates(this.tableValue),cellsStyles=newStyles||this.cellsStyles;return _.reduce(cellsCoordinates,function(styles,coords){var cellStyles=cellsStyles[coords],rowStyles=this._getRowStyles(coords),columnStyles=this._getColumnStyles(coords),genericStyles={};return styles[coords]=_.extend(genericStyles,rowStyles,columnStyles,cellStyles),styles}.bind(this),{})},Table.prototype._getRowStyles=function(coordinates){var styles={};return TableHelper.IsOddRow(coordinates)&&(styles.backgroundColor=this._oddBackgroundColor),styles},Table.prototype._getCols=function(parts){return _.unique(_.map(parts,this._getColById.bind(this)))},Table.prototype._getRows=function(parts){return _.unique(_.map(parts,this._getRowById.bind(this)))},Table.prototype._getColById=function(id){return Math.floor(_.sortBy(_.keys(this.parts)).indexOf(id)/this.getRowsNumber())},Table.prototype._getRowById=function(id){return _.sortBy(_.keys(this.parts)).indexOf(id)%this.getRowsNumber()},Table.prototype._getColumnStyles=function(coordinates){var styles={},columnIndex=TableHelper.GetColumnIndex(coordinates),widths=this.getColumnWidths();return widths[columnIndex]&&(styles.width=Parse.toPx(widths[columnIndex])),styles},Table.prototype.select=function(){this.view.addEditInfo(),AbstractElement.prototype.select.call(this)},Table.prototype.deselect=function(){this.view.removeEditInfo(),this.editable=!1,this.activeParts=[],this.firstPartSelected=null,AbstractElement.prototype.deselect.call(this)},Table.prototype.setEditing=function(turnOn){if(turnOn)this._addKeyboardEvents(),this.view.getTableElement().classList.add("ng-editing"),this.view.setCurrentlyEditable(this.Page.canvas.highlightPart.partId);else{this._removeKeyboardEvents(),this.view.getTableElement().classList.remove("ng-editing");var coords=this.view.currentlyEditable,row=TableHelper.GetRowIndex(coords),column=TableHelper.GetColumnIndex(coords);this.view.setCurrentlyEditable(!1);var tableData=_.cloneDeep(this.tableValue);tableData[row][column]=this.view.getCellValue(coords),this.updateProperty(Properties.TABLEVALUE,tableData,!0),this.editable=!1}},Table.prototype.onEnablePartSelection=function(){this.view.removeEditInfo()},Table.prototype.onDisablePartSelection=function(){this.view.enableEditInfo()},Table.prototype.canMoveRows=function(direction){var rows=this._getRows(this.activeParts),row=direction>0?_.last(rows):_.first(rows);return direction>0?row!==this.getRowsNumber()-1:0!==row},Table.prototype.canMoveCols=function(direction){var cols=this._getCols(this.activeParts),col=direction>0?_.last(cols):_.first(cols);return direction>0?col!==this.getColsNumber()-1:0!==col},Table.prototype.canDeleteCols=function(){var cols=this._getCols(this.activeParts);return cols.length<this.getColsNumber()},Table.prototype.canDeleteRows=function(){var rows=this._getRows(this.activeParts);return rows.length<this.getRowsNumber()},Table.prototype.selectionMoveRows=function(direction){if(this.activeParts.length&&this.canMoveRows(direction)){var rows=this._getRows(this.activeParts);this.moveRows(rows,direction)}},Table.prototype.selectionMoveCols=function(direction){if(this.activeParts.length&&this.canMoveCols(direction)){var cols=this._getCols(this.activeParts);this.moveColumns(cols,direction)}},Table.prototype.selectionInsertRow=function(direction){if(this.activeParts.length){var rows=_.sortBy(this._getRows(this.activeParts)),row=direction>0?_.last(rows):_.first(rows);this.insertRow(row+(direction>0?1:0),row)}},Table.prototype.selectionInsertCol=function(direction){if(this.activeParts.length){var cols=this._getCols(this.activeParts),col=direction>0?_.last(cols):_.first(cols);this.insertColumn(col+(direction>0?1:0),col)}},Table.prototype.selectionDeleteRows=function(){this.activeParts.length&&this.deleteRows(this._getRows(this.activeParts))},Table.prototype.selectionDeleteCols=function(){this.activeParts.length&&this.deleteColumns(this._getCols(this.activeParts))},Table.prototype.distributeColumnsEvenly=function(){var widths=_.times(this.getColsNumber(),function(){return Parse.toPx(this.width/this.getColsNumber())}.bind(this));this.Page.ElementsManager.inBatch(function(){this._updateProperty(Properties.COLUMNWIDTHS,widths,!0),this._updateProperty(Properties.CELLSSTYLES,this.cellsStyles,!0)}.bind(this))},Table.prototype.getMinColumnWidth=function(){return minColumnWidth},Table.prototype.getLeftOffsetForColumn=function(columnIndex){var offset=_.reduce(this.getRealCellWidths().slice(0,columnIndex),function(sum,value){return sum+parseInt(value)},0)+parseInt(this.borderLeftWidth)/2;return offset},Table}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"../utils/Color.js":217,"../utils/Parse.js":220,"./AbstractElement.js":24,"./behaviors/Multipart.js":84,"./behaviors/SimpleBorder.js":86,"./behaviors/SimpleTextEditable.js":87,"./helpers/TableHelper.js":104,"./views/TableView.js":176,lodash:19}],69:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TagView=_dereq_("./views/TagView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function Tag(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TAG,this.view=this.createView(TagView)}return Tag.DefaultProperties={width:{value:36},height:{value:36},title:{value:""},text:{value:""},src:{value:"/p/elements/standard/pins/black.png"}},Base.Extend(Tag,AbstractElement),Object.defineProperties(Tag.prototype,{title:{get:function(){return this._title},set:function(value){this._saveProperty(),this._title=value,this.view.setTitle(value)}},text:{get:function(){return this._text},set:function(value){this._saveProperty(),this._text=value,this.view.setText(value)}},src:{get:function(){return this._src},set:function(value){this._saveProperty(),this._src=value,this.view.setSrc(this._getCdnUrl(value))}}}),Tag}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./views/TagView.js":177}],70:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),TextEditable=_dereq_("./behaviors/TextEditable.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TextElementView=_dereq_("./views/TextElementView.js"),TextEditor=_dereq_("./helpers/TextEditor.js"),TextStyleHelper=_dereq_("./helpers/TextStyleHelper.js"),Properties=_dereq_("../enums/Properties.js");module.exports=function(){function TextElement(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TEXT_ELEMENT,this.view=this.createView(TextElementView)}return TextElement.DefaultProperties={inputValue:{value:TextStyleHelper.DEFAULT_TEXT},backgroundColor:{value:""},lineHeight:{value:""},link:{value:""},height:{value:14}},TextElement.ExcludedProperties={backgroundColor:!0,lineHeight:!0,textAlign:!0,link:!0},Base.Extend(TextElement,AbstractElement),Base.ApplyBehavior(TextElement,TextEditable),Object.defineProperties(TextElement.prototype,{backgroundColor:{get:function(){return TextEditor.GetBackgroundColor(this)},set:function(value){if(!this.Page.isDesignMode())return void this.view.setBackgroundColor(value);var contentData=TextEditor.SetBackgroundColor(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},lineHeight:{get:function(){return TextEditor.GetLineHeight(this)},set:function(value){var contentData=TextEditor.SetLineHeight(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},textAlign:{get:function(){return TextEditor.GetAlign(this)},set:function(value){var contentData=TextEditor.SetAlign(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},link:{get:function(){return TextEditor.GetLink(this)},set:function(value){var contentData=TextEditor.SetLink(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void this._updateProperty(Properties.HEIGHT,contentData.height,!0))}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this.shouldUpdateHeight=!0}},shouldUpdateHeight:{get:function(){return this._shouldUpdateHeight},set:function(value){this._shouldUpdateHeight=value,value&&(this.dirty=value)}}}),TextElement.prototype.update=function(){AbstractElement.prototype.update.call(this),this.shouldUpdateHeight&&(this.rect.height=parseInt(window.getComputedStyle(this.view.domElement).height)||this.rect.height,this.shouldUpdateHeight=!1)},TextElement.prototype.isTextEditable=function(){return!0},TextElement.prototype.isRichTextEditable=function(){return!0},TextElement.prototype.adjustHeightToText=function(){return!0},TextElement}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/TextEditable.js":88,"./helpers/TextEditor.js":105,"./helpers/TextStyleHelper.js":106,"./views/TextElementView.js":178}],71:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TextareaView=_dereq_("./views/TextareaView.js"),SimpleTextEditable=_dereq_("./behaviors/SimpleTextEditable.js"),Boxable=_dereq_("./behaviors/Boxable.js");module.exports=function(){function Textarea(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TEXTAREA,this.view=this.createView(TextareaView)}return Textarea.DefaultProperties={color:{value:"#474747"},paddingTop:{value:0},paddingRight:{value:10},paddingBottom:{value:0},paddingLeft:{value:10},boxShadow:{value:""},disabled:{value:0},value:{value:""},borderTopWidth:{value:1},borderRightWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},borderLock:{value:!0},borderColor:{value:"#c8c8c8"},backgroundColor:{value:"#FFFFFF"},textAlign:{value:"left"}},Base.Extend(Textarea,AbstractElement),Base.ApplyBehavior(Textarea,SimpleTextEditable),Base.ApplyBehavior(Textarea,Boxable),Object.defineProperties(Textarea.prototype,{paddingTop:{get:function(){return this._paddingTop},set:function(value){this._saveProperty(),this._paddingTop=value,this.view.setPaddingTop(value)}},paddingRight:{get:function(){return this._paddingRight},set:function(value){this._saveProperty(),this._paddingRight=value,this.view.setPaddingRight(value)}},paddingBottom:{get:function(){return this._paddingBottom},set:function(value){this._saveProperty(),this._paddingBottom=value,this.view.setPaddingBottom(value)}},paddingLeft:{get:function(){return this._paddingLeft},set:function(value){this._saveProperty(),this._paddingLeft=value,this.view.setPaddingLeft(value)}},boxShadow:{get:function(){return this._boxShadow},set:function(value){this._saveProperty(),this._boxShadow=value,this.view.setBoxShadow(value)}},disabled:{get:function(){return this._disabled},set:function(value){this._saveProperty(),this._disabled=value,this.view.setDisabled(value)}}}),Textarea.prototype.isTextInput=function(){return!0},Textarea}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./behaviors/Boxable.js":77,"./behaviors/SimpleTextEditable.js":87,"./views/TextareaView.js":179}],72:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),Box=_dereq_("./Box.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),TooltipView=_dereq_("./views/TooltipView.js");module.exports=function(){function Tooltip(){AbstractElement.apply(this,arguments),this.type=ElementTypes.TOOLTIP,this.view=this.createView(TooltipView)}return Tooltip.DefaultProperties={position:{value:"top"},borderTopWidth:{value:1},borderRightWidth:{value:1},borderBottomWidth:{value:1},borderLeftWidth:{value:1},backgroundColor:{value:"#f0f0f0"}},Base.Extend(Tooltip,Box),Object.defineProperties(Tooltip.prototype,{position:{get:function(){return this._position},set:function(value){this._saveProperty(),this._position=value,this.view.setPosition(value)}}}),Tooltip}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./AbstractElement.js":24,"./Box.js":29,"./views/TooltipView.js":180}],73:[function(_dereq_,module,exports){"use strict";var SvgIcon=_dereq_("./SvgIcon.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function UXPinIconSet(){SvgIcon.apply(this,arguments),this.type=ElementTypes.UXPIN_ICON_SET}return Base.Extend(UXPinIconSet,SvgIcon),UXPinIconSet}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgIcon.js":64}],74:[function(_dereq_,module,exports){"use strict";var SvgSymbol=_dereq_("./SvgSymbol.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),UniSvgView=_dereq_("./views/UniSvgView.js");module.exports=function(){function UniSvg(){SvgSymbol.apply(this,arguments),this.type=ElementTypes.UNI_SVG,this.view=this.createView(UniSvgView)}return UniSvg.ExcludedProperties={color:!0},Base.Extend(UniSvg,SvgSymbol),UniSvg}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgSymbol.js":66,"./views/UniSvgView.js":181}],75:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("./AbstractElement.js"),VideoView=_dereq_("./views/VideoView.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),VideoHelper=_dereq_("./helpers/VideoHelper");module.exports=function(){function Video(){AbstractElement.apply(this,arguments),this.type=ElementTypes.VIDEO,this.view=this.createView(VideoView)}return Video.DefaultProperties={width:{value:640},height:{value:385},videohtml:{value:""},videourl:{value:""},videohd:{value:""},backgroundImage:{value:""}},Base.Extend(Video,AbstractElement),Object.defineProperties(Video.prototype,{width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){return this.updateVideoHtml(),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){return this.updateVideoHtml(),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value)}},backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}},videohtml:{get:function(){return this._videohtml},set:function(value){this._saveProperty(),this._videohtml=value,this.Page.isPreviewMode()&&this.view.setVideoHtml(value)}},videourl:{get:function(){return this._videourl},set:function(value){this._saveProperty(),this._videourl=value,this.updateVideoHtml(value)}}}),Video.prototype.disablePreviewMode=function(){AbstractElement.prototype.disablePreviewMode.call(this),this.view.setVideoHtml(""),this.view.setBackgroundImage(this.backgroundImage)},Video.prototype.enablePreviewMode=function(){AbstractElement.prototype.enablePreviewMode.call(this),this.view.setVideoHtml(this.videohtml),this.view.setBackgroundImage("none")},Video.prototype.updateVideoHtml=function(url){var videoHtml=VideoHelper.getVideoHtml(url||this.videourl,this.width,this.height);videoHtml&&(this.videohtml=videoHtml)},Video}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./AbstractElement.js":24,"./helpers/VideoHelper":107,"./views/VideoView.js":182}],76:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Group=_dereq_("./Group.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function isVirtualGroupProperty(property){var properties=[Properties.ANGLE,Properties.X,Properties.Y,Properties.WIDTH,Properties.HEIGHT,Properties.STORED_ELEMENTS,Properties.IS_CLIP,Properties.CLIP,Properties.STATES];return properties.indexOf(property)>-1}function VirtualGroup(){Group.apply(this,arguments),this.type=ElementTypes.VIRTUAL_GROUP}return Base.Extend(VirtualGroup,Group),Object.defineProperties(VirtualGroup.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,this.update()}}}),VirtualGroup.prototype.isVirtualGroup=function(){return!0},VirtualGroup.prototype.update=function(){this._updateBoundingBox()},VirtualGroup.prototype.getProperties=function(){return _.reduce(_.rest(this.children),function(properties,child){var propertiesToMerge=child.getProperties();return _.pick(properties,function(propertyValue,propertyName){return propertiesToMerge[propertyName]})},_.first(this.children).getProperties())},VirtualGroup.prototype.validateProperty=function(property,value){
return value},VirtualGroup.prototype.getMaxBoxModelValue=function(property,edge){return _.min(_.map(this.children,function(child){return child.getMaxBoxModelValue(property,edge)}))},VirtualGroup.prototype.serialize=function(){var serialized={};return serialized.id=this.id,serialized.type=this.type,serialized.props={storedElements:_.cloneDeep(this.storedElements),x:this.x,y:this.y,width:this.width,height:this.height,angle:this.angle},serialized.v="2.0",serialized},VirtualGroup.prototype._updateProperty=function(property,value,addToHistory){isVirtualGroupProperty(property)?Group.prototype._updateProperty.call(this,property,value,addToHistory):_.forEach(this.children,function(child){child._updateProperty.call(child,property,value,addToHistory)})},VirtualGroup.prototype._saveProperty=function(){},VirtualGroup.prototype._updateStoredElements=function(elements){var child,index;elements.length>this._storedElements.length?_.forEach(_.difference(elements,this._storedElements),function(elementId){child=this._getElementById(elementId),index=elements.indexOf(elementId),index<this.children.length?this.children.splice(index,0,child):this.children.push(child)}.bind(this)):elements.length<this._storedElements.length&&_.forEach(_.difference(this._storedElements,elements),function(elementId){child=this._getElementById(elementId),index=this.getChildIndex(child),this.children.splice(index,1)}.bind(this)),this._storedElements=elements,this.update()},VirtualGroup.prototype._addChildProperties=function(child){_.forEach(_.reject(_.keys(child.getProperties()),isVirtualGroupProperty),function(property){this.hasOwnProperty(property)||Object.defineProperty(this,property,{get:function(){return child[property]},set:function(value){return this._updateProperty(property,value,!0)}})}.bind(this))},VirtualGroup.prototype._add=function(child){this._addChildProperties(child),this.children.push(child),this._storedElements=_.map(this.children,function(child){return child.id})},VirtualGroup.prototype._remove=function(child,index){this.children.splice(index,1),this._storedElements=_.map(this.children,function(child){return child.id})},VirtualGroup}()},{"../enums/ElementTypes.js":184,"../enums/Properties.js":195,"../utils/Base.js":213,"./Group.js":42,lodash:19}],77:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function getSizePropertyFromEdge(edge){return verticalEdges.indexOf(edge)>-1?"height":"width"}function getOppositeEdge(edge){return opposites[edge]}function Boxable(){this._defineMaxValuesGetters()}var verticalEdges=["top","bottom"],opposites={top:"bottom",left:"right",right:"left",bottom:"top"};return Boxable.DefaultProperties={borderTopWidth:{value:0},borderBottomWidth:{value:0},borderLeftWidth:{value:0},borderRightWidth:{value:0},borderTopLeftRadius:{value:0},borderTopRightRadius:{value:0},borderBottomRightRadius:{value:0},borderBottomLeftRadius:{value:0},borderColor:{value:"#c8c8c8"},borderStyle:{value:"solid"},borderLock:{value:!0},radiusLock:{value:!0},backgroundColor:{value:"#ebebeb"},backgroundImage:{value:""},backgroundSize:{value:"auto"},backgroundRepeat:{value:"repeat"},backgroundPosition:{value:"center center"}},Object.defineProperties(Boxable.prototype,{borderTopWidth:{get:function(){return this._borderTopWidth},set:function(value){this._saveProperty(),this._borderTopWidth=parseFloat(value)||0,this.view.setBorderTopWidth(value)}},borderBottomWidth:{get:function(){return this._borderBottomWidth},set:function(value){this._saveProperty(),this._borderBottomWidth=parseFloat(value)||0,this.view.setBorderBottomWidth(value)}},borderLeftWidth:{get:function(){return this._borderLeftWidth},set:function(value){this._saveProperty(),this._borderLeftWidth=parseFloat(value)||0,this.view.setBorderLeftWidth(value)}},borderRightWidth:{get:function(){return this._borderRightWidth},set:function(value){this._saveProperty(),this._borderRightWidth=parseFloat(value)||0,this.view.setBorderRightWidth(value)}},borderTopLeftRadius:{get:function(){return this._borderTopLeftRadius},set:function(value){this._saveProperty(),this._borderTopLeftRadius=parseFloat(value)||0,this.view.setBorderTopLeftRadius(this._borderTopLeftRadius)}},borderTopRightRadius:{get:function(){return this._borderTopRightRadius},set:function(value){this._saveProperty(),this._borderTopRightRadius=parseFloat(value)||0,this.view.setBorderTopRightRadius(this._borderTopRightRadius)}},borderBottomRightRadius:{get:function(){return this._borderBottomRightRadius},set:function(value){this._saveProperty(),this._borderBottomRightRadius=parseFloat(value)||0,this.view.setBorderBottomRightRadius(this._borderBottomRightRadius)}},borderBottomLeftRadius:{get:function(){return this._borderBottomLeftRadius},set:function(value){this._saveProperty(),this._borderBottomLeftRadius=parseFloat(value)||0,this.view.setBorderBottomLeftRadius(this._borderBottomLeftRadius)}},borderColor:{get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderLock:{get:function(){return this._borderLock},set:function(value){this._saveProperty(),this._borderLock=value}},radiusLock:{get:function(){return this._radiusLock},set:function(value){this._saveProperty(),this._radiusLock=value}},backgroundColor:{get:function(){return this._backgroundColor},set:function(value){this._saveProperty(),this._backgroundColor=value,this.view.setBackgroundColor(value)}},backgroundImage:{get:function(){return this._backgroundImage},set:function(value){this._saveProperty(),this._backgroundImage=value,this.view.setBackgroundImage(value)}},backgroundSize:{get:function(){return this._backgroundSize},set:function(value){this._saveProperty(),this._backgroundSize=value,this.view.setBackgroundSize(value)}},backgroundRepeat:{get:function(){return this._backgroundRepeat},set:function(value){this._saveProperty(),this._backgroundRepeat=value,this.view.setBackgroundRepeat(value)}},backgroundPosition:{get:function(){return this._backgroundPosition},set:function(value){this._saveProperty(),this._backgroundPosition=value,this.view.setBackgroundPosition(value)}}}),Boxable.prototype.getMaxBoxModelValue=function(property,edge){var size=parseInt(this[getSizePropertyFromEdge(edge)]),oppositeEdge=getOppositeEdge(edge),padding={top:parseInt(this.paddingTop)||0,left:parseInt(this.paddingLeft)||0,right:parseInt(this.paddingRight)||0,bottom:parseInt(this.paddingBottom)||0},border={top:parseInt(this.borderTopWidth)||0,left:parseInt(this.borderLeftWidth)||0,right:parseInt(this.borderRightWidth)||0,bottom:parseInt(this.borderBottomWidth)||0},calculators={border:function(){return size-border[oppositeEdge]-padding[edge]-padding[oppositeEdge]},padding:function(){return size-padding[oppositeEdge]-border[edge]-border[oppositeEdge]}};return calculators[property]()},Boxable.prototype._defineMaxValuesGetters=function(){var getters={borderTopWidth:this.getMaxBoxModelValue.bind(this,"border","top"),borderLeftWidth:this.getMaxBoxModelValue.bind(this,"border","left"),borderRightWidth:this.getMaxBoxModelValue.bind(this,"border","right"),borderBottomWidth:this.getMaxBoxModelValue.bind(this,"border","bottom"),paddingTop:this.getMaxBoxModelValue.bind(this,"padding","top"),paddingLeft:this.getMaxBoxModelValue.bind(this,"padding","left"),paddingRight:this.getMaxBoxModelValue.bind(this,"padding","right"),paddingBottom:this.getMaxBoxModelValue.bind(this,"padding","bottom")};_.forEach(getters,function(getter,property){this.DefaultProperties.hasOwnProperty(property)&&!this.DefaultProperties[property].hasOwnProperty("max")&&Object.defineProperty(this.DefaultProperties[property],"max",{get:getter})}.bind(this))},Boxable}()},{lodash:19}],78:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function Gridable(){}return Gridable.DefaultProperties={gridDisplay:{value:!1},gridOnTop:{value:!0},gridMaxWidth:{value:"100%"},gridColumnWidth:{value:60},gridMargin:{value:20},gridGutter:{value:20},gridWidth:{value:null},gridColumns:{value:null}},Gridable.ExcludedProperties={gridWidth:!0,gridColumns:!0},Object.defineProperties(Gridable.prototype,{gridDisplay:{get:function(){return this._gridDisplay},set:function(value){this._gridDisplay=value,this.shouldUpdateGrid=!0}},gridOnTop:{get:function(){return this._gridOnTop},set:function(value){this._gridOnTop=value,this.shouldUpdateGrid=!0}},gridMaxWidth:{get:function(){return this._gridMaxWidth},set:function(value){this._gridMaxWidth=value,this.shouldUpdateGrid=!0}},gridColumnWidth:{get:function(){return parseInt(this._gridColumnWidth)},set:function(value){this._gridColumnWidth=value,this.shouldUpdateGrid=!0}},gridMargin:{get:function(){return parseInt(this._gridMargin)},set:function(value){this._gridMargin=value,this.shouldUpdateGrid=!0}},gridGutter:{get:function(){return parseInt(this._gridGutter)},set:function(value){this._gridColumnWidth&&this._gridGutter&&this._gridMaxWidth&&"100%"!==this._gridMaxWidth&&(this._gridColumnWidth-=value-this._gridGutter),this._gridGutter=value,this.shouldUpdateGrid=!0}},gridColumns:{get:function(){var width=this.gridMaxWidth;return"100%"===this.gridMaxWidth&&(width=this.view.domElement.offsetWidth),width-=2*this.gridMargin,width<=0?0:(width+=this.gridGutter,Math.floor(width/(this.gridColumnWidth+this.gridGutter)))},set:function(value){var width=this.gridMaxWidth;"100%"===this.gridMaxWidth&&(width=this.view.domElement.offsetWidth),value&&(width-=2*this.gridMargin,width-=(value-1)*this.gridGutter,this.gridColumnWidth=Math.floor(width/value))}},gridWidth:{get:function(){var gridColumns,gridWidth;return"100%"===this.gridMaxWidth?gridWidth=this.view.domElement.offsetWidth:(gridWidth=2*this.gridMargin,gridColumns=this.gridColumns,gridColumns>0&&(gridWidth+=this.gridColumnWidth*gridColumns,gridWidth+=this.gridGutter*(gridColumns-1))),gridWidth}}}),Gridable.prototype.getGridOption=function(property){return Gridable.DefaultProperties.hasOwnProperty(property)?this[property]:null},Gridable.prototype.getAllGridOptions=function(){return _.mapValues(Gridable.DefaultProperties,function(value,property){return this[property]}.bind(this))},Gridable.prototype.setGridOption=function(property,value){return Gridable.DefaultProperties.hasOwnProperty(property)?void(this[property]=value):null},Gridable}()},{lodash:19}],79:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Guide=_dereq_("../ui/Guide.js"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){function Guideable(){this.activeGuide=null,this.guides=[]}return Guideable.prototype.resetGuides=function(){if(this.guides&&this.guides.length>0)for(var i=this.guides.length-1;i>=0;i--)this.removeGuide(this.guides[i])},Guideable.prototype.createGuide=function(orientation,x,y){var guide=new Guide(null,this.Page);return guide.initProperties({orientation:orientation,minX:-1*this.view.domElement.offsetLeft,minY:-1*this.view.domElement.offsetTop,x:x||0,y:y||0,width:this.view.containerDomElement.offsetWidth,height:this.view.containerDomElement.offsetHeight,visibility:this.Page.options.enableGuides}),guide.setScale(this.scale),this.addGuide(guide),guide},Guideable.prototype.createGuidesFromSerialized=function(serialized){_.forEach(serialized,function(serializedGuide){this.createGuide(serializedGuide.orientation,serializedGuide.x,serializedGuide.y)}.bind(this))},Guideable.prototype.addGuide=function(guide){this.guides.push(guide),this.view.overlayDomElement.appendChild(guide.view.domElement)},Guideable.prototype.removeGuide=function(guide){this.guides.splice(this.guides.indexOf(guide),1),this.view.overlayDomElement.removeChild(guide.view.domElement)},Guideable.prototype.displayGuides=function(value){for(var i=0,l=this.guides.length;i<l;i++)this.guides[i].visibility=value},Guideable.prototype.setGuidesScale=function(value){for(var i=0,l=this.guides.length;i<l;i++)this.guides[i].setScale(value)},Guideable.prototype.updateGuides=function(){for(var guide,i=0,l=this.guides.length;i<l;i++)guide=this.guides[i],this.resized&&(guide.minX=-1*this.view.domElement.offsetLeft,guide.minY=-1*this.view.domElement.offsetTop,guide.orientation===Orientations.HORIZONTAL?guide.width=this.view.containerDomElement.offsetWidth:guide.orientation===Orientations.VERTICAL&&(guide.height=this.view.containerDomElement.offsetHeight)),guide.dirty&&(guide.update(),guide.dirty=!1)},Guideable.prototype.serializeGuides=function(){return _.map(this.guides,function(guide){return guide.serialize()})},Guideable}()},{"../../enums/Orientations.js":193,"../ui/Guide.js":114,lodash:19}],80:[function(_dereq_,module,exports){"use strict";var IndicatorAlign=_dereq_("../../enums/IndicatorAlign.js");module.exports=function(){function getNewAttributesIndicator(page,options){var AttributesIndicator=_dereq_("../ui/AttributesIndicator.js");return new AttributesIndicator(null,page,options)}function Indicative(){this._shouldUpdateFixedIcon=!1,this._shouldUpdateInteractiveIcon=!1,this._indicatorFixed=null,this._indicatorInteractive=null}var CLASS_NAME_FIXED="el-fixed",CLASS_NAME_INTERACTIVE="el-interactive";return Indicative.DefaultProperties={shouldUpdateFixedIcon:{value:!1},shouldUpdateInteractiveIcon:{value:!1}},Indicative.ExcludedProperties={shouldUpdateFixedIcon:!0,shouldUpdateInteractiveIcon:!0},Object.defineProperties(Indicative.prototype,{shouldUpdateFixedIcon:{get:function(){return this._shouldUpdateFixedIcon},set:function(value){this._shouldUpdateFixedIcon=value,value&&(this.dirty=value)}},shouldUpdateInteractiveIcon:{get:function(){return this._shouldUpdateInteractiveIcon},set:function(value){this._shouldUpdateInteractiveIcon=value,value&&(this.dirty=value)}}}),Indicative.prototype.resetIndicators=function(){this.setFixedIconVisibility(!1),this.setInteractiveIconVisibility(!1),this.shouldUpdateFixedIcon=!0,this.shouldUpdateInteractiveIcon=!0,this.updateIndicators()},Indicative.prototype.updateIndicators=function(){if(this._shouldUpdateFixedIcon){if(this._isInInactiveState())return;this.setFixedIconVisibility(this.fixed),this._shouldUpdateFixedIcon=!1}if(this._shouldUpdateInteractiveIcon){if(this._isInInactiveState())return;this._shouldUpdateInteractiveIcon=!1,this.setInteractiveIconVisibility(!!this.actions.length)}},Indicative.prototype.setFixedIconVisibility=function(value){if(value&&(this.isVisible()||this.isSelected())){if(this._indicatorFixed)return;this._indicatorFixed=getNewAttributesIndicator(this.Page,{align:IndicatorAlign.TOP_LEFT,className:CLASS_NAME_FIXED}),this.addLinkedElement(this._indicatorFixed),this._indicatorFixed.show(this)}else{if(!this._indicatorFixed)return;this._indicatorFixed.remove(),this.removeLinkedElement(this._indicatorFixed),this._indicatorFixed=null}},Indicative.prototype.setInteractiveIconVisibility=function(value){if(value&&(this.isVisible()||this.isSelected())){if(this._indicatorInteractive)return;this._indicatorInteractive=getNewAttributesIndicator(this.Page,{align:IndicatorAlign.TOP_RIGHT,className:CLASS_NAME_INTERACTIVE}),this.addLinkedElement(this._indicatorInteractive),this._indicatorInteractive.show(this)}else if(this._indicatorInteractive){if(!this._indicatorInteractive)return;this._indicatorInteractive.remove(),this.removeLinkedElement(this._indicatorInteractive),this._indicatorInteractive=null}},Indicative.prototype._isInInactiveState=function(){return!this.parent||this.parent.isMultistate()&&!this.parent._isDescendantInActiveState(this)},Indicative}()},{"../../enums/IndicatorAlign.js":186,"../ui/AttributesIndicator.js":110}],81:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Hammer=_dereq_("hammerjs"),InteractionTriggers=_dereq_("../../enums/InteractionTriggers.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function isMouseTrigger(trigger){return[InteractionTriggers.CLICK,InteractionTriggers.CONTEXTMENU,InteractionTriggers.DBLCLICK,InteractionTriggers.MOUSEENTER,InteractionTriggers.MOUSELEAVE].indexOf(trigger)>-1}function isFormTrigger(trigger){return[InteractionTriggers.BLUR,InteractionTriggers.CHANGE,InteractionTriggers.FOCUS].indexOf(trigger)>-1}function isGestureTrigger(trigger){return[InteractionTriggers.TOUCH_PRESS,InteractionTriggers.TOUCH_PRESSUP,InteractionTriggers.TOUCH_SWIPEDOWN,InteractionTriggers.TOUCH_SWIPELEFT,InteractionTriggers.TOUCH_SWIPERIGHT,InteractionTriggers.TOUCH_SWIPEUP].indexOf(trigger)>-1}function getHammerGestureTrigger(trigger){return trigger.substr(6)}function createHammerInstance(element){var hammer=new Hammer(element,{prevent_default:!0});return hammer.get("swipe").set({direction:Hammer.DIRECTION_ALL,velocity:1e-4,threshold:2}),hammer.get("press").set({time:200}),hammer}function parseIdsToString(actions){return _.map(actions,function(action){return _.extend(action,{elements:_.map(action.elements,String)})})}function Interactable(){this._actions=[],this._hammer=null,this._propertyEndValues={},this._hoverPhase=null}return Interactable.DefaultProperties={actions:{value:[]},hammer:{value:null},propertyEndValues:{value:{}}},Interactable.ExcludedProperties={hammer:!0,propertyEndValues:!0},Object.defineProperties(Interactable.prototype,{actions:{get:function(){return this._actions},set:function(value){this._saveProperty(),this._actions=parseIdsToString(value),this.Page.isDesignMode()&&(this.shouldUpdateInteractiveIcon=!0)}},hammer:{get:function(){return this._hammer},set:function(value){this._hammer=value}},propertyEndValues:{get:function(){return this._propertyEndValues},set:function(value){this._propertyEndValues=value}}}),Interactable.prototype.addTrigger=function(trigger,componentInstanceId){this.view.setInteractive(!0),isMouseTrigger(trigger)?this.getDomElement().addEventListener(trigger,this.interactWithElement.bind(this,trigger,componentInstanceId)):trigger===InteractionTriggers.HOVER?(this.getDomElement().addEventListener(InteractionTriggers.MOUSEENTER,this.interactWithElement.bind(this,trigger,componentInstanceId)),this.getDomElement().addEventListener(InteractionTriggers.MOUSELEAVE,this.interactWithElement.bind(this,trigger,componentInstanceId))):isFormTrigger(trigger)?this.getDomFocusableElement().addEventListener(trigger,this.interactWithElement.bind(this,trigger,componentInstanceId)):isGestureTrigger(trigger)&&(this.hammer||(this.hammer=createHammerInstance(this.getDomElement())),this.hammer.on(getHammerGestureTrigger(trigger),this.interactWithElement.bind(this,trigger,componentInstanceId)))},Interactable.prototype.setPropertyEndValue=function(property,value){this.propertyEndValues[property]=value},Interactable.prototype.deletePropertyEndValue=function(property){delete this.propertyEndValues[property]},Interactable.prototype.getPropertyEndValue=function(property){return this.propertyEndValues[property]},Interactable.prototype.interactWithElement=function(trigger,componentInstanceId,e){if(trigger===InteractionTriggers.HOVER){if(e.type===InteractionTriggers.MOUSEENTER&&this._hoverPhase===e.type)return;this._hoverPhase=e.type}this.Page.InteractionsManager.interactWithElement(this.id,componentInstanceId,trigger,e)},Interactable.prototype.duplicateInteraction=function(index){var actions=_.clone(this.actions);actions.splice(index,0,_.cloneDeep(this.actions[index])),this.updateProperty(Properties.ACTIONS,actions)},Interactable.prototype.removeInteraction=function(index){var actions=_.clone(this.actions);actions.splice(index,1),this.updateProperty(Properties.ACTIONS,actions)},Interactable}()},{"../../enums/InteractionTriggers.js":188,"../../enums/Properties.js":195,hammerjs:2,lodash:19}],82:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Linkable(){this.linkedElements=[],this._dirtyPosition=!1}return Linkable.DefaultProperties={dirtyPosition:{value:!1},angle:{value:0},x:{value:0},y:{value:0},width:{value:100},height:{value:100}},Linkable.ExcludedProperties={dirtyPosition:!0},Object.defineProperties(Linkable.prototype,{dirtyPosition:{get:function(){return this._dirtyPosition},set:function(value){this._dirtyPosition=value}}}),Linkable.prototype.addLinkedElement=function(element){this.linkedElements.push(element)},Linkable.prototype.removeLinkedElement=function(element){this.linkedElements.splice(this.linkedElements.indexOf(element),1)},Linkable.prototype.updateLinkedElements=function(){this.dirtyPosition&&(this.linkedElements.forEach(function(element){element.initiatorUpdated(this)}.bind(this)),this.dirtyPosition=!1),this.dirtyOrder&&(this.linkedElements.forEach(function(element){element.initiatorReordered(this)}.bind(this)),this.dirtyOrder=!1)},Linkable.prototype.deleteLinkedElements=function(){this.linkedElements.forEach(function(element){element.initiatorDeleted(this)}.bind(this))},Linkable}()},{}],83:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Linked(){this.changeListeners=[],this.reorderListeners=[],this.deleteListeners=[]}return Linked.prototype.initiatorUpdated=function(initiator){this.changeListeners.forEach(function(listener){"function"==typeof listener&&listener(initiator)})},Linked.prototype.initiatorReordered=function(initiator){this.reorderListeners.forEach(function(listener){"function"==typeof listener&&listener(initiator)})},Linked.prototype.initiatorDeleted=function(initiator){this.deleteListeners.forEach(function(listener){"function"==typeof listener&&listener(initiator)})},Linked.prototype.addChangeListener=function(callback){this.changeListeners.push(callback)},Linked.prototype.removeChangeListener=function(callback){this.changeListeners.splice(this.changeListeners.indexOf(callback),1)},Linked.prototype.addReorderListener=function(callback){this.reorderListeners.push(callback)},Linked.prototype.removeReorderListener=function(callback){this.reorderListeners.splice(this.reorderListeners.indexOf(callback),1)},Linked.prototype.addDeleteListener=function(callback){this.deleteListeners.push(callback)},Linked.prototype.removeDeleteListener=function(callback){this.deleteListeners.splice(this.deleteListeners.indexOf(callback),1)},Linked}()},{}],84:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Point=_dereq_("../../primitives/Point.js"),Rectangle=_dereq_("../../primitives/Rectangle.js");module.exports=function(){function Multipart(){this.firstPartSelected=null,this.activeParts=[]}return Multipart.prototype.isMultipart=function(){return!0},Multipart.prototype.resetParts=function(){this.parts={}},Multipart.prototype.addPart=function(id,domElement){this.parts[id]={domElement:domElement,rect:new Rectangle}},Multipart.prototype.getPart=function(id){return this.parts[id]},Multipart.prototype.setActiveParts=function(parts){parts&&(this.activeParts=parts,this.firstPartSelected=parts[0],this.editable=!0)},Multipart.prototype.onEnablePartSelection=function(){},Multipart.prototype.onDisablePartSelection=function(){},Multipart.prototype.getActiveParts=function(){return this.activeParts},Multipart.prototype.anyPartsSelected=function(){return!!this.activeParts.length},Multipart.prototype.setPartsApplicableProperties=function(properties){this.applicableProperties=properties},Multipart.prototype.isPartProperty=function(property){return this.applicableProperties.indexOf(property)>-1},Multipart.prototype.getPartBoundingBox=function(ids){var boxes=[];if(!Array.isArray(ids))return this.getPart(ids).rect.getBoundingBox();ids.forEach(function(partId){boxes.push(this.getPart(partId).rect.getBoundingBox())}.bind(this));var minX=boxes.sort(function(a,b){return a.x-b.x})[0],maxX=boxes[boxes.length-1],minY=boxes.sort(function(a,b){return a.y-b.y})[0],maxY=boxes[boxes.length-1];return new Rectangle(minX.x,minY.y,maxX.x+maxX.width-minX.x,maxY.y+maxY.height-minY.y)},Multipart.prototype.updateParts=function(scale){var parentBoundingRect=this.view.domElement.getBoundingClientRect(),angle=this.angle,rotatePoint=new Point;_.forEach(this.parts,function(part){var boundingRect=part.domElement.getBoundingClientRect();part.rect.x=(boundingRect.left-parentBoundingRect.left)/scale,part.rect.y=(boundingRect.top-parentBoundingRect.top)/scale,part.rect.width=boundingRect.width/scale,part.rect.height=boundingRect.height/scale,part.rect.rotate(rotatePoint,angle)})},Multipart.prototype.partHitTest=function(point){for(var id in this.parts)if(this.parts.hasOwnProperty(id)&&this.parts[id].rect.hitTest(point))return id;return null},Multipart}()},{"../../primitives/Point.js":211,"../../primitives/Rectangle.js":212,lodash:19}],85:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Pickable(){this.pickMode=!1,this.ignoreMultistateChildren=!1}var onMouseMoveRef,onMouseDownRef,onKeyDownRef,validatePickRef,TARGETING_CLASS="targeting";return Pickable.prototype.getPickedElement=function(){for(var element,hit,elements=(this.Page.ElementsManager.getEditingComponent()||this).children,i=elements.length;i-- >0;){if(element=elements[i],hit=element.hitTest(this.clickPoint,this.ignoreMultistateChildren))return hit;if(element.rect.hitTest(this.clickPoint))return element}return null},Pickable.prototype.onPickMouseMove=function(validator,e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getPickedElement();element&&validator(element.id)?(this.highlight.show(element,!0),this._elementNameShow(element,e)):(this.highlight.hide(),this._elementNameHide())},Pickable.prototype.pickElementId=function(elementId){validatePickRef(elementId)},Pickable.prototype.onPickMouseDown=function(e){this.clickPoint=this._getRelativeScaledMousePosition(e);var element=this.getPickedElement();element&&validatePickRef(element.id)},Pickable.prototype.onPickKeyDown=function(reject,e){27===e.which&&(e.preventDefault(),reject("exit"))},Pickable.prototype.isPickMode=function(){return this.pickMode},Pickable.prototype.validatePick=function(validator,resolve,elementId){validator(elementId)&&resolve(elementId)},Pickable.prototype.startPickMode=function(validator,ignoreMultistateChildren){if(!this.pickMode)return this.pickMode=!0,this.ignoreMultistateChildren=ignoreMultistateChildren,this._removeEvents(),new Promise(function(resolve,reject){onMouseMoveRef=this.onPickMouseMove.bind(this,validator),onMouseDownRef=this.onPickMouseDown.bind(this),onKeyDownRef=this.onPickKeyDown.bind(this,reject),validatePickRef=this.validatePick.bind(this,validator,resolve),document.addEventListener("keydown",onKeyDownRef),this.view.containerDomElement.addEventListener("mousemove",onMouseMoveRef),this.view.containerDomElement.addEventListener("mousedown",onMouseDownRef),this.view.overlayDomElement.classList.add(TARGETING_CLASS)}.bind(this))},Pickable.prototype.endPickMode=function(){this.pickMode&&(this.pickMode=!1,this.ignoreMultistateChildren=!1,this._addEvents(),document.removeEventListener("keydown",onKeyDownRef),this.view.containerDomElement.removeEventListener("mousemove",onMouseMoveRef),this.view.containerDomElement.removeEventListener("mousedown",onMouseDownRef),this.view.overlayDomElement.classList.remove(TARGETING_CLASS))},Pickable}()},{}],86:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function getSizePropertyFromEdge(edge){return verticalEdges.indexOf(edge)>-1?"height":"width"}function getOppositeEdge(edge){return opposites[edge]}function SimpleBorder(){this._defineMaxValuesGetters()}var verticalEdges=["top","bottom"],opposites={top:"bottom",left:"right",right:"left",bottom:"top"};return SimpleBorder.DefaultProperties={borderTopWidth:{value:0},borderBottomWidth:{value:0},borderLeftWidth:{value:0},borderRightWidth:{value:0},borderColor:{value:"#c8c8c8"},borderStyle:{value:"solid"},borderLock:{value:!0}},Object.defineProperties(SimpleBorder.prototype,{borderTopWidth:{configurable:!0,get:function(){return this._borderTopWidth},set:function(value){this._saveProperty(),this._borderTopWidth=value,this.view.setBorderTopWidth(value)}},borderBottomWidth:{configurable:!0,get:function(){return this._borderBottomWidth},set:function(value){this._saveProperty(),this._borderBottomWidth=value,this.view.setBorderBottomWidth(value)}},borderLeftWidth:{configurable:!0,get:function(){return this._borderLeftWidth},set:function(value){this._saveProperty(),this._borderLeftWidth=value,this.view.setBorderLeftWidth(value)}},borderRightWidth:{configurable:!0,get:function(){return this._borderRightWidth},set:function(value){this._saveProperty(),this._borderRightWidth=value,this.view.setBorderRightWidth(value)}},borderColor:{configurable:!0,get:function(){return this._borderColor},set:function(value){this._saveProperty(),this._borderColor=value,this.view.setBorderColor(value)}},borderStyle:{configurable:!0,get:function(){return this._borderStyle},set:function(value){this._saveProperty(),this._borderStyle=value,this.view.setBorderStyle(value)}},borderLock:{configurable:!0,get:function(){return this._borderLock},set:function(value){this._saveProperty(),this._borderLock=value}}}),SimpleBorder.prototype.getMaxBoxModelValue=function(property,edge){var size=parseInt(this[getSizePropertyFromEdge(edge)]),oppositeEdge=getOppositeEdge(edge),border={top:parseInt(this.borderTopWidth)||0,left:parseInt(this.borderLeftWidth)||0,right:parseInt(this.borderRightWidth)||0,bottom:parseInt(this.borderBottomWidth)||0},calculators={border:function(){return size-border[oppositeEdge]}};return calculators[property]()},SimpleBorder.prototype._defineMaxValuesGetters=function(){var getters={borderTopWidth:this.getMaxBoxModelValue.bind(this,"border","top"),borderLeftWidth:this.getMaxBoxModelValue.bind(this,"border","left"),borderRightWidth:this.getMaxBoxModelValue.bind(this,"border","right"),borderBottomWidth:this.getMaxBoxModelValue.bind(this,"border","bottom")};_.forEach(getters,function(getter,property){this.DefaultProperties.hasOwnProperty(property)&&!this.DefaultProperties[property].hasOwnProperty("max")&&Object.defineProperty(this.DefaultProperties[property],"max",{get:getter})}.bind(this))},SimpleBorder}()},{lodash:19}],87:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),TextFormattable=_dereq_("./TextFormattable.js");module.exports=function(){function SimpleTextEditable(){}return SimpleTextEditable.DefaultProperties={inputValue:{value:""},color:{value:"#000000"},fontSize:{value:"14px"},fontWeight:{value:"normal"},fontStyle:{value:"normal"},fontFamily:{value:"Arial"},textDecoration:{value:""},textAlign:{value:"center"}},_.extend(SimpleTextEditable.prototype,TextFormattable.prototype),Object.defineProperties(SimpleTextEditable.prototype,{inputValue:{configurable:!0,get:function(){return this._inputValue},set:function(value){this._saveProperty(),value=this.isTextInput()?value.replace(/<br \/>/g,"\n"):value.replace(/\r?\n/g,"<br />"),this._inputValue=value,this.view.setInputValue(value)}},color:{configurable:!0,get:function(){return this._color},set:function(value){this._saveProperty(),this._color=value,this.view.setColor(value)}},fontSize:{configurable:!0,get:function(){return this._fontSize},set:function(value){this._saveProperty(),this._fontSize=value,this.view.setFontSize(value)}},fontWeight:{configurable:!0,get:function(){return this._fontWeight},set:function(value){this._saveProperty(),this._fontWeight=value,this.view.setFontWeight(value)}},fontStyle:{configurable:!0,get:function(){return this._fontStyle},set:function(value){this._saveProperty(),this._fontStyle=value,this.view.setFontStyle(value)}},fontFamily:{configurable:!0,get:function(){return this._fontFamily},set:function(value){this._saveProperty(),this._fontFamily=value,this.view.setFontFamily(value)}},textDecoration:{configurable:!0,get:function(){return this._textDecoration},set:function(value){this._saveProperty(),this._textDecoration=value,this.view.setTextDecoration(value)}},textAlign:{configurable:!0,get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value,this.view.setTextAlign(value);
}}}),SimpleTextEditable.prototype.isTextEditable=function(){return!0},SimpleTextEditable.prototype.setEditing=function(value){this.view.setEditing(value),value?this._addKeyboardEvents():this._removeKeyboardEvents()},SimpleTextEditable.prototype._addKeyboardEvents=function(){this.keyboardEventRef=function(e){66===e.keyCode&&e.metaKey?(this.Page.ElementsManager.startBatch(),this.toggleBold(),this.Page.ElementsManager.endBatch()):73===e.keyCode&&e.metaKey?(this.Page.ElementsManager.startBatch(),this.toggleItalic(),this.Page.ElementsManager.endBatch()):85===e.keyCode&&e.metaKey&&(this.Page.ElementsManager.startBatch(),this.toggleUnderline(),this.Page.ElementsManager.endBatch())}.bind(this),this.view.domElement.addEventListener("keydown",this.keyboardEventRef)},SimpleTextEditable.prototype._removeKeyboardEvents=function(){this.view.domElement.removeEventListener("keydown",this.keyboardEventRef)},SimpleTextEditable}()},{"./TextFormattable.js":89,lodash:19}],88:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js"),TextEditor=_dereq_("../helpers/TextEditor.js"),TextFormattable=_dereq_("./TextFormattable.js"),AbstractElement=_dereq_("../AbstractElement.js");module.exports=function(){var TextEditable=function(){};return TextEditable.DefaultProperties={inputValue:{value:""},color:{value:"#000000"},fontSize:{value:"14px"},fontWeight:{value:"normal"},fontStyle:{value:"normal"},fontFamily:{value:"Arial"},letterSpacing:{value:0},textDecoration:{value:""},textAlign:{value:"center"}},TextEditable.ExcludedProperties={fontSize:!0,fontWeight:!0,fontFamily:!0,fontStyle:!0,letterSpacing:!0,textDecoration:!0,color:!0},_.extend(TextEditable.prototype,TextFormattable.prototype),Object.defineProperties(TextEditable.prototype,{inputValue:{get:function(){return this._inputValue},set:function(value){this._saveProperty(),value=value.replace(/<p[^>]*>(<span[^>]*>)*\n+(<\/span>)*<\/p>/g,""),this._inputValue=value,TextEditor.GetEditingElement()!==this&&this.view.setInputValue(value)}},color:{get:function(){return TextEditor.GetColor(this)},set:function(value){if(!this.Page.isDesignMode())return void this.view.setColor(value);var contentData=TextEditor.SetColor(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontSize:{get:function(){return TextEditor.GetFontSize(this)},set:function(value){var contentData=TextEditor.SetFontSize(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontWeight:{get:function(){return TextEditor.GetBold(this)?"bold":"normal"},set:function(value){var contentData=TextEditor.SetBold(this,"bold"===value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontStyle:{get:function(){return TextEditor.GetItalic(this)?"italic":"normal"},set:function(value){var contentData=TextEditor.SetItalic(this,"italic"===value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},fontFamily:{get:function(){return TextEditor.GetFont(this)},set:function(value){var contentData=TextEditor.SetFont(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},letterSpacing:{get:function(){return TextEditor.GetLetterSpacing(this)},set:function(value){var contentData=TextEditor.SetLetterSpacing(this,value);return!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},textDecoration:{get:function(){var decoration=[];return TextEditor.GetUnderline(this)&&decoration.push("underline"),TextEditor.GetLineThrough(this)&&decoration.push("line-through"),decoration.length>0?decoration.join(" "):"none"},set:function(value){var contentData;return"none"===value||_.isEmpty(value)?(contentData=TextEditor.SetUnderline(this,!1),contentData=TextEditor.SetLineThrough(this,!1)):(value.match(/underline/)&&(contentData=TextEditor.SetUnderline(this,!0)),value.match(/line\-through/)&&(contentData=TextEditor.SetLineThrough(this,!0))),!!contentData&&(this._saveProperty(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),void(this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0)))}},textAlign:{configurable:!0,get:function(){return this._textAlign},set:function(value){this._saveProperty(),this._textAlign=value,this.view.setTextAlign(value)}}}),TextEditable.prototype.isTextEditable=function(){return!0},TextEditable.prototype.isRichTextEditable=function(){return!0},TextEditable.prototype.setEditing=function(value){this.view.setEditing(value)},TextEditable.prototype.select=function(){this.shouldUpdateHeight=!0,this.view.setTextContentEditable(!0),TextEditor.Init(this),AbstractElement.prototype.select.apply(this,arguments)},TextEditable.prototype.deselect=function(){TextEditor.Destroy(this),this.view.setTextContentEditable(!1),AbstractElement.prototype.deselect.apply(this,arguments)},TextEditable.prototype.insertText=function(text){var contentData=TextEditor.InsertText(this,text);contentData&&(this.Page.ElementsManager.startBatch(),this._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),this.adjustHeightToText()&&this._updateProperty(Properties.HEIGHT,contentData.height,!0),this.Page.ElementsManager.endBatch())},TextEditable.prototype._updateProperty=function(property,value,addToHistory){this._isPropertySerializable(property)?AbstractElement.prototype._updateProperty.call(this,property,value,addToHistory):this[property]=value},TextEditable}()},{"../../enums/Properties.js":195,"../AbstractElement.js":24,"../helpers/TextEditor.js":105,"./TextFormattable.js":89,lodash:19}],89:[function(_dereq_,module,exports){"use strict";var Properties=_dereq_("../../enums/Properties.js"),TextStyleHelper=_dereq_("../helpers/TextStyleHelper.js");module.exports=function(){function TextFormattable(){}return TextFormattable.prototype.toggleBold=function(){var value="bold"===this.fontWeight?"normal":"bold";this._updateProperty(Properties.FONT_WEIGHT,value,!0),TextStyleHelper.SetDefaultStyle(Properties.FONT_WEIGHT,value)},TextFormattable.prototype.toggleItalic=function(){var value="italic"===this.fontStyle?"normal":"italic";this._updateProperty(Properties.FONT_STYLE,value,!0),TextStyleHelper.SetDefaultStyle(Properties.FONT_STYLE,value)},TextFormattable.prototype.toggleUnderline=function(){var value,currentValue=this.textDecoration.replace("none","");value=currentValue.match(/underline/)?currentValue.replace("underline",""):currentValue+" underline",value=0===value.trim().length?"none":value,this._updateProperty(Properties.TEXT_DECORATION,value,!0),TextStyleHelper.SetDefaultStyle(Properties.TEXT_DECORATION,value)},TextFormattable}()},{"../../enums/Properties.js":195,"../helpers/TextStyleHelper.js":106}],90:[function(_dereq_,module,exports){"use strict";var ImageUpload=_dereq_("../ui/ImageUpload.js"),Properties=_dereq_("../../enums/Properties.js"),UploadStatus=_dereq_("../../enums/UploadStatus.js"),ImageEditor=_dereq_("../helpers/ImageEditor.js");module.exports=function(){function Uploadable(){this.imageUpload=null,this.hasProperty(Properties.SRC)?this.srcProperty=Properties.SRC:this.hasProperty(Properties.BACKGROUND_IMAGE)&&(this.srcProperty=Properties.BACKGROUND_IMAGE)}return Uploadable.prototype.isUploadable=function(){return!0},Uploadable.prototype.isDuringUpload=function(){return!!this.imageUpload&&this.imageUpload.status===UploadStatus.PENDING},Uploadable.prototype.setTemporaryImageSrc=function(src){this.shouldUpdateSrc=!1,this.srcProperty===Properties.SRC?this.view.setSrc(this._getCdnUrl(src),!0):this.srcProperty===Properties.BACKGROUND_IMAGE&&this.view.setBackgroundImage(this._getCdnUrl(src))},Uploadable.prototype.setImageSrc=function(src,addToHistory){this._updateProperty(this.srcProperty,src,addToHistory)},Uploadable.prototype.showProgress=function(){this.imageUpload||(this.imageUpload=new ImageUpload(null,this.Page),this.addLinkedElement(this.imageUpload)),this.imageUpload.show(this),this.imageUpload.status=UploadStatus.PENDING},Uploadable.prototype.hideProgress=function(){this.imageUpload&&(this.imageUpload.remove(),this.removeLinkedElement(this.imageUpload),this.imageUpload=null)},Uploadable.prototype.setProgress=function(e){this.imageUpload&&(this.imageUpload.status=UploadStatus.PENDING,this.imageUpload.progress=e.loaded/e.total)},Uploadable.prototype.setCompleted=function(src){this.imageUpload&&(this.imageUpload.progress=1,this.imageUpload.status=UploadStatus.COMPLETED,this.hideProgress()),ImageEditor.PreloadImage(src).then(function(){this.setImageSrc(src,!0)}.bind(this))},Uploadable.prototype.setFailed=function(){this.imageUpload&&(this.imageUpload.status=UploadStatus.FAILED)},Uploadable}()},{"../../enums/Properties.js":195,"../../enums/UploadStatus.js":199,"../helpers/ImageEditor.js":98,"../ui/ImageUpload.js":124}],91:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function getBoundingBox(selectedElements){return _.reduce(_.rest(selectedElements),function(bb,element){return bb.add(element.getBoundingBox(!0))},selectedElements[0].getBoundingBox(!0).clone())}function getCumulatedSize(selectedElements,sizeType){return _.reduce(selectedElements,function(size,element){return size+element.getBoundingBox(!0)[sizeType]},0)}function moveHorizontallyBy(element,delta){moveElementBy(element,Properties.X,delta)}function moveVerticallyBy(element,delta){moveElementBy(element,Properties.Y,delta)}function moveElementBy(element,property,delta){var value=element[property]+delta;element._updateProperty(property,value,!0)}function sortByPosition(selectedElements,position){return _.sortBy(selectedElements,function(element){return element.getBoundingBox(!0)[position]})}function Align(axis,selectedElements){var fn="Align"+_.capitalize(axis);if("function"==typeof this[fn])return this[fn](selectedElements)}function Distribute(orientation,selectedElements){var fn="Distribute"+_.capitalize(orientation);if("function"==typeof this[fn])return this[fn](selectedElements)}function AlignTop(selectedElements){var axis=getBoundingBox(selectedElements).top;_.forEach(selectedElements,function(element){moveVerticallyBy(element,axis-element.getBoundingBox(!0).top)})}function AlignMiddle(selectedElements){var axis=getBoundingBox(selectedElements).middle;_.forEach(selectedElements,function(element){var bb=element.getBoundingBox(!0),bbTop=axis-bb.height/2;moveVerticallyBy(element,bbTop-bb.top)})}function AlignBottom(selectedElements){var axis=getBoundingBox(selectedElements).bottom;_.forEach(selectedElements,function(element){moveVerticallyBy(element,axis-element.getBoundingBox(!0).bottom)})}function AlignLeft(selectedElements){var axis=getBoundingBox(selectedElements).left;_.forEach(selectedElements,function(element){moveHorizontallyBy(element,axis-element.getBoundingBox(!0).left)})}function AlignCenter(selectedElements){var axis=getBoundingBox(selectedElements).center;_.forEach(selectedElements,function(element){var bb=element.getBoundingBox(!0),bbLeft=axis-bb.width/2;moveHorizontallyBy(element,bbLeft-bb.left)})}function AlignRight(selectedElements){var axis=getBoundingBox(selectedElements).right;_.forEach(selectedElements,function(element){moveHorizontallyBy(element,axis-element.getBoundingBox(!0).right)})}function DistributeHorizontal(selectedElements){var bb=getBoundingBox(selectedElements),elementsWidth=getCumulatedSize(selectedElements,"width"),spacing=DEFAULT_SPACING,left=bb.left;bb.width>=elementsWidth&&(spacing=(bb.width-elementsWidth)/(selectedElements.length-1)),_.forEach(sortByPosition(selectedElements,"left"),function(element){moveHorizontallyBy(element,left-element.getBoundingBox(!0).left),left+=element.getBoundingBox(!0).width+spacing})}function DistributeVertical(selectedElements){var bb=getBoundingBox(selectedElements),elementsHeight=getCumulatedSize(selectedElements,"height"),spacing=DEFAULT_SPACING,top=bb.top;bb.height>=elementsHeight&&(spacing=(bb.height-elementsHeight)/(selectedElements.length-1)),_.forEach(sortByPosition(selectedElements,"top"),function(element){moveVerticallyBy(element,top-element.getBoundingBox(!0).top),top+=element.getBoundingBox(!0).height+spacing})}var DEFAULT_SPACING=5,AlignHelper={Align:Align,AlignTop:AlignTop,AlignMiddle:AlignMiddle,AlignBottom:AlignBottom,AlignLeft:AlignLeft,AlignCenter:AlignCenter,AlignRight:AlignRight,Distribute:Distribute,DistributeHorizontal:DistributeHorizontal,DistributeVertical:DistributeVertical};return Object.freeze(AlignHelper)}()},{"../../enums/Properties.js":195,lodash:19}],92:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Tree=_dereq_("../../utils/Tree.js");module.exports=function(){function zSort(reversed,element1,element2){var ancestor,order=reversed?-1:1;return Tree.IsAncestorOf(element2,element1)?-1*order:Tree.IsDescendantOf(element2,element1)?1*order:(ancestor=Tree.GetClosestAncestor(element1,element2),(ancestor.getChildIndex(Tree.GetRootElement(element1,ancestor))-ancestor.getChildIndex(Tree.GetRootElement(element2,ancestor)))*order)}function ZSortSelectedElements(selectedElements,reversed){selectedElements.sort(zSort.bind(this,reversed))}function MoveToFront(selectedElements){var index;selectedElements.sort(zSort.bind(null,!1)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index<element.parent.children.length-1&&element.parent.moveChildAt(element,element.parent.children.length-1)})}function MoveToBack(selectedElements){var index;selectedElements.sort(zSort.bind(null,!0)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index>0&&element.parent.moveChildAt(element,0)})}function MoveForward(selectedElements){var index;selectedElements.sort(zSort.bind(null,!0)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index<element.parent.children.length-1&&element.parent.moveChildAt(element,index+1)})}function MoveBehind(selectedElements){var index;selectedElements.sort(zSort.bind(null,!1)),_.forEach(selectedElements,function(element){index=element.parent.getChildIndex(element),index>0&&element.parent.moveChildAt(element,index-1)})}function MoveBefore(elements,target){elements.sort(zSort.bind(null,!1)),_.forEach(elements,function(element){if(!Tree.IsAncestorOf(target,element)){element.parent.removeChild(element);var targetIndex=target.parent.getChildIndex(target);target.parent.addChildAt(element,targetIndex)}})}function MoveAfter(elements,target){elements.sort(zSort.bind(null,!0)),_.forEach(elements,function(element){if(!Tree.IsAncestorOf(target,element)){element.parent.removeChild(element);var targetIndex=target.parent.getChildIndex(target);target.parent.addChildAt(element,targetIndex+1)}})}var ArrangeHelper={ZSortSelectedElements:ZSortSelectedElements,MoveToFront:MoveToFront,MoveToBack:MoveToBack,MoveForward:MoveForward,MoveBehind:MoveBehind,MoveBefore:MoveBefore,MoveAfter:MoveAfter};return ArrangeHelper}()},{"../../utils/Tree.js":223,lodash:19}],93:[function(_dereq_,module,exports){"use strict";module.exports=function(){function isSafari(){var ua=navigator.userAgent.toLowerCase();return ua.indexOf("safari")>-1&&ua.indexOf("chrome")===-1}return Object.freeze({isSafari:isSafari})}()},{}],94:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Tree=_dereq_("../../utils/Tree.js"),ArrangeHelper=_dereq_("./ArrangeHelper.js"),ElementsHelper=_dereq_("./ElementsHelper.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Parse=_dereq_("../../utils/Parse.js"),Storage=_dereq_("../../utils/Storage.js"),Rectangle=_dereq_("../../primitives/Rectangle.js");module.exports=function(){function IsRawImage(clipboardData){if(clipboardData){var item,items=clipboardData.items;if(items)for(var i=0;i<items.length;i++)if(item=items[i],item.type.indexOf("image")!==-1)return!0}return!1}function saveToStorage(clipboard,boundingBox,pageId,isCut){Storage.Save(DB_ID,{_id:DB_ID,elements:clipboard,boundingBox:boundingBox.serialize(),pageId:pageId,isCut:isCut})}function containsComponent(elements){return _.some(elements,function(element){return element.type===ElementTypes.COMPONENT})}function GetRawImageBlobSrc(clipboardData){var src="";if(clipboardData){var items=clipboardData.items;items&&_.forEach(items,function(item){if(item.type.indexOf("image")!==-1){var blob=item.getAsFile();src=window.URL.createObjectURL(blob)}})}return src}function CopyElements(elements,pageId,isCut,boundingBox,store){var clipboard={},elementsWithAllDescendants=_.reduce(elements,function(copied,element){return copied.push(element),element.isComponent()?copied:copied.concat(Tree.GetAllDescendants(element))},[]);return store="undefined"==typeof store||store,clipboard=_.mapValues(Parse.getElementsMap(elementsWithAllDescendants),function(element){return element.serialize()}),ArrangeHelper.ZSortSelectedElements(elements),clipboard[ElementsHelper.CANVAS_ID]=ElementsHelper.GetSerializedCanvas(elements),store?void saveToStorage(clipboard,boundingBox,pageId,isCut):void(CLIPBOARD_CONTENT={elements:clipboard,boundingBox:boundingBox,pageId:pageId,isCut:isCut})}function PasteElements(parent,position){return Storage.Load(DB_ID).then(function(doc){return PasteToTarget(parent,position,doc.elements,doc.boundingBox,doc.pageId,doc.isCut)})["catch"](function(){return[]})}function PasteInPlace(parent,position){if(!_.isEmpty(CLIPBOARD_CONTENT))return PasteToTarget(parent,position,CLIPBOARD_CONTENT.elements,CLIPBOARD_CONTENT.boundingBox,CLIPBOARD_CONTENT.pageId,CLIPBOARD_CONTENT.isCut,!0)}function PasteToTarget(parent,position,elements,boundingBox,pageId,isCut,updateElements){if(_.isEmpty(elements)||parent.Page.isComponentEditMode()&&containsComponent(elements))return[];var pageElementsIds=_.map(parent.Page.getAllElements(),function(element){return element.id});ElementsHelper.RemoveNonexistingElementsFromActions(elements,pageElementsIds);var children,boundingRectangle=Rectangle.FromSerialized(boundingBox),currentPageId=parent.Page.pageId,newPage=pageId!==currentPageId;return isCut=isCut||newPage,parent.Page.ElementsManager.startBatch(),children=parent.Page.ElementsManager.duplicateElementsFromClipboard(elements,isCut),parent.Page.ElementsManager.setPastedElementsCoordinates(children,parent.Page.canvas,position,boundingRectangle,newPage),updateElements&&updateGroupElements(children),parent.addChildren(children),parent.Page.ElementsManager.endBatch(),children}function updateGroupElements(elements){elements.forEach(function(element){(element.isGroup()||element.isComponent())&&element.update()})}function IsClipboardEmpty(){return Storage.Load(DB_ID).then(function(doc){return _.isEmpty(doc.elements)})["catch"](function(){return!0})}var DB_ID="clipboard",CLIPBOARD_CONTENT={},ClipboardHelper={IsRawImage:IsRawImage,GetRawImageBlobSrc:GetRawImageBlobSrc,CopyElements:CopyElements,PasteElements:PasteElements,PasteInPlace:PasteInPlace,IsClipboardEmpty:IsClipboardEmpty};return ClipboardHelper}()},{"../../enums/ElementTypes.js":184,"../../primitives/Rectangle.js":212,"../../utils/Parse.js":220,"../../utils/Storage.js":222,"../../utils/Tree.js":223,"./ArrangeHelper.js":92,"./ElementsHelper.js":97,lodash:19}],95:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function isImage(file){return file.type.indexOf("image")!==-1}function ContainsImageFile(dataTransfer){if(dataTransfer){var file,files=dataTransfer.files;if(files)for(var i=0;i<files.length;i++)if(file=files[i],isImage(file))return!0}return!1}function GetImages(dataTransfer){var images=[];if(dataTransfer){var files=dataTransfer.files;files&&_.forEach(files,function(file){isImage(file)&&images.push({src:window.URL.createObjectURL(file),file:file})})}return images}var DragAndDropHelper={ContainsImageFile:ContainsImageFile,GetImages:GetImages};return DragAndDropHelper}()},{lodash:19}],96:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function UpdateStates(props,idsMap){_.forEach(props[Properties.STATES],function(state){state.elements=_.map(state.elements,function(id){return idsMap[id]||id})})}function UpdateStoredElements(props,idsMap){props[Properties.STORED_ELEMENTS]=_.map(props[Properties.STORED_ELEMENTS],function(id){return idsMap[id]||id})}function UpdateActions(props,idsMap,animationsIdsMap){_.forEach(props[Properties.ACTIONS],function(action){action.elements=_.map(action.elements,function(id){return idsMap[id]||id}),action.id&&animationsIdsMap&&animationsIdsMap[action.id]&&(action.id=animationsIdsMap[action.id],action.name=action.name.replace(/[0-9]*$/,action.id.substring(0,5)))})}var DuplicateHelper={};return DuplicateHelper[Properties.STATES]=UpdateStates,DuplicateHelper[Properties.STORED_ELEMENTS]=UpdateStoredElements,DuplicateHelper[Properties.ACTIONS]=UpdateActions,DuplicateHelper}()},{"../../enums/Properties.js":195,lodash:19}],97:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),MD5=_dereq_("../../utils/MD5.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),DuplicateHelper=_dereq_("../../elements/helpers/DuplicateHelper.js"),Tree=_dereq_("../../utils/Tree.js"),INTERACTION_TRIGGERS_GROUPED=_dereq_("../../enums/InteractionTriggersGrouped.js");module.exports=function(){function getElementsChildren(element,serialized){var children=[];return element.props.storedElements&&element.type!==ElementTypes.MULTISTATE&&element.type!==ElementTypes.COMPONENT?children=getGroupChildren(element,serialized):element.props.states&&(children=getMultistateChildren(element,serialized)),children}function getGroupChildren(element,serialized){return _.map(element.props.storedElements,function(elementId){return serialized[elementId]})}function getMultistateChildren(element,serialized){return _.reduce(element.props.states,function(children,state){return _.forEach(state.elements,function(elementId){children.push(serialized[elementId])}),children},[])}function getFixedChildren(element){return _.filter(element.children,function(child){return child.fixed})}function getUnfixableParentElement(element){element.isVirtualGroup()&&(element=element.children[0]);var parentsList=Tree.GetAllAncestors(element);return _.find(parentsList,function(parent){return parent.isMultistate()||parent.isClip})}function GetUniqueId(elementType){return MD5((elementType||"")+Math.random()+Date.now())}function GetElementsWithoutCanvas(serialized){return _.omit(serialized,CANVAS_ID)}function GenerateIdsMap(ids){var map={};return _.forEach(ids,function(id){map[id]=id===CANVAS_ID?CANVAS_ID:GetUniqueId("AbstractElement",id)}),map}function TranslateIds(serialized,idsMap){var translated=_.cloneDeep(serialized);translated.id=idsMap[translated.id];var animationsIdsMap=_.isArray(translated.props.actions)?translated.props.actions.reduce(function(idsMap,newElement){return newElement.id?(idsMap[newElement.id]=GetUniqueId(),idsMap):idsMap},{}):null;return _.forEach(translated.props,function(value,property){"function"==typeof DuplicateHelper[property]&&DuplicateHelper[property].call(null,translated.props,idsMap,animationsIdsMap)}),translated}function TranslateAllIds(serializedElements,idsMap){var elements={};return idsMap[CANVAS_ID]||(idsMap[CANVAS_ID]=CANVAS_ID),_.forEach(serializedElements,function(serialized,elementId){elements[idsMap[elementId]]=TranslateIds(serialized,idsMap)}),elements}function ConvertListToMap(elementsSerializedList){return _.reduce(elementsSerializedList,function(map,elementSerialized){return map[elementSerialized.id]=elementSerialized,map},{})}function GetSortedPageElements(serialized){var sorted=[],appendElement=function(element){sorted.push(_.omit(element,"__children")),_.forEach(element.__children,appendElement)};return _.forEach(serialized,function(element,elementId){_.extend(element,{id:elementId,__children:getElementsChildren(element,serialized)})}),appendElement(serialized[CANVAS_ID]),sorted}function GetSerializedCanvas(elements){return{id:CANVAS_ID,type:ElementTypes.CANVAS,v:"2.0",props:{storedElements:_.map(elements,"id")}}}function ContainsComponent(elements){return _.some(elements,function(element){return element.isComponent()||element.children&&ContainsComponent(element.children)||!1})}function canBeFixed(element){var ancestors=Tree.GetAllAncestors(element);return!_.some(ancestors,function(ancestor){return ancestor.isClip||ancestor.isMultistate()})}function RemoveNonexistingElementsFromActions(serialized,pageElementsIds){var elementIds=_.keys(serialized);pageElementsIds&&(elementIds=_.union(elementIds,pageElementsIds)),_.forEach(serialized,function(element){var actions=[];element.props.actions&&(_.forEach(element.props.actions,function(action){_.size(action.elements)?(action.elements=_.filter(action.elements,function(elementId){return elementIds.indexOf(elementId.toString())>-1}),_.size(action.elements)&&actions.push(action)):actions.push(action)}),element.props.actions=actions)})}function isFormEventUnsupported(elementType,actionTrigger){return!_.contains(INTERACTION_TRIGGERS_GROUPED.EVENTS_SUPPORT.FORM_EVENTS,elementType)&&_.contains(INTERACTION_TRIGGERS_GROUPED.TRIGGERS_GROUP.FORM_EVENTS,actionTrigger)}function isSelectListEventUnsupported(elementType,actionTrigger){return!_.contains(INTERACTION_TRIGGERS_GROUPED.EVENTS_SUPPORT.SELECT_LIST_EVENTS,elementType)&&_.contains(INTERACTION_TRIGGERS_GROUPED.TRIGGERS_GROUP.SELECT_LIST_EVENTS,actionTrigger)}function isStandardEventUnsupported(elementType,actionTrigger){return _.contains(INTERACTION_TRIGGERS_GROUPED.EVENTS_SUPPORT.CANVAS_EVENTS,elementType)&&_.contains(INTERACTION_TRIGGERS_GROUPED.TRIGGERS_GROUP.STANDARD_EVENTS,actionTrigger)}function isActionSupported(elementType,actionTrigger){return!(isFormEventUnsupported(elementType,actionTrigger)||isSelectListEventUnsupported(elementType,actionTrigger)||isStandardEventUnsupported(elementType,actionTrigger))}function RemoveInvalidActionsFromElements(serialized){_.forEach(serialized,function(element){element.props.actions=_.filter(element.props.actions,function(action){return isActionSupported(element.type,action.event)})})}function GenerateZIndicesInList(serializedList){return _.map(serializedList,function(element,i){return"undefined"==typeof element.props["z-index"]&&(element.props["z-index"]=1e3+i),element})}function GetElementsSortedFromRoot(rootElement){var elements=[rootElement];return rootElement.isComponent()||_.forEach(rootElement.children,function(element){elements=elements.concat(GetElementsSortedFromRoot(element))}),elements}function GetAllElementDescendants(element){return Tree.GetAllDescendants(element)}var CANVAS_ID="canvas",ElementsHelper={CANVAS_ID:CANVAS_ID,GetUniqueId:GetUniqueId,GetElementsWithoutCanvas:GetElementsWithoutCanvas,GenerateIdsMap:GenerateIdsMap,TranslateIds:TranslateIds,TranslateAllIds:TranslateAllIds,ConvertListToMap:ConvertListToMap,GetSortedPageElements:GetSortedPageElements,GetSerializedCanvas:GetSerializedCanvas,ContainsComponent:ContainsComponent,RemoveNonexistingElementsFromActions:RemoveNonexistingElementsFromActions,RemoveInvalidActionsFromElements:RemoveInvalidActionsFromElements,GenerateZIndicesInList:GenerateZIndicesInList,canBeFixed:canBeFixed,getFixedChildren:getFixedChildren,getUnfixableParentElement:getUnfixableParentElement,GetAllElementDescendants:GetAllElementDescendants,GetElementsSortedFromRoot:GetElementsSortedFromRoot};return ElementsHelper}()},{"../../elements/helpers/DuplicateHelper.js":96,"../../enums/ElementTypes.js":184,"../../enums/InteractionTriggersGrouped.js":189,"../../utils/MD5.js":219,"../../utils/Tree.js":223,lodash:19}],98:[function(_dereq_,module,exports){"use strict";_dereq_("../../lib/canvas-to-blob.min.js");var _=_dereq_("lodash"),Point=_dereq_("../../primitives/Point.js"),Rectangle=_dereq_("../../primitives/Rectangle.js"),Events=_dereq_("../../enums/Events.js"),ImageCrop=_dereq_("../ui/ImageCrop.js"),ImageEdit=_dereq_("../ui/ImageEdit.js"),BrowserHelper=_dereq_("./BrowserHelper.js");module.exports=function(){function getScaleForOriginalImage(element,originalWidth,originalHeight,cropRectangles){for(var rect,rectPrev,first=_.first(cropRectangles),last=_.last(cropRectangles),width=last?last.width:originalWidth,height=last?last.height:originalHeight,scale=new Point(element.width/width,element.height/height),i=cropRectangles.length;i-- >0;)rect=cropRectangles[i],rect!==last&&(rectPrev=cropRectangles[i+1],scale.x*=rectPrev.prevWidth/rect.width,scale.y*=rectPrev.prevHeight/rect.height);return first&&(scale.x*=first.prevWidth/originalWidth,scale.y*=first.prevHeight/originalHeight),scale}function getPositionForOriginalImage(element,cropRectangles){var scale,rectPrev,rect,delta,position=element.getBoundingBox().clone()._p0,last=_.last(cropRectangles);if(last){scale={x:element.width/last.width,y:element.height/last.height};for(var i=cropRectangles.length;i-- >0;)rect=cropRectangles[i],rectPrev=cropRectangles[i-1],delta={x:rect.left,y:rect.top},rectPrev&&(delta.x-=rectPrev.left,delta.y-=rectPrev.top),delta.x*=scale.x,delta.y*=scale.y,position.translate(-delta.x,-delta.y,element.angle)}return position}function getBlobSrcFromSrc(src){return new Promise(function(resolve){var xhr=new XMLHttpRequest;xhr.open("GET",src,!0),xhr.responseType="arraybuffer",xhr.onload=function(){var arrayBufferView=new Uint8Array(xhr.response),imageUrl=GetBlobSrc([arrayBufferView],"image/jpeg");resolve(imageUrl)},xhr.send()})}function getBlobSrcFromImg(img){return new Promise(function(resolve){var width=img.naturalWidth,height=img.naturalHeight,canvas=document.createElement("canvas");canvas.setAttribute("width",width+"px"),canvas.setAttribute("height",height+"px");var ctx=canvas.getContext("2d");ctx.drawImage(img,0,0,width,height),canvas.toBlob(function(blob){resolve(createBlobSrc(blob))})})}function normalizeBlob(blob){return BrowserHelper.isSafari()?flipBlob(blob):blob}function flipBlob(blob){return new Promise(function(resolve){var img=document.createElement("img");img.crossOrigin="Anonymous",img.onload=function(){var canvas=document.createElement("canvas"),ctx=canvas.getContext("2d");canvas.width=img.naturalWidth,canvas.height=img.naturalHeight,ctx.translate(0,img.naturalHeight),ctx.scale(1,-1),ctx.drawImage(img,0,0),canvas.toBlob(resolve)},img.src=createBlobSrc(blob)})}function GetBlobSrcFromSvg(svg,originalWidth,originalHeight){var viewBox="0 0 "+originalWidth+" "+originalHeight,wrapper=document.createElement("div");wrapper.innerHTML=svg;var svgElement=wrapper.querySelector("svg");return svgElement.setAttribute("viewBox",viewBox),svgElement.setAttribute("preserveAspectRatio","none"),GetBlobSrc([wrapper.innerHTML],"image/svg+xml")}function GetCropBlob(imageCropElement){var cropRectangle=imageCropElement.getCropRectangle();return new Promise(function(resolve){var canvas=document.createElement("canvas");canvas.setAttribute("width",cropRectangle.width+"px"),canvas.setAttribute("height",cropRectangle.height+"px");var ctx=canvas.getContext("2d");ctx.drawImage(imageCropElement.view.img,-cropRectangle.x,-cropRectangle.y,imageCropElement.originRect.width,imageCropElement.originRect.height),canvas.toBlob(resolve)})}function getEditedBlob(imageEditElement){return new Promise(function(resolve){
imageEditElement.view.domElement.toBlob(resolve)})}function createBlobSrc(blob){return window.URL.createObjectURL(blob)}function GetBlobSrc(object,type){var blob=new Blob(object,{type:type});return createBlobSrc(blob)}function GetImageSize(src){return new Promise(function(resolve){var img=document.createElement("img");img.onload=function(){resolve({width:img.naturalWidth,height:img.naturalHeight})},img.src=src})}function Crop(imageCropElement){var promiseResolve,imageElement=imageCropElement.image,cropRectangle=imageCropElement.getCropRectangle(),croppedImageRectangle=imageCropElement.getImageRectangle(),promise=new Promise(function(resolve){promiseResolve=resolve});return imageElement.getBoundingBox().isEqual(croppedImageRectangle)?Promise.resolve():(imageCropElement.imageProcessingStart(),GetCropBlob(imageCropElement).then(function(blob){var blobSrc=createBlobSrc(blob);blob.name=imageElement.createModifiedFileName(),imageElement.Page.emit(Events.IMAGE_EDITED,{file:blob,onProgress:imageElement.setProgress.bind(imageElement),onComplete:imageElement.onCompletedModifiedUpload.bind(imageElement),onError:imageElement.setFailed.bind(imageElement),onGotSrc:function(src){imageElement.updateCrop(croppedImageRectangle,cropRectangle,src),imageElement.srcMod=blobSrc,imageElement.enableUpload(),imageElement.showProgress(),imageCropElement.imageProcessingEnd(),promiseResolve()}})}),promise)}function ApplyEdit(imageEditElement){var imageBlob,imageBlobSrc,promiseResolve,imageElement=imageEditElement.image,adjustments=imageEditElement.getChangedAdjustments(),promise=new Promise(function(resolve){promiseResolve=resolve});return _.isEmpty(adjustments)?Promise.resolve():(imageElement.imageProcessingStart(),getEditedBlob(imageEditElement).then(normalizeBlob).then(function(blob){return imageBlob=blob,imageBlobSrc=createBlobSrc(blob)}).then(PreloadImage).then(function(){imageBlob.name=imageElement.createModifiedFileName(),imageElement.Page.emit(Events.IMAGE_EDITED,{file:imageBlob,onComplete:imageElement.onCompletedModifiedUpload.bind(imageElement),onProgress:imageElement.setProgress.bind(imageElement),onError:imageElement.setFailed.bind(imageElement),onGotSrc:function(src){imageElement.updateAdjustments(adjustments,src),imageElement.srcMod=imageBlobSrc,imageElement.enableUpload(),imageElement.showProgress(),imageElement.imageProcessingEnd(),promiseResolve()}})}),promise)}function GetImageCrop(image,Page,ignoreAdjustments){return new Promise(function(resolve){var getBlobSrc;getBlobSrc=image.isAdjusted()&&!ignoreAdjustments?GetImageEdit(image,Page,!0).then(getEditedBlob).then(normalizeBlob).then(createBlobSrc):image.isCropped()?getBlobSrcFromSrc(image.src):getBlobSrcFromImg(image.view.domElement),getBlobSrc.then(function(src){GetImageSize(src).then(function(size){var position=getPositionForOriginalImage(image,image.crop),scale=getScaleForOriginalImage(image,size.width,size.height,image.crop),originRect=new Rectangle(position.x,position.y,size.width*scale.x,size.height*scale.y,image.angle),imageCrop=new ImageCrop(null,Page);imageCrop.initProperties({src:src,originRect:originRect,image:image}),ignoreAdjustments||image.onStartCrop(imageCrop),resolve(imageCrop)})})})}function GetImageEdit(image,Page,ignoreCrop){var getBlobSrc;return getBlobSrc=image.isCropped()&&!ignoreCrop?GetImageCrop(image,Page,!0).then(ImageEditor.GetCropBlob).then(createBlobSrc):getBlobSrcFromSrc(image.src),getBlobSrc.then(function(src){var imageEdit=new ImageEdit(null,Page);return imageEdit.initProperties({src:src,image:image}),imageEdit.loaded()})}function PreloadImage(src){return new Promise(function(resolve,reject){var image=new window.Image;image.crossOrigin="Anonymous",image.onload=resolve,image.onerror=reject,image.src=src})}var ImageEditor={GetImageSize:GetImageSize,Crop:Crop,ApplyEdit:ApplyEdit,GetImageCrop:GetImageCrop,GetImageEdit:GetImageEdit,GetBlobSrc:GetBlobSrc,GetBlobSrcFromSvg:GetBlobSrcFromSvg,GetCropBlob:GetCropBlob,PreloadImage:PreloadImage};return ImageEditor}()},{"../../enums/Events.js":185,"../../lib/canvas-to-blob.min.js":210,"../../primitives/Point.js":211,"../../primitives/Rectangle.js":212,"../ui/ImageCrop.js":122,"../ui/ImageEdit.js":123,"./BrowserHelper.js":93,lodash:19}],99:[function(_dereq_,module,exports){"use strict";module.exports=function(){function buttonPressed(e,button){return e.which===button}function leftButtonPressed(e){return buttonPressed(e,BUTTONS.LEFT)}function rightButtonPressed(e){return buttonPressed(e,BUTTONS.RIGHT)}function addToSelection(e){return leftButtonPressed(e)&&(e.shiftKey||e.metaKey||e.ctrlKey)}function isEventOnElement(e,element){var bb,x=e.clientX,y=e.clientY;return e.target===element||(bb=element.getBoundingClientRect(),bb.left<=x&&bb.right>=x&&bb.top<=y&&bb.bottom>=y)}var BUTTONS={LEFT:1,RIGHT:3},MouseHelper={leftButtonPressed:leftButtonPressed,rightButtonPressed:rightButtonPressed,addToSelection:addToSelection,isEventOnElement:isEventOnElement};return MouseHelper}()},{}],100:[function(_dereq_,module,exports){var _=_dereq_("lodash"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){"use strict";function MoveTracer(options){this._lastDirection=null,this._moves=[],this._options={tracingMovesCount:50},this.reset(),this.setOptions(options)}return MoveTracer.prototype.setOptions=function(options){return options&&"object"==typeof options&&(this._options=_.extend(this._options,options)),this},MoveTracer.prototype.getOption=function(option){return this._options[option]},MoveTracer.prototype.reset=function(){return this._moves=[],this._lastDirection=null,this},MoveTracer.prototype.addMove=function(coordinates){return this._moves.length>this._options.tracingMovesCount-1&&this._moves.splice(0,this._moves.length-this._options.tracingMovesCount+1),this._moves.push(coordinates),this},MoveTracer.prototype.getMoves=function(limit){return this._moves.slice(0,limit>0?limit:this._moves.length)},MoveTracer.prototype.getDirection=function(coordinates){coordinates&&this.addMove(coordinates);var movedX=0,movedY=0,moves=this.getMoves();return moves.forEach(function(coordinates,index){index>0&&(movedX+=Math.abs(coordinates.x-moves[index-1].x),movedY+=Math.abs(coordinates.y-moves[index-1].y))}),movedX>movedY?this._lastDirection=Orientations.HORIZONTAL:movedY>movedX&&(this._lastDirection=Orientations.VERTICAL),this._lastDirection},MoveTracer}()},{"../../enums/Orientations.js":193,lodash:19}],101:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function isEmptyGroup(element){return element.isGroup()&&element.type!==ElementTypes.CANVAS&&!element.storedElements.length}function updateActions(elementDeleted,elements){elementDeleted.isVirtualGroup()||_.forEach(elements,function(element){var changed=!1,actions=_.reduce(_.cloneDeep(element.actions),function(actions,action){var index=_.isArray(action.elements)?action.elements.indexOf(elementDeleted.id):-1;return index>-1&&(action.elements.splice(index,1),changed=!0),index!==-1&&_.isEmpty(action.elements)||actions.push(action),actions},[]);changed&&element._updateProperty(Properties.ACTIONS,actions,!0)})}var RemoveHelper={isEmptyGroup:isEmptyGroup,updateActions:updateActions};return RemoveHelper}()},{"../../enums/ElementTypes.js":184,"../../enums/Properties.js":195,lodash:19}],102:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ArrangeHelper=_dereq_("./ArrangeHelper.js"),BrowserHelper=_dereq_("./BrowserHelper"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Properties=_dereq_("../../enums/Properties.js"),Events=_dereq_("../../enums/Events.js"),RemoveHelper=_dereq_("./RemoveHelper.js"),Tree=_dereq_("../../utils/Tree.js");module.exports=function(){function addMultistateNameSuffix(name){return name+MULTISTATE_NAME_SUFFIX}function removeMultistateNameSuffix(name){return name.replace(new RegExp(RegExp.quote(MULTISTATE_NAME_SUFFIX)+"$"),"")}function convertMultistateToGroup(multistate){var group,serialized=multistate.serialize(),properties=_.omit(serialized.props,[Properties.STORED_ELEMENTS,Properties.MULTISTATE_ORIGIN]),elements=_.clone(multistate.children),map={};return multistate.removeAllChildren(),properties[Properties.NAME]=removeMultistateNameSuffix(properties[Properties.NAME]),properties[Properties.MULTISTATE_ORIGIN]=ElementTypes.GROUP,group=multistate.Page.ElementsManager.createElement(ElementTypes.GROUP,properties),group.addChildren(elements),map[multistate.id]=group.id,multistate.parent.replaceChild(group,multistate),multistate.Page.ElementsManager.translateIds(map),multistate.Page.ElementsManager.removeElement(multistate),group}function extractElementsFromGroup(element){var child,parent=element.parent,index=parent.getChildIndex(element),children=_.clone(element.children);parent._remove(element,index);for(var i=element.children.length;i-- >0;)child=element.children[i],element._remove(child,element.getChildIndex(child)),parent._add(child,index),element.isClip&&(child.dirty=!0);return element.resetIndicators(),parent.Page.ElementsManager.removeElement(element),parent.dirty=!0,children}function CanDeleteAllElements(elements){return _.every(elements,function(element){return!element.Page.ElementsManager.cantRemoveElement(element)})}function DeleteElements(elements,onMultistateStateRemoval){_.forEach(elements,function(element){if(element.Page.ElementsManager.cantRemoveElement(element))return void element.Page.emit(Events.CANT_DELETE_ELEMENT);var parent=element.parent;onMultistateStateRemoval||parent.removeChild(element),element.Page.ElementsManager.removeElement(element),element.isGroup()&&_.forEach(Tree.GetAllDescendants(element),function(descendant){descendant.Page.ElementsManager.removeElement(descendant)}),!onMultistateStateRemoval&&RemoveHelper.isEmptyGroup(parent)&&DeleteElements([parent])})}function Group(elements){var group,lastElement=_.last(elements),parent=lastElement.parent,index=parent.getChildIndex(lastElement);return ArrangeHelper.ZSortSelectedElements(elements,!1),parent.Page.ElementsManager.startBatch(),group=parent.Page.ElementsManager.createElement(ElementTypes.GROUP,{}),parent.addChildAt(group,index),_.forEach(elements,function(element){element.parent.removeChild(element)}),group.addChildren(elements),parent.Page.ElementsManager.endBatch(),isSafari&&group.update(),group}function Ungroup(element){var ungroupedElements,parent=element.parent;return parent.Page.ElementsManager.startBatch(),ungroupedElements=extractElementsFromGroup(element),parent.Page.ElementsManager.endBatch(),ungroupedElements}function Delete(elements){var elementsManager=_.last(elements).Page.ElementsManager;elementsManager.startBatch(),DeleteElements(elements),elementsManager.endBatch()}function emitCantCreateComponent(Page){Page.emit(Events.CANT_DELETE_ELEMENT,{header:"Cannot create Smart Element",content:"You cannot create Smart Element while somebody is editing element inside."})}function CreateComponent(name,elements,x,y){return new Promise(function(resolve,reject){var component,parent=_.last(elements).parent,index=parent.getChildIndex(_.last(elements));return CanDeleteAllElements(elements)?(ArrangeHelper.ZSortSelectedElements(elements,!1),void parent.Page.ElementsManager.createComponent(name,elements).then(function(componentId){parent.Page.ElementsManager.startBatch(),DeleteElements(elements),component=parent.Page.ElementsManager.createElement(ElementTypes.COMPONENT,{idComponent:componentId,x:x,y:y}),parent.Page.emit(Events.COMPONENT_ADDED,componentId),parent.addChildAt(component,index),parent.Page.ElementsManager.endBatch(),resolve(component)})["catch"](function(){emitCantCreateComponent(parent.Page),reject()})):(emitCantCreateComponent(parent.Page),reject())})}function CreateMultistate(elements,stateName){var multistate,lastElement=_.last(elements),parent=lastElement.parent,index=parent.getChildIndex(lastElement);return ArrangeHelper.ZSortSelectedElements(elements,!1),parent.Page.ElementsManager.startBatch(),_.forEach(elements,function(element){element.parent.removeChild(element)}),multistate=parent.Page.ElementsManager.createMultistate(elements,stateName),parent.addChildAt(multistate,index),parent.Page.ElementsManager.endBatch(),isSafari&&multistate.update(),multistate}function ConvertToMultistate(group,stateName){var multistate,serialized=group.serialize(),properties=_.omit(serialized.props,Properties.STORED_ELEMENTS),elements=_.clone(group.children),map={};return group.Page.ElementsManager.startBatch(),group.removeAllChildren(),properties[Properties.NAME]=addMultistateNameSuffix(properties[Properties.NAME]),properties[Properties.MULTISTATE_ORIGIN]=ElementTypes.GROUP,multistate=group.Page.ElementsManager.createMultistate(elements,stateName,properties),map[group.id]=multistate.id,group.parent.replaceChild(multistate,group),group.Page.ElementsManager.translateIds(map),group.Page.ElementsManager.removeElement(group),group.Page.ElementsManager.endBatch(),isSafari&&multistate.update(),multistate}function CreateOrConvertToMultistate(elements,stateName){return 1===elements.length&&elements[0].isGroup()&&!elements[0].isVirtualGroup()?ConvertToMultistate(elements[0],stateName):(1===elements.length&&elements[0].isVirtualGroup()&&(elements=elements[0].children),CreateMultistate(elements,stateName))}function ConvertFromMultistate(multistate){return!(!multistate.isMultistate()||multistate.getStatesCount()>1)&&(multistate.isCreatedFromGroup()?[convertMultistateToGroup(multistate)]:extractElementsFromGroup(multistate))}var isSafari=BrowserHelper.isSafari(),MULTISTATE_NAME_SUFFIX=" - Multistate",SelectionHelper={Group:Group,Ungroup:Ungroup,Delete:Delete,DeleteElements:DeleteElements,CreateComponent:CreateComponent,CreateMultistate:CreateMultistate,ConvertToMultistate:ConvertToMultistate,CreateOrConvertToMultistate:CreateOrConvertToMultistate,ConvertFromMultistate:ConvertFromMultistate};return SelectionHelper}()},{"../../enums/ElementTypes.js":184,"../../enums/Events.js":185,"../../enums/Properties.js":195,"../../utils/Tree.js":223,"./ArrangeHelper.js":92,"./BrowserHelper":93,"./RemoveHelper.js":101,lodash:19}],103:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),EventEmitter=_dereq_("event-emitter"),Events=_dereq_("../../enums/Events.js"),Orientations=_dereq_("../../enums/Orientations.js"),Properties=_dereq_("../../enums/Properties.js"),Tree=_dereq_("../../utils/Tree.js");module.exports=function(){function emitGuideShow(axis,value){emitter.emit(Events.SNAPPING_GUIDE_SHOW,{axis:axis===xAxis?Properties.X:Properties.Y,value:value})}function emitGuideHide(axis){emitter.emit(Events.SNAPPING_GUIDE_HIDE,{axis:axis===xAxis?Properties.X:Properties.Y})}function getSnappedValue(value,axis){for(var snappedValue,len=elementValues.length,i=0;i<=5;i++)for(var j=0;j<len;j++){if(snappedValue=elementValues[j],axis[snappedValue-i])return emitGuideShow(axis,snappedValue-i),value-i;if(axis[snappedValue+i])return emitGuideShow(axis,snappedValue+i),value+i}return emitGuideHide(axis),value}function getSelectedElements(element){return element.isGroup()||element.isVirtualGroup()?Tree.GetAllDescendants(element):[element]}function PrepareData(elementBoundingBox,elements,guides,selectedElement){var element,bb,i,l,selectedElements=_.reject(getSelectedElements(selectedElement),function(el){return el.isGroup()||el.isVirtualGroup()});xAxis=[],yAxis=[],boundingBox=elementBoundingBox;for(i in elements)if(elements.hasOwnProperty(i)){if(element=elements[i],selectedElements.indexOf(element)>-1||element.isGroup())continue;bb=element.getBoundingBox(!0),xAxis[Math.round(bb.left)]=!0,xAxis[Math.round(bb.center)]=!0,xAxis[Math.round(bb.right)]=!0,yAxis[Math.round(bb.top)]=!0,yAxis[Math.round(bb.middle)]=!0,yAxis[Math.round(bb.bottom)]=!0}for(i=0,l=guides.length;i<l;i++)guides[i].orientation===Orientations.HORIZONTAL?yAxis[guides[i].getPosition()]=!0:xAxis[guides[i].getPosition()]=!0}function GetSnappedX(x){var minX,maxX;return boundingBox.x=x,minX=boundingBox.getMinX(),maxX=boundingBox.getMaxX(),elementValues[0]=Math.round(minX),elementValues[1]=Math.round(minX+(maxX-minX)/2),elementValues[2]=Math.round(maxX),getSnappedValue(x,xAxis)}function GetSnappedY(y){var minY,maxY;return boundingBox.y=y,minY=boundingBox.getMinY(),maxY=boundingBox.getMaxY(),elementValues[0]=Math.round(minY),elementValues[1]=Math.round(minY+(maxY-minY)/2),elementValues[2]=Math.round(maxY),getSnappedValue(y,yAxis)}var xAxis=null,yAxis=null,boundingBox=null,elementValues=[],emitter=new EventEmitter,SnappingHelper={PrepareData:PrepareData,GetSnappedX:GetSnappedX,GetSnappedY:GetSnappedY,AddListener:emitter.on.bind(emitter),RemoveListener:emitter.off.bind(emitter)};return SnappingHelper}()},{"../../enums/Events.js":185,"../../enums/Orientations.js":193,"../../enums/Properties.js":195,"../../utils/Tree.js":223,"event-emitter":3,lodash:19}],104:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function generateSymbols(length){var symbol,alphabet="ABCDEFGHIJKLMNOPQRSTUWXYZ";if(length=length||1/0,symbolsCached.length<length)for(var i=symbolsCached.length;i<length;i++){if(i<alphabet.length)symbol=alphabet[i];else{if(!alphabet[Math.floor(i/alphabet.length)-1])break;symbol=alphabet[Math.floor(i/alphabet.length)-1]+alphabet[i%alphabet.length]}symbolsCached.push(symbol)}return symbolsCached}function GetColumnSymbol(index){return generateSymbols(index+1)[index]}function GetCellCoordinates(row,column){return GetColumnSymbol(column)+row.toString()}function GetAllCellsCoordinates(table){var coordinates=[],rowsCount=table.length,columnsCount=GetColumnsCount(table);generateSymbols(rowsCount*columnsCount);for(var rowIndex=0;rowIndex<rowsCount;rowIndex++)for(var columnIndex=0;columnIndex<columnsCount;columnIndex++)coordinates.push(GetCellCoordinates(rowIndex,columnIndex));return coordinates}function GetColumnsCount(table){return _.reduce(table,function(count,columns){return count<columns.length?columns.length:count},0)}function GetRowIndex(coordinates){return parseInt(coordinates.replace(/[A-Z]+/g,""))}function GetColumnIndex(coordinates){for(var columnSymbol=coordinates.replace(/\d+/g,""),allSymbols=generateSymbols(),allSymbolsLength=allSymbols.length,index=0;allSymbols[index]!==columnSymbol&&index+1<allSymbolsLength;)index++;return index}function IsEvenRow(coordinates){return GetRowIndex(coordinates)%2===0}function IsOddRow(coordinates){return GetRowIndex(coordinates)%2===1}var symbolsCached=[],TableHelper={GetColumnSymbol:GetColumnSymbol,GetCellCoordinates:GetCellCoordinates,GetAllCellsCoordinates:GetAllCellsCoordinates,GetColumnsCount:GetColumnsCount,GetRowIndex:GetRowIndex,GetColumnIndex:GetColumnIndex,IsEvenRow:IsEvenRow,IsOddRow:IsOddRow};return TableHelper}()},{lodash:19}],105:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),BrowserHelper=_dereq_("./BrowserHelper"),EventEmitter=_dereq_("event-emitter"),Events=_dereq_("../../enums/Events.js"),Styles=_dereq_("../../enums/Styles.js"),Keys=_dereq_("../../enums/Keys.js"),Properties=_dereq_("../../enums/Properties.js"),Parse=_dereq_("../../utils/Parse.js"),TextStyleHelper=_dereq_("./TextStyleHelper.js");module.exports=function(){function disableKeystrokes(){CKEDITOR.config.keystrokes=[[CKEDITOR.CTRL+66,null],[CKEDITOR.CTRL+73,null],[CKEDITOR.CTRL+85,null]]}function enableKeystrokes(){CKEDITOR.config.keystrokes=[[CKEDITOR.CTRL+66,BOLD],[CKEDITOR.CTRL+73,ITALIC],[CKEDITOR.CTRL+85,UNDERLINE]]}function applyStyle(styleFunction,element,value){var instance=getInstance(element),shouldSelectAll=!isEditingElement(element);return shouldSelectAll?(element.setEditing(!0),selectAll(null,instance),styleFunction.call(null,instance,value),deselect(),element.setEditing(!1)):styleFunction.call(null,instance,value),element.shouldUpdateHeight=!0,getContentData(instance)}function applyText(text,element){var instance=getInstance(element),shouldSelectAll=!isEditingElement(element);return shouldSelectAll?(element.setEditing(!0),selectAll(null,instance),instance.insertText(text),deselect(),element.setEditing(!1)):instance.insertText(text),element.shouldUpdateHeight=!0,getContentData(instance)}function selectAll(e,instance){var range=instance.createRange();range.selectNodeContents(instance.editable()),range.shrink(2,!0),range.select()}function deselect(){window.getSelection().removeAllRanges()}function isEditingElement(element){return element===editingElement}function isTextNode(node){return 3===node.nodeType}function hasTextChildNode(node){return _.some(node.childNodes,isTextNode)}function getInstance(element){return editorInstances[element.id]}function getInstancePromise(element){return new Promise(function(resolve){var onCreated=function(){var instance=getInstance(element);instance&&(emitter.off(INSIDE_EVENTS.INSTANCE_CREATED,onCreated),resolve(instance))};getInstance(element)?onCreated():(emitter.on(INSIDE_EVENTS.INSTANCE_CREATED,onCreated),editorInstancesInitiated[element.id]||Init(element))})}function getContentData(instance){return{content:instance.element.$.innerHTML,height:parseInt(getElementStyle(instance.container.$,Properties.HEIGHT))}}function strip(html){var container=document.createElement("div");return container.innerHTML=html,container.textContent||""}function highlight(element){emitter.emit(Events.TEXT_SELECTION_CHANGED,getTextFormat(element))}function onPaste(e){e.data.type="text",e.data.dataValue=strip(e.data.dataValue)}function isSelectionEmpty(instance,isEditingElement){return!instance.getSelection().getSelectedText()&&isEditingElement}function getSelectedNodes(selection){var crawler,node,range=selection.getRanges()[0],start=range.startContainer.$,end=range.endContainer.$,nodes=[];if(start===end)nodes.push(start);else for(crawler=new CKEDITOR.dom.walker(range);null!==(node=crawler.next());)nodes.push(node.$);return _.unique(_.reduce(nodes,function(selectedNodes,node){return isTextNode(node)?selectedNodes.concat(node.parentNode):hasTextChildNode(node)?selectedNodes.concat(node):selectedNodes.concat(_.filter(node.querySelectorAll("*"),hasTextChildNode))},[]))}function getSelection(instance,element){var textElements,selection=instance?instance.getSelection(!0):null;return selection&&!_.isEmpty(selection.getRanges())?getSelectedNodes(selection):element?(textElements=_.filter(element.view.getEditableElement().querySelectorAll("*"),hasTextChildNode),0===textElements.length&&hasTextChildNode(element.view.getEditableElement())&&(textElements=[element.view.getEditableElement()]),textElements):null}function onSelectionChange(e){highlight(getSelection(e.editor))}function onBeforeCommandExec(e){isSelectionEmpty(e.editor)&&_.contains([BOLD,ITALIC,UNDERLINE,STRIKE],e.data.name)&&e.cancel()}function onChange(){editingElement.shouldUpdateHeight=!0}function onKeyDown(instance,e){var cmdKey=e.metaKey||e.ctrlKey;e.which===Keys.EQUALS&&cmdKey?(e.preventDefault(),increaseFontSize(instance)):e.which===Keys.DASH&&cmdKey&&(e.preventDefault(),decreaseFontSize(instance))}function increaseFontSize(instance){var size=parseInt(getFontSize(getSelection(instance))),sizeNew=size+1;selectAll(null,instance),setFontSize(instance,sizeNew),TextStyleHelper.SetDefaultStyle(Properties.FONT_SIZE,sizeNew),editingElement.shouldUpdateHeight=!0}function decreaseFontSize(instance){var size=parseInt(getFontSize(getSelection(instance))),sizeNew=size>1?size-1:1;selectAll(null,instance),setFontSize(instance,sizeNew),TextStyleHelper.SetDefaultStyle(Properties.FONT_SIZE,sizeNew),editingElement.shouldUpdateHeight=!0}function getElementStyle(element,property){return element?window.getComputedStyle(element).getPropertyValue(property):""}function getStyle(elements,property){return _.reduce(_.rest(elements),function(reduced,element){return reduced===getElementStyle(element,property)?reduced:""},getElementStyle(_.first(elements),property))}function hasStyle(elements,property,value){return getStyle(elements,property)===value}function getAlign(elements){return getStyle(elements,Styles.TEXT_ALIGN)}function getBackgroundColor(elements){return getStyle(elements,Styles.BACKGROUND_COLOR)}function getColor(elements){return getStyle(elements,Styles.COLOR)}function getFont(elements){return getStyle(elements,Styles.FONT_FAMILY)}function getFontSize(elements){return getStyle(elements,Styles.FONT_SIZE)}function getLetterSpacing(elements){return getStyle(elements,Styles.LETTER_SPACING)}function safariGetLineHeightForElement(element){for(;element&&"P"!==element.tagName;)element=element.parentNode;return element?element.style.getPropertyValue(Styles.LINE_HEIGHT):""}function safariGetLineHeight(elements){var lineHeight=safariGetLineHeightForElement(_.first(elements)),everyElementsHasSameLineHeight=_.every(_.rest(elements),function(element){return lineHeight===safariGetLineHeightForElement(element)});return everyElementsHasSameLineHeight?lineHeight||"normal":""}function getLineHeight(elements){return isSafari?safariGetLineHeight(elements):getStyle(elements,Styles.LINE_HEIGHT)}function isBold(elements){return hasStyle(elements,Styles.FONT_WEIGHT,"bold")}function isItalic(elements){return hasStyle(elements,Styles.FONT_STYLE,"italic")}function isUnderline(elements){return hasStyle(elements,Styles.TEXT_DECORATION,"underline")}function isLineThrough(elements){return hasStyle(elements,Styles.TEXT_DECORATION,"line-through")}function isLink(element){for(;element&&"P"!==element.tagName;){if("A"===element.tagName)return!0;element=element.parentElement}return!1}function getTextFormat(element){return{align:getAlign(element),backgroundColor:getBackgroundColor(element),color:getColor(element),font:getFont(element),fontSize:getFontSize(element),lineHeight:getLineHeight(element),bold:isBold(element),italic:isItalic(element),underline:isUnderline(element),lineThrough:isLineThrough(element),link:isLink(element)}}function setAlign(instance,value){instance.execCommand(ALIGN_MAP[value])}function setBackgroundColor(instance,value){instance.applyStyle(new CKEDITOR.style(BACKGROUND_COLOR_CONFIG,{color:value}))}function setColor(instance,value){instance.applyStyle(new CKEDITOR.style(COLOR_CONFIG,{color:value}))}function setFont(instance,value){instance.applyStyle(new CKEDITOR.style(FONT_CONFIG,{font:value}))}function setFontSize(instance,value){instance.applyStyle(new CKEDITOR.style(SIZE_CONFIG,{size:Parse.toPx(value)}))}function setLineHeight(instance,value){instance.applyStyle(new CKEDITOR.style(LINE_HEIGHT_CONFIG,{height:value}))}function setLetterSpacing(instance,value){instance.applyStyle(new CKEDITOR.style(LETTER_SPACING_CONFIG,{spacing:value}))}function setBold(instance){instance.execCommand(BOLD)}function setItalic(instance){instance.execCommand(ITALIC)}function setUnderline(instance){instance.execCommand(UNDERLINE)}function setLineThrough(instance){instance.execCommand(STRIKE)}function setLink(instance,value){instance.applyStyle(new CKEDITOR.style(ANCHOR_CONFIG,{href:value}))}function unsetLink(instance){instance.removeStyle(new CKEDITOR.style(ANCHOR_CONFIG))}function addEvents(instance){eventRefs[KEYDOWN]=onKeyDown.bind(null,instance),instance.on(ON_PASTE,onPaste),instance.on(ON_SELECTION_CHANGE,onSelectionChange),instance.on(ON_BEFORE_COMMAND_EXEC,onBeforeCommandExec),instance.on(CHANGE,onChange),document.addEventListener(KEYDOWN,eventRefs[KEYDOWN])}function removeEvents(instance){instance.removeListener(ON_PASTE,onPaste),instance.removeListener(ON_SELECTION_CHANGE,onSelectionChange),instance.removeListener(ON_BEFORE_COMMAND_EXEC,onBeforeCommandExec),instance.removeListener(CHANGE,onChange),document.removeEventListener(KEYDOWN,eventRefs[KEYDOWN])}function Destroy(element){var instance=getInstance(element);instance&&(window.getSelection().removeAllRanges(),instance.destroy(),delete editorInstances[element.id]),delete editorInstancesInitiated[element.id]}function Init(element){var elementEditor=CKEDITOR.instances[element.view.getEditableElementId()];return editorInstancesInitiated[element.id]=!0,elementEditor&&elementEditor.destroy(!0),CKEDITOR.inline(element.view.getEditableElementId())}function Edit(element,onEditReady){element.setEditing(!0),getInstancePromise(element).then(function(instance){return GetEditingElement(element)?instance:(element.Page.emit(Events.TEXT_EDITION_STARTED),instance.focus(),selectAll(null,instance),addEvents(instance),editingElement=element,element.isRichTextEditable()?enableKeystrokes():disableKeystrokes(),onEditReady(),instance)})}function FinishEditing(){var instance=getInstance(editingElement),contentData=getContentData(instance);deselect(),removeEvents(instance),editingElement.setEditing(!1),editingElement.Page.ElementsManager.startBatch(),editingElement.adjustHeightToText()&&editingElement._updateProperty(Properties.HEIGHT,contentData.height,!0),editingElement._updateProperty(Properties.INPUT_VALUE,contentData.content,!0),editingElement.Page.ElementsManager.endBatch(),editingElement.Page.emit(Events.TEXT_EDITION_FINISHED),editingElement=null}function GetEditingElement(){return editingElement}function GetAlign(element){return getAlign(getSelection(getInstance(element),element))}function SetAlign(element,value){return applyStyle(setAlign,element,value)}function GetBackgroundColor(element){return getBackgroundColor(getSelection(getInstance(element),element))}function SetBackgroundColor(element,value){return!isSelectionEmpty(getInstance(element),isEditingElement(element))&&applyStyle(setBackgroundColor,element,value)}function GetColor(element){return getColor(getSelection(getInstance(element),element))}function SetColor(element,value){return!isSelectionEmpty(getInstance(element),isEditingElement(element))&&applyStyle(setColor,element,value)}function GetFont(element){return getFont(getSelection(getInstance(element),element))}function SetFont(element,value){return applyStyle(setFont,element,TextStyleHelper.SanitizeFontName(value))}function GetFontSize(element){return getFontSize(getSelection(getInstance(element),element))}function SetFontSize(element,value){return!isSelectionEmpty(getInstance(element),isEditingElement(element))&&applyStyle(setFontSize,element,value)}function GetLineHeight(element){return getLineHeight(getSelection(getInstance(element),element))}function SetLineHeight(element,value){return applyStyle(setLineHeight,element,value)}function GetLetterSpacing(element){return getLetterSpacing(getSelection(getInstance(element),element))}function SetLetterSpacing(element,value){return applyStyle(setLetterSpacing,element,value)}function GetBold(element){return isBold(getSelection(getInstance(element),element))}function SetBold(element,value){return GetBold(element)!==value&&applyStyle(setBold,element,value)}function GetItalic(element){return isItalic(getSelection(getInstance(element),element))}function SetItalic(element,value){return GetItalic(element)!==value&&applyStyle(setItalic,element,value)}function GetUnderline(element){return isUnderline(getSelection(getInstance(element),element))}function SetUnderline(element,value){return GetUnderline(element)!==value&&applyStyle(setUnderline,element,value)}function GetLineThrough(element){return isLineThrough(getSelection(getInstance(element),element))}function SetLineThrough(element,value){return GetLineThrough(element)!==value&&applyStyle(setLineThrough,element,value)}function GetLink(element){return isLink(getSelection(getInstance(element),element))}function SetLink(element,value){return value?!isSelectionEmpty(getInstance(element),isEditingElement(element))&&applyStyle(setLink,element,value):applyStyle(unsetLink,element,value)}function GetTextFormat(element){return getTextFormat(getSelection(getInstance(element),element))}function InsertText(element,text){return!!getInstance(element)&&applyText(text,element)}var isSafari=BrowserHelper.isSafari(),CKEDITOR_EVENTS={INSTANCE_READY:"instanceReady"},INSIDE_EVENTS={INSTANCE_CREATED:"instanceCreated"};_.isEmpty(window.CKEDITOR)?window.CKEDITOR={}:(CKEDITOR.disableAutoInline=!0,CKEDITOR.config.allowedContent=!0,
CKEDITOR.config.pasteFilter="plain-text",CKEDITOR.config.language="en",CKEDITOR.config.toolbar="Custom",CKEDITOR.config.toolbar_Custom=[],CKEDITOR.dtd.$editable.label=1,CKEDITOR.dtd.$editable.a=1,CKEDITOR.dtd.$editable.button=1,CKEDITOR.config.removePlugins="toolbar,elementspath,resize,link",CKEDITOR.config.extraPlugins="justify",CKEDITOR.config.justifyClasses=[TextStyleHelper.ALIGN_PREFIX+"left",TextStyleHelper.ALIGN_PREFIX+"center",TextStyleHelper.ALIGN_PREFIX+"right",TextStyleHelper.ALIGN_PREFIX+"justify"],CKEDITOR.config.coreStyles_bold={element:"span",attributes:{style:"font-weight: bold;"},overrides:[{element:"strong"},{element:"b"}]},CKEDITOR.config.coreStyles_italic={element:"span",attributes:{style:"font-style: italic;"},overrides:"em"},CKEDITOR.config.coreStyles_underline={element:"span",attributes:{style:"text-decoration: underline;"},overrides:"u"},CKEDITOR.config.coreStyles_strike={element:"span",attributes:{style:"text-decoration: line-through;"},overrides:"strike"},CKEDITOR.on(CKEDITOR_EVENTS.INSTANCE_READY,function(e){var elementId=e.editor.element.$.dataset.id;return editorInstancesInitiated[elementId]?(editorInstances[elementId]=e.editor,void emitter.emit(INSIDE_EVENTS.INSTANCE_CREATED)):void Destroy({id:elementId})}));var ON_PASTE="paste",ON_SELECTION_CHANGE="selectionChange",ON_BEFORE_COMMAND_EXEC="beforeCommandExec",KEYDOWN="keydown",CHANGE="change",BOLD="bold",ITALIC="italic",UNDERLINE="underline",STRIKE="strike",JUSTIFY_LEFT="justifyleft",JUSTIFY_CENTER="justifycenter",JUSTIFY_RIGHT="justifyright",JUSTIFY_BLOCK="justifyblock",ALIGN_MAP={left:JUSTIFY_LEFT,center:JUSTIFY_CENTER,right:JUSTIFY_RIGHT,justify:JUSTIFY_BLOCK},BACKGROUND_COLOR_CONFIG={element:"span",styles:{"background-color":"#(color)"}},COLOR_CONFIG={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:/#[\w]{3,6}/}}]},SIZE_CONFIG={element:"span",styles:{"font-size":"#(size)"},overrides:[{element:"span",styles:{"font-size":"/w+/"}}]},FONT_CONFIG={element:"span",attributes:{"class":TextStyleHelper.FONT_TYPE_PREFIX+"#(font)"},overrides:[{element:"span",attributes:{"class":new RegExp(TextStyleHelper.FONT_TYPE_PREFIX+"\\w+")}}]},LINE_HEIGHT_CONFIG={element:"p",styles:{"line-height":"#(height)"}},LETTER_SPACING_CONFIG={element:"span",styles:{"letter-spacing":"#(spacing)"}},ANCHOR_CONFIG={element:"a",attributes:{href:"#(href)"},type:CKEDITOR.STYLE_INLINE,overrides:"a",alwaysRemoveElement:1},editorInstances={},editorInstancesInitiated={},eventRefs={},editingElement=null,emitter=new EventEmitter,TextEditor={Init:Init,Destroy:Destroy,Edit:Edit,FinishEditing:FinishEditing,GetEditingElement:GetEditingElement,InsertText:InsertText,GetTextFormat:GetTextFormat,GetAlign:GetAlign,SetAlign:SetAlign,GetBackgroundColor:GetBackgroundColor,SetBackgroundColor:SetBackgroundColor,GetColor:GetColor,SetColor:SetColor,GetFont:GetFont,SetFont:SetFont,GetFontSize:GetFontSize,SetFontSize:SetFontSize,GetLineHeight:GetLineHeight,SetLineHeight:SetLineHeight,GetLetterSpacing:GetLetterSpacing,SetLetterSpacing:SetLetterSpacing,GetBold:GetBold,SetBold:SetBold,GetItalic:GetItalic,SetItalic:SetItalic,GetUnderline:GetUnderline,SetUnderline:SetUnderline,GetLineThrough:GetLineThrough,SetLineThrough:SetLineThrough,GetLink:GetLink,SetLink:SetLink,AddListener:emitter.on.bind(emitter),RemoveListener:emitter.off.bind(emitter)};return TextEditor}()},{"../../enums/Events.js":185,"../../enums/Keys.js":190,"../../enums/Properties.js":195,"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./BrowserHelper":93,"./TextStyleHelper.js":106,"event-emitter":3,lodash:19}],106:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Properties=_dereq_("../../enums/Properties.js"),Styles=_dereq_("../../enums/Styles.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function applyParagraphStyles(paragraph,props){props[Properties.TEXT_ALIGN]&&paragraph.classList.add(ALIGN_PREFIX+props[Properties.TEXT_ALIGN]),props[Properties.LINE_HEIGHT]&&(paragraph.style[Styles.LINE_HEIGHT]=props[Properties.LINE_HEIGHT])}function getNewSpan(node){var span=document.createElement("span");return span.appendChild(node),span}function getStyledSpans(node,props){return props[Properties.BACKGROUND_COLOR]&&(node=getNewSpan(node),node.style[Styles.BACKGROUND_COLOR]=props[Properties.BACKGROUND_COLOR]),props[Properties.COLOR]&&(node=getNewSpan(node),node.style[Styles.COLOR]=props[Properties.COLOR]),props[Properties.FONT_FAMILY]&&(node=getNewSpan(node),node.classList.add(FONT_TYPE_PREFIX+SanitizeFontName(props[Properties.FONT_FAMILY]))),props[Properties.FONT_SIZE]&&(node=getNewSpan(node),node.style[Styles.FONT_SIZE]=Parse.toPx(props[Properties.FONT_SIZE])),props[Properties.FONT_STYLE]&&(node=getNewSpan(node),node.style[Styles.FONT_STYLE]=props[Properties.FONT_STYLE]),props[Properties.FONT_WEIGHT]&&(node=getNewSpan(node),node.style[Styles.FONT_WEIGHT]=props[Properties.FONT_WEIGHT]),props[Properties.LETTER_SPACING]&&(node=getNewSpan(node),node.style[Styles.LETTER_SPACING]=props[Properties.LETTER_SPACING]),props[Properties.TEXT_DECORATION]&&(node=getNewSpan(node),node.style[Styles.TEXT_DECORATION]=props[Properties.TEXT_DECORATION]),node}function getInputValue(props){var paragraph=document.createElement("p"),text=document.createTextNode(DEFAULT_TEXT);return applyParagraphStyles(paragraph,props),paragraph.appendChild(getStyledSpans(text,props)),paragraph.outerHTML}function IsStyleProperty(elementType,property){return IsTextEditable(elementType)&&[Properties.BACKGROUND_COLOR,Properties.COLOR,Properties.FONT_FAMILY,Properties.FONT_SIZE,Properties.FONT_STYLE,Properties.FONT_WEIGHT,Properties.LETTER_SPACING,Properties.LINE_HEIGHT,Properties.TEXT_ALIGN,Properties.TEXT_DECORATION].indexOf(property)>-1}function IsTextEditable(elementType){return[ElementTypes.TEXT_ELEMENT].indexOf(elementType)>-1}function SetDefaultStyle(property,value){_defaultStyle[property]=value}function UseDefaultStyle(props){return props[Properties.INPUT_VALUE]=getInputValue(_.extend({},_defaultStyle,props)),props}function SanitizeFontName(font){var fontsNames={Arial:"arial","Comic Sans MS":"comicsans",Verdana:"verdana","Trebuchet MS":"trebuchet","Times New Roman":"timesnew",Georgia:"georgia",Tahoma:"tahoma","Courier New":"couriernew"};return fontsNames[font]?fontsNames[font]:font.replace(/\s/g,"")}var DEFAULT_TEXT="Text ...",ALIGN_PREFIX="uxp-align-",FONT_TYPE_PREFIX="wysiwyg-font-type-",_defaultStyle={},TextStyleHelper={DEFAULT_TEXT:DEFAULT_TEXT,ALIGN_PREFIX:ALIGN_PREFIX,FONT_TYPE_PREFIX:FONT_TYPE_PREFIX,IsStyleProperty:IsStyleProperty,IsTextEditable:IsTextEditable,SetDefaultStyle:SetDefaultStyle,UseDefaultStyle:UseDefaultStyle,SanitizeFontName:SanitizeFontName};return Object.freeze(TextStyleHelper)}()},{"../../enums/ElementTypes.js":184,"../../enums/Properties.js":195,"../../enums/Styles.js":198,"../../utils/Parse.js":220,lodash:19}],107:[function(_dereq_,module,exports){"use strict";module.exports=function(){function detectServiceByUrl(url){if(url){var regexp,match;for(var service in VIDEO_SERVICES)if(VIDEO_SERVICES.hasOwnProperty(service)&&(regexp=new RegExp(VIDEO_SERVICES[service].REGEXP,"i"),match=url.match(regexp)))return{service:service,match:match};return null}}function getVideoHtml(url,width,height){if(url){var detected=detectServiceByUrl(url);if(detected){var videoHtml=VIDEO_SERVICES[detected.service].SD.replace(/\[\[id\]\]/g,detected.match[1]).replace(/\[\[id2\]\]/g,detected.match[2]).replace(/\[\[width\]\]/g,width||640).replace(/\[\[height\]\]/g,height||385);return videoHtml}}}var VIDEO_SERVICES={YOUTUBE:{REGEXP:"(?:youtube.com/watch\\?v=|youtu.be/)([^$&]+)",SD:'<iframe width="[[width]]" height="[[height]]" src="https://www.youtube.com/embed/[[id]]" frameborder="0" allowfullscreen></iframe>',HD:""},VIMEO:{REGEXP:"vimeo.com/(\\d+)",SD:'<iframe src="https://player.vimeo.com/video/[[id]]" width="[[width]]" height="[[height]]" frameborder="0" webkitallowfullscreen mozallowfullscreen allowfullscreen></iframe>',HD:""},DROPBOX:{REGEXP:"(http.*dropbox.*.([a-z0-9]{3,4}))",SD:'<video width="[[width]]" height="[[height]]" controls><source src="[[id]]?dl=1" type="video/[[id2]]"><p>Your browser does not support HTML5 video</p></video>',HD:""}},VideoHelper={detectServiceByUrl:detectServiceByUrl,getVideoHtml:getVideoHtml};return VideoHelper}()},{}],108:[function(_dereq_,module,exports){"use strict";var SvgSymbol=_dereq_("./SvgSymbol.js"),Base=_dereq_("../utils/Base.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),IOS7View=_dereq_("./views/IOS7View.js");module.exports=function(){function iOS7(){SvgSymbol.apply(this,arguments),this.type=ElementTypes.IOS7,this.view=this.createView(IOS7View)}return Base.Extend(iOS7,SvgSymbol),iOS7}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./SvgSymbol.js":66,"./views/IOS7View.js":159}],109:[function(_dereq_,module,exports){"use strict";var GroupingInstance=_dereq_("./GroupingInstance.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Base=_dereq_("../utils/Base.js");module.exports=function(){function iOS8(){GroupingInstance.apply(this,arguments),this.type=ElementTypes.IOS8}return Base.Extend(iOS8,GroupingInstance),iOS8}()},{"../enums/ElementTypes.js":184,"../utils/Base.js":213,"./GroupingInstance.js":43}],110:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("../AbstractElement"),Linked=_dereq_("../behaviors/Linked.js"),IndicatorAlign=_dereq_("../../enums/IndicatorAlign.js"),AttributesIndicatorView=_dereq_("./views/AttributesIndicatorView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function AttributesIndicator(id,Page,options){AbstractElement.apply(this,arguments),this.setOptions(options),this.view=new AttributesIndicatorView(this.className),this.onElementChangeRef=this.onElementChange.bind(this),this.onElementReorderRef=this.onElementReorder.bind(this),this.onElementDeleteRef=this.onElementDelete.bind(this)}var defaultOptions={align:IndicatorAlign.TOP_LEFT,className:""};return Base.Extend(AttributesIndicator,AbstractElement),Base.ApplyBehavior(AttributesIndicator,Linked),Object.defineProperties(AttributesIndicator.prototype,{}),AttributesIndicator.prototype.setOptions=function(options){options=_.extend(defaultOptions,options),this.align=options.align,this.className=options.className},AttributesIndicator.prototype.show=function(element){this.addChangeListener(this.onElementChangeRef),this.addReorderListener(this.onElementReorderRef),this.addDeleteListener(this.onElementDeleteRef),this.onElementChange(element),this._insertIndicatorNode(element)},AttributesIndicator.prototype.remove=function(){this.removeChangeListener(this.onElementChangeRef),this.removeReorderListener(this.onElementReorderRef),this.removeDeleteListener(this.onElementDeleteRef),this._removeIndicatorNode()},AttributesIndicator.prototype.onElementChange=function(element){this.angle=element.angle,this.x=element.x,this.y=element.y,this.width=element.width,this.height=element.height,this.update()},AttributesIndicator.prototype.onElementReorder=function(element){this._insertIndicatorNode(element)},AttributesIndicator.prototype.onElementDelete=function(){this._removeIndicatorNode()},AttributesIndicator.prototype._insertIndicatorNode=function(element){this.view.insertNodeAfter(this.view.domElement,element.view.domElement)},AttributesIndicator.prototype._removeIndicatorNode=function(){this.view.domElement.parentNode&&this.view.domElement.parentNode.removeChild(this.view.domElement)},AttributesIndicator.prototype._updateProperty=function(){},AttributesIndicator.prototype._saveProperty=function(){},AttributesIndicator}()},{"../../enums/IndicatorAlign.js":186,"../../utils/Base.js":213,"../AbstractElement":24,"../behaviors/Linked.js":83,"./views/AttributesIndicatorView.js":127,lodash:19}],111:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AbstractElement=_dereq_("../AbstractElement"),Base=_dereq_("../../utils/Base.js"),CollaboratorView=_dereq_("./views/CollaboratorView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Linked=_dereq_("../behaviors/Linked.js");module.exports=function(){function Collaborator(id,page,collaboratorData,scale){AbstractElement.apply(this,[id,page]),this.type=ElementTypes.COLLABORATION,this.view=new CollaboratorView(collaboratorData),this._pageId=parseInt(collaboratorData.id_page),this._data=collaboratorData,this._scale=scale||1,this._elementIds=[],this.addChangeListener(function(){this.refresh()}.bind(this))}return Base.Extend(Collaborator,AbstractElement),Base.ApplyBehavior(Collaborator,Linked),Collaborator.prototype.activateElement=function(pageId,elementIds,isComponent){var elements=this._getSelectedElements(pageId,elementIds,isComponent);this._pageId=parseInt(pageId),this._elementIds=elementIds,this._isComponent=isComponent,_.forEach(this._elements,function(element){element.removeLinkedElement(this)}.bind(this)),_.forEach(elements,function(element){element.addLinkedElement(this)}.bind(this)),this._elements=elements,this.view.setElements(this.isVisible(this._elements),this._elements,this._scale)},Collaborator.prototype.isVisible=function(elements){return elements.length>0&&(parseInt(this.Page.pageId)===this._pageId||this._isComponent)},Collaborator.prototype.refresh=function(scale){scale&&(this._scale=scale),window.requestAnimationFrame(function(){this._elements=this._getSelectedElements(this._pageId,this._elementIds,this._isComponent);var isVisible=this.isVisible(this._elements);this.view.setElements(isVisible,this._elements,this._scale)}.bind(this))},Collaborator.prototype.setData=function(data,scale){this._scale=scale,this._data=data,this._elementIds=this._pageId===parseInt(data.id_page)?this._elementIds:[],this._pageId=parseInt(data.id_page),this.view.setViewData(data),this.refresh()},Collaborator.prototype.destroy=function(){this.view.destroyDomElement()},Collaborator.prototype._getSelectedElements=function(pageId,elementIds,isComponent){if(isComponent)return _.compact(this.Page.ElementsManager.getElementsByComponentId(pageId))||[];var onlyCanvasSelected=1===elementIds.length&&"canvas"===_.first(elementIds);return onlyCanvasSelected||!elementIds.length||this._pageId!==parseInt(pageId)?[]:_.compact(_.map(elementIds,function(id){return this.Page.ElementsManager.getElementById(id)}.bind(this)))},Collaborator}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../AbstractElement":24,"../behaviors/Linked.js":83,"./views/CollaboratorView.js":128,lodash:19}],112:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Base=_dereq_("../../utils/Base.js"),AbstractElement=_dereq_("../AbstractElement"),ElementIndicatorView=_dereq_("./views/ElementIndicatorView.js");module.exports=function(){function ElementIndicator(){AbstractElement.apply(this,arguments),this.type=ElementTypes.ELEMENT_INDICATOR,this.view=new ElementIndicatorView,this.hideDebounced=_.debounce(this.hide.bind(this),100)}return ElementIndicator.DefaultProperties={element:{value:null}},Base.Extend(ElementIndicator,AbstractElement),Object.defineProperties(ElementIndicator.prototype,{element:{get:function(){return this._element},set:function(value){this._element=value,this.onUpdateElement()}}}),ElementIndicator.prototype.show=function(element){this.element=element},ElementIndicator.prototype.showCoordinates=function(element){this.element=element,this.view.showCoordinates(this.element.x,this.element.y),this.hideDebounced()},ElementIndicator.prototype.showDimensions=function(element){this.element=element,this.view.showDimensions(this.element.width,this.element.height),this.hideDebounced()},ElementIndicator.prototype.showRotation=function(element){this.element=element,this.view.showRotation(this.element.angle),this.hideDebounced()},ElementIndicator.prototype.hide=function(){this.view.hide()},ElementIndicator.prototype.onUpdateElement=function(){var position=this._getIndicatorPosition();this.rect.x=position.x,this.rect.y=position.y,this.dirty=!0},ElementIndicator.prototype._getIndicatorPosition=function(){var scale=this.Page.canvas.scale,elementBB=this.element.getBoundingBox(!0).clone().multiply(scale),minWidth=120,minHeight=50,spacing=10,position={};return elementBB.width>=minWidth&&elementBB.height>=minHeight?(position.x=elementBB.center-this.view.domElement.offsetWidth/2,position.y=elementBB.middle-this.view.domElement.offsetHeight/2):(position.x=elementBB.right+spacing,position.y=elementBB.bottom+spacing),position},ElementIndicator}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../AbstractElement":24,"./views/ElementIndicatorView.js":129,lodash:19}],113:[function(_dereq_,module,exports){"use strict";var ElementTypes=_dereq_("../../enums/ElementTypes.js"),ElementNameView=_dereq_("./views/ElementNameView.js"),Base=_dereq_("../../utils/Base.js"),AbstractElement=_dereq_("../AbstractElement");module.exports=function(){function ElementName(){AbstractElement.apply(this,arguments),this.type=ElementTypes.ELEMENT_NAME,this.view=new ElementNameView}return Base.Extend(ElementName,AbstractElement),Object.defineProperties(ElementName.prototype,{}),ElementName.prototype.setPosition=function(x,y){this.view.setPosition(x,y)},ElementName.prototype.setName=function(name){this.view.setName(name)},ElementName.prototype.show=function(){this.view.setVisibility(!0)},ElementName.prototype.hide=function(){this.view.setVisibility(!1)},ElementName}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../AbstractElement":24,"./views/ElementNameView.js":130}],114:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),GuideView=_dereq_("./views/GuideView.js"),Base=_dereq_("../../utils/Base.js"),Orientations=_dereq_("../../enums/Orientations.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function Guide(){AbstractElement.apply(this,arguments),this.type=ElementTypes.GUIDE,this.view=new GuideView,this.scale=1}return Guide.DefaultProperties={orientation:{value:Orientations.HORIZONTAL},minX:{value:0},minY:{value:0},x:{value:0},y:{value:0},width:{value:1},height:{value:1},visibility:{value:!0}},Base.Extend(Guide,AbstractElement),Object.defineProperties(Guide.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){this.orientation===Orientations.VERTICAL&&(value=1),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value)}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){this.orientation===Orientations.HORIZONTAL&&(value=1),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value)}},minX:{get:function(){return this._minX},set:function(value){this._minX=value,this.orientation===Orientations.HORIZONTAL&&(this.x=value)}},minY:{get:function(){return this._minY},set:function(value){this._minY=value,this.orientation===Orientations.VERTICAL&&(this.y=value)}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){this.orientation===Orientations.HORIZONTAL&&(value=this.minX),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value)}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){this.orientation===Orientations.VERTICAL&&(value=this.minY),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value)}},orientation:{get:function(){return this._orientation},set:function(value){this._orientation=value,value===Orientations.HORIZONTAL?this.height=1:this.width=1,this.view.setOrientation(value),this.dirty=!0}},visibility:{get:function(){return this._visibility},set:function(value){this._visibility=value,this.view.setVisibility(value)}}}),Guide.prototype.setScale=function(value){this._rect.multiply(value/this.scale),this.orientation===Orientations.HORIZONTAL?this._rect.height=1:this.orientation===Orientations.VERTICAL&&(this._rect.width=1),this.scale=value,this.dirty=!0},Guide.prototype.update=function(){this.visibility&&this.view.updateTransform(this)},Guide.prototype.serialize=function(){return{orientation:this.orientation,x:this.x/this.scale,y:this.y/this.scale}},Guide.prototype.getPosition=function(){return(this.orientation===Orientations.HORIZONTAL?this.y:this.x)/this.scale},Guide.prototype.hitTest=function(p){var rect=this.rect.clone();return rect.multiply(1/this.scale),this.orientation===Orientations.HORIZONTAL?(rect.y-=1,rect.height=3):this.orientation===Orientations.VERTICAL&&(rect.x-=1,rect.width=3),rect.hitTest(p)?this:null},Guide}()},{"../../enums/ElementTypes.js":184,"../../enums/Orientations.js":193,"../../enums/Properties.js":195,"../../utils/Base.js":213,"../AbstractElement":24,"./views/GuideView.js":131}],115:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),ElementName=_dereq_("./ElementName.js"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){function GuidePosition(){ElementName.apply(this,arguments),this.view.domElement.classList.add("guide-position"),this.hideDebounced=_.debounce(this.hide.bind(this),100)}return Base.Extend(GuidePosition,ElementName),GuidePosition.prototype.setGuidePosition=function(position){this.setName(position)},GuidePosition.prototype.show=function(guide){var position,scale=this.Page.canvas.scale;position=guide.orientation===Orientations.HORIZONTAL?guide.y:guide.x,this.setGuidePosition(position/scale),this.hideDebounced(),ElementName.prototype.show.call(this)},GuidePosition}()},{"../../enums/Orientations.js":193,"../../utils/Base.js":213,"./ElementName.js":113,lodash:19}],116:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightView=_dereq_("./views/HighlightView.js"),Base=_dereq_("../../utils/Base.js"),Linked=_dereq_("../behaviors/Linked.js");module.exports=function(){function Highlight(){AbstractElement.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT,this.view=new HighlightView,this.scale=1,this._element=null,this.onElementChangeRef=this.onElementChange.bind(this)}var HIGHLIGHT_CLASS="highlighting",DRAG_INFO_CLASS="drag-info-visible",SMALL_CLASS="small-image",IMAGE_ALREADY_UPLOADED_CLASS="image-already-uploaded",MULTISTATE_CLASS="multistate";return Base.Extend(Highlight,AbstractElement),Base.ApplyBehavior(Highlight,Linked),Object.defineProperties(Highlight.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,this.update()}},element:{get:function(){return this._element}}}),Highlight.prototype.link=function(element){this.addChangeListener(this.onElementChangeRef),this.onElementChange(element)},Highlight.prototype.unlink=function(){this.removeChangeListener(this.onElementChangeRef)},Highlight.prototype.show=function(element,interactive,showDragInfo){this._element!==element&&(this.initHighlight(element),element.isMultistate()?this.view.domElement.classList.add(MULTISTATE_CLASS):this.view.domElement.classList.remove(MULTISTATE_CLASS),showDragInfo||element.type===ElementTypes.IMAGE&&element.isEmpty()?this.view.domElement.classList.add(DRAG_INFO_CLASS):this.view.domElement.classList.remove(DRAG_INFO_CLASS),element.type!==ElementTypes.IMAGE||element.isEmpty()?this.view.domElement.classList.remove(IMAGE_ALREADY_UPLOADED_CLASS):this.view.domElement.classList.add(IMAGE_ALREADY_UPLOADED_CLASS),element.type===ElementTypes.IMAGE&&element.isSmall()?this.view.domElement.classList.add(SMALL_CLASS):this.view.domElement.classList.remove(SMALL_CLASS),interactive&&this.view.domElement.classList.add(HIGHLIGHT_CLASS))},Highlight.prototype.initHighlight=function(element){this._element=element,this.view.setVisibility(!0,element.locked||!this.Page.canChangeElements()),this.update(!0)},Highlight.prototype.hide=function(force){(this._element||force)&&(this.view.setVisibility(!1),this._element=null,this.view.domElement.classList.remove(HIGHLIGHT_CLASS))},Highlight.prototype.hideView=function(){this.view.setVisibility(!1)},Highlight.prototype.showView=function(){this.view.setVisibility(!0)},Highlight.prototype.setScale=function(value){this._rect.multiply(value/this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this.scale=value,this.update()},Highlight.prototype.update=function(shouldUpdateBoundingBox){var bb;shouldUpdateBoundingBox&&this._element&&(bb=this._element.getBoundingBox(),this._rect=bb.clone().multiply(this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this._angle=this._rect.angle),AbstractElement.prototype.update.call(this)},Highlight.prototype.onElementChange=function(element){this.angle=element.angle,this.x=element.x,this.y=element.y,this.width=element.width,this.height=element.height,this.update()},Highlight.prototype.validateProperty=function(property,value){return this._element.validateProperty(property,value)},Highlight.prototype._updateProperty=function(){},Highlight.prototype._saveProperty=function(){},Highlight}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../AbstractElement":24,"../behaviors/Linked.js":83,"./views/HighlightView.js":137}],117:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),Highlight=_dereq_("./Highlight.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightCellResizerView=_dereq_("./views/HighlightCellResizerView.js"),Base=_dereq_("../../utils/Base.js"),Point=_dereq_("../../primitives/Point.js"),Linked=_dereq_("../behaviors/Linked.js"),Orientations=_dereq_("../../enums/Orientations.js");module.exports=function(){function HighlightCellResizer(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_CELL_RESIZER,this.view=new HighlightCellResizerView,this._startDragPoint=new Point,this._lowerResizerLimit=null,this._upperResizerLimit=null,this.onElementChangeRef=this.onElementChange.bind(this)}return Base.Extend(HighlightCellResizer,Highlight),Base.ApplyBehavior(HighlightCellResizer,Linked),Object.defineProperties(HighlightCellResizer.prototype,{element:{get:function(){return this._element}}}),HighlightCellResizer.prototype.show=function(element){element.containsRotatedElement()||(this.view.initView(element,this.scale),this.initHighlight(element),this.addChangeListener(this.onElementChangeRef),this.element.addLinkedElement(this))},HighlightCellResizer.prototype.hide=function(force){this.element&&this.element.removeLinkedElement(this),this.view.removeResizers(),this.removeChangeListener(this.onElementChangeRef),Highlight.prototype.hide.call(this,force)},HighlightCellResizer.prototype.startDrag=function(resizer){this.view.setResizerMoving(resizer,!0),this._setResizerLimits("x",parseInt(resizer.getAttribute("data-index")))},HighlightCellResizer.prototype.dragResizer=function(x,y,resizer){if(this._startDragPoint.x=x/this.scale,this._startDragPoint.y=y/this.scale,this.isVertical(resizer)){var resizerIndex=parseInt(resizer.getAttribute("data-index")),position=this._limitResizerPosition(this._startDragPoint.x,"x",resizerIndex);this.view.updateVerticalResizerPosition(resizerIndex,position*this.scale)}},HighlightCellResizer.prototype.commitCellResize=function(resizer){this.isVertical(resizer)&&(this.view.setResizerMoving(resizer,!1),this.element.setColumnWidth(parseInt(resizer.getAttribute("data-index")),this._getColumnWidthFromResizer(resizer)),this._clearResizerLimits())},HighlightCellResizer.prototype.update=function(shouldUpdateBoundingBox){window.requestAnimationFrame(function(){this.element&&!this.element.containsRotatedElement()?this.view.updateResizerPositions(this.element,this.scale):this.element&&this.element.containsRotatedElement()&&this.view.removeResizers()}.bind(this)),Highlight.prototype.update.call(this,shouldUpdateBoundingBox)},HighlightCellResizer.prototype.getResizers=function(){return this.view.domElement.children},HighlightCellResizer.prototype._limitResizerPosition=function(dragPoint,axis){if("x"===axis){var leftLimit=this._element.x+this._lowerResizerLimit,rightLimit=this._element.x+this._upperResizerLimit;if(dragPoint>rightLimit)return rightLimit-this.element[axis];if(dragPoint<leftLimit)return leftLimit-this.element[axis]}return dragPoint-this.element[axis]},HighlightCellResizer.prototype._setResizerLimits=function(axis,resizerIndex){"x"===axis&&(this._lowerResizerLimit=this.element.getLeftOffsetForColumn(resizerIndex)+this.element.getMinColumnWidth(),this._upperResizerLimit=this.element.getLeftOffsetForColumn(resizerIndex+2)-this.element.getMinColumnWidth())},HighlightCellResizer.prototype._clearResizerLimits=function(){this._lowerResizerLimit=this._upperResizerLimit=null},HighlightCellResizer.prototype._getColumnWidthFromResizer=function(resizer){var preColumnsCounter=parseInt(resizer.getAttribute("data-index")),columnWidth=_.reduce(this.element.getRealCellWidths().slice(0,preColumnsCounter),function(sum,value){return sum-parseInt(value)},parseInt(resizer.style.left)/this.scale)-parseInt(this.element.borderLeftWidth)/2;return columnWidth},HighlightCellResizer.prototype.isVertical=function(resizer){return!!resizer.classList.contains(Orientations.VERTICAL)},HighlightCellResizer.prototype.isHorizontal=function(resizer){return!!resizer.classList.contains(Orientations.HORIZONTAL)},HighlightCellResizer}()},{"../../enums/ElementTypes.js":184,"../../enums/Orientations.js":193,"../../primitives/Point.js":211,"../../utils/Base.js":213,"../behaviors/Linked.js":83,"./Highlight.js":116,"./views/HighlightCellResizerView.js":132,lodash:19}],118:[function(_dereq_,module,exports){"use strict";var Highlight=_dereq_("./Highlight.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightEditView=_dereq_("./views/HighlightEditView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function HighlightEdit(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_EDIT,this.view=new HighlightEditView}return Base.Extend(HighlightEdit,Highlight),Object.defineProperties(HighlightEdit.prototype,{}),HighlightEdit.prototype.show=function(element,isMultistate){Highlight.prototype.show.call(this,element),this.view.setMultistateMode(isMultistate)},HighlightEdit}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"./Highlight.js":116,"./views/HighlightEditView.js":134}],119:[function(_dereq_,module,exports){"use strict";var HighlightEdit=_dereq_("./HighlightEdit.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightEditClippedView=_dereq_("./views/HighlightEditClippedView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function HighlightEditClipped(){HighlightEdit.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_EDIT_CLIPPED,this.view=new HighlightEditClippedView}return Base.Extend(HighlightEditClipped,HighlightEdit),Object.defineProperties(HighlightEditClipped.prototype,{}),HighlightEditClipped.prototype.show=function(element){if(element&&element.isGroup()&&element.isClip){var bb=element.getBoundingBox();this._rect=bb.clone().multiply(this.scale),this.view.setVisibility(!0),this.update()}},HighlightEditClipped}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"./HighlightEdit.js":118,"./views/HighlightEditClippedView.js":133}],120:[function(_dereq_,module,exports){"use strict";var Base=_dereq_("../../utils/Base.js"),Highlight=_dereq_("./Highlight.js"),AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightPartView=_dereq_("./views/HighlightPartView.js"),Base=_dereq_("../../utils/Base.js");
module.exports=function(){function HighlightPart(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_PART,this.view=new HighlightPartView}return Base.Extend(HighlightPart,Highlight),Object.defineProperties(HighlightPart.prototype,{element:{get:function(){return this._element}},partId:{get:function(){return this._partId}}}),HighlightPart.prototype.show=function(element,partId){this._partId=partId,this.initHighlight(element)},HighlightPart.prototype.update=function(shouldUpdateBoundingBox){var bb,elementBb;shouldUpdateBoundingBox&&this._element&&this._partId&&(elementBb=this._element.getBoundingBox(),bb=this._element.getPartBoundingBox(this._partId).clone(),bb.x+=elementBb.x,bb.y+=elementBb.y,this._rect=bb.multiply(this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this._angle=this._rect.angle),AbstractElement.prototype.update.call(this)},HighlightPart}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../AbstractElement":24,"./Highlight.js":116,"./views/HighlightPartView.js":135}],121:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),Highlight=_dereq_("./Highlight.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),HighlightSelectView=_dereq_("./views/HighlightSelectView.js"),Point=_dereq_("../../primitives/Point.js"),Base=_dereq_("../../utils/Base.js"),AbstractElement=_dereq_("../AbstractElement.js"),Properties=_dereq_("../../enums/Properties.js"),Orientations=_dereq_("../../enums/Orientations.js"),BrowserHelper=_dereq_("../helpers/BrowserHelper.js"),SnappingHelper=_dereq_("../helpers/SnappingHelper.js"),Calc=_dereq_("../../utils/Calc.js"),Rectangle=_dereq_("../../primitives/Rectangle.js"),MoveTracer=_dereq_("../helpers/MoveTracer.js");module.exports=function(){function HighlightSelect(){Highlight.apply(this,arguments),this.type=ElementTypes.HIGHLIGHT_SELECT,this.view=new HighlightSelectView,this._startDragPoint=new Point,this._startAngle=0,this._elementStartPoint=new Point,this._elementStartAngle=0,this._resizePoint=new Point,this._mode=HighlightSelect.MODE_RESIZE,this._moveTracer=new MoveTracer,this.adjustCornersThrottled=_.throttle(this._adjustCorners.bind(this),100)}var TINY_DIMENSIONS=15,SMALL_DIMENSIONS=30,isSafari=BrowserHelper.isSafari();return HighlightSelect.MODE_RESIZE="modeResize",HighlightSelect.MODE_CROP="modeCrop",Base.Extend(HighlightSelect,Highlight),Object.defineProperties(HighlightSelect.prototype,{element:{get:function(){return this._element}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value),this._element._updateProperty(Properties.X,value/this.scale,!0),isSafari&&this._element.update()}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value),this._element._updateProperty(Properties.Y,value/this.scale,!0),isSafari&&this._element.update()}},width:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.WIDTH).set.call(this,value),this._element._updateProperty(Properties.WIDTH,value/this.scale,!0),this.adjustCornersThrottled()}},height:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).get.call(this)},set:function(value){Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.HEIGHT).set.call(this,value),this._element._updateProperty(Properties.HEIGHT,value/this.scale,!0),this.adjustCornersThrottled()}},angle:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.ANGLE).get.call(this)},set:function(value){value=this._element.validateProperty(Properties.ANGLE,value),this._angle=this.rect.angle=value,this._element._updateProperty(Properties.ANGLE,value,!0),this.dirty=!0}},rotatable:{get:function(){return this._rotatable},set:function(value){this._rotatable=value,this.view.enableRotation(value)}}}),HighlightSelect.prototype.showElements=function(elements){var group;1===elements.length?this.show(_.first(elements)):elements.length>1&&(group=this.Page.ElementsManager.createElement("VirtualGroup",{}),group.addChildren(elements),this.show(group))},HighlightSelect.prototype.updateElements=function(){this._element&&this._element.isVirtualGroup()&&(this._element.update(),this.update(!0))},HighlightSelect.prototype.show=function(element){element.isGroup()&&element.isClip?(this.view.domElement.classList.add("ng-highlight-clipped"),this.view.domElement.classList.add("clipped")):(this.view.domElement.classList.remove("ng-highlight-clipped"),this.view.domElement.classList.remove("clipped")),element.type===ElementTypes.TEXT_ELEMENT?this.view.domElement.classList.add("horizontal-transform-only"):this.view.domElement.classList.remove("horizontal-transform-only"),this.view.setTransformEnabled(this._isTransformEnabled()),this._setMode(element.type===ElementTypes.IMAGE_CROP?HighlightSelect.MODE_CROP:HighlightSelect.MODE_RESIZE),Highlight.prototype.show.call(this,element),this._adjustCorners()},HighlightSelect.prototype.hide=function(){this._element&&this._element.isVirtualGroup()&&this._element.Page.ElementsManager.removeElement(this._element),Highlight.prototype.hide.apply(this,arguments)},HighlightSelect.prototype.update=function(shouldUpdateBoundingBox){Highlight.prototype.update.call(this,shouldUpdateBoundingBox),shouldUpdateBoundingBox&&this._element&&this.adjustCornersThrottled()},HighlightSelect.prototype.startDrag=function(x,y){this._startDragPoint.x=x/this.scale,this._startDragPoint.y=y/this.scale,this._elementStartPoint.x=this._element.x,this._elementStartPoint.y=this._element.y,this._moveTracer.reset(),this._moveTracer.addMove(this._startDragPoint),SnappingHelper.PrepareData(this.getBoundingBox().clone().multiply(1/this.scale),this._getElementsForSnapping(),this._getGuidesForSnapping(),this._element)},HighlightSelect.prototype.startResize=function(){SnappingHelper.PrepareData(new Rectangle,this._getElementsForSnapping(),this._getGuidesForSnapping(),this._element)},HighlightSelect.prototype.startRotate=function(x,y){var dx,dy,rad;this._startDragPoint=this.getBoundingBox().getCenterPoint(),dx=x-this._startDragPoint.x,dy=y-this._startDragPoint.y,rad=Math.atan2(-dx,dy),this._startAngle=Calc.RadToDeg(rad+Math.PI)%360,this._elementStartAngle=this.angle},HighlightSelect.prototype.drag=function(x,y,moveOnLine){var dragDirection,dx=x/this.scale-this._startDragPoint.x,dy=y/this.scale-this._startDragPoint.y;moveOnLine?(dragDirection=this._moveTracer.getDirection({x:this._startDragPoint.x+dx,y:this._startDragPoint.y+dy}),dragDirection===Orientations.HORIZONTAL?this._moveOnX(dx):this._moveOnY(dy)):this._move(dx,dy)},HighlightSelect.prototype.moveOnX=function(delta){this.x=this._element.validateProperty(Properties.X,this.x+delta*this.scale)},HighlightSelect.prototype.moveOnY=function(delta){this.y=this._element.validateProperty(Properties.Y,this.y+delta*this.scale)},HighlightSelect.prototype.resize=function(x,y,direction,lockRatio,useAnchor){var bb=this.getBoundingBox(),width=this.width,height=this.height,anchorX=this._element._anchorX,anchorY=this._element._anchorY;this._resizePoint.x=this.angle?x:SnappingHelper.GetSnappedX(Math.round(x/this.scale))*this.scale,this._resizePoint.y=this.angle?y:SnappingHelper.GetSnappedY(Math.round(y/this.scale))*this.scale,useAnchor||(this._element._anchorX=0,this._element._anchorY=0),this._element._isResizing=!0,this["_resize"+direction].call(this,bb,width,height,lockRatio,useAnchor),this._element._isResizing=!1,useAnchor||(this._element._anchorX=anchorX,this._element._anchorY=anchorY)},HighlightSelect.prototype.rotate=function(x,y,withShiftKey){var dx=x-this._startDragPoint.x,dy=y-this._startDragPoint.y,rad=Math.atan2(-dx,dy),angle=(this._elementStartAngle+Calc.RadToDeg(rad+Math.PI)-this._startAngle)%360;this.angle=withShiftKey?15*Math.round(angle/15):angle},HighlightSelect.prototype._isTransformEnabled=function(){return!this.Page.isComponentInSelection()},HighlightSelect.prototype.containsRotatedElement=function(){return(this._element.isGroup()||this._element.isVirtualGroup())&&this._element.containsRotatedElement()},HighlightSelect.prototype._isElementsSnappingEnabled=function(){return this.Page.options.enableSmartGuides&&this.Page.options.enableSmartGuidesSnapping&&this._element.type!==ElementTypes.IMAGE_CROP},HighlightSelect.prototype._isGuidesSnappingEnabled=function(){return this.Page.options.enableGuides&&this.Page.options.enableGuidesSnapping&&this._element.type!==ElementTypes.IMAGE_CROP},HighlightSelect.prototype._getElementsForSnapping=function(){var elements={};return this._isElementsSnappingEnabled()&&(elements=this.Page.ElementsManager.getElements()),elements},HighlightSelect.prototype._getGuidesForSnapping=function(){var guides=[];return this._isGuidesSnappingEnabled()&&(guides=this.Page.canvas.guides),guides},HighlightSelect.prototype._resizeL=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p2,bb._p1,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=width/this.width,height=scale*this.height),this._setSize(width,height,useAnchor?0:1,useAnchor?0:.5)},HighlightSelect.prototype._resizeR=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p0,bb._p3,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=width/this.width,height=scale*this.height),this._setSize(width,height,0,useAnchor?0:.5)},HighlightSelect.prototype._resizeT=function(bb,width,height,lockRatio,useAnchor){var scale;height=Calc.GetLinePointDistance(bb._p3,bb._p2,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=height/this.height,width=scale*this.width),this._setSize(width,height,useAnchor?0:.5,useAnchor?0:1)},HighlightSelect.prototype._resizeB=function(bb,width,height,lockRatio,useAnchor){var scale;height=Calc.GetLinePointDistance(bb._p1,bb._p0,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=height/this.height,width=scale*this.width),this._setSize(width,height,useAnchor?0:.5,0)},HighlightSelect.prototype._resizeTL=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p2,bb._p1,this._resizePoint),height=Calc.GetLinePointDistance(bb._p3,bb._p2,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,useAnchor?0:1,useAnchor?0:1)},HighlightSelect.prototype._resizeTR=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p0,bb._p3,this._resizePoint),height=Calc.GetLinePointDistance(bb._p3,bb._p2,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,0,useAnchor?0:1)},HighlightSelect.prototype._resizeBL=function(bb,width,height,lockRatio,useAnchor){var scale;width=Calc.GetLinePointDistance(bb._p2,bb._p1,this._resizePoint),height=Calc.GetLinePointDistance(bb._p1,bb._p0,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,useAnchor?0:1,0)},HighlightSelect.prototype._resizeBR=function(bb,width,height,lockRatio){var scale;width=Calc.GetLinePointDistance(bb._p0,bb._p3,this._resizePoint),height=Calc.GetLinePointDistance(bb._p1,bb._p0,this._resizePoint),(lockRatio||this.containsRotatedElement())&&(scale=Math.max(width/this.width,height/this.height),width=scale*this.width,height=scale*this.height),this._setSize(width,height,0,0)},HighlightSelect.prototype._setSize=function(width,height,anchorX,anchorY){this.anchorX=anchorX,this.anchorY=anchorY;var changeBase={width:width/this.scale,height:height/this.scale},changeByWidth=this._scaleObject(this._calculateWidthRelatedProperties(width,this.x,this.y)),changeByHeight=this._scaleObject(this._calculateHeightRelatedProperties(height,"undefined"==typeof changeByWidth.x?this.x:changeByWidth.x,"undefined"==typeof changeByWidth.y?this.y:changeByWidth.y)),changes=_.extend(changeBase,changeByWidth,changeByHeight),validated=this._element.validateProperties(changes);this.width=validated.width*this.scale,this.height=validated.height*this.scale},HighlightSelect.prototype._scaleObject=function(object){return _.mapValues(object,function(value){return value/this.scale}.bind(this))},HighlightSelect.prototype._setMode=function(mode){this._mode=mode,this.rotatable=mode!==HighlightSelect.MODE_CROP,this.view.setResizeMode(mode===HighlightSelect.MODE_RESIZE)},HighlightSelect.prototype._isSmall=function(){return this.width<SMALL_DIMENSIONS||this.height<SMALL_DIMENSIONS},HighlightSelect.prototype._isTiny=function(){return this.width<TINY_DIMENSIONS||this.height<TINY_DIMENSIONS},HighlightSelect.prototype._adjustCorners=function(){var smallClass="small-corners",tinyClass="tiny-corners";this._isSmall()?(this.view.domElement.classList.add(smallClass),this._isTiny()&&this.view.domElement.classList.add(tinyClass)):this.view.domElement.classList.remove(smallClass,tinyClass)},HighlightSelect.prototype._moveOnX=function(delta){var x=this._getSnappedX(delta),validatedProperties=this._element.validateProperties({x:x,y:this._elementStartPoint.y});this.x=validatedProperties.x*this.scale,this.y=validatedProperties.y*this.scale},HighlightSelect.prototype._moveOnY=function(delta){var y=this._getSnappedY(delta),validatedProperties=this._element.validateProperties({x:this._elementStartPoint.x,y:y});this.x=validatedProperties.x*this.scale,this.y=validatedProperties.y*this.scale},HighlightSelect.prototype._move=function(dx,dy){var x=this._getSnappedX(dx),y=this._getSnappedY(dy),validatedProperties=this._element.validateProperties({x:x,y:y});this.x=validatedProperties.x*this.scale,this.y=validatedProperties.y*this.scale},HighlightSelect.prototype._getSnappedX=function(delta){return SnappingHelper.GetSnappedX(Math.round(this._elementStartPoint.x+delta))},HighlightSelect.prototype._getSnappedY=function(delta){return SnappingHelper.GetSnappedY(Math.round(this._elementStartPoint.y+delta))},HighlightSelect}()},{"../../enums/ElementTypes.js":184,"../../enums/Orientations.js":193,"../../enums/Properties.js":195,"../../primitives/Point.js":211,"../../primitives/Rectangle.js":212,"../../utils/Base.js":213,"../../utils/Calc.js":215,"../AbstractElement.js":24,"../helpers/BrowserHelper.js":93,"../helpers/MoveTracer.js":100,"../helpers/SnappingHelper.js":103,"./Highlight.js":116,"./views/HighlightSelectView.js":136,lodash:19}],122:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Events=_dereq_("../../enums/Events.js"),Properties=_dereq_("../../enums/Properties.js"),AbstractElement=_dereq_("../AbstractElement.js"),ImageCropView=_dereq_("./views/ImageCropView.js"),Rectangle=_dereq_("../../primitives/Rectangle.js"),Point=_dereq_("../../primitives/Point.js");module.exports=function(){function ImageCrop(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE_CROP,this.view=new ImageCropView,this._rectClip=new Rectangle}var bbProperties=[Properties.X,Properties.Y,Properties.WIDTH,Properties.HEIGHT],point0=new Point,positionDelta=new Point,emitChange=_.debounce(function(imageCrop){imageCrop.Page.emit(Events.CROP_CHANGE,imageCrop.getCropSettings())},30);return ImageCrop.DefaultProperties={src:{value:""},originRect:{value:null},image:{value:null}},Base.Extend(ImageCrop,AbstractElement),Object.defineProperties(ImageCrop.prototype,{rect:{get:function(){return this._rectClip}},src:{get:function(){return this._src},set:function(value){this._src=value,this.view.img.src=this._getCdnUrl(value)}},originRect:{get:function(){return this._rect},set:function(value){this._rect=value,this.dirty=!0}},image:{get:function(){return this._image},set:function(value){this._image=value,this._setCropArea(value),this.dirty=!0}}}),ImageCrop.prototype.validateProperty=function(property,value){return _.contains(bbProperties,property)&&(value=this._validateBbProperty(property,value)),AbstractElement.prototype.validateProperty.call(this,property,value)},ImageCrop.prototype.validateProperties=function(properties){var rect,bbChanges=_.pick(properties,bbProperties),stdChanges=_.omit(properties,bbProperties),validated=_.clone(properties);if(!_.isEmpty(bbChanges)&&(rect=_.extend(this._rectClip.clone(),bbChanges),!this._rect.isInBounds(rect))){var maxBounds=this._rect.getMaxBounds(this._rectClip.clone(),rect);validated=_.extend(validated,_.mapValues(bbChanges,function(value,property){return"undefined"!=typeof maxBounds[property]?maxBounds[property]:this[property]}.bind(this)))}return _.isEmpty(stdChanges)||(validated=_.extend(validated,AbstractElement.prototype.validateProperties.call(this,properties))),validated},ImageCrop.prototype._validateBbProperty=function(property,value){var rect=this._rectClip.clone();return rect[property]=value,this._rect.isInBounds(rect)||(value=this[property]),value},ImageCrop.prototype.hitTest=function(p){return this.originRect.hitTest(p)?this:null},ImageCrop.prototype.getPositionDelta=function(){return positionDelta.x=this._rectClip.x-this._rect.x,positionDelta.y=this._rectClip.y-this._rect.y,this.angle&&positionDelta.rotate(point0,-this.angle),positionDelta},ImageCrop.prototype.getCropRectangle=function(){var delta=this.getPositionDelta();return new Rectangle(delta.x,delta.y,this._rectClip.width,this._rectClip.height)},ImageCrop.prototype.getImageRectangle=function(){return this._rectClip.clone()},ImageCrop.prototype.getMaxWidth=function(){return this._rect.x+this._rect.width-this._rectClip.x},ImageCrop.prototype.getMaxHeight=function(){return this._rect.y+this._rect.height-this._rectClip.y},ImageCrop.prototype.getCropSettings=function(){return{width:this.width,height:this.height,maxWidth:this.getMaxWidth(),maxHeight:this.getMaxHeight()}},ImageCrop.prototype.setCropSettings=function(settings){_.forEach(settings,function(value,property){this[property]=value}.bind(this))},ImageCrop.prototype.update=function(){AbstractElement.prototype.update.call(this),emitChange(this)},ImageCrop.prototype.updateProperty=function(property,value){this._updateProperty(property,value)},ImageCrop.prototype.imageProcessingStart=function(){this._disableTransformation(),this.Page.emit(Events.IMAGE_PROCESSING,!0)},ImageCrop.prototype.imageProcessingEnd=function(){this._enableTransformation(),this.Page.emit(Events.IMAGE_PROCESSING,!1)},ImageCrop.prototype._updateProperty=function(property,value){this[property]=value},ImageCrop.prototype._saveProperty=function(){},ImageCrop.prototype._setCropArea=function(image){this._rectClip=image.rect.clone(),_.isEmpty(image.crop)&&(this._rectClip.width=.8*image.width,this._rectClip.height=.8*image.height,this._rectClip.moveAlongAngle(.1*image.width,.1*image.height))},ImageCrop.prototype._getGroupTranslates=function(){return this.image._getGroupTranslates()},ImageCrop}()},{"../../enums/ElementTypes.js":184,"../../enums/Events.js":185,"../../enums/Properties.js":195,"../../primitives/Point.js":211,"../../primitives/Rectangle.js":212,"../../utils/Base.js":213,"../AbstractElement.js":24,"./views/ImageCropView.js":138,lodash:19}],123:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Base=_dereq_("../../utils/Base.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),AbstractElement=_dereq_("../AbstractElement.js"),Linked=_dereq_("../behaviors/Linked.js"),ImageEditView=_dereq_("./views/ImageEditView.js");module.exports=function(){function ImageEdit(){AbstractElement.apply(this,arguments),this.type=ElementTypes.IMAGE_EDIT,this.view=new ImageEditView,this._imageElement=null,this._imageDrawn=!1,this._imageUpdateRef=this._onImageUpdate.bind(this),this._loadedResolve=null,this._loaded=new Promise(function(resolve){this._loadedResolve=resolve}.bind(this)),this.manipulator=null,this._loaded.then(function(){this.manipulator=new GlfxInterface(this.view.domElement,function(instance,canvas){this.view.domElement=canvas,instance.initializeRender(this.getAdjustments())}.bind(this))}.bind(this))}return ImageEdit.DefaultProperties={brightness:{value:0},contrast:{value:0},saturation:{value:0},vibrance:{value:0},exposure:{value:0},sharpen:{value:0},blur:{value:0},src:{value:""},image:{value:null}},Base.Extend(ImageEdit,AbstractElement),Base.ApplyBehavior(ImageEdit,Linked),Object.defineProperties(ImageEdit.prototype,{brightness:{get:function(){return this._brightness},set:function(value){this._brightness=value,this.manipulator&&this.manipulator.renderProperty("brightness",value)}},contrast:{get:function(){return this._contrast},set:function(value){this._contrast=value,this.manipulator&&this.manipulator.renderProperty("contrast",value)}},saturation:{get:function(){return this._saturation},set:function(value){this._saturation=value,this.manipulator&&this.manipulator.renderProperty("saturation",value)}},vibrance:{get:function(){return this._vibrance},set:function(value){this._vibrance=value,this.manipulator&&this.manipulator.renderProperty("vibrance",value)}},exposure:{get:function(){return this._exposure},set:function(value){this._exposure=value,this.manipulator&&this.manipulator.renderProperty("exposure",value)}},sharpen:{get:function(){return this._sharpen},set:function(value){this._sharpen=value,this.manipulator&&this.manipulator.renderProperty("sharpen",value)}},blur:{get:function(){return this._blur},set:function(value){this._blur=value,this.manipulator&&this.manipulator.renderProperty("blur",value)}},src:{get:function(){return this._src},set:function(value){this._src=value,this._imageDrawn=!1,this._imageElement=new Image,this._imageElement.crossOrigin="Anonymous",this._imageElement.onload=function(){this._onImageUpdate(this.image),this._updateAdjustments(),this._drawImage(),this._loadedResolve(this)}.bind(this),this._imageElement.src=this._getCdnUrl(value)}},image:{get:function(){return this._image},set:function(value){this._observeImage(value),this._image=value}}}),ImageEdit.prototype.loaded=function(){return this._loaded},ImageEdit.prototype.getAdjustments=function(){return{brightness:this.brightness,saturation:this.saturation,contrast:this.contrast,vibrance:this.vibrance,exposure:this.exposure,sharpen:this.sharpen,blur:this.blur}},ImageEdit.prototype.getChangedAdjustments=function(){return _.pick(this.getAdjustments(),function(value,property){return value!==this.image[property]}.bind(this))},ImageEdit.prototype.setAdjustments=function(settings){_.forEach(settings,function(value,property){this[property]=value}.bind(this))},ImageEdit.prototype.destroy=function(){this.removeChangeListener(this._imageUpdateRef),this.manipulator&&this.manipulator.destroy()},ImageEdit.prototype._observeImage=function(){this._image&&this.removeChangeListener(this._imageUpdateRef),this.addChangeListener(this._imageUpdateRef)},ImageEdit.prototype._onImageUpdate=function(image){this._rect=image._rect.clone(),this.dirty=!0},ImageEdit.prototype._updateAdjustments=function(){this.brightness=this.image.brightness,this.saturation=this.image.saturation,this.contrast=this.image.contrast,this.vibrance=this.image.vibrance,this.exposure=this.image.exposure,this.sharpen=this.image.sharpen,this.blur=this.image.blur},ImageEdit.prototype._drawImage=function(){var width=this._imageElement.naturalWidth,height=this._imageElement.naturalHeight;this.view.domElement.setAttribute("width",Parse.toPx(width)),this.view.domElement.setAttribute("height",Parse.toPx(height));var ctx=this.view.domElement.getContext("2d");ctx.drawImage(this._imageElement,0,0,width,height),this._imageDrawn=!0},ImageEdit.prototype._getGroupTranslates=function(){return this.image._getGroupTranslates()},ImageEdit}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../../utils/Parse.js":220,"../AbstractElement.js":24,"../behaviors/Linked.js":83,"./views/ImageEditView.js":139,lodash:19}],124:[function(_dereq_,module,exports){"use strict";var Highlight=_dereq_("./Highlight.js"),Linked=_dereq_("../behaviors/Linked.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),UploadStatus=_dereq_("../../enums/UploadStatus.js"),ImageUploadView=_dereq_("./views/ImageUploadView.js"),Base=_dereq_("../../utils/Base.js"),Calc=_dereq_("../../utils/Calc.js");module.exports=function(){function ImageUpload(){Highlight.apply(this,arguments),this.type=ElementTypes.IMAGE_UPLOAD,this.view=new ImageUploadView,this._progress=0,this._status=UploadStatus.READY}return Base.Extend(ImageUpload,Highlight),Base.ApplyBehavior(ImageUpload,Linked),Object.defineProperties(ImageUpload.prototype,{progress:{get:function(){return this._progress},set:function(value){this._progress=value,this.dirty=!0}},status:{get:function(){return this._status},set:function(value){this._status!==value&&(this._status=value,this.dirty=!0)}}}),ImageUpload.prototype.getProgressPercentage=function(){return Calc.Round(100*this.progress,0)},ImageUpload.prototype.show=function(element){Highlight.prototype.show.call(this,element),this.addChangeListener(this.onElementChange.bind(this)),element.view.insertNodeAfter(this.view.domElement,element.view.domElement)},ImageUpload.prototype.remove=function(){this.view.destroyDomElement()},ImageUpload.prototype.onElementChange=function(element){this.x=element.x,this.y=element.y,this.width=element.width,this.height=element.height,this.angle=element.angle},ImageUpload.prototype._getGroupTranslates=function(){return this.element._getGroupTranslates()},ImageUpload}()},{"../../enums/ElementTypes.js":184,"../../enums/UploadStatus.js":199,"../../utils/Base.js":213,"../../utils/Calc.js":215,"../behaviors/Linked.js":83,"./Highlight.js":116,"./views/ImageUploadView.js":140}],125:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),MultiSelectView=_dereq_("./views/MultiSelectView.js"),Base=_dereq_("../../utils/Base.js");module.exports=function(){function MultiSelect(){AbstractElement.apply(this,arguments),this.type=ElementTypes.MULTI_SELECT,this.view=new MultiSelectView,this.scale=1,this.startPoint=null,this._selection=null}return Base.Extend(MultiSelect,AbstractElement),Object.defineProperties(MultiSelect.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,this.update()}}}),MultiSelect.prototype.show=function(selection){this._selection=selection,this.view.setVisibility(!0),this.update(!0)},MultiSelect.prototype.hide=function(){this.view.setVisibility(!1),this._selection=null},MultiSelect.prototype.hasSelection=function(){return!!this._selection},MultiSelect.prototype.setScale=function(value){this._rect.multiply(value/this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this.scale=value,this.update()},MultiSelect.prototype.update=function(shouldUpdateBoundingBox){shouldUpdateBoundingBox&&this._selection&&(this._rect=this._selection.clone().multiply(this.scale),this._x=this._rect.x,this._y=this._rect.y,this._width=this._rect.width,this._height=this._rect.height,this._angle=this._rect.angle),AbstractElement.prototype.update.call(this)},MultiSelect.prototype._updateProperty=function(){},MultiSelect.prototype._saveProperty=function(){},MultiSelect}()},{"../../enums/ElementTypes.js":184,"../../utils/Base.js":213,"../AbstractElement":24,"./views/MultiSelectView.js":141}],126:[function(_dereq_,module,exports){"use strict";var AbstractElement=_dereq_("../AbstractElement"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),SmartguideView=_dereq_("./views/SmartguideView.js"),Base=_dereq_("../../utils/Base.js"),Orientations=_dereq_("../../enums/Orientations.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function Smartguide(id,page,orientation){AbstractElement.apply(this,arguments),this.type=ElementTypes.GUIDE,this.view=new SmartguideView,this.orientation=orientation,this.visibility=!1}return Base.Extend(Smartguide,AbstractElement),Object.defineProperties(Smartguide.prototype,{dirty:{get:function(){return this._dirty},set:function(value){this._dirty=value,value&&this.update()}},x:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).get.call(this)},set:function(value){this.orientation===Orientations.HORIZONTAL&&(value=0),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.X).set.call(this,value)}},y:{get:function(){return Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).get.call(this)},set:function(value){this.orientation===Orientations.VERTICAL&&(value=0),Object.getOwnPropertyDescriptor(AbstractElement.prototype,Properties.Y).set.call(this,value)}},orientation:{get:function(){return this._orientation},set:function(value){this._orientation=value,value===Orientations.HORIZONTAL?this.height=1:this.width=1,this.view.setOrientation(value),this.dirty=!0}},visibility:{get:function(){return this._visibility},set:function(value){this._visibility=value,this.view.setVisibility(value)}}}),Smartguide.prototype.update=function(){this.visibility&&this.dirty&&(this.dirty=!1,this.view.updateTransform(this))},Smartguide.prototype._updateProperty=function(){},Smartguide.prototype._saveProperty=function(){},Smartguide}()},{"../../enums/ElementTypes.js":184,"../../enums/Orientations.js":193,"../../enums/Properties.js":195,"../../utils/Base.js":213,"../AbstractElement":24,"./views/SmartguideView.js":142}],127:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),IndicatorAlign=_dereq_("../../../enums/IndicatorAlign.js");module.exports=function(){function getAlignTranslate(element){var x=0,y=0;return element.align!==IndicatorAlign.TOP_RIGHT&&element.align!==IndicatorAlign.BOTTOM_RIGHT||(x=element.width),element.align!==IndicatorAlign.BOTTOM_LEFT&&element.align!==IndicatorAlign.BOTTOM_RIGHT||(y=element.height),x||y?"translate("+Parse.toPx(x)+","+Parse.toPx(y)+")":""}function AttributesIndicatorView(className){this.className=className,ElementView.call(this)}return AttributesIndicatorView.prototype=Object.create(ElementView.prototype),AttributesIndicatorView.constructor=AttributesIndicatorView,AttributesIndicatorView.prototype.createDomElement=function(){var el=document.createElement("FIGURE");return el.classList.add("el-indicator",this.className),el},AttributesIndicatorView.prototype.updateTransform=function(element){this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate("+element.angle+"deg)"+getAlignTranslate(element),this.domElement.style["-webkit-transform"]=this.domElement.style.transform},AttributesIndicatorView}()},{"../../../enums/IndicatorAlign.js":186,"../../../utils/Parse.js":220,"../../views/ElementView.js":153}],128:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),Render=_dereq_("../../../utils/Render.js"),SingleCollaborationHighlight=function(){function getName(data){return data.username?data.username:data.email.slice(0,data.email.indexOf("@"))}function SingleCollaborationHighlight(data,element,scale){this.setViewData(data,element,scale,!0),ElementView.call(this),this.updateTransform()}return SingleCollaborationHighlight.prototype=Object.create(ElementView.prototype),
SingleCollaborationHighlight.constructor=SingleCollaborationHighlight,SingleCollaborationHighlight.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("element-collaboration-indicator"),el.style.borderColor=this.color,el.appendChild(Render.ToDom(['<div class="user-info" style="background-color:',this.color,';">',this.username,"</div>"].join(""))),el},SingleCollaborationHighlight.prototype.setViewData=function(data,element,scale,initial){this._rect=element.getBoundingBox(!0);var rect=this._rect.clone().multiply(scale);this._scale=scale,this._x=rect.x,this._y=rect.y,this._width=rect.width,this._height=rect.height,this._angle=rect.angle,this.color=data.color,this.username=getName(data),!initial&&this.updateTransform(this)},SingleCollaborationHighlight.prototype.setScale=function(scale){if(this._scale!==scale){var rect=this._rect.clone().multiply(scale);this._scale=scale,this._x=rect.x,this._y=rect.y,this._width=rect.width,this._height=rect.height,this._angle=rect.angle}},SingleCollaborationHighlight.prototype.updateTransform=function(){this.domElement.style.width=Parse.toPx(this._width),this.domElement.style.height=Parse.toPx(this._height),this.domElement.style.transform="translate("+Parse.toPx(this._x)+","+Parse.toPx(this._y)+")rotate("+this._angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},SingleCollaborationHighlight}();module.exports=function(){function removeSingleCollaborationHighlight(highlight){highlight.destroyDomElement()}function CollaboratorView(data){this.data=data,this.viewHighlighters=[],ElementView.call(this)}return CollaboratorView.prototype=Object.create(ElementView.prototype),CollaboratorView.constructor=CollaboratorView,CollaboratorView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-collaboration-wrapper"),el},CollaboratorView.prototype.setViewData=function(data){this.data=data},CollaboratorView.prototype.setElements=function(isVisible,elements,scale){this.setVisibility(isVisible,!1),isVisible&&(this.viewHighlighters.length>elements.length&&this.viewHighlighters.splice(elements.length).forEach(removeSingleCollaborationHighlight),this.viewHighlighters=_.reduce(elements,function(highlighters,element,index){if(highlighters[index])return highlighters[index].setViewData(this.data,element,scale),highlighters;var highlighter=new SingleCollaborationHighlight(this.data,element,scale);return this.domElement.appendChild(highlighter.domElement),highlighters.concat(highlighter)}.bind(this),this.viewHighlighters))},CollaboratorView.prototype.setScale=function(scale){this.viewHighlighters.forEach(function(highlighter){highlighter.setScale(scale)})},CollaboratorView}()},{"../../../utils/Parse.js":220,"../../../utils/Render.js":221,"../../views/ElementView.js":153,lodash:19}],129:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Render=_dereq_("../../../utils/Render.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function ElementIndicatorView(){ElementView.call(this)}var CLASS_VISIBLE="visible",CLASS_COORDINATES="element-coordinates",CLASS_DIMENSIONS="element-dimensions",CLASS_ROTATION="element-rotation",templateCoordinates="<span>x</span> <%= x %>px <span>y</span> <%= y %>px",templateDimensions="<span><%= width %>px</span><span><%= height %>px</span>",templateRotation="<span><%= angle %></span>";return ElementIndicatorView.prototype=Object.create(ElementView.prototype),ElementIndicatorView.constructor=ElementIndicatorView,ElementIndicatorView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el},ElementIndicatorView.prototype.updateTransform=function(element){this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},ElementIndicatorView.prototype.showCoordinates=function(x,y){this.domElement.innerHTML=Render.ToHtml(templateCoordinates,{x:parseInt(x),y:parseInt(y)}),this.domElement.classList.remove(CLASS_DIMENSIONS,CLASS_ROTATION),this.domElement.classList.add(CLASS_COORDINATES,CLASS_VISIBLE)},ElementIndicatorView.prototype.showDimensions=function(width,height){this.domElement.innerHTML=Render.ToHtml(templateDimensions,{width:parseInt(width),height:parseInt(height)}),this.domElement.classList.remove(CLASS_COORDINATES,CLASS_ROTATION),this.domElement.classList.add(CLASS_DIMENSIONS,CLASS_VISIBLE)},ElementIndicatorView.prototype.showRotation=function(angle){this.domElement.innerHTML=Render.ToHtml(templateRotation,{angle:parseInt(angle)}),this.domElement.classList.remove(CLASS_COORDINATES,CLASS_DIMENSIONS),this.domElement.classList.add(CLASS_ROTATION,CLASS_VISIBLE)},ElementIndicatorView.prototype.hide=function(){this.domElement.classList.remove("visible")},ElementIndicatorView}()},{"../../../utils/Parse.js":220,"../../../utils/Render.js":221,"../../views/ElementView.js":153}],130:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function ElementNameView(){ElementView.call(this)}return ElementNameView.prototype=Object.create(ElementView.prototype),ElementNameView.constructor=ElementNameView,ElementNameView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("element-name-box"),el},ElementNameView.prototype.setVisibility=function(visibility){return visibility?void this.domElement.classList.add("visible"):void this.domElement.classList.remove("visible")},ElementNameView.prototype.setName=function(name){this.domElement.textContent=name},ElementNameView.prototype.setPosition=function(x,y){this.domElement.style.left=Parse.toPx(x),this.domElement.style.top=Parse.toPx(y)},ElementNameView}()},{"../../../utils/Parse.js":220,"../../views/ElementView.js":153}],131:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),Orientations=_dereq_("../../../enums/Orientations.js");module.exports=function(){function GuideView(){ElementView.call(this)}return GuideView.prototype=Object.create(ElementView.prototype),GuideView.constructor=GuideView,GuideView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-guide"),el.classList.add("guideline"),el},GuideView.prototype.updateTransform=function(element){element.orientation===Orientations.HORIZONTAL?this.domElement.style.width=Parse.toPx(element.width):this.domElement.style.height=Parse.toPx(element.height),this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate(0deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},GuideView.prototype.setOrientation=function(value){this.domElement.classList.add(value)},GuideView.prototype.setVisibility=function(value){this.domElement.style.display=value?"block":"none"},GuideView}()},{"../../../enums/Orientations.js":193,"../../../utils/Parse.js":220,"../../views/ElementView.js":153}],132:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js"),Orientations=_dereq_("../../../enums/Orientations.js");module.exports=function(){function HighlightCellResizerView(){ElementView.call(this)}function createResizeHandler(className,index,position){var resizeHandler=document.createElement("div");return resizeHandler.style.left=position,resizeHandler.className=className,resizeHandler.classList.add("cell-resizer-handle"),resizeHandler.setAttribute("data-index",index),resizeHandler}return HighlightCellResizerView.prototype=Object.create(ElementView.prototype),HighlightCellResizerView.constructor=HighlightCellResizerView,HighlightCellResizerView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight-cell-resizer","element-transformator","table-cell-resizer"),el},HighlightCellResizerView.prototype.initView=function(element,scale){this.domElement.innerHTML="",_.each(element.getRealCellWidths().slice(0,element.columnWidths.length-1),function(value,index){var position=Parse.toPx(element.getLeftOffsetForColumn(index+1)*scale),resizeHandler=createResizeHandler(Orientations.VERTICAL,index,position);this.domElement.appendChild(resizeHandler)},this)},HighlightCellResizerView.prototype.updateResizerPositions=function(element,scale){var position,cellWidths=element.getRealCellWidths(),iterationArray=new Array(Math.max(cellWidths.length-1,this.domElement.children.length));_.each(iterationArray,function(value,index){position=Parse.toPx(element.getLeftOffsetForColumn(index+1)*scale),this.domElement.children[index]?this.domElement.children[index]&&!cellWidths[index+1]?this.domElement.removeChild(this.domElement.children[index]):this.domElement.children[index].style.left=position:this.domElement.appendChild(createResizeHandler(Orientations.VERTICAL,index,position))},this)},HighlightCellResizerView.prototype.removeResizers=function(){for(var viewContainer=this.domElement;viewContainer.firstChild;)viewContainer.removeChild(viewContainer.firstChild)},HighlightCellResizerView.prototype.setResizerMoving=function(resizer,isMoving){isMoving?resizer.classList.add("moving"):resizer.classList.remove("moving")},HighlightCellResizerView.prototype.updateVerticalResizerPosition=function(index,left){var verticalResizers=this.domElement.getElementsByClassName(Orientations.VERTICAL);verticalResizers[index].style.left=Parse.toPx(left)},HighlightCellResizerView}()},{"../../../enums/Orientations.js":193,"../../../utils/Parse.js":220,"../../views/ElementView.js":153,lodash:19}],133:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightEditClippedView(){ElementView.call(this)}return HighlightEditClippedView.prototype=Object.create(ElementView.prototype),HighlightEditClippedView.constructor=HighlightEditClippedView,HighlightEditClippedView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("clipped"),el.classList.add("clipped-edit"),el},HighlightEditClippedView}()},{"../../views/ElementView.js":153}],134:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightEditView(){ElementView.call(this)}return HighlightEditView.prototype=Object.create(ElementView.prototype),HighlightEditView.constructor=HighlightEditView,HighlightEditView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight-edit","element-transformator","group-editing"),el},HighlightEditView.prototype.setMultistateMode=function(isMultistate){return isMultistate?void this.domElement.classList.add("multistate"):void this.domElement.classList.remove("multistate")},HighlightEditView}()},{"../../views/ElementView.js":153}],135:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function HighlightPartView(){ElementView.call(this)}return HighlightPartView.prototype=Object.create(ElementView.prototype),HighlightPartView.constructor=HighlightPartView,HighlightPartView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("element-transformator-part"),el},HighlightPartView}()},{"../../views/ElementView.js":153}],136:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("../../views/ElementView.js"),Render=_dereq_("../../../utils/Render.js");module.exports=function(){function getPositiveAngle(angle){return angle<0?360+angle:angle}function getRotatedClassIndex(angle){var STEP=45;return Math.floor(getPositiveAngle(angle-STEP/2)/STEP)}function HighlightSelectView(){this._rotatedClassName=ROTATED_CLASS_NAMES[7],ElementView.call(this)}var ROTATOR_SELECTOR='[data-rotator="1"]',ROTATION_CLASSES=["ng-rotator","rotate-corner"],ROTATED_CLASS_NAMES=["axis-part-7","axis-part-6","axis-part-5","axis-part-4","axis-part-3","axis-part-2","axis-part-1","axis-part-0"],template='<div class="center" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateTL rotate-corner top-left" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateTR rotate-corner top-right" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateBL rotate-corner bottom-left" title="Rotate"></div><div data-rotator="1" class="ng-rotator ng-rotateBR rotate-corner bottom-right" title="Rotate"></div><div data-direction="TL" class="ng-resizer resize-corner top-left ng-resizeTL" title="Resize"></div><div data-direction="T" class="ng-resizer resize-corner top ng-resizeT" title="Resize"></div><div data-direction="TR" class="ng-resizer resize-corner top-right ng-resizeTR" title="Resize"></div><div data-direction="L" class="ng-resizer resize-corner left ng-resizeL" title="Resize"></div><div data-direction="R" class="ng-resizer resize-corner right ng-resizerR" title="Resize"></div><div data-direction="BL" class="ng-resizer resize-corner bottom-left ng-resizeBL" title="Resize"></div><div data-direction="B" class="ng-resizer resize-corner bottom ng-resizeB" title="Resize"></div><div data-direction="BR" class="ng-resizer resize-corner bottom-right ng-resizeBR" title="Resize"></div>';return HighlightSelectView.prototype=Object.create(ElementView.prototype),HighlightSelectView.constructor=HighlightSelectView,HighlightSelectView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight-select","element-transformator","transforming"),el.innerHTML=Render.ToHtml(template),el},HighlightSelectView.prototype.setResizeMode=function(isResizeMode){isResizeMode?this.domElement.classList.remove("cropping"):this.domElement.classList.add("cropping")},HighlightSelectView.prototype.enableRotation=function(value){_.forEach(this.domElement.querySelectorAll(ROTATOR_SELECTOR),function(element){value?element.classList.add.apply(element.classList,ROTATION_CLASSES):element.classList.remove.apply(element.classList,ROTATION_CLASSES)})},HighlightSelectView.prototype.setTransformEnabled=function(isTransformEnabled){return isTransformEnabled?void this.domElement.classList.remove("transform-disabled"):void this.domElement.classList.add("transform-disabled")},HighlightSelectView.prototype.updateTransform=function(element){ElementView.prototype.updateTransform.call(this,element),this._updateRotatedClass(element.angle)},HighlightSelectView.prototype._updateRotatedClass=function(angle){var className=ROTATED_CLASS_NAMES[getRotatedClassIndex(angle)];this._rotatedClassName!==className&&(this.domElement.classList.remove(this._rotatedClassName),this.domElement.classList.add(className),this._rotatedClassName=className)},HighlightSelectView}()},{"../../../utils/Render.js":221,"../../views/ElementView.js":153,lodash:19}],137:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Render=_dereq_("../../../utils/Render.js");module.exports=function(){function HighlightView(){ElementView.call(this)}return HighlightView.prototype=Object.create(ElementView.prototype),HighlightView.constructor=HighlightView,HighlightView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight","element-transformator"),el.appendChild(Render.ToDom('<p class="drag-info"><span class="icon-font-arrow">Drop image here</span></p>')),el},HighlightView}()},{"../../../utils/Render.js":221,"../../views/ElementView.js":153}],138:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function ImageCropView(){this.img=null,this.area=null,ElementView.call(this)}return ImageCropView.prototype=Object.create(ElementView.prototype),ImageCropView.constructor=ImageCropView,ImageCropView.prototype.createDomElement=function(){var el=document.createElement("div");return el.classList.add("ng-element"),el.classList.add("ng-crop-container"),this.img=document.createElement("img"),this.img.classList.add("ng-crop-image"),el.appendChild(this.img),this.area=document.createElement("div"),this.area.classList.add("ng-crop-area"),el.appendChild(this.area),el},ImageCropView.prototype.updateTransform=function(element){var delta=element.getPositionDelta();this.domElement.style.width=Parse.toPx(element.originRect.width),this.domElement.style.height=Parse.toPx(element.originRect.height),this.domElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate("+Parse.toRealPx(element.originRect.x)+","+Parse.toRealPx(element.originRect.y)+") rotate("+element.originRect.angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform,this.area.style.width=Parse.toPx(element.width),this.area.style.height=Parse.toPx(element.height),this.area.style.transform="translate("+Parse.toRealPx(delta.x)+","+Parse.toRealPx(delta.y)+")",this.area.style["-webkit-transform"]=this.area.style.transform},ImageCropView}()},{"../../../utils/Parse.js":220,"../../views/ElementView.js":153}],139:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function ImageEditView(){this.img=null,this.area=null,ElementView.call(this)}return ImageEditView.prototype=Object.create(ElementView.prototype),ImageEditView.constructor=ImageEditView,ImageEditView.prototype.createDomElement=function(){var el=document.createElement("canvas");return el.classList.add("ng-element"),el},ImageEditView}()},{"../../views/ElementView.js":153}],140:[function(_dereq_,module,exports){"use strict";var Render=_dereq_("../../../utils/Render.js"),ElementView=_dereq_("../../views/ElementView.js"),UploadStatus=_dereq_("../../../enums/UploadStatus.js"),VISIBLE_CLASS="visible",UPLOADING_CLASS="uploading-image";module.exports=function(){function ImageUploadView(){ElementView.call(this)}var template='<div class="ng-element upload-image-helper visible"><p class="drag-info icon-font-drag visible">Drop image here</p><p class="progress-indicator"><span class="progress-uploading-info">Uploading image <strong class="progress-percentage"><%= progress %>%</strong></span></p><p class="failed-info">Upload failed, please try again.</p></div>';return ImageUploadView.prototype=Object.create(ElementView.prototype),ImageUploadView.constructor=ImageUploadView,ImageUploadView.prototype.createDomElement=function(){var el=Render.ToDom(template,{progress:100});return this.dragInfoEl=el.querySelector(".drag-info"),this.failedInfoEl=el.querySelector(".failed-info"),this.progressEl=el.querySelector(".progress-percentage"),this.progressIndicatorEl=el.querySelector(".progress-indicator"),el},ImageUploadView.prototype.updateTransform=function(element){ElementView.prototype.updateTransform.call(this,element),element.status===UploadStatus.READY?this.setReadyView():element.status===UploadStatus.PENDING?this.setPendingView(element.getProgressPercentage()):element.status===UploadStatus.COMPLETED?this.setCompletedView():element.status===UploadStatus.FAILED&&this.setFailedView()},ImageUploadView.prototype.setReadyView=function(){this.domElement.classList.remove(UPLOADING_CLASS),this.dragInfoEl.classList.add(VISIBLE_CLASS),this.failedInfoEl.classList.remove(VISIBLE_CLASS)},ImageUploadView.prototype.setPendingView=function(progress){this.domElement.classList.add(UPLOADING_CLASS),this.dragInfoEl.classList.remove(VISIBLE_CLASS),this.failedInfoEl.classList.remove(VISIBLE_CLASS),this.progressEl.innerHTML=progress+"%",this.progressIndicatorEl.style.width=progress+"%"},ImageUploadView.prototype.setCompletedView=function(){this.setPendingView(100)},ImageUploadView.prototype.setFailedView=function(){this.dragInfoEl.classList.add(VISIBLE_CLASS),this.domElement.classList.remove(UPLOADING_CLASS),this.failedInfoEl.classList.add(VISIBLE_CLASS)},ImageUploadView}()},{"../../../enums/UploadStatus.js":199,"../../../utils/Render.js":221,"../../views/ElementView.js":153}],141:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js");module.exports=function(){function MultiSelectView(){ElementView.call(this)}return MultiSelectView.prototype=Object.create(ElementView.prototype),MultiSelectView.constructor=MultiSelectView,MultiSelectView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-highlight"),el.classList.add("selector"),el},MultiSelectView}()},{"../../views/ElementView.js":153}],142:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("../../views/ElementView.js"),Parse=_dereq_("../../../utils/Parse.js");module.exports=function(){function SmartguideView(){ElementView.call(this)}return SmartguideView.prototype=Object.create(ElementView.prototype),SmartguideView.constructor=SmartguideView,SmartguideView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("smartguide"),el},SmartguideView.prototype.updateTransform=function(element){this.domElement.style.transform="translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate(0deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},SmartguideView.prototype.setOrientation=function(value){this.domElement.classList.add(value)},SmartguideView.prototype.setVisibility=function(value){this.domElement.style.display=value?"block":"none"},SmartguideView}()},{"../../../utils/Parse.js":220,"../../views/ElementView.js":153}],143:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function ArrowView(){ElementView.apply(this,arguments)}var PATH_MARGIN=20;return ArrowView.prototype=Object.create(ElementView.prototype),ArrowView.constructor=ArrowView,ArrowView.prototype.createDomElement=function(){var el=this._createSvgElement("svg");el.classList.add("ng-element","el-arrow"),this.startMarkerId="start_marker_"+this.elementId,this.startMarkerPath=this._createSvgElement("path"),this.startMarkerPath.setAttribute("d","M 0 5 L 10 0 L 10 10 z"),this.endMarkerId="end_marker_"+this.elementId,this.endMarkerPath=this._createSvgElement("path"),this.endMarkerPath.setAttribute("d","M 0 0 L 10 5 L 0 10 z");var startMarker=this._createMarker(this.startMarkerId,4,9,5);startMarker.appendChild(this.startMarkerPath);var endMarker=this._createMarker(this.endMarkerId,4,1,5);endMarker.appendChild(this.endMarkerPath);var markersDefinitions=this._createSvgElement("defs");return markersDefinitions.appendChild(startMarker),markersDefinitions.appendChild(endMarker),this.path=this._createSvgElement("path"),this.path.setAttribute("stroke-width",5),this.path.setAttribute("fill","none"),el.appendChild(markersDefinitions),el.appendChild(this.path),el},ArrowView.prototype.updateSvgPath=function(element){var pathPoints;pathPoints=element.isHorizontal()?this._createHorizontalPathPoints(element):this._createVerticalPathPoints(element);var path="M"+pathPoints.startX+","+pathPoints.startY+"q"+pathPoints.curveX+","+pathPoints.curveY+" "+pathPoints.endX+","+pathPoints.endY;this.path.setAttribute("d",path),this.path.setAttribute("stroke-width",element.stroke)},ArrowView.prototype.toggleArrowStartMarker=function(value){this.path.setAttribute("marker-start",value?"url(#"+this.startMarkerId+")":"none")},ArrowView.prototype.toggleArrowEndMarker=function(value){this.path.setAttribute("marker-end",value?"url(#"+this.endMarkerId+")":"none")},ArrowView.prototype._createMarker=function(id,size,refX,refY){var marker=this._createSvgElement("marker");return marker.setAttribute("id",id),marker.setAttribute("viewBox","0 0 10 10"),marker.setAttribute("markerUnits","strokeWidth"),marker.setAttribute("markerWidth",size),marker.setAttribute("markerHeight",size),marker.setAttribute("orient","auto"),marker.setAttribute("refX",refX),marker.setAttribute("refY",refY),marker},ArrowView.prototype._createVerticalPathPoints=function(element){var width=parseInt(element.width),height=parseInt(element.height),stroke=element.stroke,strokemod=3.2*stroke,points={};return points.startY=PATH_MARGIN+strokemod,element.isUpperCurve()?(points.startX=PATH_MARGIN+strokemod,points.curveX=2*width-3*points.startX,points.curveX<0&&(points.curveX=0)):element.isLowerCurve()?(points.startX=width-PATH_MARGIN-strokemod,points.curveX=0-2*width+3*PATH_MARGIN+2.5*strokemod,points.curveX>0&&(points.curveX=0)):(points.startX=width/2,points.curveX=0),points.curveY=height/2-points.startY,points.endX=0,points.endY=height-2*points.startY,points},ArrowView.prototype._createHorizontalPathPoints=function(element){var width=parseInt(element.width),height=parseInt(element.height),stroke=element.stroke,strokemod=3.2*stroke,points={};return points.startX=PATH_MARGIN+strokemod,points.curveX=width/2-PATH_MARGIN-strokemod,element.isUpperCurve()?(points.startY=height-PATH_MARGIN-strokemod,points.curveY=0-2*height+3*PATH_MARGIN+2.5*strokemod,points.curveY>0&&(points.curveY=0)):element.isLowerCurve()?(points.startY=PATH_MARGIN+strokemod,points.curveY=2*height-3*PATH_MARGIN-2.5*strokemod,points.curveY<0&&(points.curveY=0)):(points.startY=height/2,points.curveY=0),points.endX=width-PATH_MARGIN-PATH_MARGIN-2*strokemod,points.endY=0,points},ArrowView.prototype.setColor=function(value){this.path.setAttribute("stroke",value),this.startMarkerPath.setAttribute("fill",value),this.endMarkerPath.setAttribute("fill",value)},ArrowView}()},{"./ElementView.js":153}],144:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function BannerView(){ElementView.apply(this,arguments)}return BannerView.prototype=Object.create(ElementView.prototype),BannerView.constructor=BannerView,BannerView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-banner"),el},BannerView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},BannerView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153}],145:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function BoxView(){ElementView.apply(this,arguments)}return BoxView.prototype=Object.create(ElementView.prototype),BoxView.constructor=BoxView,BoxView.prototype.createDomElement=function(){this.textElement=document.createElement("p"),this.textElement.id=this.createId(ElementTypes.BOX);var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-box"),el.classList.add("text-editor-light"),el.classList.add("line-height-hack"),el.appendChild(this.textElement),el},BoxView.prototype.setElementId=function(id){ElementView.prototype.setElementId.call(this,id),this.textElement.dataset.id=id},BoxView.prototype.getEditableElement=function(){return this.textElement},BoxView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},BoxView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},BoxView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},BoxView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},BoxView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},BoxView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},BoxView.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},BoxView.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},BoxView.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},BoxView.prototype.setTextAlign=function(value){this.textElement.style[Styles.TEXT_ALIGN]=value},BoxView.prototype.setInputValue=function(value){var htmlContainer=document.createElement("div");htmlContainer.innerHTML=value,this.parseTextWhitespaces(htmlContainer);var containerChild=htmlContainer.firstChild;containerChild&&"P"===containerChild.nodeName?(this.textElement.innerHTML=containerChild.innerHTML,containerChild.style.fontSize&&(this.textElement.style.fontSize=containerChild.style.fontSize)):this.textElement.innerHTML=htmlContainer.innerHTML},BoxView.prototype.setPaddingTop=function(value){this.setStyle(Styles.PADDING_TOP,Parse.toPx(value))},BoxView.prototype.setPaddingRight=function(value){this.setStyle(Styles.PADDING_RIGHT,Parse.toPx(value))},BoxView.prototype.setPaddingBottom=function(value){this.setStyle(Styles.PADDING_BOTTOM,Parse.toPx(value))},BoxView.prototype.setPaddingLeft=function(value){this.setStyle(Styles.PADDING_LEFT,Parse.toPx(value))},BoxView.prototype.setShadowEnabled=function(){},BoxView.prototype.setShadowOffsetX=function(){},BoxView.prototype.setShadowOffsetY=function(){},BoxView.prototype.setShadowBlur=function(){},BoxView.prototype.setShadowColor=function(){},BoxView.prototype.setGrayscale=function(){},BoxView.prototype.setColor=function(value){this.forEachTextParent(function(node){node.style.color=value})},BoxView.prototype.parseTextWhitespaces=function(node){3===node.nodeType?node.textContent=node.textContent.replace(/\B(?!^)\s/g,""):_.forEach(node.childNodes,this.parseTextWhitespaces,this)},BoxView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153,lodash:19}],146:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Styles=_dereq_("../../enums/Styles.js"),Color=_dereq_("../../utils/Color.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function insertSpace(){var range=window.getSelection().getRangeAt(0),node=range.createContextualFragment("&nbsp;");range.insertNode(node),window.getSelection().collapseToEnd(),window.getSelection().modify("move","forward","character")}function ButtonView(){ElementView.apply(this,arguments),this.backgroundColorGradient=!1}return ButtonView.prototype=Object.create(ElementView.prototype),ButtonView.constructor=ButtonView,ButtonView.prototype.createDomElement=function(){var el=document.createElement("button");return el.id=this.createId(ElementTypes.BUTTON),el.classList.add("ng-element"),el.classList.add("el-button"),el.addEventListener("keydown",function(e){32===e.keyCode&&el.contentEditable&&(e.preventDefault(),insertSpace())}),el},ButtonView.prototype.setInputValue=function(value){this.domElement.innerHTML=value.replace(/&nbsp;/g," ");
},ButtonView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},ButtonView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},ButtonView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},ButtonView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},ButtonView.prototype.setFontFamily=function(value){this.setStyle(Styles.FONT_FAMILY,value)},ButtonView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},ButtonView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},ButtonView.prototype.setPaddingTop=function(value){this.setStyle(Styles.PADDING_TOP,Parse.toPx(value))},ButtonView.prototype.setPaddingRight=function(value){this.setStyle(Styles.PADDING_RIGHT,Parse.toPx(value))},ButtonView.prototype.setPaddingBottom=function(value){this.setStyle(Styles.PADDING_BOTTOM,Parse.toPx(value))},ButtonView.prototype.setPaddingLeft=function(value){this.setStyle(Styles.PADDING_LEFT,Parse.toPx(value))},ButtonView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},ButtonView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},ButtonView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},ButtonView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},ButtonView.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},ButtonView.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},ButtonView.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},ButtonView.prototype.setBackgroundImage=function(value){value?this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value)):this.backgroundColorGradient&&this.setBackgroundColorGradient(this.backgroundColorGradient)},ButtonView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value),this.backgroundColorGradient&&this.setBackgroundColorGradient(this.backgroundColorGradient)},ButtonView.prototype.setBackgroundColorGradient=function(value){var gradientColor,gradientStyles,baseColor=Color.rgbaStringToHex(value);return this.backgroundColorGradient=value,baseColor?(gradientColor=Color.illuminate(baseColor,.2),gradientStyles=["linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-o-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-moz-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-webkit-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)","-ms-linear-gradient(bottom, "+baseColor+" 0%, "+gradientColor+" 100%)"],void gradientStyles.forEach(function(styleString){this.setStyle(Styles.BACKGROUND_IMAGE,styleString)}.bind(this))):this.setStyle(Styles.BACKGROUND_IMAGE,"none")},ButtonView.prototype.setState=function(value){"inactive"===value?this.setStyle(Styles.OPACITY,.5):this.setStyle(Styles.OPACITY,1)},ButtonView.prototype.setBoxShadow=function(value){this.setStyle(Styles.BOX_SHADOW,value)},ButtonView.prototype.setShadowEnabled=function(){},ButtonView.prototype.setShadowOffsetX=function(){},ButtonView.prototype.setShadowOffsetY=function(){},ButtonView.prototype.setShadowBlur=function(){},ButtonView.prototype.setShadowColor=function(){},ButtonView.prototype.setGrayscale=function(){},ButtonView.prototype.getDomFocusableElement=function(){return this.domElement},ButtonView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"../../utils/Color.js":217,"../../utils/Parse.js":220,"./ElementView.js":153}],147:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function getDataSetZoomValueByScale(value){return value>1?"in":value<1?"out":""}function CanvasView(containerEl){this.containerDomElement=containerEl,this.overlayDomElement=null,this.gridDomElement=null,this.workbenchDomElement=null,ElementView.apply(this,_.rest(arguments))}var gridColor="rgb(255, 229, 229)";return CanvasView.prototype=Object.create(ElementView.prototype),CanvasView.constructor=CanvasView,CanvasView.prototype.setScale=function(value){this.domElement.dataset.zoom=getDataSetZoomValueByScale(value),this.domElement.style.transform="scale("+value+","+value+")",this.domElement.style["-webkit-transform"]=this.domElement.style.transform,this._setGridScale(value),value>2?this.domElement.classList.add("zoomed-more-than-twice"):this.domElement.classList.remove("zoomed-more-than-twice")},CanvasView.prototype.createDomElement=function(){this._createContaineromElement();var el=this._createCanvasDomElement();return this._createOverlayDomElement(),this._createGridDomElement(),this._setWorkbenchDomElement(),el},CanvasView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},CanvasView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},CanvasView.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},CanvasView.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},CanvasView.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},CanvasView.prototype.updateGrid=function(canvas){return canvas.gridDisplay?(this._moveGridTo(canvas.gridOnTop?this.overlayDomElement:this.domElement),this._setGridScale(canvas.scale),this.gridDomElement.style.display="block",this.gridDomElement.style.width="100%"===canvas.gridWidth?canvas.gridWidth:Parse.toPx(canvas.gridWidth),this.gridDomElement.style.borderLeftWidth=Parse.toPx(canvas.gridMargin),this.gridDomElement.style.borderRightWidth=Parse.toPx(canvas.gridMargin),this.gridDomElement.style.backgroundSize=Parse.toPx(canvas.gridColumnWidth+canvas.gridGutter)+" 100%",void(this.gridDomElement.style.backgroundImage="linear-gradient(to right, "+gridColor+" 0px, "+gridColor+" "+Parse.toPx(canvas.gridColumnWidth)+", transparent "+Parse.toPx(canvas.gridColumnWidth)+", transparent "+Parse.toPx(canvas.gridColumnWidth+canvas.gridGutter)+")")):void(this.gridDomElement.style.display="none")},CanvasView.prototype.clearCanvas=function(){var gridInCanvas=this.gridDomElement.parentNode===this.domElement;this.domElement.innerHTML="",gridInCanvas&&this._moveGridTo(this.domElement)},CanvasView.prototype.showOverlay=function(){this.overlayDomElement.style.display="block"},CanvasView.prototype.hideOverlay=function(){this.overlayDomElement.style.display="none"},CanvasView.prototype._createContaineromElement=function(){"string"==typeof this.containerDomElement&&(this.containerDomElement=document.querySelector(this.containerDomElement))},CanvasView.prototype._createCanvasDomElement=function(){var el=this.containerDomElement.querySelector(".ng-canvas");return el?el.style.zIndex="auto":(el=document.createElement("div"),el.className="ng-canvas",this.containerDomElement.appendChild(el)),el},CanvasView.prototype._createOverlayDomElement=function(){this.overlayDomElement=this.containerDomElement.querySelector(".ng-overlay"),this.overlayDomElement||(this.overlayDomElement=document.createElement("div"),this.overlayDomElement.className="ng-overlay",this.containerDomElement.appendChild(this.overlayDomElement))},CanvasView.prototype._createGridDomElement=function(){this.gridDomElement=document.createElement("div"),this.gridDomElement.className="ng-grid grid-container",this.overlayDomElement.appendChild(this.gridDomElement)},CanvasView.prototype._moveGridTo=function(container){this.gridDomElement.parentNode!==container&&(this.gridDomElement.parentNode&&this.gridDomElement.parentNode.removeChild(this.gridDomElement),container.childNodes.length>0?container.insertBefore(this.gridDomElement,container.childNodes[0]):container.appendChild(this.gridDomElement))},CanvasView.prototype._setGridScale=function(value){this.gridDomElement.parentNode===this.domElement&&(value=1),this.gridDomElement.style.transform="scale("+value+","+value+")translate3d(0, 0, 0)"},CanvasView.prototype.appendToOverlay=function(elements){var fragment=document.createDocumentFragment();elements.forEach(function(child){fragment.appendChild(child)}),this.overlayDomElement.appendChild(fragment)},CanvasView.prototype.removeNode=function(node){node.parentNode.removeChild(node)},CanvasView.prototype._setWorkbenchDomElement=function(){this.workbenchDomElement=document.getElementById("workbench")},CanvasView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153,lodash:19}],148:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),SIDES=_dereq_("../../enums/Sides"),PageModes=_dereq_("../../enums/PageModes.js");module.exports=function(){function CheckboxView(){ElementView.apply(this,arguments)}return CheckboxView.prototype=Object.create(ElementView.prototype),CheckboxView.constructor=CheckboxView,CheckboxView.prototype.createDomElement=function(){var elementId=this.createId(ElementTypes.CHECKBOX);this.inputElement=document.createElement("input"),this.inputElement.id=elementId,this.inputElement.type="checkbox",this.labelElement=document.createElement("label"),this.labelElement.id="checkbox-label-"+elementId,this.labelElement.dataset.id=this.elementId,this.pageMode===PageModes.PREVIEW&&this.labelElement.setAttribute("for",elementId);var el=document.createElement("div");return el.className="ng-element",el.classList.add("el-form-control"),el.classList.add("line-height-hack"),el.appendChild(this.inputElement),el.appendChild(this.labelElement),el},CheckboxView.prototype.getEditableElement=function(){return this.labelElement},CheckboxView.prototype.getEditableElementId=function(){return this.getEditableElement().id},CheckboxView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},CheckboxView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},CheckboxView.prototype.setInputValue=function(value){var htmlContainer=document.createElement("div");htmlContainer.innerHTML=value;var containerChild=htmlContainer.firstChild;containerChild&&"P"===containerChild.nodeName?(this.setTextAlign(containerChild.style.textAlign),this.labelElement.innerHTML=containerChild.innerHTML,containerChild.style.fontSize&&(this.labelElement.style.fontSize=containerChild.style.fontSize)):this.labelElement.innerHTML=value},CheckboxView.prototype.setChecked=function(value){this.inputElement.checked=value},CheckboxView.prototype.setDisabled=function(value){this.inputElement.disabled=value},CheckboxView.prototype.setPosition=function(value){return value===SIDES.RIGHT?void this.domElement.classList.add("switched-right"):void this.domElement.classList.remove("switched-right")},CheckboxView.prototype.getDomFocusableElement=function(){return this.inputElement},CheckboxView}()},{"../../enums/ElementTypes.js":184,"../../enums/PageModes.js":194,"../../enums/Sides":197,"../../enums/Styles.js":198,"./ElementView.js":153}],149:[function(_dereq_,module,exports){"use strict";var BoxView=_dereq_("./BoxView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function CircleView(){BoxView.apply(this,arguments)}return CircleView.prototype=Object.create(BoxView.prototype),CircleView.constructor=CircleView,CircleView.prototype.createDomElement=function(){this.textElement=document.createElement("p"),this.textElement.id=this.createId(ElementTypes.CIRCLE);var el=document.createElement("div");return el.classList.add("ng-element"),el.classList.add("el-circle"),el.classList.add("text-editor-light"),el.appendChild(this.textElement),el},CircleView}()},{"../../enums/ElementTypes.js":184,"./BoxView.js":145}],150:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function ClipartView(){ElementView.apply(this,arguments)}return ClipartView.prototype=Object.create(ElementView.prototype),ClipartView.constructor=ClipartView,ClipartView.prototype.createDomElement=function(){var el=document.createElement("IMG");return el.classList.add("ng-element"),el.classList.add("el-image-no-back"),el},ClipartView.prototype.setSrc=function(value){this.domElement.src!==value&&(this.domElement.src=value)},ClipartView}()},{"./ElementView.js":153}],151:[function(_dereq_,module,exports){"use strict";var GroupView=_dereq_("./GroupView.js");module.exports=function(){function ComponentView(){GroupView.apply(this,arguments)}return ComponentView.prototype=Object.create(GroupView.prototype),ComponentView.constructor=ComponentView,ComponentView}()},{"./GroupView.js":156}],152:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function DialogView(){ElementView.apply(this,arguments)}return DialogView.prototype=Object.create(ElementView.prototype),DialogView.constructor=DialogView,DialogView.prototype.createDomElement=function(){var containerDiv=document.createElement("div");return this.dialogElement=document.createElement("div"),containerDiv.appendChild(this.dialogElement),this.dialogElement.id=this.createId(ElementTypes.DIALOG),this.dialogElement.classList.add("ng-element"),this.dialogElement.classList.add("el-dialog"),this.closeButtonElement=document.createElement("div"),this.closeButtonElement.innerHTML="",this.closeButtonElement.className="close",this.topbarElement=document.createElement("header"),this.topbarElement.className="topbar",this.contentElement=document.createElement("div"),this.contentElement.className="content",this.bottombarElement=document.createElement("footer"),this.bottombarElement.className="bottombar",this.dialogElement.appendChild(this.topbarElement),this.dialogElement.appendChild(this.closeButtonElement),this.dialogElement.appendChild(this.contentElement),this.dialogElement.appendChild(this.bottombarElement),containerDiv},DialogView.prototype.updateTransform=function(element){this.dialogElement.style.width=Parse.toPx(element.width),this.dialogElement.style.height=Parse.toPx(element.height),this.dialogElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate("+element.angle+"deg)",this.dialogElement.style["-webkit-transform"]=this.dialogElement.style.transform},DialogView.prototype.setStyle=function(property,value){this.dialogElement.style[property]=value},DialogView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},DialogView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},DialogView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},DialogView.prototype.setBorderRadius=function(value){this.setStyle(Styles.BORDER_RADIUS,Parse.toPx(value))},DialogView.prototype.setBorderWidth=function(value){this.setStyle(Styles.BORDER_WIDTH,Parse.toPx(value))},DialogView.prototype.setTopbarDisplay=function(value){this.topbarElement.style[Styles.DISPLAY]=value},DialogView.prototype.setTopbarBackgroundColor=function(value){this.topbarElement.style[Styles.BACKGROUND_COLOR]=value},DialogView.prototype.setTopbarText=function(value){this.topbarElement.innerHTML=value},DialogView.prototype.setTopbarColor=function(value){this.topbarElement.style[Styles.COLOR]=value},DialogView.prototype.setTopbarFontWeight=function(value){this.topbarElement.style[Styles.FONT_WEIGHT]=value},DialogView.prototype.setTopbarFontStyle=function(value){this.topbarElement.style[Styles.FONT_STYLE]=value},DialogView.prototype.setTopbarFontSize=function(value){this.topbarElement.style[Styles.FONT_SIZE]=value},DialogView.prototype.setTopbarFontFamily=function(value){this.topbarElement.style[Styles.FONT_FAMILY]=value},DialogView.prototype.setTopbarTextAlign=function(value){this.topbarElement.style[Styles.TEXT_ALIGN]=value},DialogView.prototype.setContentBackgroundColor=function(value){this.contentElement.style[Styles.BACKGROUND_COLOR]=value},DialogView.prototype.setContentText=function(value){this.contentElement.innerHTML=value},DialogView.prototype.setContentColor=function(value){this.contentElement.style[Styles.COLOR]=value},DialogView.prototype.setContentFontWeight=function(value){this.contentElement.style[Styles.FONT_WEIGHT]=value},DialogView.prototype.setContentFontStyle=function(value){this.contentElement.style[Styles.FONT_STYLE]=value},DialogView.prototype.setContentFontSize=function(value){this.contentElement.style[Styles.FONT_SIZE]=value},DialogView.prototype.setContentFontFamily=function(value){this.contentElement.style[Styles.FONT_FAMILY]=value},DialogView.prototype.setContentTextAlign=function(value){this.contentElement.style[Styles.TEXT_ALIGN]=value},DialogView.prototype.setBottombarDisplay=function(value){this.bottombarElement.style[Styles.DISPLAY]=value},DialogView.prototype.setBottombarBackgroundColor=function(value){this.bottombarElement.style[Styles.BACKGROUND_COLOR]=value},DialogView.prototype.setModalOverlayDisplay=function(value){if("block"===value){var modalOverlay=document.createElement("div");modalOverlay.classList.add("modal-overlay"),this.dialogElement.parentElement.insertBefore(modalOverlay,this.dialogElement)}},DialogView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153}],153:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementsHelper=_dereq_("../helpers/ElementsHelper.js");module.exports=function(){function ElementView(elementId,pageMode){this.elementId=elementId,this.pageMode=pageMode,this.domElement=this.createDomElement(),this.setElementId(this.elementId)}return ElementView.prototype.createDomElement=function(){return null},ElementView.prototype.createId=function(elementType){return elementType+ElementsHelper.GetUniqueId(elementType)},ElementView.prototype.setElementId=function(id){this.domElement.dataset&&(this.domElement.dataset.id=id)},ElementView.prototype.destroyDomElement=function(){this.domElement.remove(),this.domElement=null},ElementView.prototype.insertNodeAfter=function(newNode,existingNode){existingNode.nextSibling?existingNode.parentNode.insertBefore(newNode,existingNode.nextSibling):existingNode.parentNode.appendChild(newNode)},ElementView.prototype.setEditing=function(value){value?(this.setTextContentEditable(value),this.domElement.classList.add("ng-editing")):(this.removeTextFocus(),this.domElement.classList.remove("ng-editing"))},ElementView.prototype.setTextContentEditable=function(value){this.getEditableElement().setAttribute("contentEditable",value)},ElementView.prototype.forEachTextParent=function(callback){var nodes=this.domElement.querySelectorAll("*");_.each(nodes,function(node){var isTextElementParent=Array.prototype.filter.call(node.childNodes,function(node){return node.nodeType===window.Node.TEXT_NODE}).length>0;isTextElementParent&&callback(node)})},ElementView.prototype.removeTextFocus=function(){this.getEditableElement().blur()},ElementView.prototype.getEditableElement=function(){return this.domElement},ElementView.prototype.getEditableElementId=function(){return this.getEditableElement().id},ElementView.prototype.updateTransform=function(element){this.domElement.style.width=Parse.toPx(element.width),this.domElement.style.height=Parse.toPx(element.height),this.domElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+")rotate("+element.angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform},ElementView.prototype.removeAllChildren=function(){for(;this.domElement.firstChild;)this.domElement.removeChild(this.domElement.firstChild)},ElementView.prototype.setFixed=function(value){value?this.domElement.classList.add("fixed-position"):this.domElement.classList.remove("fixed-position")},ElementView.prototype.setFixedOffset=function(point){this.setStyle(Styles.LEFT,Parse.toPx(point.x)),this.setStyle(Styles.TOP,Parse.toPx(point.y))},ElementView.prototype.setStateIa=function(value){this.setVisibility(value)},ElementView.prototype.setVisibility=function(value,isElementLocked){this.setStyle(Styles.DISPLAY,value?"":"none"),void 0!==isElementLocked&&(value&&isElementLocked?this.domElement.classList.add("locked"):this.domElement.classList.remove("locked"))},ElementView.prototype.setOpacity=function(value){this.setStyle(Styles.OPACITY,value)},ElementView.prototype.setStyle=function(property,value){this.domElement.style[property]=value},ElementView.prototype.setInteractive=function(value){value?this.domElement.classList.add("interactive"):this.domElement.classList.remove("interactive")},ElementView.prototype.getInputValue=function(){return null},ElementView.prototype.getDomFocusableElement=function(){return null},ElementView.prototype.getComputedStyle=function(property,element){return element=element||this.domElement,window.getComputedStyle(element).getPropertyValue(property)},ElementView.prototype._createSvgElement=function(nodeName){var el=document.createElementNS("http://www.w3.org/2000/svg",nodeName);return"svg"===nodeName&&el.setAttribute("version","1.2"),el},ElementView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"../helpers/ElementsHelper.js":97,lodash:19}],154:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js");module.exports=function(){function GeoSVGView(){ElementView.apply(this,arguments)}var SVG_NS="http://www.w3.org/2000/svg";return GeoSVGView.prototype=Object.create(ElementView.prototype),GeoSVGView.constructor=GeoSVGView,GeoSVGView.prototype.createDomElement=function(){var el=document.createElementNS(SVG_NS,"svg");return el.setAttribute("version","1.2"),el.setAttribute("preserveAspectRatio","none"),el.setAttribute("viewBox","0 0 100 100"),el.classList.add("ng-element"),el},GeoSVGView.prototype.setColor=function(value){this.domElement.setAttribute("fill",value)},GeoSVGView.prototype.setElement=function(config){this.removeAllChildren();var element=document.createElementNS(SVG_NS,config.tag);_.forEach(config.data,function(attribute){element.setAttribute(attribute.attributeName,attribute.attributeValue)}),this.domElement.appendChild(element)},GeoSVGView}()},{"./ElementView.js":153,lodash:19}],155:[function(_dereq_,module,exports){"use strict";var BoxView=_dereq_("./BoxView.js");module.exports=function(){function GlassCanvasView(){BoxView.apply(this,arguments)}return GlassCanvasView.prototype=Object.create(BoxView.prototype),GlassCanvasView.constructor=GlassCanvasView,GlassCanvasView.prototype.createDomElement=function(){this.displayElement=document.createElement("div"),this.displayElement.className="glass-display";var el=document.createElement("div");return el.className="ng-element el-glass-canvas",el.appendChild(this.displayElement),el},GlassCanvasView}()},{"./BoxView.js":145}],156:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function GroupView(){ElementView.apply(this,arguments)}return GroupView.prototype=Object.create(ElementView.prototype),GroupView.constructor=GroupView,GroupView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("el-group"),el},GroupView.prototype.setClip=function(value){value?this.domElement.classList.add("clipped"):(this.domElement.classList.remove("clipped"),this.domElement.style.width="",this.domElement.style.height="",this.domElement.style.transform="",this.domElement.style["-webkit-transform"]=this.domElement.style.transform)},GroupView.prototype.setClipScrollX=function(value){value?this.domElement.classList.add("scroll-x"):this.domElement.classList.remove("scroll-x")},GroupView.prototype.setClipScrollY=function(value){value?this.domElement.classList.add("scroll-y"):this.domElement.classList.remove("scroll-y")},GroupView.prototype.updateTransform=function(element){element.isClip&&(this.domElement.style.width=element._clippingRect.width+"px",this.domElement.style.height=element._clippingRect.height+"px",this.domElement.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate3d("+Parse.toPx(element._clippingRect.x)+","+Parse.toPx(element._clippingRect.y)+",0)rotate("+element.angle+"deg)",this.domElement.style["-webkit-transform"]=this.domElement.style.transform)},GroupView}()},{"../../utils/Parse.js":220,"./ElementView.js":153}],157:[function(_dereq_,module,exports){"use strict";var ScrollbarView=_dereq_("./ScrollbarView.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function HorizontalScrollbarView(){ScrollbarView.apply(this,arguments),this.sizeProperty=Properties.WIDTH,this.positionProperty="left"}return HorizontalScrollbarView.prototype=Object.create(ScrollbarView.prototype),HorizontalScrollbarView.constructor=HorizontalScrollbarView,HorizontalScrollbarView.prototype.createDomElement=function(){var el=ScrollbarView.prototype.createDomElement.call(this);return this.topButtonElement.style.removeProperty("width"),this.topButtonElement.style.height="100%",this.topButtonElement.classList.remove("upper"),this.topButtonElement.classList.add("left"),this.barElement.style.removeProperty("width"),this.barElement.style.height="100%",this.barElement.classList.remove("inner"),this.barElement.classList.add("horizontal-inner"),this.bottomButtonElement.style.removeProperty("width"),this.bottomButtonElement.style.height="100%",this.bottomButtonElement.classList.remove("lower"),this.bottomButtonElement.classList.add("right"),this.scrollElement.style.removeProperty("width"),this.scrollElement.style.height="100%",this.scrollElement.classList.remove("scroll"),this.scrollElement.classList.add("horizontal-scroll"),el},HorizontalScrollbarView}()},{"../../enums/Properties.js":195,"./ScrollbarView.js":171}],158:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function HotspotView(){ElementView.apply(this,arguments)}return HotspotView.prototype=Object.create(ElementView.prototype),HotspotView.constructor=HotspotView,HotspotView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-hotspot"),el},HotspotView}()},{"./ElementView.js":153}],159:[function(_dereq_,module,exports){"use strict";var SvgSymbolView=_dereq_("./SvgSymbolView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function IOS7View(){SvgSymbolView.apply(this,arguments)}return IOS7View.prototype=Object.create(SvgSymbolView.prototype),IOS7View.constructor=IOS7View,IOS7View.prototype.updateViewBox=function(width,height){this.domElement.setAttribute("viewBox","0 0 "+2*width+" "+2*height),this.setStyle(Styles.WIDTH,Parse.toPx(width)),this.setStyle(Styles.HEIGHT,Parse.toPx(height))},IOS7View}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./SvgSymbolView.js":174}],160:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function ImageView(){ElementView.apply(this,arguments)}var placeholderValue="/p/imagepixel.png",nonPlaceHolderClass="el-image-no-back";return ImageView.prototype=Object.create(ElementView.prototype),ImageView.constructor=ImageView,ImageView.prototype.createDomElement=function(){var el=document.createElement("IMG");return el.classList.add("ng-element","el-image",nonPlaceHolderClass),el},ImageView.prototype.setLoading=function(value){value?this.domElement.classList.add("ng-loading"):this.domElement.classList.remove("ng-loading")},ImageView.prototype.setSrc=function(value,cors){this.domElement.src!==value&&(value&&value.indexOf(placeholderValue)>-1?this.domElement.classList.remove(nonPlaceHolderClass):this.domElement.classList.add(nonPlaceHolderClass),cors&&(this.domElement.crossOrigin="Anonymous"),this.domElement.src=value)},ImageView.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,value)},ImageView.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,value)},ImageView.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,value)},ImageView.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,value)},ImageView}()},{"../../enums/Styles.js":198,"./ElementView.js":153}],161:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function Input2View(){ElementView.apply(this,arguments)}return Input2View.prototype=Object.create(ElementView.prototype),Input2View.constructor=Input2View,Input2View.prototype.createDomElement=function(){var el=document.createElement("input");return el.className="ng-element el-input-without-label",el},Input2View.prototype.setEditing=function(value){value?this.domElement.classList.add("ng-editing"):this.domElement.classList.remove("ng-editing"),this.domElement.focus()},Input2View.prototype.getInputValue=function(){return this.domElement.value},Input2View.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},Input2View.prototype.setBorderTopLeftRadius=function(value){this.setStyle(Styles.BORDER_TOP_LEFT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderTopRightRadius=function(value){this.setStyle(Styles.BORDER_TOP_RIGHT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderBottomRightRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_RIGHT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderBottomLeftRadius=function(value){this.setStyle(Styles.BORDER_BOTTOM_LEFT_RADIUS,Parse.toPx(value))},Input2View.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},Input2View.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},Input2View.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},Input2View.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,"url("+value+")");
},Input2View.prototype.setBackgroundSize=function(value){this.setStyle(Styles.BACKGROUND_SIZE,value)},Input2View.prototype.setBackgroundRepeat=function(value){this.setStyle(Styles.BACKGROUND_REPEAT,value)},Input2View.prototype.setBackgroundPosition=function(value){this.setStyle(Styles.BACKGROUND_POSITION,value)},Input2View.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},Input2View.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},Input2View.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},Input2View.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},Input2View.prototype.setFontFamily=function(value){this.setStyle(Styles.FONT_FAMILY,value)},Input2View.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},Input2View.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},Input2View.prototype.setPaddingTop=function(value){this.setStyle(Styles.PADDING_TOP,Parse.toPx(value))},Input2View.prototype.setPaddingRight=function(value){this.setStyle(Styles.PADDING_RIGHT,Parse.toPx(value))},Input2View.prototype.setPaddingBottom=function(value){this.setStyle(Styles.PADDING_BOTTOM,Parse.toPx(value))},Input2View.prototype.setPaddingLeft=function(value){this.setStyle(Styles.PADDING_LEFT,Parse.toPx(value))},Input2View.prototype.setInputValue=function(value){this.domElement.value=value},Input2View.prototype.setInactive=function(value){this.domElement.disabled=!!value},Input2View.prototype.setInputType=function(value){this.domElement.type=value},Input2View.prototype.setRequired=function(){},Input2View.prototype.setBoxShadow=function(value){this.setStyle(Styles.BOX_SHADOW,value)},Input2View.prototype.getDomFocusableElement=function(){return this.domElement},Input2View}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153}],162:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function InputWithLabelView(){ElementView.apply(this,arguments)}return InputWithLabelView.prototype=Object.create(ElementView.prototype),InputWithLabelView.constructor=InputWithLabelView,InputWithLabelView.prototype.createDomElement=function(){this.labelElement=document.createElement("label"),this.inputElement=document.createElement("input"),this.labelElement.style.display="inline-block",this.labelElement.style.marginRight="20px";var el=document.createElement("div");return el.className="ng-element el-input-with-label",el.appendChild(this.labelElement),el.appendChild(this.inputElement),el},InputWithLabelView.prototype.getComputedHeight=function(){var labelHeight=this.getComputedStyle("height",this.labelElement),inputHeight=this.getComputedStyle("height",this.inputElement);return Parse.toPx(parseInt(labelHeight)+parseInt(inputHeight))},InputWithLabelView.prototype.setBorderTopLeftRadius=function(value){this.inputElement.style.borderTopLeftRadius=Parse.toPx(value)},InputWithLabelView.prototype.setBorderTopRightRadius=function(value){this.inputElement.style.borderTopRightRadius=Parse.toPx(value)},InputWithLabelView.prototype.setBorderBottomRightRadius=function(value){this.inputElement.style.borderBottomRightRadius=Parse.toPx(value)},InputWithLabelView.prototype.setBorderBottomLeftRadius=function(value){this.inputElement.style.borderBottomLeftRadius=Parse.toPx(value)},InputWithLabelView.prototype.setColor=function(value){this.labelElement.style.color=value,this.inputElement.style.color=value},InputWithLabelView.prototype.setFontSize=function(value){this.labelElement.style.fontSize=Parse.toPx(value),this.inputElement.style.fontSize=Parse.toPx(value)},InputWithLabelView.prototype.setFontWeight=function(value){this.labelElement.style.fontWeight=value,this.inputElement.style.fontWeight=value},InputWithLabelView.prototype.setFontStyle=function(value){this.labelElement.style.fontStyle=value,this.inputElement.style.fontStyle=value},InputWithLabelView.prototype.setFontFamily=function(value){this.labelElement.style.fontFamily=value,this.inputElement.style.fontFamily=value},InputWithLabelView.prototype.setTextDecoration=function(value){this.labelElement.style.textDecoration=value},InputWithLabelView.prototype.setTextAlign=function(value){this.labelElement.style.textAlign=value},InputWithLabelView.prototype.setLabelPosition=function(value){"top"===value?this.setLabelPositionTop():this.setLabelPositionLeft()},InputWithLabelView.prototype.setLabelPositionLeft=function(){this.labelElement.style.display="inline-block",this.labelElement.style.marginRight="20px"},InputWithLabelView.prototype.setLabelPositionTop=function(){this.labelElement.style.display="block",this.labelElement.style.marginRight="0px"},InputWithLabelView.prototype.setLabelText=function(value){this.labelElement.textContent=value},InputWithLabelView.prototype.setInputValue=function(value){this.inputElement.value=value},InputWithLabelView.prototype.setLabelWidth=function(value){this.labelElement.style.width=Parse.toPx(value)},InputWithLabelView.prototype.setInputWidth=function(value){this.inputElement.style.width=Parse.toPx(value)},InputWithLabelView.prototype.setInactive=function(value){this.inputElement.disabled=!!value},InputWithLabelView.prototype.setInputType=function(value){this.inputElement.type=value},InputWithLabelView.prototype.setRequired=function(){},InputWithLabelView.prototype.getDomFocusableElement=function(){return this.inputElement},InputWithLabelView}()},{"../../utils/Parse.js":220,"./ElementView.js":153}],163:[function(_dereq_,module,exports){"use strict";var TextElementView=_dereq_("./TextElementView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function LabelView(){TextElementView.apply(this,arguments)}return LabelView.prototype=Object.create(TextElementView.prototype),LabelView.constructor=LabelView,LabelView.prototype.createDomElement=function(){var el=TextElementView.prototype.createDomElement.call(this);return el.id=this.createId(ElementTypes.LABEL),el},LabelView}()},{"../../enums/ElementTypes.js":184,"./TextElementView.js":178}],164:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js");module.exports=function(){function LineView(){ElementView.apply(this,arguments)}return LineView.prototype=Object.create(ElementView.prototype),LineView.constructor=LineView,LineView.prototype.createDomElement=function(){var el=this._createSvgElement("svg");return el.classList.add("ng-element"),this.lineElement=this._createSvgElement("line"),this.lineElement.setAttribute("x1","0"),this.lineElement.setAttribute("y1","5"),this.lineElement.setAttribute("x2","300"),this.lineElement.setAttribute("y2","5"),this.lineElement.setAttribute("stroke","black"),this.lineElement.setAttribute("stroke-width",10),el.appendChild(this.lineElement),el},LineView.prototype.updateLineSvg=function(element){var dasharray="",linecap="",points={x1:0,x2:element.width,y1:element.height/2,y2:element.height/2};switch(element.isVertical()&&(points.x1=element.width/2,points.x2=element.width/2,points.y1=0,points.y2=element.height),this.lineElement.setAttribute("x1",points.x1),this.lineElement.setAttribute("x2",points.x2),this.lineElement.setAttribute("y1",points.y1),this.lineElement.setAttribute("y2",points.y2),this.lineElement.setAttribute("stroke-width",element.stroke),element.lineType){case"dotted":linecap="round",dasharray="0.5,"+element.stroke;break;case"dashed":dasharray=3*element.stroke+","+3*element.stroke}this.lineElement.setAttribute("stroke-linecap",linecap),this.lineElement.setAttribute("stroke-dasharray",dasharray)},LineView.prototype.setStroke=function(value){this.lineElement.setAttribute("stroke",value)},LineView}()},{"./ElementView.js":153}],165:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),_=_dereq_("lodash");module.exports=function(){function LinkListView(){ElementView.apply(this,arguments)}return LinkListView.prototype=Object.create(ElementView.prototype),LinkListView.constructor=LinkListView,LinkListView.prototype.createDomElement=function(){var el=document.createElement("div");return el.className="ng-element el-link-list",this.headerElement=document.createElement("div"),this.headerElement.className="header",this.listElement=document.createElement("ul"),el.appendChild(this.headerElement),el.appendChild(this.listElement),el},LinkListView.prototype.setHeaderDisplay=function(value){this.headerElement.style.display=value?"block":"none"},LinkListView.prototype.setHeaderText=function(value){this.headerElement.innerHTML=value},LinkListView.prototype.setInputValue=function(value){this.listElement.innerHTML="",value.forEach(function(record){var li=document.createElement("li"),anchor=document.createElement("a");anchor.href="#",anchor.innerHTML=record.text,anchor.addEventListener("click",function(e){e.preventDefault()}),record.page_id&&(anchor.dataset.pageId=record.page_id),li.appendChild(anchor),this.listElement.appendChild(li)}.bind(this))},LinkListView.prototype.setColor=function(value){var links=this.domElement.getElementsByTagName("a");Array.prototype.forEach.call(links,function(link){link.style[Styles.COLOR]=value})},LinkListView.prototype.setFontSize=function(value){this.listElement.style[Styles.FONT_SIZE]=value},LinkListView.prototype.setFontWeight=function(value){this.listElement.style[Styles.FONT_WEIGHT]=value},LinkListView.prototype.setFontStyle=function(value){this.listElement.style[Styles.FONT_STYLE]=value},LinkListView.prototype.setFontFamily=function(value){this.listElement.style[Styles.FONT_FAMILY]=value},LinkListView.prototype.setTextDecoration=function(value){this.listElement.style[Styles.TEXT_DECORATION]=value},LinkListView.prototype.setTextAlign=function(value){this.listElement.style[Styles.TEXT_ALIGN]=value},LinkListView.prototype.setHeaderColor=function(value){this.headerElement.style.color=value},LinkListView.prototype.setHeaderFontSize=function(value){this.headerElement.style.fontSize=Parse.toPx(value)},LinkListView.prototype.setHeaderFontWeight=function(value){this.headerElement.style.fontWeight=value},LinkListView.prototype.setHeaderFontStyle=function(value){this.headerElement.style.fontStyle=value},LinkListView.prototype.setHeaderFontFamily=function(value){this.headerElement.style.fontFamily=value},LinkListView.prototype.setHeaderTextDecoration=function(value){this.headerElement.style.textDecoration=value},LinkListView.prototype.setHeaderTextAlign=function(value){this.headerElement.style.textAlign=value},LinkListView.prototype.getListHeight=function(){var computed=window.getComputedStyle(this.listElement),height=parseInt(computed.getPropertyValue("height"));return height},LinkListView.prototype.getListWidth=function(){var width=0,header=parseInt(window.getComputedStyle(this.headerElement).getPropertyValue("width")),items=this.listElement.querySelectorAll("a");return _.each(items,function(item){var itemWidth=item.offsetWidth;width=itemWidth>width?itemWidth:width}),!header||width>header?width:header},LinkListView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153,lodash:19}],166:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function LinkView(){ElementView.apply(this,arguments)}return LinkView.prototype=Object.create(ElementView.prototype),LinkView.constructor=LinkView,LinkView.prototype.createDomElement=function(){var el=document.createElement("a");return el.href="#",el.id=this.createId(ElementTypes.LINK),el.className="ng-element el-link",el.style.overflow="hidden",el},LinkView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},LinkView.prototype.setInputValue=function(value){var htmlContainer=document.createElement("div");htmlContainer.innerHTML=value;var containerChild=htmlContainer.firstChild;containerChild&&"P"===containerChild.nodeName?(this.setTextAlign(containerChild.style.textAlign),this.domElement.innerHTML=containerChild.innerHTML,containerChild.style.fontSize&&(this.domElement.style.fontSize=containerChild.style.fontSize)):this.domElement.innerHTML=value},LinkView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"./ElementView.js":153}],167:[function(_dereq_,module,exports){"use strict";var SvgSymbolView=_dereq_("./SvgSymbolView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function MobileSymbolView(){SvgSymbolView.apply(this,arguments)}return MobileSymbolView.prototype=Object.create(SvgSymbolView.prototype),MobileSymbolView.constructor=MobileSymbolView,MobileSymbolView.prototype.createDomElement=function(){var el=document.createElement("img");return el.classList.add("ng-element"),el},MobileSymbolView.prototype.setData=function(){throw Error("data property is not supported on MobileSymbolView")},MobileSymbolView.prototype.setSvgSrc=function(value){"string"==typeof value&&value&&(this.domElement.src=value)},MobileSymbolView.prototype.setCssClass=function(value){value&&this.domElement.classList.add(value)},MobileSymbolView.prototype.updateViewBox=function(width,height){this.setStyle(Styles.WIDTH,Parse.toPx(width)),this.setStyle(Styles.HEIGHT,Parse.toPx(height))},MobileSymbolView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./SvgSymbolView.js":174}],168:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),TweenLite=_dereq_("gsap"),GroupView=_dereq_("./GroupView.js"),AnimationsHelper=_dereq_("../../interactions/AnimationsHelper.js"),MultistateAnimations=_dereq_("../../enums/MultistateAnimations.js"),Parse=_dereq_("../../utils/Parse.js"),PageModes=_dereq_("../../enums/PageModes.js");module.exports=function(){function MultistateView(){this.stateContainer=null,this.nextStateContainers=[],GroupView.apply(this,arguments)}return MultistateView.prototype=Object.create(GroupView.prototype),MultistateView.constructor=MultistateView,MultistateView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("el-group"),el.classList.add("el-multistate"),this.stateContainer=document.createElement("DIV"),el.appendChild(this.stateContainer),this.stateContainer.classList.add("el-group"),this.stateContainer.classList.add("ng-state-container"),this.stateContainer.style.perspective="1000px",this.stateContainer.style.position="absolute",this.stateContainer.style.transformOrigin="0 0 0",this.state=document.createElement("DIV"),this.stateContainer.appendChild(this.state),this.state.classList.add("ng-state"),this.pageMode===PageModes.PREVIEW&&(this.state.style.backfaceVisibility="hidden"),el},MultistateView.prototype.updateTransform=function(element){element.Page.isPreviewMode()&&(this.state.style.width=Parse.toPx(element.width),this.state.style.height=Parse.toPx(element.height),this.stateContainer.style.width=Parse.toPx(element.width),this.stateContainer.style.height=Parse.toPx(element.height),element.isClip||(this.stateContainer.style.transform=element._getGroupRotation()+element._getGroupTranslates()+"translate3d("+Parse.toPx(element.x)+","+Parse.toPx(element.y)+",0)rotate("+element.angle+"deg)",_.forEach(this.nextStateContainers,function(container){var stateId=container.dataset.stateId,bb=element._getBoundingBoxForState(parseInt(stateId));container.style.width=Parse.toPx(bb.width),container.style.height=Parse.toPx(bb.height),container.style.transform="translate3d("+Parse.toPx(bb.x)+","+Parse.toPx(bb.y)+",0)rotate("+bb.angle+"deg)",container.style["-webkit-transform"]=container.style.transform})),this.stateContainer.style["-webkit-transform"]=this.stateContainer.style.transform),GroupView.prototype.updateTransform.call(this,element)},MultistateView.prototype.animateChangeState=function(container,animation,reversed){return animation&&animation.show===MultistateAnimations.FADE?this._animateFade(container,animation):animation&&[MultistateAnimations.FLIP_X,MultistateAnimations.FLIP_Y].indexOf(animation.show)>-1?this._animateFlip(container,animation,reversed):animation&&[MultistateAnimations.SLIDE_LEFT,MultistateAnimations.SLIDE_RIGHT,MultistateAnimations.SLIDE_UP,MultistateAnimations.SLIDE_DOWN].indexOf(animation.show)>-1?this._animateSlide(container,animation,reversed):(this._onComplete(container),Promise.resolve())},MultistateView.prototype.resetAnimation=function(){TweenLite.killTweensOf(this.state),this.state.style.opacity=1,this.state.style.transform="",this.state.style["-webkit-transform"]=this.state.style.transform},MultistateView.prototype.createNextStateContainer=function(stateId,bb,clipped){var nextStateContainer=document.createElement("DIV");nextStateContainer.classList.add("el-group"),nextStateContainer.classList.add("ng-state-container"),nextStateContainer.style.perspective="1000px",nextStateContainer.style.position="absolute",nextStateContainer.style.transformOrigin="0 0 0",nextStateContainer.setAttribute("data-state-id",stateId),clipped||(nextStateContainer.style.transform="translate3d("+Parse.toPx(bb.x)+","+Parse.toPx(bb.y)+",0)rotate("+bb.angle+"deg)",nextStateContainer.style["-webkit-transform"]=nextStateContainer.style.transform);var state=document.createElement("DIV");return nextStateContainer.appendChild(state),state.classList.add("ng-state"),state.style.backfaceVisibility="hidden",state.style.width=Parse.toPx(bb.width),state.style.height=Parse.toPx(bb.height),this.domElement.appendChild(nextStateContainer),this.nextStateContainers.push(nextStateContainer),state},MultistateView.prototype._animateSlide=function(container,animation,reversed){return new Promise(function(resolve){var reverser=reversed?-1:1,transform=[MultistateAnimations.SLIDE_LEFT,MultistateAnimations.SLIDE_RIGHT].indexOf(animation.show)>-1?"x":"y",direction=[MultistateAnimations.SLIDE_LEFT,MultistateAnimations.SLIDE_UP].indexOf(animation.show)>-1?1:-1,value1=("x"===transform?parseInt(container.style.width):parseInt(container.style.height))||0,value2=("x"===transform?parseInt(this.state.style.width):parseInt(this.state.style.height))||0;container.parentNode.style.overflow="hidden",this.state.parentNode.style.overflow="hidden",animation=AnimationsHelper.ParseAnimation(animation),TweenLite.to(container,0,_.set({},transform,value1*reverser*direction)),TweenLite.to(this.state,0,_.set({},transform,0)),TweenLite.to(container,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:this._onComplete.bind(this,container)},transform,0)),TweenLite.to(this.state,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:function(container){TweenLite.to(container,0,_.set({},transform,0)),container.parentNode.style.overflow="",resolve()}.bind(null,this.state)},transform,-value2*reverser*direction))}.bind(this))},MultistateView.prototype._animateFlip=function(container,animation,reversed){return new Promise(function(resolve){var reverser=reversed?-1:1,transform=animation.show===MultistateAnimations.FLIP_X?"rotationX":"rotationY";animation=AnimationsHelper.ParseAnimation(animation),TweenLite.to(container,0,_.set({},transform,-180*reverser)),TweenLite.to(this.state,0,_.set({},transform,0)),TweenLite.to(container,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:this._onComplete.bind(this,container)},transform,0)),TweenLite.to(this.state,animation.duration/1e3,_.set({ease:AnimationsHelper.GetEasing(animation),onComplete:function(container){TweenLite.to(container,0,_.set({},transform,0)),resolve()}.bind(null,this.state)},transform,180*reverser))}.bind(this))},MultistateView.prototype._animateFade=function(container,animation){return new Promise(function(resolve){animation=AnimationsHelper.ParseAnimation(animation),container.style.opacity=0,TweenLite.to(container,animation.duration/1e3,{opacity:1,ease:AnimationsHelper.GetEasing(animation),onComplete:this._onComplete.bind(this,container)}),TweenLite.to(this.state,animation.duration/1e3,{opacity:0,ease:AnimationsHelper.GetEasing(animation),onComplete:function(container){container.style.opacity=1,resolve()}.bind(null,this.state)})}.bind(this))},MultistateView.prototype._onComplete=function(container){this.domElement.removeChild(container.parentNode),this.nextStateContainers=_.without(this.nextStateContainers,container.parentNode)},MultistateView}()},{"../../enums/MultistateAnimations.js":191,"../../enums/PageModes.js":194,"../../interactions/AnimationsHelper.js":204,"../../utils/Parse.js":220,"./GroupView.js":156,gsap:1,lodash:19}],169:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function NavigationView(){ElementView.apply(this,arguments)}return NavigationView.prototype=Object.create(ElementView.prototype),NavigationView.constructor=NavigationView,NavigationView.prototype.createDomElement=function(){var el=document.createElement("ul");return el.id=this.createId(ElementTypes.NAVIGATION),el.classList.add("ng-element"),el.classList.add("el-navigation"),el},NavigationView.prototype.setOrientation=function(value){this.domElement.classList.remove("horizontal","vertical"),this.domElement.classList.add(value)},NavigationView.prototype.setInputValue=function(value){for(;this.domElement.firstChild;)this.domElement.removeChild(this.domElement.firstChild);var parents=[this.domElement];value.forEach(function(item){if(item.text){var depth=0,listElement=document.createElement("li"),span=document.createElement("span");listElement.appendChild(span),item.page_id&&(listElement.dataset.pageId=item.page_id);var indentationMatch=item.text.match(/^\s*(\/+)/),activeMatch=item.text.match(/^[\s\/]*\*/);if(indentationMatch?(depth=indentationMatch[0].trim().length,listElement.classList.add("active"),span.innerHTML=item.text.replace(/\/+/,"")):activeMatch?(listElement.classList.add("active"),span.innerHTML=item.text.replace("*","")):span.innerHTML=item.text,parents.length-1===depth)parents[parents.length-1].appendChild(listElement);else if(parents.length-1<depth){var parentElement=document.createElement("ul");parentElement.appendChild(listElement),parents[parents.length-1].lastChild.appendChild(parentElement),parents.push(parentElement)}else{for(;parents.length-1>depth;)parents.pop();parents[parents.length-1].appendChild(listElement)}}})},NavigationView.prototype.setElementBackgroundColor=function(element,value){element.style[Styles.BACKGROUND_COLOR]=value},NavigationView.prototype.setBackgroundColor=function(value){var items=this.domElement.getElementsByTagName("li");Array.prototype.forEach.call(items,function(item){item.classList.contains("active")||this.setElementBackgroundColor(item,value)},this)},NavigationView.prototype.setActiveBackgroundColor=function(value){var items=this.domElement.getElementsByClassName("active");Array.prototype.forEach.call(items,function(item){this.setElementBackgroundColor(item,value)},this)},NavigationView.prototype.setElementBorder=function(width,color){var boxShadowString="inset 0 0 0 "+width+"px "+color,items=this.domElement.getElementsByTagName("li");Array.prototype.forEach.call(items,function(item){item.style[Styles.BOX_SHADOW]=boxShadowString})},NavigationView.prototype.setColor=function(value){this.domElement.style[Styles.COLOR]=value},NavigationView.prototype.setFontSize=function(value){this.domElement.style[Styles.FONT_SIZE]=value},NavigationView.prototype.setFontWeight=function(value){this.domElement.style[Styles.FONT_WEIGHT]=value},NavigationView.prototype.setFontStyle=function(value){this.domElement.style[Styles.FONT_STYLE]=value},NavigationView.prototype.setFontFamily=function(value){this.domElement.style[Styles.FONT_FAMILY]=value},NavigationView.prototype.setTextDecoration=function(value){this.domElement.style[Styles.TEXT_DECORATION]=value},NavigationView.prototype.setTextAlign=function(value){this.domElement.style[Styles.TEXT_ALIGN]=value},NavigationView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"./ElementView.js":153}],170:[function(_dereq_,module,exports){"use strict";var CheckboxView=_dereq_("./CheckboxView.js");module.exports=function(){function RadioView(){CheckboxView.apply(this,arguments)}return RadioView.prototype=Object.create(CheckboxView.prototype),RadioView.constructor=RadioView,RadioView.prototype.createDomElement=function(){var el=CheckboxView.prototype.createDomElement.call(this);return this.inputElement.type="radio",el},RadioView.prototype.setFormGroupName=function(value){this.inputElement.name=value},RadioView}()},{"./CheckboxView.js":148}],171:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js"),Properties=_dereq_("../../enums/Properties.js");module.exports=function(){function ScrollbarView(){ElementView.apply(this,arguments),this.sizeProperty=Properties.HEIGHT,this.positionProperty="top"}var BUTTONS_SIZE=18,SCROLL_SIZE=.33;return ScrollbarView.prototype=Object.create(ElementView.prototype),ScrollbarView.constructor=ScrollbarView,ScrollbarView.prototype.createDomElement=function(){var el=document.createElement("div");return el.classList.add("ng-element"),el.classList.add("el-scrollbar"),this.topButtonElement=document.createElement("div"),this.topButtonElement.className="el-scroll upper",this.topButtonElement.style.width="100%",this.scrollElement=document.createElement("div"),this.scrollElement.className="el-scroll scroll",this.barElement=document.createElement("div"),this.barElement.className="el-scroll inner",this.barElement.style.width="100%",this.barElement.appendChild(this.scrollElement),this.bottomButtonElement=document.createElement("div"),this.bottomButtonElement.className="el-scroll lower",this.bottomButtonElement.style.width="100%",el.appendChild(this.topButtonElement),el.appendChild(this.barElement),el.appendChild(this.bottomButtonElement),el},ScrollbarView.prototype.updateTransform=function(element){ElementView.prototype.updateTransform.call(this,element),this.barElement.style[this.sizeProperty]=Parse.toPx(this._calculateBarSize(element[this.sizeProperty])),this.setScrollPosition(element[Properties.SCROLL_POSITION],element[this.sizeProperty])},ScrollbarView.prototype.setScrollPosition=function(value,elementSize){var position=0;value>0&&(position=this._calculateBarSize(elementSize)*(1-SCROLL_SIZE)*(value/100)),this.scrollElement.style[this.positionProperty]=Parse.toPx(position)},ScrollbarView.prototype._calculateBarSize=function(elementSize){return elementSize-2*BUTTONS_SIZE},ScrollbarView}()},{"../../enums/Properties.js":195,"../../utils/Parse.js":220,"./ElementView.js":153}],172:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function SelectlistView(){ElementView.apply(this,arguments)}return SelectlistView.prototype=Object.create(ElementView.prototype),SelectlistView.constructor=SelectlistView,SelectlistView.prototype.createDomElement=function(){this.selectElement=document.createElement("select");var wrapperElement=document.createElement("div");return wrapperElement.className="ng-element el-select-list-wrapper",this.selectElement.className="ng-element el-select-list",wrapperElement.appendChild(this.selectElement),wrapperElement},SelectlistView.prototype.setStyle=function(property,value){[Styles.DISPLAY,Styles.OPACITY].indexOf(property)>-1?this.domElement.style[property]=value:this.selectElement.style[property]=value},SelectlistView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},SelectlistView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},SelectlistView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},SelectlistView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},SelectlistView.prototype.setFontFamily=function(value){this.setStyle(Styles.FONT_FAMILY,value)},SelectlistView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},SelectlistView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},SelectlistView.prototype.setMultiple=function(value){var selectWrapper=this.selectElement.parentNode;value?(selectWrapper.classList.add("multiple"),this.selectElement.multiple="multiple"):(selectWrapper.classList.remove("multiple"),this.selectElement.removeAttribute("multiple"))},SelectlistView.prototype.setOptions=function(value){var fragment=document.createDocumentFragment();_.forEach(value,function(option){var optionElement=document.createElement("option");optionElement.value=option.id,optionElement.textContent=option.text,fragment.appendChild(optionElement)}),this.selectElement.innerHTML="",this.selectElement.appendChild(fragment)},SelectlistView.prototype.getDomFocusableElement=function(){return this.selectElement},SelectlistView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153,lodash:19}],173:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),SvgSymbolView=_dereq_("./SvgSymbolView.js");module.exports=function(){function SvgIconView(){SvgSymbolView.apply(this,arguments)}return SvgIconView.prototype=Object.create(SvgSymbolView.prototype),SvgIconView.constructor=SvgIconView,SvgIconView.prototype.setColor=function(value){SvgSymbolView.prototype.setColor.call(this,value),_.forEach(["circle","line","ellipse","polyline","path","polygon","rect"],function(nodeName){_.forEach(this.domElement.getElementsByTagName(nodeName),function(node){node.setAttribute("fill",value)})}.bind(this))},SvgIconView}()},{"./SvgSymbolView.js":174,lodash:19}],174:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js");module.exports=function(){function SvgSymbolView(){ElementView.apply(this,arguments)}return SvgSymbolView.prototype=Object.create(ElementView.prototype),SvgSymbolView.constructor=SvgSymbolView,SvgSymbolView.prototype.createDomElement=function(){var el=this._createSvgElement("svg");return el.setAttribute("preserveAspectRatio","none"),el.setAttribute("viewBox","0 0 100 100"),el.classList.add("ng-element"),el},SvgSymbolView.prototype.setData=function(value){if(value){var container=document.createElement("div");container.innerHTML=value;var svg=container.querySelector("svg");this.removeAllChildren(),_.forEach(_.take(svg.children,svg.childElementCount),function(child){this.domElement.appendChild(child)}.bind(this))}},SvgSymbolView.prototype.setColor=function(value){this.domElement.setAttribute("fill",value)},SvgSymbolView.prototype.updateViewBox=function(width,height,ratio){var size=Math.max(width,height),x1=ratio<1?(height*ratio-height)/2:0,y1=ratio>1?(width/ratio-width)/2:0;this.domElement.setAttribute("viewBox",x1+" "+y1+" "+size+" "+size)},SvgSymbolView}()},{"./ElementView.js":153,lodash:19}],175:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Orientations=_dereq_("../../enums/Orientations"),Sides=_dereq_("../../enums/Sides"),Properties=_dereq_("../../enums/Properties"),Styles=_dereq_("../../enums/Styles"),Parse=_dereq_("../../utils/Parse"),InteractionsHelper=_dereq_("../../interactions/InteractionsHelper.js"),InteractionActions=_dereq_("../../enums/InteractionActions.js");module.exports=function(){function formatRadius(r1,r2,r3,r4){return Parse.toPx(r1)+" "+Parse.toPx(r2)+" "+Parse.toPx(r3)+" "+Parse.toPx(r4)}function TabView(){ElementView.apply(this,arguments)}return TabView.prototype=Object.create(ElementView.prototype),TabView.constructor=TabView,
TabView.prototype.createDomElement=function(){return this.el=document.createElement("DIV"),this.el.classList.add("ng-element"),this.el.classList.add("el-tab"),this.el},TabView.prototype.renderTabs=function(data){this.el.innerHTML="",this.listEl=document.createElement("ul"),_.forEach(data.inputValue,function(tab){if(!_.isEmpty(tab.text)){var tabNode=document.createElement("li"),activityClass=/^\s*\*/.test(tab.text)?"active":"inactive",link=document.createElement("a");tab.page_id&&(link.dataset.pageId=tab.page_id),tabNode.classList.add("element",activityClass),link.innerHTML=tab.text.replace(/^\*(.*)/,"$1"),tabNode.appendChild(link),this.listEl.appendChild(tabNode)}}.bind(this)),this.addContainerStyles(data),this.addTabStyles(data),this.setTabSizes(data),this.el.appendChild(this.listEl),data.Page.isPreviewMode()&&this.addLinkEvent(data)},TabView.prototype.addLinkEvent=function(element){this.el.addEventListener("mousedown",this.mouseDownHandler.bind(this,element))},TabView.prototype.mouseDownHandler=function(element,e){e.target.dataset.pageId&&InteractionsHelper.ApplyInteractionEffect(element,{action:InteractionActions.LINK_PAGE,value:{id_page:e.target.dataset.pageId,target:!1}})},TabView.prototype.addContainerStyles=function(data){var properties=[Properties.WIDTH,Properties.HEIGHT,Properties.FONT_SIZE,Properties.FONT_FAMILY,Properties.TEXT_ALIGN,Properties.FONT_WEIGHT,Properties.FONT_STYLE,Properties.TEXT_DECORATION,Properties.COLOR];_.forEach(properties,function(property){this.listEl.style[property]=data[property]}.bind(this))},TabView.prototype.addTabStyles=function(data){var tabsAll=this.listEl.querySelectorAll("li"),tabsActive=this.listEl.querySelectorAll("li.active"),tabsInactive=this.listEl.querySelectorAll("li.inactive"),horizontalBorder=data.typeHorizontal===Sides.BOTTOM?Styles.BORDER_TOP_WIDTH:Styles.BORDER_BOTTOM_WIDTH,verticalBorder=data.typeVertical===Sides.RIGHT?Styles.BORDER_LEFT_WIDTH:Styles.BORDER_RIGHT_WIDTH,borderToReset=data.tabType===Orientations.HORIZONTAL?horizontalBorder:verticalBorder,propertiesMap={borderStyle:data.elementBorderStyle,borderWidth:Parse.toPx(data.elementBorderWidth),borderRadius:this.calculateBorderRadius(data),borderColor:data.elementBorderColor,textDecoration:data.textDecoration,"float":data.tabType===Orientations.HORIZONTAL?"left":"none"};_.forEach(tabsAll,function(tab){_.forEach(propertiesMap,function(value,property){tab.style[property]=value})}),_.forEach(tabsActive,function(tab){tab.style.backgroundColor=data.activeBackgroundColor,tab.style[borderToReset]=0}),_.forEach(tabsInactive,function(tab){tab.style.backgroundColor=data.inactiveBackgroundColor})},TabView.prototype.setTabSizes=function(data){if(this.listEl){var i,tabsAll=this.listEl.querySelectorAll("li"),tabsActive=this.listEl.querySelectorAll("li.active"),width=data.width,elWidth=Math.floor(width/tabsAll.length),height=data.height,elHeight=Math.floor(height/tabsAll.length);if(data.tabType===Orientations.VERTICAL){for(_.forEach(tabsAll,function(tab){tab.style.lineHeight=Parse.toPx(elHeight),tab.style.height=Parse.toPx(elHeight),tab.style.width=Parse.toPx(width)}),i=0;i<height%tabsAll.length;i++)tabsAll[i].style.height=Parse.toPx(elHeight+1);return void _.forEach(tabsActive,function(tab){tab.style.width=Parse.toPx(width+1),tab.style.marginLeft=data.typeVertical===Sides.RIGHT?"-1px":"0"})}for(_.forEach(tabsAll,function(tab){tab.style.lineHeight=Parse.toPx(height),tab.style.height=Parse.toPx(height),tab.style.width=Parse.toPx(elWidth)}),i=0;i<width%tabsAll.length;i++)tabsAll[i].style.width=Parse.toPx(elWidth+1);_.forEach(tabsActive,function(tab){tab.style.height=Parse.toPx(height+1),tab.style.marginTop=data.typeHorizontal===Sides.BOTTOM?"-1px":"0"})}},TabView.prototype.calculateBorderRadius=function(data){var radius,radiusValue=data.elementBorderRadius;return data.tabType===Orientations.HORIZONTAL&&data.typeHorizontal===Sides.BOTTOM?radius=formatRadius(0,0,radiusValue,radiusValue):data.tabType===Orientations.HORIZONTAL?radius=formatRadius(radiusValue,radiusValue,0,0):data.tabType===Orientations.VERTICAL&&data.typeVertical===Sides.RIGHT?radius=formatRadius(0,radiusValue,radiusValue,0):data.tabType===Orientations.VERTICAL&&(radius=formatRadius(radiusValue,0,0,radiusValue)),radius},TabView}()},{"../../enums/InteractionActions.js":187,"../../enums/Orientations":193,"../../enums/Properties":195,"../../enums/Sides":197,"../../enums/Styles":198,"../../interactions/InteractionsHelper.js":208,"../../utils/Parse":220,"./ElementView.js":153,lodash:19}],176:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),TableHelper=_dereq_("../helpers/TableHelper.js");module.exports=function(){function TableView(){ElementView.apply(this,arguments)}return TableView.prototype=Object.create(ElementView.prototype),TableView.constructor=TableView,TableView.prototype.createDomElement=function(){var el=document.createElement("div");return el.className="ng-element el-table",this.tableElement=document.createElement("table"),el.appendChild(this.tableElement),el},TableView.prototype.getCell=function(coordinates){return this.getTableElement().querySelector("td[data-coords="+coordinates+"]")},TableView.prototype.getCellValue=function(coordinates){return this.getCell(coordinates).innerHTML},TableView.prototype.getTableElement=function(){return this.tableElement},TableView.prototype.setCurrentlyEditable=function(cell){cell?(this.currentlyEditable=cell,this.setCellEditable(this.getCell(this.currentlyEditable))):this.currentlyEditable&&(this.closeCellEditable(this.getCell(this.currentlyEditable)),this.currentlyEditable=null)},TableView.prototype.getEditableElement=function(){return this.currentlyEditable},TableView.prototype.setCellEditable=function(cellEl){this.insertTextArea(cellEl)},TableView.prototype.closeCellEditable=function(cellEl){var area=this._getTextAreaElement(cellEl),text=area.value;cellEl.removeChild(area),cellEl.innerHTML=text.replace(/\r?\n/g,"<br/>")},TableView.prototype.removeTextArea=function(cellEl){var area=this._getTextAreaElement(cellEl);cellEl.removeChild(area)},TableView.prototype.insertTextArea=function(cellEl){var textarea=document.createElement("textarea");textarea.value=cellEl.textContent,textarea.rows="1",cellEl.innerHTML="";var styles={cursor:"text",width:"100%","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-xbox","box-sizing":"border-box",margin:0,background:"transparent",border:"none","vertical-align":"inherit",resize:"none",overflow:"hidden","font-size":"inherit","font-family":"inherit","font-style":"inherit","font-weight":"inherit",color:"inherit","line-height":"inherit","text-align":"inherit"};for(var i in styles)styles.hasOwnProperty(i)&&(textarea.style[i]=styles[i]);textarea.addEventListener("change",this.resizeTextArea.bind(this,cellEl),!1),textarea.addEventListener("cut",this.delayedResizeTextArea.bind(this,cellEl),!1),textarea.addEventListener("paste",this.delayedResizeTextArea.bind(this,cellEl),!1),textarea.addEventListener("keydown",this.delayedResizeTextArea.bind(this,cellEl),!1),cellEl.appendChild(textarea),setTimeout(function(){textarea.focus(),textarea.selectRange(0,textarea.value.length)},200),this.resizeTextArea(cellEl)},TableView.prototype.setStyle=function(property,value){this.getTableElement().style[property]=value},TableView.prototype.setColor=function(value){this.setStyle(Styles.COLOR,value)},TableView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},TableView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},TableView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},TableView.prototype.setFontFamily=function(value){this.setStyle(Styles.FONT_FAMILY,value)},TableView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},TableView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},TableView.prototype.setBorderWidth=function(value){this.setStyle(Styles.BORDER_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderColor=function(value){this.setStyle(Styles.BORDER_COLOR,value)},TableView.prototype.setBorderStyle=function(value){this.setStyle(Styles.BORDER_STYLE,value)},TableView.prototype.setBorderTopWidth=function(value){this.setStyle(Styles.BORDER_TOP_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderBottomWidth=function(value){this.setStyle(Styles.BORDER_BOTTOM_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderLeftWidth=function(value){this.setStyle(Styles.BORDER_LEFT_WIDTH,Parse.toPx(value))},TableView.prototype.setBorderRightWidth=function(value){this.setStyle(Styles.BORDER_RIGHT_WIDTH,Parse.toPx(value))},TableView.prototype.setBackgroundColor=function(value){this.setStyle(Styles.BACKGROUND_COLOR,value)},TableView.prototype.setInputValue=function(){},TableView.prototype.addEditInfo=function(){},TableView.prototype.removeEditInfo=function(){},TableView.prototype.setTableValue=function(content){var rowIndex,columnIndex,tr,td,rowsCount=content.length,columnsCount=TableHelper.GetColumnsCount(content),fragment=document.createElement("tbody");for(rowIndex=0;rowIndex<rowsCount;rowIndex++){for(tr=document.createElement("tr"),0===rowIndex?tr.classList.add("header"):rowIndex%2===0?tr.classList.add("even"):tr.classList.add("odd"),columnIndex=0;columnIndex<columnsCount;columnIndex++)td=document.createElement("td"),td.dataset.coords=TableHelper.GetCellCoordinates(rowIndex,columnIndex),td.id=TableHelper.GetCellCoordinates(rowIndex,columnIndex),td.innerHTML=content[rowIndex][columnIndex],tr.appendChild(td);fragment.appendChild(tr)}this.tableElement.innerHTML="",this.tableElement.appendChild(fragment)},TableView.prototype.setCellsStyles=function(cells){_.forEach(cells,function(styles,coordinates){var cell=this.getCell(coordinates);cell.style.cssText="",_.forEach(styles,function(value,property){cell.style[property]=value})}.bind(this))},TableView.prototype.resizeTextArea=function(cellEl){var textarea=this._getTextAreaElement(cellEl);textarea.style.height="auto",textarea.style.height=textarea.scrollHeight+"px"},TableView.prototype.delayedResizeTextArea=function(cellEl){window.setTimeout(this.resizeTextArea.bind(this,cellEl),0)},TableView.prototype._getTextAreaElement=function(cellEl){return cellEl.querySelector("textarea")},TableView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"../helpers/TableHelper.js":104,"./ElementView.js":153,lodash:19}],177:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Parse=_dereq_("../../utils/Parse.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function TagView(){ElementView.apply(this,arguments)}var defaultSrc="/p/elements/standard/pins/black.png",defaultBase64="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAA1QAAANUBVNmqYgAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAQlSURBVEiJxZdNSGNXFMf/7yMmJhPtjGObcWoR6Qdt0IEKWVhKF6kWsa5U0EXdSJ3NUMEKLRSKdFMKrioERJFCIbS4UBd2IZUGFcGVFdoyWHCTxtRovszLy7tJXm4XuS+8PN/Lx2x64XAJ73J/93/uOfeccJRS/B9DbHL924SQT3O53EeU0oTNZvvH6XSGeZ7/G8DPAG4b3YhrUPG7mUzmB1EU3woGg9je3m5xu93weDzweDzU5/PJPp+POByOT3ie/6UhMqW0nr0qy3JicXGx1NraSgGY2tjYGE0kEjlJkn5MJpPtmigrqwd1ZTKZ58vLy3kroN46Ojrozs6OLEnSn0tLSyIAzuoANcGEkO/29/dzPM/XhWomCAI9Pz/PEkKeAuCZ3TlATXA6nb4YGRlpGKqZ3++nuVwufXBw8BCAoMEbBufzeaW3t7dpMAB6eHiYzWQynwFoQTl7quC8VdBxHMcVi0Vit9sbClLjuLi4EEqlUpsOyrNtObAflkNRlNPBwcEXAquqyhcKBTsD34HXBLe1tQWnpqayLwIWBIErFos2ADYGFsCCDABnnmPsYyQSeUwIKbhcrqbu1+Fw0HQ6Tba2tj4G8AqA+wDuAXBU1FsmeBkuxOPxv8bHx5sCBwKBfDQa/R1AL4DHADoBtANwMg8ItaA8AEGW5W9XVlaKjQDdbjfd2NggqVQqNjMz8x6A1wG8plPtAlC+9zpg8fb2dvrk5CRTD+r3+2k0GlXC4fDR5OTkBwDeAfAmgB4AjwA8YO5uDHx5eTkYiUSyVkC73U5XV1cLsiznQqHQVwCeAOhj4DdMwA4AYr2yyHEc51AUpWT2sbOzE7u7u6S7u/v5/Pz8F2tra/+yA5WYUd2slUEKmNRjLcGZagiCcE+SpDu10+l04vj4WBFF8df+/v6vr6+vtTjQoEVmKjP9ISwbgQqc53m3JEl3FgQCgbzL5Trt6ur6EtXuVw1gI5wCoLVczTHwS8lksuqhmZ6exsTERG5ubu5ztrFeqR6sWsFrKeYA8IIgdFxdXVXW9fT0YH19PR8KhZ4Fg8GYDqqazEar3HcVmN2v/o45juMexGIxOwDwPI9gMKjc3Nz8NDo6emiAGsFGD1QFWT3FIIQ8isfjAICFhYWS1+uNDQ0NfQOgUAdKTWYAoLRW/qKc6M5YLPbb7Ows9Xq9VFGU/N7e3ocAXgbwEOXcbEc5P50o56gd1YWh0ghAV49rBRdl7u+QJAmbm5tKKpX6fnh4+NTCjXpX3slbamxnrd5olDsHRzKZDB8dHanpdPqPvr6++wDaDAq1DkNTVlGnV1iz2TOARQAt2Ww2VSgU8mdnZ08YrFUHtJkBG2iZTcFVcFVViSRJC+zu7DqgXmXDQMtmzwjPZrPvDwwMaKCaAdOMmf6FMb7XJsM8YJoY/wFnANLPPi15ggAAAABJRU5ErkJggg==";return TagView.prototype=Object.create(ElementView.prototype),TagView.constructor=TagView,TagView.prototype.createDomElement=function(){var el=document.createElement("figure");return el.className="ng-element el-note",this.noteTitleElement=document.createElement("dt"),this.noteTextElement=document.createElement("dd"),this.noteElement=document.createElement("dl"),this.noteElement.classList.add("note-element-content-wrapper"),this.noteElement.appendChild(this.noteTitleElement),this.noteElement.appendChild(this.noteTextElement),el.addEventListener("mouseover",this.showNote.bind(this)),el.addEventListener("mouseout",this.hideNote.bind(this)),this.noteElement.addEventListener("mouseout",this.hideNote.bind(this)),el},TagView.prototype.setSrc=function(value){value===defaultSrc&&(value=defaultBase64),this.domElement.src=value},TagView.prototype.setTitle=function(value){this.noteTitleElement.textContent=value},TagView.prototype.setText=function(value){this.noteTextElement.textContent=value},TagView.prototype.showNote=function(){var translate=this.domElement.style.transform.match(/translate\((\d+)px, (\d+)px\)/),x=parseInt(translate[1])+parseInt(this.getComputedStyle(Styles.WIDTH)),y=parseInt(translate[2]);this.noteElement.style.top=Parse.toPx(y),this.noteElement.style.left=Parse.toPx(x),this.domElement.parentNode.appendChild(this.noteElement)},TagView.prototype.hideNote=function(e){e.relatedTarget!==this.noteElement&&e.relatedTarget.parentNode!==this.noteElement&&e.relatedTarget!==this.domElement&&this.noteElement.parentNode.removeChild(this.noteElement)},TagView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153}],178:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js");module.exports=function(){function TextElementView(){ElementView.apply(this,arguments)}return TextElementView.prototype=Object.create(ElementView.prototype),TextElementView.constructor=TextElementView,TextElementView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.id=this.createId(ElementTypes.TEXT_ELEMENT),el.classList.add("ng-element"),el.classList.add("el-text-2"),el.classList.add("empty-line-hack"),el.classList.add("line-height-hack"),el.classList.add("wysiwyg-font-type-arial"),el},TextElementView.prototype.setVisibility=function(value,isElementLocked){this.setStyle(Styles.VISIBILITY,value?"":"hidden"),void 0!==isElementLocked&&(value&&isElementLocked?this.domElement.classList.add("locked"):this.domElement.classList.remove("locked"))},TextElementView.prototype.setInputValue=function(value){this.domElement.innerHTML=value},TextElementView.prototype.setColor=function(value){this.forEachTextParent(function(node){node.style.color=value})},TextElementView.prototype.setFontSize=function(value){this.setStyle(Styles.FONT_SIZE,Parse.toPx(value))},TextElementView.prototype.setFontWeight=function(value){this.setStyle(Styles.FONT_WEIGHT,value)},TextElementView.prototype.setFontStyle=function(value){this.setStyle(Styles.FONT_STYLE,value)},TextElementView.prototype.setFontFamily=function(value){this.setStyle(Styles.FONT_FAMILY,value)},TextElementView.prototype.setTextDecoration=function(value){this.setStyle(Styles.TEXT_DECORATION,value)},TextElementView.prototype.setTextAlign=function(value){this.setStyle(Styles.TEXT_ALIGN,value)},TextElementView.prototype.setBackgroundColor=function(value){this.forEachTextParent(function(node){node.style.backgroundColor=value})},TextElementView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153}],179:[function(_dereq_,module,exports){"use strict";var Input2View=_dereq_("./Input2View.js");module.exports=function(){function TextareaView(){Input2View.apply(this,arguments)}return TextareaView.prototype=Object.create(Input2View.prototype),TextareaView.constructor=TextareaView,TextareaView.prototype.createDomElement=function(){var el=document.createElement("textarea");return el.className="ng-element el-textarea",el},TextareaView.prototype.setDisabled=function(value){this.domElement.disabled=!!value},TextareaView.prototype.getDomFocusableElement=function(){return this.domElement},TextareaView}()},{"./Input2View.js":161}],180:[function(_dereq_,module,exports){"use strict";var BoxView=_dereq_("./BoxView.js"),ElementTypes=_dereq_("../../enums/ElementTypes.js"),Styles=_dereq_("../../enums/Styles.js");module.exports=function(){function TooltipView(){BoxView.apply(this,arguments)}return TooltipView.prototype=Object.create(BoxView.prototype),TooltipView.constructor=TooltipView,TooltipView.prototype.createDomElement=function(){this.textElement=document.createElement("p"),this.textElement.id=this.createId(ElementTypes.TOOLTIP);var tooltipWrapper=document.createElement("DIV");return tooltipWrapper.className="ng-element el-tooltip-wrapper",this.tooltipArrow=document.createElement("DIV"),this.tooltipArrow.classList.add("el-tooltip-arrow"),tooltipWrapper.appendChild(this.tooltipArrow),this.tooltipElement=document.createElement("DIV"),this.tooltipElement.classList.add("ng-element"),this.tooltipElement.classList.add("el-tooltip"),this.tooltipElement.classList.add("text-editor-light"),this.tooltipElement.classList.add("line-height-hack"),this.tooltipElement.appendChild(this.textElement),tooltipWrapper.appendChild(this.tooltipElement),tooltipWrapper},TooltipView.prototype.setStyle=function(property,value){this.tooltipElement.style[property]=value,[Styles.DISPLAY,Styles.OPACITY].indexOf(property)>-1&&(this.tooltipArrow.style[property]=value),property===Styles.BORDER_COLOR&&(this.domElement.style[property]=value)},TooltipView.prototype.setPosition=function(value){var classPrefix="arrow-",className=classPrefix+value;if(!this.domElement.classList.contains(className)){for(var i=this.domElement.classList.length-1;i>=0;i--)new RegExp(classPrefix).test(this.domElement.classList[i])&&this.domElement.classList.remove(this.domElement.classList[i]);this.domElement.classList.add(className)}},TooltipView}()},{"../../enums/ElementTypes.js":184,"../../enums/Styles.js":198,"./BoxView.js":145}],181:[function(_dereq_,module,exports){"use strict";var SvgSymbolView=_dereq_("./SvgSymbolView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function UniSvgView(){SvgSymbolView.apply(this,arguments)}return UniSvgView.prototype=Object.create(SvgSymbolView.prototype),UniSvgView.constructor=UniSvgView,UniSvgView.prototype.updateViewBox=function(width,height){this.domElement.setAttribute("viewBox","0 0 "+width+" "+height),this.setStyle(Styles.WIDTH,Parse.toPx(width)),this.setStyle(Styles.HEIGHT,Parse.toPx(height))},UniSvgView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./SvgSymbolView.js":174}],182:[function(_dereq_,module,exports){"use strict";var ElementView=_dereq_("./ElementView.js"),Styles=_dereq_("../../enums/Styles.js"),Parse=_dereq_("../../utils/Parse.js");module.exports=function(){function VideoView(){ElementView.apply(this,arguments)}return VideoView.prototype=Object.create(ElementView.prototype),VideoView.constructor=VideoView,VideoView.prototype.createDomElement=function(){var el=document.createElement("DIV");return el.classList.add("ng-element"),el.classList.add("el-video"),el},VideoView.prototype.setBackgroundImage=function(value){this.setStyle(Styles.BACKGROUND_IMAGE,Parse.backgroundImageString(value))},VideoView.prototype.setVideoHtml=function(value){this.domElement.innerHTML=value},VideoView}()},{"../../enums/Styles.js":198,"../../utils/Parse.js":220,"./ElementView.js":153}],183:[function(_dereq_,module,exports){"use strict";module.exports=function(){var AnimationsMap={easing:{LINEAR:{value:"easeNone",label:"Linear"},EASE_IN:{value:"easeIn",label:"Ease In"},EASE_OUT:{value:"easeOut",label:"Ease Out"},EASE_IN_OUT:{value:"easeInOut",label:"Ease In Out"}},easingType:{POWER0:{value:"Power0",label:"None",hidden:!0},QUAD:{value:"Power1",label:"Quadratic"},CUBIC:{value:"Power2",label:"Cubic"},QUART:{value:"Power3",label:"Quartic"},QUINT:{value:"Power4",label:"Quintic"},SINE:{value:"Sine",label:"Sine"},EXPO:{value:"Expo",label:"Exponential"},CIRC:{value:"Circ",label:"Circular"},ELASTIC:{value:"Elastic",label:"Elastic"},BOUNCE:{value:"Bounce",label:"Bounce"},BACK:{value:"Back",label:"Back"}}};return AnimationsMap.legacyEasing={linear:{easing:AnimationsMap.easing.LINEAR.value,easingType:AnimationsMap.easingType.POWER0.value},"ease-in":{easing:AnimationsMap.easing.EASE_IN.value,easingType:AnimationsMap.easingType.CUBIC.value},"ease-out":{easing:AnimationsMap.easing.EASE_OUT.value,easingType:AnimationsMap.easingType.CUBIC.value},"ease-in-out":{easing:AnimationsMap.easing.EASE_IN_OUT.value,easingType:AnimationsMap.easingType.CUBIC.value},"back-out":{easing:AnimationsMap.easing.EASE_OUT.value,easingType:AnimationsMap.easingType.BACK.value},"elastic-out":{easing:AnimationsMap.easing.EASE_OUT.value,easingType:AnimationsMap.easingType.ELASTIC.value}},AnimationsMap}()},{}],184:[function(_dereq_,module,exports){"use strict";module.exports=function(){var ElementTypes={ABSTRACT_ELEMENT:"Element",ANDROID_GEAR:"AndroidGear",ANDROID_ICON:"AndroidIcon",ARROW:"Arrow",BANNER:"Banner",BOX:"Box",BUTTON:"Button",CHECKBOX:"Checkbox",CIRCLE:"Circle",CLIPART:"Clipart",COMPONENT:"Component",COSTCO_ICON:"CostcoIcon",DIALOG:"Dialog",FONT_AWESOME:"FontAwesome",GEO_SVG:"GeoSvg",GLASS_CANVAS:"GlassCanvas",GROUP:"Group",GROUPING_INSTANCE:"GroupingInstance",HORIZONTAL_SCROLLBAR:"HorizontalScrollbar",HOTSPOT:"Hotspot",IMAGE:"Image",INPUT2:"Input2",INPUT:"Input",INPUT_WITH_LABEL:"InputWithLabel",IOS7:"iOS7",IOS8:"iOS8",LABEL:"Label",LINE:"Line",LINE_HORIZONTAL:"LineHorizontal",LINE_VERTICAL:"LineVertical",LINK:"Link",LINK_LIST:"LinkList",MATERIAL_ICON:"MaterialIcon",MENU:"Menu",MOBILE_SYMBOL:"MobileSymbol",MULTISTATE:"Multistate",NAVIGATION:"Navigation",PASSWORD:"Password",PIXLE_ICON:"PixleIcon",RADIO:"Radio",RETINA_ICON:"RetinaIcon",SCROLLBAR:"Scrollbar",SELECTLIST:"Selectlist",STICKY_NOTE:"StickyNote",SVG_SYMBOL:"SvgSymbol",SVG_ICON_LEGACY:"SvgIconLegacy",TAB:"Tab",TABLE:"Table",TAG:"Tag",TEXT:"Text",TEXT_ELEMENT:"TextElement",TEXTAREA:"Textarea",TOOLTIP:"Tooltip",UNI_SVG:"UniSvg",UXPIN_ICON_SET:"UXPinIconSet",VIDEO:"Video",VIRTUAL_GROUP:"VirtualGroup",CANVAS:"Canvas",COLLABORATION:"Collaboration",GRID:"Grid",GUIDE:"Guide",ELEMENT_INDICATOR:"ElementIndicator",ELEMENT_NAME:"ElementName",GUIDE_POSITION:"GuidePosition",HIGHLIGHT:"Highlight",HIGHLIGHT_EDIT:"HighlightEdit",HIGHLIGHT_EDIT_CLIPPED:"HighlightEditClipped",HIGHLIGHT_SELECT:"HighlightSelect",HIGHLIGHT_CELL_RESIZER:"HighlightCellResizer",IMAGE_CROP:"ImageCrop",IMAGE_EDIT:"ImageEdit",IMAGE_UPLOAD:"ImageUpload",MULTI_SELECT:"MultiSelect"};return ElementTypes}()},{}],185:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Events={ELEMENTS_CHANGE:"elementsChange",ELEMENTS_SELECTED:"elementsSelected",ENABLED_DESIGN_MODE:"enabledDesignMode",ENABLED_PREVIEW_MODE:"enabledPreviewMode",CANT_DELETE_ELEMENT:"cantDeleteElement",COMPONENT_ADDED:"componentAdded",COMPONENT_CREATED:"componentCreated",COMPONENT_EDIT_MODE:"componentEditMode",CROP_CHANGE:"cropChange",CROP_DEACTIVATE:"cropDeactivate",ELEMENT_DELETE_CONFIRMATION:"deleteConfirmation",ELEMENT_RESIZE:"elementResize",ELEMENT_ROTATE:"elementRotate",ELEMENT_DRAG:"elementDrag",ELEMENT_DRAG_END:"elementDragEnd",ELEMENT_PASTE:"elementPaste",GRID_UPDATE:"gridUpdate",GROUP_REORDER:"groupReorder",GUIDES_UPDATE:"guidesUpdate",HIDE_CONTEXT_MENU:"hideContextMenu",HISTORY_CHANGE:"historyChange",IMAGES_DROP:"imagesDrop",IMAGE_EDITED:"imageEdited",IMAGE_PROCESSING:"imageProcessing",LOAD_FUNCTION_FINISHED:"loadFunctionFinished",MODE_CHANGE:"modeChange",MULTISTATE_ELEMENT_OPENED:"multistateElementOpened",MULTISTATE_ELEMENT_CLOSED:"multistateElementClosed",NAVIGATE:"navigate",OPEN_IMAGE_UPLOAD_DIALOG:"openImageUploadDialog",SCROLL_TO_Y:"scrollToY",SET_SCALE:"setScale",SHORTCUT_ADD_NEW_STATE:"shortcutAddNewState",SHOW_CONTEXT_MENU:"showContextMenu",SNAPPING_GUIDE_HIDE:"snappingGuideHide",SNAPPING_GUIDE_SHOW:"snappingGuideShow",TEXT_EDITION_STARTED:"textEditionStarted",TEXT_EDITION_FINISHED:"textEditionFinished",TEXT_SELECTION_CHANGED:"textSelectionChanged",ZOOM_IN:"zoomIn",ZOOM_OUT:"zoomOut",ZOOM_RESET:"zoomReset"};return Events}()},{}],186:[function(_dereq_,module,exports){"use strict";module.exports=function(){var IndicatorAlign={BOTTOM_LEFT:"bottomLeft",BOTTOM_RIGHT:"bottomRight",TOP_LEFT:"topLeft",TOP_RIGHT:"topRight"};return IndicatorAlign}()},{}],187:[function(_dereq_,module,exports){"use strict";module.exports=function(){var InteractionActions={BRING_TO_BACK:"bring_to_back",BRING_TO_FRONT:"bring_to_front",CHANGE_STATE:"change_state",CHECK:"check",DISABLE:"disable",ENABLE:"enable",FOCUS:"focus",HIDE:"hide",LINK_BACK:"link_back",LINK_PAGE:"link_page",LINK_URL:"link_url",MOVE:"move",MOVE_TO:"move_to",NEXT_STATE:"next_state",OPACITY:"opacity",PREVIOUS_STATE:"previous_state",RESIZE:"resize",ROTATE:"rotate",SCROLL:"scroll",SHOW:"show",STYLE:"style",TOGGLE:"toggle",UNCHECK:"uncheck"};return InteractionActions}()},{}],188:[function(_dereq_,module,exports){"use strict";module.exports=function(){var InteractionTriggers={BLUR:"blur",CHANGE:"change",CLICK:"click",CONTEXTMENU:"contextmenu",DBLCLICK:"dblclick",FOCUS:"focus",HOVER:"hover",MOUSEENTER:"mouseenter",MOUSELEAVE:"mouseleave",TOUCH_PRESS:"touch.press",TOUCH_PRESSUP:"touch.pressup",TOUCH_SWIPEDOWN:"touch.swipedown",TOUCH_SWIPELEFT:"touch.swipeleft",TOUCH_SWIPERIGHT:"touch.swiperight",TOUCH_SWIPEUP:"touch.swipeup",WINDOW_KEYDOWN:"window.keydown",WINDOW_SCROLL:"window.scroll",WINDOW_LOAD:"window.load"};return InteractionTriggers}()},{}],189:[function(_dereq_,module,exports){"use strict";var INTERACTION_TRIGGERS=_dereq_("./InteractionTriggers.js"),ELEMENT_TYPES=_dereq_("./ElementTypes.js");module.exports=function(){var InteractionTriggersGrouped={TRIGGERS_GROUP:{SELECT_LIST_EVENTS:[INTERACTION_TRIGGERS.CHANGE],FORM_EVENTS:[INTERACTION_TRIGGERS.FOCUS,INTERACTION_TRIGGERS.BLUR],CANVAS_EVENTS:[INTERACTION_TRIGGERS.WINDOW_KEYDOWN,INTERACTION_TRIGGERS.WINDOW_SCROLL,INTERACTION_TRIGGERS.WINDOW_LOAD],STANDARD_EVENTS:[INTERACTION_TRIGGERS.CLICK,INTERACTION_TRIGGERS.CONTEXTMENU,INTERACTION_TRIGGERS.DBLCLICK,INTERACTION_TRIGGERS.HOVER,INTERACTION_TRIGGERS.MOUSEENTER,INTERACTION_TRIGGERS.MOUSELEAVE,INTERACTION_TRIGGERS.TOUCH_PRESS,INTERACTION_TRIGGERS.TOUCH_PRESSUP,INTERACTION_TRIGGERS.TOUCH_SWIPEDOWN,INTERACTION_TRIGGERS.TOUCH_SWIPELEFT,INTERACTION_TRIGGERS.TOUCH_SWIPERIGHT,INTERACTION_TRIGGERS.TOUCH_SWIPEUP]},EVENTS_SUPPORT:{SELECT_LIST_EVENTS:[ELEMENT_TYPES.SELECTLIST],FORM_EVENTS:[ELEMENT_TYPES.CHECKBOX,ELEMENT_TYPES.RADIO,ELEMENT_TYPES.INPUT_WITH_LABEL,ELEMENT_TYPES.PASSWORD,ELEMENT_TYPES.SELECTLIST,ELEMENT_TYPES.BUTTON,ELEMENT_TYPES.TEXTAREA,ELEMENT_TYPES.INPUT2],CANVAS_EVENTS:[ELEMENT_TYPES.CANVAS]}};return InteractionTriggersGrouped}()},{"./ElementTypes.js":184,"./InteractionTriggers.js":188}],190:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Keys={BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,CAPS_LOCK:20,ESCAPE:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT_ARROW:37,UP_ARROW:38,RIGHT_ARROW:39,DOWN_ARROW:40,INSERT:45,DELETE:46,KEY_0:48,KEY_1:49,KEY_2:50,KEY_3:51,KEY_4:52,KEY_5:53,KEY_6:54,KEY_7:55,KEY_8:56,KEY_9:57,KEY_A:65,KEY_B:66,KEY_C:67,KEY_D:68,KEY_E:69,KEY_F:70,KEY_G:71,KEY_H:72,KEY_I:73,KEY_J:74,KEY_K:75,KEY_L:76,KEY_M:77,KEY_N:78,KEY_O:79,KEY_P:80,KEY_Q:81,KEY_R:82,KEY_S:83,KEY_T:84,KEY_U:85,KEY_V:86,KEY_W:87,KEY_X:88,KEY_Y:89,KEY_Z:90,LEFT_META:91,RIGHT_META:92,SELECT:93,NUMPAD_0:96,NUMPAD_1:97,NUMPAD_2:98,NUMPAD_3:99,NUMPAD_4:100,NUMPAD_5:101,NUMPAD_6:102,NUMPAD_7:103,NUMPAD_8:104,NUMPAD_9:105,MULTIPLY:106,ADD:107,SUBTRACT:109,DECIMAL:110,DIVIDE:111,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,NUM_LOCK:144,SCROLL_LOCK:145,SEMICOLON:186,EQUALS:187,COMMA:188,DASH:189,PERIOD:190,FORWARD_SLASH:191,GRAVE_ACCENT:192,OPEN_BRACKET:219,BACK_SLASH:220,CLOSE_BRACKET:221,SINGLE_QUOTE:222};return Keys}()},{}],191:[function(_dereq_,module,exports){"use strict";module.exports=function(){var MultistateAnimations={FADE:"fade",FLIP_X:"flip-x",FLIP_Y:"flip-y",SLIDE_LEFT:"slide-left",SLIDE_RIGHT:"slide-right",SLIDE_UP:"slide-up",SLIDE_DOWN:"slide-down"};return MultistateAnimations}()},{}],192:[function(_dereq_,module,exports){"use strict";module.exports=function(){var OperationTypes={ADD_ELEMENT:"addElement",CHANGE_PROPERTY:"changeProperty",REMOVE_ELEMENT:"removeElement"};return OperationTypes}()},{}],193:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Orientations={HORIZONTAL:"horizontal",VERTICAL:"vertical"};return Orientations}()},{}],194:[function(_dereq_,module,exports){"use strict";module.exports=function(){return{PREVIEW:"preview",DESIGN:"design",EXPORT:"export"}}()},{}],195:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Properties={ACTIONS:"actions",ANCHOR_X:"anchorX",ANCHOR_Y:"anchorY",ANGLE:"angle",ARROW_END_MARKER:"arrowEndMarker",ARROW_START_MARKER:"arrowStartMarker",ARROW_CURVE:"arrowCurve",ARROW_ORIENTATION:"arrowOrientation",BACKGROUND_COLOR:"backgroundColor",BACKGROUND_IMAGE:"backgroundImage",BACKGROUND_POSITION:"backgroundPosition",BACKGROUND_REPEAT:"backgroundRepeat",BACKGROUND_SIZE:"backgroundSize",BLUR:"blur",BORDER_BOTTOM_LEFT_RADIUS:"borderBottomLeftRadius",BORDER_BOTTOM_RIGHT_RADIUS:"borderBottomRightRadius",BORDER_BOTTOM_WIDTH:"borderBottomWidth",BORDER_COLOR:"borderColor",BORDER_LEFT_WIDTH:"borderLeftWidth",BORDER_LOCK:"borderLock",BORDER_RIGHT_WIDTH:"borderRightWidth",BORDER_STYLE:"borderStyle",BORDER_TOP_LEFT_RADIUS:"borderTopLeftRadius",BORDER_TOP_RIGHT_RADIUS:"borderTopRightRadius",BORDER_TOP_WIDTH:"borderTopWidth",BORDER_WIDTH:"borderWidth",BRIGHTNESS:"brightness",CAPTION:"caption",CLIP:"clip",CELLSSTYLES:"cellsStyles",COLOR:"color",COLUMNWIDTHS:"columnWidths",CONTRAST:"contrast",CROP:"crop",CSS_CLASS:"cssClass",CURRENT_ELEMENT_CATEGORY_ID:"currentElementCategoryId",CURRENT_ELEMENT_ID:"currentElementId",DATA:"data",ELEMENT:"element",ELEMENT_BORDER_COLOR:"elementBorderColor",ELEMENT_BORDER_RADIUS:"elementBorderRadius",ELEMENT_BORDER_STYLE:"elementBorderStyle",ELEMENT_BORDER_WIDTH:"elementBorderWidth",EXPOSURE:"exposure",FIXED:"fixed",FONT_FAMILY:"fontFamily",FONT_SIZE:"fontSize",FONT_STYLE:"fontStyle",FONT_WEIGHT:"fontWeight",GRAYSCALE:"grayscale",HEADER_TEXT:"headerText",HEADER_DISPLAY:"headerDisplay",HEADER_COLOR:"headerColor",HEADER_FONT_WEIGHT:"headerFontWeight",HEADER_FONT_STYLE:"headerFontStyle",HEADER_FONT_SIZE:"headerFontSize",HEADER_FONT_FAMILY:"headerFontFamily",HEADER_TEXT_DECORATION:"headerTextDecoration",HEADER_TEXT_ALIGN:"headerTextAlign",HEIGHT:"height",ID_COMPONENT:"idComponent",ID_STORED_FILE:"idStoredFile",IS_CLIP:"isClip",INIT_ELEMENTS:"initElements",INPUT_VALUE:"inputValue",LABEL:"label",LETTER_SPACING:"letterSpacing",LINE_ORIENTATION:"lineOrientation",LINE_HEIGHT:"lineHeight",LINE_TYPE:"lineType",LOCKED:"locked",MENU_VALUE:"menuValue",MULTISTATE_ORIGIN:"multistateOrigin",NAME:"name",OPACITY:"opacity",ORIGINAL_HEIGHT:"originalHeight",ORIGINAL_RATIO:"originalRatio",ORIGINAL_WIDTH:"originalWidth",OUTLINE_COLOR:"outlineColor",OUTLINE_STYLE:"outlineStyle",OUTLINE_WIDTH:"outlineWidth",PADDING_BOTTOM:"paddingBottom",
PADDING_LEFT:"paddingLeft",PADDING_RIGHT:"paddingRight",PADDING_TOP:"paddingTop",PADDING_LOCK:"paddingLock",RADIUS_LOCK:"radiusLock",SATURATION:"saturation",SCROLL_POSITION:"scrollPosition",SHADOW_BLUR:"shadowBlur",SHADOW_COLOR:"shadowColor",SHADOW_ENABLED:"shadowEnabled",SHADOW_OFFSET_X:"shadowOffsetX",SHADOW_OFFSET_Y:"shadowOffsetY",SHARPEN:"sharpen",SRC:"src",SRC_MOD:"srcMod",SVG_SRC:"svgSrc",STATE_IA:"stateIa",STATES:"states",STORED_ELEMENTS:"storedElements",STROKE:"stroke",TABLEVALUE:"tableValue",TAB_TYPE:"tabType",TEXT_ALIGN:"textAlign",TEXT_DECORATION:"textDecoration",VIBRANCE:"vibrance",VERTICAL_ALIGN:"verticalAlign",WIDTH:"width",X:"x",Y:"y"};return Properties}()},{}],196:[function(_dereq_,module,exports){"use strict";module.exports=function(){var RestrictModes={ALL:"all",ELEMENTS:"elements",NONE:"none"};return RestrictModes}()},{}],197:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Sides={BOTTOM:"bottom",LEFT:"left",RIGHT:"right",TOP:"top"};return Sides}()},{}],198:[function(_dereq_,module,exports){"use strict";module.exports=function(){var Styles={ANGLE:"angle",BACKGROUND_COLOR:"background-color",BACKGROUND_IMAGE:"background-image",BACKGROUND_POSITION:"background-position",BACKGROUND_REPEAT:"background-repeat",BACKGROUND_SIZE:"background-size",BORDER_BOTTOM_LEFT_RADIUS:"border-bottom-left-radius",BORDER_BOTTOM_RIGHT_RADIUS:"border-bottom-right-radius",BORDER_BOTTOM_WIDTH:"border-bottom-width",BORDER_COLOR:"border-color",BORDER_LEFT_WIDTH:"border-left-width",BORDER_RIGHT_WIDTH:"border-right-width",BORDER_RADIUS:"border-radius",BORDER_STYLE:"border-style",BORDER_TOP_LEFT_RADIUS:"border-top-left-radius",BORDER_TOP_RIGHT_RADIUS:"border-top-right-radius",BORDER_TOP_WIDTH:"border-top-width",BORDER_WIDTH:"border-width",BOX_SHADOW:"box-shadow",COLOR:"color",DISPLAY:"display",FONT_FAMILY:"font-family",FONT_SIZE:"font-size",FONT_STYLE:"font-style",FONT_WEIGHT:"font-weight",HEIGHT:"height",LEFT:"left",LETTER_SPACING:"letter-spacing",LINE_HEIGHT:"line-height",OPACITY:"opacity",PADDING_BOTTOM:"padding-bottom",PADDING_LEFT:"padding-left",PADDING_RIGHT:"padding-right",PADDING_TOP:"padding-top",POSITION:"position",TEXT_ALIGN:"text-align",TEXT_DECORATION:"text-decoration",TOP:"top",VISIBILITY:"visibility",WIDTH:"width",X:"x",Y:"y"};return Styles}()},{}],199:[function(_dereq_,module,exports){"use strict";module.exports=function(){var UploadStatus={COMPLETED:"completed",FAILED:"failed",PENDING:"pending",READY:"ready"};return UploadStatus}()},{}],200:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),EventEmitter=_dereq_("event-emitter"),Calc=_dereq_("../utils/Calc.js"),OperationTypes=_dereq_("../enums/OperationTypes.js"),BatchOperation=_dereq_("./BatchOperation.js"),Properties=_dereq_("../enums/Properties.js"),ElementTypes=_dereq_("../enums/ElementTypes.js");module.exports=function(){function isEqual(property1,property2){return"number"==typeof property1?Calc.Round(property1,2)===Calc.Round(property2,2):_.isEqual(property1,property2)}function getElementChanges(element,serialized,prevSerialized){return _.omit(serialized,function(value,property){return!element._isPropertySerializable(property)||isEqual(prevSerialized[property],value)})}function isComponentCanvasOperation(operation){if(operation.type!==OperationTypes.CHANGE_PROPERTY)return!1;var storedElements1=operation.prevSerialized.props[Properties.STORED_ELEMENTS],storedElements2=operation.serialized.props[Properties.STORED_ELEMENTS];return operation.serialized.type===ElementTypes.COMPONENT&&!_.isEqual(storedElements1,storedElements2)}function getChangedProperties(operations){return _.reduce(_.filter(operations,{type:OperationTypes.CHANGE_PROPERTY}),function(changes,operation){var valueOld=operation.prevSerialized.props[operation.property],valueNew=operation.serialized.props[operation.property];return isEqual(valueOld,valueNew)||(changes[operation.elementId]||(changes[operation.elementId]={}),changes[operation.elementId][operation.property]=valueNew),changes},{})}function Batch(Page,updateOnBatchEnd,addToHistory){this.Page=Page,this.updateOnBatchEnd=updateOnBatchEnd,this.addToHistory=addToHistory,this.operations=[],this.updated={},this.elements={},this.components={}}return Batch.FromSerialized=function(Page,serialized){var batch=new Batch(Page);return batch.operations=_.map(serialized,function(operation){return new BatchOperation.FromSerialized(operation)}),batch},Batch.prototype=Object.create(new EventEmitter),Batch.constructor=Batch,Batch.prototype.setUpdated=function(elementId,property){this.updated[elementId]||(this.updated[elementId]={}),this.updated[elementId][property]=!0},Batch.prototype.canUpdate=function(elementId,property){return!this.updated[elementId]||!this.updated[elementId][property]},Batch.prototype.hasChanges=function(){for(var operation,i=0,len=this.operations.length;i<len;i++)if(operation=this.operations[i],!_.isEmpty(operation.getChanges()))return!0;return!1},Batch.prototype.end=function(){var operation,element,virtualGroup=this._getVirtualGroup(this.operations);if(this.updateOnBatchEnd)for(var i=0,len=this.operations.length;i<len;i++)operation=this.operations[i],element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId),element&&operation.setSerialized(element.serialize());virtualGroup&&(this.operations.unshift(new BatchOperation(OperationTypes.ADD_ELEMENT,virtualGroup.id,"",_.find(this.operations,function(operation){return operation.elementId===virtualGroup.id}).prevSerialized,{})),this.operations.push(new BatchOperation(OperationTypes.REMOVE_ELEMENT,virtualGroup.id,"",{},virtualGroup.serialize())))},Batch.prototype.addSaveOperation=function(element,serialized){this._canAddElement(element.id)&&(this.elements[element.id]=serialized||element.serialize())},Batch.prototype.changeProperty=function(elementId,componentInstanceId,serialized,prevSerialized,property){this._storeSerializedComponent(elementId,componentInstanceId,serialized,prevSerialized,property),isEqual(prevSerialized.props[property],serialized.props[property])&&!this.updateOnBatchEnd||this._addOperation(OperationTypes.CHANGE_PROPERTY,elementId,componentInstanceId,serialized,prevSerialized,property)},Batch.prototype.addElement=function(elementId,componentInstanceId,serialized){this._addOperation(OperationTypes.ADD_ELEMENT,elementId,componentInstanceId,serialized,{})},Batch.prototype.removeElement=function(elementId,componentInstanceId,prevSerialized){this._addOperation(OperationTypes.REMOVE_ELEMENT,elementId,componentInstanceId,{},prevSerialized)},Batch.prototype.undo=function(){var operation,editingComponent=this.Page.ElementsManager.getEditingComponent(),editingComponentInstanceId=editingComponent?editingComponent.id:"",batchComponentInstanceId=this.getComponentInstanceId(),shouldChangeEditingComponent=batchComponentInstanceId&&batchComponentInstanceId!==editingComponentInstanceId;shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(this.Page.ElementsManager.getElementById(batchComponentInstanceId)),this.Page.ElementsManager.startBatch(!1,!1);for(var i=this.operations.length;i-- >0;)operation=this.operations[i],operation.type===OperationTypes.CHANGE_PROPERTY?this._undoChangeProperty(operation):operation.type===OperationTypes.ADD_ELEMENT?this._undoAddElement(operation):operation.type===OperationTypes.REMOVE_ELEMENT&&this._undoRemoveElement(operation);return this.Page.ElementsManager.endBatch(),shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(editingComponent),this.Page.canvas.updateHighlightSelect(),!0},Batch.prototype.redo=function(){var editingComponent=this.Page.ElementsManager.getEditingComponent(),editingComponentInstanceId=editingComponent?editingComponent.id:"",batchComponentInstanceId=this.getComponentInstanceId(),shouldChangeEditingComponent=batchComponentInstanceId&&batchComponentInstanceId!==editingComponentInstanceId;return shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(this.Page.ElementsManager.getElementById(batchComponentInstanceId)),this.Page.ElementsManager.startBatch(!1,!1),_.forEach(this.operations,function(operation){operation.type===OperationTypes.CHANGE_PROPERTY?this._redoChangeProperty(operation):operation.type===OperationTypes.ADD_ELEMENT?this._redoAddElement(operation):operation.type===OperationTypes.REMOVE_ELEMENT&&this._redoRemoveElement(operation)}.bind(this)),this.Page.ElementsManager.endBatch(),shouldChangeEditingComponent&&this.Page.ElementsManager.editComponent(editingComponent),this.Page.canvas.updateHighlightSelect(),!0},Batch.prototype.getComponentInstanceId=function(){return _.first(_.without(_.uniq(_.map(this.operations,function(operation){return isComponentCanvasOperation(operation)?operation.elementId:operation.componentInstanceId})),""))},Batch.prototype.getComponentId=function(){var componentInstanceId=this.getComponentInstanceId(),componentId=componentInstanceId?this.Page.ElementsManager.getElementById(componentInstanceId).idComponent:"";return componentId},Batch.prototype.getChanges=function(){var deletedElements=_.map(_.filter(this.operations,{type:OperationTypes.REMOVE_ELEMENT}),function(operation){return operation.elementId}),elementChanges=_.mapValues(_.omit(this.elements,deletedElements),function(prevSerialized,elementId){var componentInstanceId=this.Page.ElementsManager.getComponentInstanceIdByElementId(elementId),element=this.Page.ElementsManager.getElementById(elementId,componentInstanceId);return{type:element.type,props:getElementChanges(element,element.serialize().props,prevSerialized.props),v:prevSerialized.v}}.bind(this)),changedElements=_.omit(elementChanges,function(changes){return _.isEmpty(changes.props)});return{changed_properties:getChangedProperties(this.operations),changed_elements:changedElements,deleted_elements:_.mapValues(_.countBy(deletedElements),function(){return!0})}},Batch.prototype.getSerializedComponent=function(componentInstanceId){return this.components[componentInstanceId]},Batch.prototype.serialize=function(){return _.map(this.operations,function(operation){return operation.serialize()})},Batch.prototype._addOperation=function(operationType,elementId,componentInstanceId,serialized,prevSerialized,property){this.operations.push(new BatchOperation(operationType,elementId,componentInstanceId,serialized,prevSerialized,property))},Batch.prototype._canAddElement=function(elementId){var editingComponent=this.Page.ElementsManager.getEditingComponent(),componentId=this.Page.ElementsManager.getComponentIdByElementId(elementId);return!this.elements[elementId]&&(!componentId||editingComponent&&editingComponent.idComponent===componentId)},Batch.prototype._undoChangeProperty=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);element._updateProperty(operation.property,operation.prevSerialized.props[operation.property],!0)},Batch.prototype._undoAddElement=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);this.Page.ElementsManager.removeElement(element,operation.componentInstanceId),this.Page.canvas.removeFromSelection(element)},Batch.prototype._undoRemoveElement=function(operation){this.Page.ElementsManager.addElementSerialized(operation.prevSerialized,operation.componentInstanceId)},Batch.prototype._redoChangeProperty=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);element._updateProperty(operation.property,operation.serialized.props[operation.property],!0)},Batch.prototype._redoAddElement=function(operation){this.Page.ElementsManager.addElementSerialized(operation.serialized,operation.componentInstanceId)},Batch.prototype._redoRemoveElement=function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId,operation.componentInstanceId);this.Page.ElementsManager.removeElement(element,operation.componentInstanceId)},Batch.prototype._getVirtualGroup=function(operations){var group=null;return _.forEach(operations,function(operation){var element=this.Page.ElementsManager.getElementById(operation.elementId);if(element&&element.isVirtualGroup())return group=element,!1}.bind(this)),group},Batch.prototype._storeSerializedComponent=function(elementId,componentInstanceId,serialized){componentInstanceId=componentInstanceId||(serialized.type===ElementTypes.COMPONENT?elementId:""),componentInstanceId&&!this.components[componentInstanceId]&&(this.components[componentInstanceId]=this.Page.ElementsManager.getElementById(componentInstanceId).serialize())},Batch}()},{"../enums/ElementTypes.js":184,"../enums/OperationTypes.js":192,"../enums/Properties.js":195,"../utils/Calc.js":215,"./BatchOperation.js":201,"event-emitter":3,lodash:19}],201:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Calc=_dereq_("../utils/Calc.js");module.exports=function(){function BatchOperation(type,elementId,componentInstanceId,serialized,prevSerialized,property){this.type=type,this.elementId=elementId,this.componentInstanceId=componentInstanceId,this.serialized=serialized,this.prevSerialized=prevSerialized,this.property=property}return BatchOperation.FromSerialized=function(serialized){var operation=new BatchOperation(serialized.type,serialized.elementId,serialized.componentInstanceId,serialized.serialized,serialized.prevSerialized,serialized.property);return operation},BatchOperation.prototype.setSerialized=function(serialized){this.serialized=serialized},BatchOperation.prototype.getChanges=function(){return _.omit(this.serialized,function(value,property){return"number"==typeof value?Calc.Round(this.prevSerialized[property],2)===Calc.Round(value,2):_.isEqual(this.prevSerialized[property],value)}.bind(this))},BatchOperation.prototype.serialize=function(){return{type:this.type,elementId:this.elementId,componentInstanceId:this.componentInstanceId,serialized:this.serialized,prevSerialized:this.prevSerialized,property:this.property}},BatchOperation}()},{"../utils/Calc.js":215,lodash:19}],202:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),EventEmitter=_dereq_("event-emitter"),Batch=_dereq_("./Batch.js"),HistoryValidator=_dereq_("./HistoryValidator.js"),Events=_dereq_("../enums/Events.js"),Storage=_dereq_("../utils/Storage.js");module.exports=function(){function saveToStorage(pageId){dontUpdate||Storage.Save(getDBId(pageId),serialize(pageId))}function updateStoredCurrentBatch(pageId){dontUpdate||Storage.Update(getDBId(pageId),"currentBatch",currentBatch)}function deserialize(Page,batches){return _.map(batches,function(batch){return Batch.FromSerialized(Page,batch)})}function serialize(pageId){var serialized={};return serialized._id=getDBId(pageId),serialized.currentBatch=currentBatch,serialized.componentsMap=componentsMap,serialized.batches=_.map(batches,function(batch){return batch.serialize()}),serialized}function getDBId(pageId){return DB_ID_PREFIX+pageId}function emitHistoryChange(){emitter.emit(Events.HISTORY_CHANGE,{undo:CanUndo(),redo:CanRedo()})}function Add(batch){currentBatch!==batches.length-1&&batches.splice(currentBatch+1,batches.length-currentBatch),batches.length>=MAX_STEPS&&batches.shift(),batches.push(batch),currentBatch=batches.length-1,saveToStorageThrottled(batch.Page.pageId),emitHistoryChange()}function CanUndo(){return!!(!locked&&batches.length&&currentBatch>-1)}function CanRedo(){return!!(!locked&&batches.length&&currentBatch<batches.length-1)}function Undo(){var batch=batches[currentBatch--];batch.undo(),updateStoredCurrentBatchThrottled(batch.Page.pageId),emitHistoryChange()}function Redo(){var batch=batches[++currentBatch];batch.redo(),updateStoredCurrentBatchThrottled(batch.Page.pageId),emitHistoryChange()}function Load(page){Storage.Load(getDBId(page.pageId)).then(function(doc){currentBatch=doc.currentBatch,batches=deserialize(page,doc.batches),_.forEach(doc.componentsMap,AddToComponentsMap),ValidateAndStore(page)})["catch"](function(){Clear(),emitHistoryChange()})}function Clear(){batches=[],currentBatch=-1,storedBatches=null,storedCurrentBatch=null,dontUpdate=!1}function Lock(value){locked=value}function StoreAndClear(){dontUpdate||(dontUpdate=!0,storedBatches=batches,storedCurrentBatch=currentBatch,batches=[],currentBatch=-1,emitHistoryChange())}function Restore(){dontUpdate&&(dontUpdate=!1,batches=storedBatches,currentBatch=storedCurrentBatch,storedBatches=null,storedCurrentBatch=null,emitHistoryChange())}function ValidateAndStore(page){var i,changed=!1;for(i=currentBatch;i>=0;i--)if(!HistoryValidator.IsValidBatch(batches[i],page.ElementsManager.componentsAvailableIds,componentsMap)){clearHistoryRange(0,i+1),changed=!0;break}for(i=currentBatch+1;i<batches.length;i++)if(!HistoryValidator.IsValidBatch(batches[i],page.ElementsManager.componentsAvailableIds,componentsMap)){clearHistoryRange(i,batches.length-i),changed=!0;break}changed&&saveToStorage(page.pageId),emitHistoryChange()}function AddToComponentsMap(componentId,instanceId){componentsMap[instanceId]=componentId}function clearHistoryRange(start,length){batches.splice(start,length),start<currentBatch&&(currentBatch-=length)}var saveToStorageThrottled,updateStoredCurrentBatchThrottled,DB_ID_PREFIX="batches_",MAX_STEPS=100,batches=[],componentsMap={},storedBatches=null,currentBatch=-1,storedCurrentBatch=null,emitter=new EventEmitter,dontUpdate=!1,locked=!1;saveToStorageThrottled=_.throttle(saveToStorage,1e3),updateStoredCurrentBatchThrottled=_.throttle(updateStoredCurrentBatch,1e3);var HistoryManager={Add:Add,CanUndo:CanUndo,CanRedo:CanRedo,Undo:Undo,Redo:Redo,Load:Load,Clear:Clear,Lock:Lock,StoreAndClear:StoreAndClear,ValidateAndStore:ValidateAndStore,Restore:Restore,AddToComponentsMap:AddToComponentsMap,AddListener:emitter.on.bind(emitter),RemoveListener:emitter.off.bind(emitter)};return HistoryManager}()},{"../enums/Events.js":185,"../utils/Storage.js":222,"./Batch.js":200,"./HistoryValidator.js":203,"event-emitter":3,lodash:19}],203:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function isRemovedComponent(elementId,instanceMap,componentsIds){var componentOriginalId=instanceMap[elementId];return componentOriginalId&&componentsIds.indexOf(componentOriginalId)===-1}function areSomeRemovedComponents(elements,instanceMap,componentsIds){return!_.isEmpty(elements)&&_.some(elements,function(elementId){return isRemovedComponent(elementId,instanceMap,componentsIds)})}function IsValidBatch(batch,componentsIds,instanceMap){return _.every(batch.operations,IsValidOperation.bind(null,componentsIds,instanceMap))}function IsValidOperation(componentsIds,instanceMap,operation){return!isRemovedComponent(operation.elementId,instanceMap,componentsIds)&&((!operation.componentInstanceId||!isRemovedComponent(operation.componentInstanceId,instanceMap,componentsIds))&&((!operation.serialized.props||!areSomeRemovedComponents(operation.serialized.props.storedElements,instanceMap,componentsIds))&&(!operation.prevSerialized.props||!areSomeRemovedComponents(operation.prevSerialized.props.storedElements,instanceMap,componentsIds))))}var HistoryValidator={IsValidBatch:IsValidBatch,IsValidOperation:IsValidOperation};return HistoryValidator}()},{lodash:19}],204:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),AnimationsMap=_dereq_("../enums/AnimationsMap.js");module.exports=function(){function ParseAnimation(data){var easingData=_.defaults(data||{},{easing:AnimationsMap.easing.LINEAR.value,easingType:AnimationsMap.easingType.POWER0.value,duration:0});return data&&data.easing||(easingData.duration=0),easingData.style&&Object.keys(AnimationsMap.legacyEasing).indexOf(easingData.style)>-1&&(easingData.duration=easingData.time||easingData.duration||0,easingData.easing=AnimationsMap.legacyEasing[easingData.style].easing,easingData.easingType=AnimationsMap.legacyEasing[easingData.style].easingType),easingData}function GetEasing(data){var easing,springiness;return data.easingType===AnimationsMap.easingType.ELASTIC.value?(springiness=data.springness/Math.pow(10,2*(String(data.springness).length-2)+1),easing=window[data.easingType][data.easing].config(data.amplitude/100,springiness)):easing=window[data.easingType][data.easing],easing}var AnimationsHelper={ParseAnimation:ParseAnimation,GetEasing:GetEasing};return Object.freeze(AnimationsHelper)}()},{"../enums/AnimationsMap.js":183,lodash:19}],205:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),TweenLite=_dereq_("gsap"),AnimationsHelper=_dereq_("./AnimationsHelper.js");module.exports=function(){function Animator(element,property,startValue,endValue,interaction){this.property=property,this.interaction=interaction,this.startValue=startValue,this.endValue=endValue,this.element=element,this.value=null,this.prevValue=null,this.tween=null}return Animator.prototype.play=function(){return this._setStartValue(),new Promise(function(resolve){var animation=AnimationsHelper.ParseAnimation(this.interaction.animation);this.tween=TweenLite.to(this,animation.duration/1e3,this._setEndValue({ease:AnimationsHelper.GetEasing(animation),onUpdate:this._update.bind(this),onComplete:resolve.bind(null,this)}))}.bind(this))},Animator.prototype.cancel=function(){this.tween.kill()},Animator.prototype._setStartValue=function(){this.value=this.prevValue=this.startValue},Animator.prototype._setEndValue=function(props){return _.extend(props,{value:this.endValue})},Animator.prototype._update=function(){var delta=this.value-this.prevValue;this.prevValue=this.value,this.element[this.property]+=delta},Animator}()},{"./AnimationsHelper.js":204,gsap:1,lodash:19}],206:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Animator=_dereq_("./Animator.js"),Color=_dereq_("../utils/Color.js");module.exports=function(){function AnimatorColor(element,property,startValue,endValue,interaction){Animator.call(this,element,property,startValue,endValue,interaction)}return AnimatorColor.prototype=Object.create(Animator.prototype),AnimatorColor.constructor=AnimatorColor,AnimatorColor.prototype._setStartValue=function(){var start=Color.getRgbaIngredients(this.startValue);start||(start=Color.isTransparent(this.startValue)?this.startValue:Color.hexToRgba(this.startValue)),_.extend(this,start)},AnimatorColor.prototype._setEndValue=function(props){var end=Color.getRgbaIngredients(this.endValue);return end||(end=Color.hexToRgba(this.endValue)),_.extend(props,end)},AnimatorColor.prototype._update=function(){this.element[this.property]=Color.rgbaToString(Math.round(this.r),Math.round(this.g),Math.round(this.b),this.a)},AnimatorColor}()},{"../utils/Color.js":217,"./Animator.js":205,lodash:19}],207:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),InteractionActions=_dereq_("../enums/InteractionActions.js");module.exports=function(){function parseDelay(delay){return parseInt("object"==typeof delay?delay.value:delay)||0}function isCancelable(action,value){var isMoveBy=action===InteractionActions.MOVE,isRotateBy=action===InteractionActions.ROTATE&&"object"==typeof value&&"to"===value.type;return!(isMoveBy||isRotateBy)}function Interaction(action){this.id=_.uniqueId("interaction"),this.trigger=action.event,this.action=action.action,this.value=action.action_value,this.triggerValue=action.event_value||action.trigger_value,this.elements=action.elements,this.animation=action.animation,this.delay=parseDelay(action.delay),this.isCancelable=isCancelable(this.action,this.value),this.step=action.step,this.initialState={}}return Interaction.prototype.getInitialState=function(id){return this.initialState[id]},Interaction.prototype.setInitialState=function(element,property){var endValue=element.getPropertyEndValue(property);_.set(this.initialState,[element.id,property],"undefined"!=typeof endValue?endValue:element[property])},Interaction}()},{"../enums/InteractionActions.js":187,lodash:19}],208:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Events=_dereq_("../enums/Events.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),Properties=_dereq_("../enums/Properties.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),Color=_dereq_("../utils/Color.js"),Animator=_dereq_("./Animator.js"),AnimatorColor=_dereq_("./AnimatorColor.js");module.exports=function(){function shouldSetInitialState(trigger){return trigger===InteractionTriggers.HOVER||trigger===InteractionTriggers.WINDOW_SCROLL}function setInteractionInitialState(element,interaction,property){shouldSetInitialState(interaction.trigger)&&interaction.setInitialState(element,property)}function getPropertyEndValue(element,property){var endValue=element.getPropertyEndValue(property);return"undefined"!=typeof endValue?endValue:element[property]}function getAngle(value){return parseInt("object"==typeof value?value.angle:value,10)||0}function getUniqueElementId(element){return element.componentInstance?element.id.concat(element.componentInstance.id):element.id}function toCamelCase(str){return str.replace(/[_]([a-z])/g,function(match,p1){return p1.toUpperCase()})}function getBackgroundColor(value){return value["background-color"]}function getBorderColor(value){return value["border-color"]}function getColor(value,elementType){return!value.color&&mayHaveBrokenColorProperty(elementType)?getBackgroundColor(value):value.color}function isColorProperty(property){return[Properties.BACKGROUND_COLOR,Properties.BORDER_COLOR,Properties.COLOR].indexOf(property)>-1}function mayHaveBrokenColorProperty(elementType){return[ElementTypes.ANDROID_ICON,ElementTypes.COSTCO_ICON,ElementTypes.MATERIAL_ICON,ElementTypes.FONT_AWESOME,ElementTypes.GEO_SVG,ElementTypes.LINE,ElementTypes.PIXLE_ICON,ElementTypes.RETINA_ICON,ElementTypes.UXPIN_ICON_SET].indexOf(elementType)>-1}function isEqual(property,valueStart,valueEnd){return isColorProperty(property)&&(valueStart=valueStart?Color.toRgba(valueStart):0,valueEnd=valueEnd?Color.toRgba(valueEnd):0),valueStart===valueEnd}function borderRadius(element,interaction,reversed){var borderBottomLeftRadius=reversed?interaction.getInitialState(element.id).borderBottomLeftRadius:interaction.value.borderBottomLeftRadius,borderBottomRightRadius=reversed?interaction.getInitialState(element.id).borderBottomRightRadius:interaction.value.borderBottomRightRadius,borderTopLeftRadius=reversed?interaction.getInitialState(element.id).borderTopLeftRadius:interaction.value.borderTopLeftRadius,borderTopRightRadius=reversed?interaction.getInitialState(element.id).borderTopRightRadius:interaction.value.borderTopRightRadius;animate(element,Properties.BORDER_BOTTOM_LEFT_RADIUS,parseInt(borderBottomLeftRadius)||0,interaction),animate(element,Properties.BORDER_BOTTOM_RIGHT_RADIUS,parseInt(borderBottomRightRadius)||0,interaction),animate(element,Properties.BORDER_TOP_LEFT_RADIUS,parseInt(borderTopLeftRadius)||0,interaction),animate(element,Properties.BORDER_TOP_RIGHT_RADIUS,parseInt(borderTopRightRadius)||0,interaction)}function borderWidth(element,interaction,reversed){var borderBottomWidth=reversed?interaction.getInitialState(element.id).borderBottomWidth:interaction.value.borderBottomWidth,borderTopWidth=reversed?interaction.getInitialState(element.id).borderTopWidth:interaction.value.borderTopWidth,borderLeftWidth=reversed?interaction.getInitialState(element.id).borderLeftWidth:interaction.value.borderLeftWidth,borderRightWidth=reversed?interaction.getInitialState(element.id).borderRightWidth:interaction.value.borderRightWidth;animate(element,Properties.BORDER_BOTTOM_WIDTH,parseInt(borderBottomWidth)||0,interaction),animate(element,Properties.BORDER_TOP_WIDTH,parseInt(borderTopWidth)||0,interaction),animate(element,Properties.BORDER_LEFT_WIDTH,parseInt(borderLeftWidth)||0,interaction),animate(element,Properties.BORDER_RIGHT_WIDTH,parseInt(borderRightWidth)||0,interaction)}function bringToBack(element,interaction,reversed){element.parent.moveChildAt(element,reversed?element.parent.children.length:0)}function bringToFront(element,interaction,reversed){element.parent.moveChildAt(element,reversed?0:element.parent.children.length)}function bringForward(element,interaction,reversed){var elementPosition=element.parent.getChildIndex(element);element.parent.moveChildAt(element,reversed?elementPosition-1:elementPosition+1)}function bringBackward(element,interaction,reversed){var elementPosition=element.parent.getChildIndex(element);element.parent.moveChildAt(element,reversed?elementPosition+1:elementPosition-1)}function changeState(element,interaction,reversed){element.animateChangeState(interaction.value,interaction.animation,reversed,interaction)}function check(element,interaction,reversed){element.getDomFocusableElement().checked=!reversed}function disable(element,interaction,reversed){element.getDomFocusableElement().disabled=!reversed}function enable(element,interaction,reversed){element.getDomFocusableElement().disabled=!!reversed}function focus(element,interaction,reversed){reversed?element.getDomFocusableElement().blur():element.getDomFocusableElement().focus()}function hide(element,interaction,reversed){var opacity=reversed?getPropertyEndValue(element,"finalOpacity")||element.opacity:0,finalOpacity=reversed?interaction.getInitialState(element.id).finalOpacity:getPropertyEndValue(element,"finalOpacity")||element.opacity;element.setPropertyEndValue("finalOpacity",finalOpacity),interaction.setInitialState(element,"finalOpacity"),reversed&&(element.stateIa="visible",element.opacity=0),animate(element,Properties.OPACITY,opacity,interaction).then(function(finalOpacity){reversed||(element.stateIa="hidden",element.opacity=finalOpacity)}.bind(null,finalOpacity))}function linkBack(element,interaction){element.Page.emit(Events.NAVIGATE,interaction.action)}function linkPage(element,interaction){element.Page.emit(Events.NAVIGATE,interaction.action,interaction.value)}function linkUrl(element,interaction){element.Page.emit(Events.NAVIGATE,interaction.action,interaction.value)}function move(element,interaction,reversed){var reverser=reversed?-1:1,x=getPropertyEndValue(element,Properties.X)+interaction.value.x*reverser,y=getPropertyEndValue(element,Properties.Y)+interaction.value.y*reverser;animate(element,Properties.X,x,interaction),animate(element,Properties.Y,y,interaction)}function moveTo(element,interaction,reversed){var x=reversed?interaction.getInitialState(element.id).x:interaction.value.x,y=reversed?interaction.getInitialState(element.id).y:interaction.value.y;animate(element,Properties.X,x,interaction),animate(element,Properties.Y,y,interaction)}function nextState(element,interaction,reversed){element.animateNextState(interaction.animation,reversed)}function opacity(element,interaction,reversed){var alpha=reversed?interaction.getInitialState(element.id).opacity:interaction.value;animate(element,Properties.OPACITY,alpha,interaction)}function previousState(element,interaction,reversed){element.animatePreviousState(interaction.animation,reversed)}function resize(element,interaction,reversed){var width=reversed?interaction.getInitialState(element.id).width:interaction.value.w,height=reversed?interaction.getInitialState(element.id).height:interaction.value.h;animate(element,Properties.WIDTH,width,interaction),animate(element,Properties.HEIGHT,height,interaction)}function rotate(element,interaction,reversed){var angle,reverser=reversed?-1:1;angle="to"===interaction.value.type?reversed?interaction.getInitialState(element.id).angle:getAngle(interaction.value):getPropertyEndValue(element,Properties.ANGLE)+getAngle(interaction.value)*reverser,animate(element,Properties.ANGLE,angle,interaction)}function scroll(element,interaction){element.Page.emit(Events.SCROLL_TO_Y,element.y,interaction.animation,interaction.delay)}function show(element,interaction,reversed){if("hidden"===interaction.value)return hide(element,interaction,reversed);var opacity=reversed?0:getPropertyEndValue(element,"finalOpacity")||element.opacity||100,finalOpacity=reversed?interaction.getInitialState(element.id).finalOpacity:opacity;
element.setPropertyEndValue("finalOpacity",finalOpacity),interaction.setInitialState(element,"finalOpacity"),reversed||"visible"===element.stateIa||(element.stateIa="visible",element.opacity=0),animate(element,Properties.OPACITY,opacity,interaction).then(function(finalOpacity){reversed&&(element.stateIa="hidden",element.opacity=finalOpacity)}.bind(null,finalOpacity))}function style(element,interaction,reversed){var backgroundColor=getBackgroundColor(interaction.value),borderColor=getBorderColor(interaction.value),color=getColor(interaction.value,element.type);backgroundColor&&element.hasProperty(Properties.BACKGROUND_COLOR)&&(reversed&&(backgroundColor=interaction.getInitialState(element.id).backgroundColor),backgroundColor&&animate(element,Properties.BACKGROUND_COLOR,backgroundColor,interaction)),borderColor&&element.hasProperty(Properties.BORDER_COLOR)&&(reversed&&(borderColor=interaction.getInitialState(element.id).borderColor),borderColor&&animate(element,Properties.BORDER_COLOR,borderColor,interaction)),color&&element.hasProperty(Properties.COLOR)&&(reversed&&(color=interaction.getInitialState(element.id).color),color&&animate(element,Properties.COLOR,color,interaction))}function toggle(element,interaction){"visible"===element.stateIa?hide(element,interaction):show(element,interaction)}function uncheck(element,interaction,reversed){element.getDomFocusableElement().checked=!!reversed}function animate(element,property,valueEnd,interaction){var valueStart=element[property];return isEqual(property,valueStart,valueEnd)?(cancelAnimatorsOf(element,property),Promise.resolve()):(isColorProperty(property)&&Color.isTransparent(valueStart)&&(valueStart=Color.makeColorTransparent(valueEnd)),setInteractionInitialState(element,interaction,property),element.setPropertyEndValue(property,valueEnd),cancelAnimatorsOf(element,property),startAnimator(element,createAnimator(element,property,valueStart,valueEnd,interaction)).then(function(animator){removeAnimator(element,animator),element.deletePropertyEndValue(property)}))}function createAnimator(element,property,valueStart,valueEnd,interaction){return isColorProperty(property)?new AnimatorColor(element,property,valueStart,valueEnd,interaction):new Animator(element,property,valueStart,valueEnd,interaction)}function cancelAnimatorsOf(element,property){animators[getUniqueElementId(element)]&&(animators[getUniqueElementId(element)]=_.filter(animators[getUniqueElementId(element)],function(animator){return animator.property!==property||(animator.cancel(),!1)}))}function removeAnimator(element,animator){animators[getUniqueElementId(element)]=_.without(animators[getUniqueElementId(element)],animator)}function startAnimator(element,animator){return animators[getUniqueElementId(element)]||(animators[getUniqueElementId(element)]=[]),animators[getUniqueElementId(element)].push(animator),animator.play()}function applyInteraction(element,interaction,reversed){var fn=FUNCTIONS[toCamelCase(interaction.action)];("style"!==interaction.action||reversed&&!interaction.getInitialState(element.id))&&"style"===interaction.action||fn.apply(null,arguments)}function ApplyInteractionEffect(element,interaction,reversed){var fn=FUNCTIONS[toCamelCase(interaction.action)];"function"==typeof fn&&0!==interaction.step&&(interaction.delay>0?setTimeout(applyInteraction.bind(null,element,interaction,reversed),interaction.delay):applyInteraction.apply(null,arguments))}var animators={},FUNCTIONS={borderRadius:borderRadius,borderWidth:borderWidth,bringToBack:bringToBack,bringToFront:bringToFront,bringForward:bringForward,bringBackward:bringBackward,changeState:changeState,check:check,disable:disable,enable:enable,focus:focus,hide:hide,linkBack:linkBack,linkPage:linkPage,linkUrl:linkUrl,move:move,moveTo:moveTo,nextState:nextState,opacity:opacity,previousState:previousState,resize:resize,rotate:rotate,scroll:scroll,show:show,style:style,toggle:toggle,uncheck:uncheck},InteractionsHelper={ApplyInteractionEffect:ApplyInteractionEffect};return Object.freeze(InteractionsHelper)}()},{"../enums/ElementTypes.js":184,"../enums/Events.js":185,"../enums/InteractionTriggers.js":188,"../enums/Properties.js":195,"../utils/Color.js":217,"./Animator.js":205,"./AnimatorColor.js":206,lodash:19}],209:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Interaction=_dereq_("./Interaction.js"),InteractionsHelper=_dereq_("./InteractionsHelper.js"),InteractionActions=_dereq_("../enums/InteractionActions.js"),InteractionTriggers=_dereq_("../enums/InteractionTriggers.js"),ElementTypes=_dereq_("../enums/ElementTypes.js"),ElementsHelper=_dereq_("../elements/helpers/ElementsHelper.js"),Tree=_dereq_("../utils/Tree.js");module.exports=function(){function getAllActionsExceptLegacyWindow(type,actions){return _.filter(actions,function(action){return type===ElementTypes.CANVAS||[InteractionTriggers.WINDOW_KEYDOWN,InteractionTriggers.WINDOW_LOAD,InteractionTriggers.WINDOW_SCROLL].indexOf(action.event)===-1})}function getLegacyWindowActions(element){return _.filter(element.actions,function(action){return element.type!==ElementTypes.CANVAS&&[InteractionTriggers.WINDOW_KEYDOWN,InteractionTriggers.WINDOW_LOAD,InteractionTriggers.WINDOW_SCROLL].indexOf(action.event)>-1})}function getComponents(elements){return _.filter(elements,function(element){return element.isComponent()})}function getElementsWithoutCanvas(elements){return _.omit(elements,ElementsHelper.CANVAS_ID)}function getElementsInteractions(elements){return _.reduce(elements,function(interactions,element){return interactions[element.id]=_.groupBy(_.map(getAllActionsExceptLegacyWindow(element.type,element.actions),function(action){return new Interaction(action)}),"trigger"),interactions},{})}function getComponentElementsInteractions(elements){return _.reduce(elements,function(interactions,element,elementId){return interactions[elementId]=_.groupBy(_.map(getAllActionsExceptLegacyWindow(element.type,element.props.actions),function(action){return new Interaction(action)}),"trigger"),interactions},{})}function getLegacyCanvasInteractions(elements){return _.groupBy(_.reduce(elements,function(interactions,element){return interactions.concat(_.map(getLegacyWindowActions(element),function(action){return new Interaction(_.extend(action,{elements:[element.id]}))}))},[]),"trigger")}function getComponentsInteractions(ElementsManager,elements){return _.reduce(getComponents(elements),function(interactions,component){var componentDefinition=ElementsManager.getComponentById(component.idComponent);return componentDefinition&&(interactions[component.id]=getComponentElementsInteractions(componentDefinition)),interactions},{})}function isKey(elementId,trigger){return elementId===ElementsHelper.CANVAS_ID&&trigger===InteractionTriggers.WINDOW_KEYDOWN}function isScroll(elementId,trigger){return elementId===ElementsHelper.CANVAS_ID&&trigger===InteractionTriggers.WINDOW_SCROLL}function isChange(trigger){return trigger===InteractionTriggers.CHANGE}function isContextMenu(trigger){return trigger===InteractionTriggers.CONTEXTMENU}function isReversed(trigger,e){return e&&trigger===InteractionTriggers.HOVER&&e.type===InteractionTriggers.MOUSELEAVE}function addLegacyCanvasInteractions(triggers,componentsTriggers,ElementsManager,elements){function processElements(triggers,elements){_.forEach(getLegacyCanvasInteractions(elements),function(interactions,trigger){triggers[trigger]||(triggers[trigger]=[]),triggers[trigger]=triggers[trigger].concat(interactions)})}function prepareComponentDefinitionData(elements){return _.map(elements,function(element,id){return{id:id,type:element.type,actions:element.props.actions}})}processElements(triggers,elements),_.forEach(getComponents(elements),function(component){var componentDefinition=ElementsManager.getComponentById(component.idComponent);componentDefinition&&processElements(componentsTriggers[component.id][ElementsHelper.CANVAS_ID],prepareComponentDefinitionData(componentDefinition))})}function isSelfTrigger(interaction){return[InteractionActions.LINK_BACK,InteractionActions.LINK_PAGE,InteractionActions.LINK_URL].indexOf(interaction.action)>-1}function InteractionsManager(ElementsManager){this.ElementsManager=ElementsManager,this.interactionsElements={},this.interactionsComponents={},this.scrollValues=[],this.scrolledValues=[],this.scrollPosition=0}return InteractionsManager.prototype.loadInteractions=function(elements){this.interactionsElements=getElementsInteractions(elements),this.interactionsComponents=getComponentsInteractions(this.ElementsManager,elements),addLegacyCanvasInteractions(this.interactionsElements[ElementsHelper.CANVAS_ID],this.interactionsComponents,this.ElementsManager,elements),this.scrollValues=this.getScrollValues(),window.requestAnimationFrame(function(){window.requestAnimationFrame(this.addTriggers.bind(this))}.bind(this))},InteractionsManager.prototype.getScrollValues=function(){var elementsInteractions=this.interactionsElements[ElementsHelper.CANVAS_ID][InteractionTriggers.WINDOW_SCROLL],componentInteractions=_.reduce(this.interactionsComponents,function(interactions,interactionsComponent){return interactions.concat(interactionsComponent[ElementsHelper.CANVAS_ID][InteractionTriggers.WINDOW_SCROLL])},[]);return _.sortBy(_.uniq(_.map(_.reject(componentInteractions.concat(elementsInteractions),_.isUndefined),function(interaction){return interaction.triggerValue})))},InteractionsManager.prototype.addTriggers=function(){_.forEach(this.interactionsElements,function(elementInteractions,elementId){_.forEach(_.sortBy(_.keys(elementInteractions)),function(trigger){this.ElementsManager.getElementById(elementId).addTrigger(trigger)}.bind(this))}.bind(this)),_.forEach(this.interactionsComponents,function(elements,componentId){_.forEach(getElementsWithoutCanvas(elements),function(elementInteractions,elementId){_.forEach(_.sortBy(_.keys(elementInteractions)),function(trigger){this.ElementsManager.getElementById(elementId,componentId).addTrigger(trigger,componentId)}.bind(this))}.bind(this))}.bind(this))},InteractionsManager.prototype.getInteractionsForTriggerValue=function(elementId,componentInstanceId,trigger,value){return componentInstanceId?_.reduce(this.interactionsComponents,function(interactions,elements){return elements[elementId]&&elements[elementId][trigger]?interactions.concat(_.filter(elements[elementId][trigger],function(interaction){return interaction.triggerValue===value})):interactions},[]):_.filter(this.interactionsElements[elementId][trigger],function(interaction){return interaction.triggerValue===value})},InteractionsManager.prototype.getValuesToScroll=function(direction,e){return this.scrollPosition=e.target.scrollTop,_.filter(this.scrollValues,function(value){return direction>0&&this.scrollPosition>=value&&this.scrolledValues.indexOf(value)===-1?(this.scrolledValues.push(value),!0):direction<0&&this.scrollPosition<value&&this.scrolledValues.indexOf(value)!==-1&&(this.scrolledValues=_.without(this.scrolledValues,value),!0)}.bind(this))},InteractionsManager.prototype.getElementInteractionsByTrigger=function(elementId,componentInstanceId,trigger){return componentInstanceId?this.interactionsComponents[componentInstanceId][elementId][trigger]:this.interactionsElements[elementId][trigger]},InteractionsManager.prototype.hasOnPageLoadInteractions=function(){return!!this.interactionsElements[ElementsHelper.CANVAS_ID][InteractionTriggers.WINDOW_LOAD]},InteractionsManager.prototype.interactWithElement=function(elementId,componentInstanceId,trigger,e){isScroll(elementId,trigger)?this.interactWithElementOnScroll(elementId,componentInstanceId,trigger,e):isKey(elementId,trigger)?this.interactWithElementOnKey(elementId,componentInstanceId,trigger,e):isChange(trigger)?this.interactWithElementOnChange(elementId,componentInstanceId,trigger,e):this.interactWithElementGeneric(elementId,componentInstanceId,trigger,e)},InteractionsManager.prototype.interactWithElementGeneric=function(elementId,componentInstanceId,trigger,e){var reversed=isReversed(trigger,e),interactions=this.getElementInteractionsByTrigger(elementId,componentInstanceId,trigger);isContextMenu(trigger)&&e.preventDefault(),this.applyInteractionEffect(elementId,componentInstanceId,interactions,reversed)},InteractionsManager.prototype.interactWithElementOnChange=function(elementId,componentInstanceId,trigger,e){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,e.target.value);this.applyInteractionEffect(elementId,componentInstanceId,interactions,!1)},InteractionsManager.prototype.interactWithElementOnKey=function(elementId,componentInstanceId,trigger,e){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,e.which);this.applyInteractionEffect(elementId,componentInstanceId,interactions,!1)},InteractionsManager.prototype.interactWithElementOnScroll=function(elementId,componentInstanceId,trigger,e){var direction=e.target.scrollTop>this.scrollPosition?1:-1,reversed=direction<0;_.forEach(this.getValuesToScroll(direction,e),function(value){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,value);this.applyInteractionEffect(elementId,componentInstanceId,interactions,reversed),_.forEach(this.interactionsComponents,function(interactionsComponent,componentInstanceId){var interactions=this.getInteractionsForTriggerValue(elementId,componentInstanceId,trigger,value);this.applyInteractionEffect(elementId,componentInstanceId,interactions,reversed)}.bind(this))}.bind(this))},InteractionsManager.prototype.applyInteractionEffect=function(elementId,componentInstanceId,interactions,reversed){var interactionsOrder=this.sortInteractionsByElementsHierarchy(interactions);_.forEach(interactionsOrder,function(interactionId){_.forEach(isSelfTrigger(interactions[interactionId])?[elementId]:interactions[interactionId].elements,function(targetElementId){var element=this.ElementsManager.getElementById(targetElementId,componentInstanceId);InteractionsHelper.ApplyInteractionEffect(element,interactions[interactionId],reversed)}.bind(this))}.bind(this))},InteractionsManager.prototype.sortInteractionsByElementsHierarchy=function(interactions){var interactionsOrder=_.keys(interactions);return interactionsOrder.sort(function(a,b){var firstInteractionElement=this.ElementsManager.getElementById(interactions[a].elements[0]),secondInteractionElement=this.ElementsManager.getElementById(interactions[b].elements[0]);return!firstInteractionElement||Tree.IsAncestorOf(firstInteractionElement,secondInteractionElement)?1:!secondInteractionElement||Tree.IsAncestorOf(secondInteractionElement,firstInteractionElement)?-1:0}.bind(this)),interactionsOrder},InteractionsManager.prototype.destroy=function(){this.interactionsElements=null,this.interactionsComponents=null,this.scrollValues=null,this.scrolledValues=null},InteractionsManager}()},{"../elements/helpers/ElementsHelper.js":97,"../enums/ElementTypes.js":184,"../enums/InteractionActions.js":187,"../enums/InteractionTriggers.js":188,"../utils/Tree.js":223,"./Interaction.js":207,"./InteractionsHelper.js":208,lodash:19}],210:[function(_dereq_,module,exports){!function(a){"use strict";var b=a.HTMLCanvasElement&&a.HTMLCanvasElement.prototype,c=a.Blob&&function(){try{return Boolean(new Blob)}catch(a){return!1}}(),d=c&&a.Uint8Array&&function(){try{return 100===new Blob([new Uint8Array(100)]).size}catch(a){return!1}}(),e=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder,f=(c||e)&&a.atob&&a.ArrayBuffer&&a.Uint8Array&&function(a){var b,f,g,h,i,j;for(b=a.split(",")[0].indexOf("base64")>=0?atob(a.split(",")[1]):decodeURIComponent(a.split(",")[1]),f=new ArrayBuffer(b.length),g=new Uint8Array(f),h=0;h<b.length;h+=1)g[h]=b.charCodeAt(h);return i=a.split(",")[0].split(":")[1].split(";")[0],c?new Blob([d?g:f],{type:i}):(j=new e,j.append(f),j.getBlob(i))};a.HTMLCanvasElement&&!b.toBlob&&(b.mozGetAsFile?b.toBlob=function(a,c,d){a(d&&b.toDataURL&&f?f(this.toDataURL(c,d)):this.mozGetAsFile("blob",c))}:b.toDataURL&&f&&(b.toBlob=function(a,b,c){a(f(this.toDataURL(b,c)))})),"function"==typeof define&&define.amd?define(function(){return f}):a.dataURLtoBlob=f}(window)},{}],211:[function(_dereq_,module,exports){"use strict";module.exports=function(){function Point(x,y){this.x=x||0,this.y=y||0}return Point.FromObject=function(coords){return new Point(coords.x,coords.y)},Point.prototype.translate=function(dx,dy,angle){var point;angle?(point=this.clone(),this.x+=dx,this.y+=dy,this.rotate(point,angle)):(this.x+=dx,this.y+=dy)},Point.prototype.rotate=function(origin,angle){var point=this.clone(),rad=angle*Math.PI/180,cos=Math.cos(rad),sin=Math.sin(rad);this.x=cos*(point.x-origin.x)-sin*(point.y-origin.y)+origin.x,this.y=sin*(point.x-origin.x)+cos*(point.y-origin.y)+origin.y},Point.prototype.dot=function(p){return this.x*p.x+this.y*p.y},Point.prototype.distanceTo=function(p){var dx=this.x-p.x,dy=this.y-p.y;return Math.sqrt(dx*dx+dy*dy)},Point.prototype.clone=function(){return new Point(this.x,this.y)},Point.prototype.toString=function(){return"Point(x = "+this.x+", y = "+this.y+")"},Point}()},{}],212:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),Point=_dereq_("./Point.js"),Calc=_dereq_("../utils/Calc.js");module.exports=function(){function Rectangle(x,y,w,h,a){x=x||0,y=y||0,w=w||0,h=h||0,a=a||0,this._p0=new Point,this._p1=new Point,this._p2=new Point,this._p3=new Point,this._points=[this._p0,this._p1,this._p2,this._p3],this._x=0,this._y=0,this._width=0,this._height=0,this._angle=0,this.x=x,this.y=y,this.width=w,this.height=h,a&&this.rotate(this._p0,a)}return Rectangle.FromSerialized=function(serialized){return new Rectangle(serialized.x,serialized.y,serialized.width,serialized.height,serialized.angle)},Object.defineProperties(Rectangle.prototype,{x:{get:function(){return this._x},set:function(value){var delta=value-this._x;this._x=value,this._p0.translate(delta,0),this._p1.translate(delta,0),this._p2.translate(delta,0),this._p3.translate(delta,0)}},y:{get:function(){return this._y},set:function(value){var delta=value-this._y;this._y=value,this._p0.translate(0,delta),this._p1.translate(0,delta),this._p2.translate(0,delta),this._p3.translate(0,delta)}},width:{get:function(){return this._width},set:function(value){var delta=value-this._width;this._width=value,this._angle?(this._p1.translate(delta,0,this._angle),this._p2.translate(delta,0,this._angle)):(this._p1.translate(delta,0),this._p2.translate(delta,0))}},height:{get:function(){return this._height},set:function(value){var delta=value-this._height;this._height=value,this._angle?(this._p2.translate(0,delta,this._angle),this._p3.translate(0,delta,this._angle)):(this._p2.translate(0,delta),this._p3.translate(0,delta))}},top:{get:function(){return this.y}},left:{get:function(){return this.x}},right:{get:function(){return this.x+this.width}},bottom:{get:function(){return this.y+this.height}},middle:{get:function(){return this.top+this.height/2}},center:{get:function(){return this.left+this.width/2}},aspectRatio:{get:function(){return this.width/this.height}},angle:{get:function(){return this._angle},set:function(value){var p=this.getCenterPoint();this.rotate(p,value)}}}),Rectangle.prototype.multiply=function(value){return this.x*=value,this.y*=value,this.width*=value,this.height*=value,this},Rectangle.prototype.add=function(rectangle){var r1=this,r2=rectangle,x=Math.min(r1._p0.x,r1._p1.x,r1._p2.x,r1._p3.x,r2._p0.x,r2._p1.x,r2._p2.x,r2._p3.x),y=Math.min(r1._p0.y,r1._p1.y,r1._p2.y,r1._p3.y,r2._p0.y,r2._p1.y,r2._p2.y,r2._p3.y);return new Rectangle(x,y,Math.max(r1._p0.x,r1._p1.x,r1._p2.x,r1._p3.x,r2._p0.x,r2._p1.x,r2._p2.x,r2._p3.x)-x,Math.max(r1._p0.y,r1._p1.y,r1._p2.y,r1._p3.y,r2._p0.y,r2._p1.y,r2._p2.y,r2._p3.y)-y)},Rectangle.prototype.rotate=function(p,angle){this.rotateBy(p,angle-this._angle)},Rectangle.prototype.rotateBy=function(p,delta){this._angle+=delta,this._p0.rotate(p,delta),this._p1.rotate(p,delta),this._p2.rotate(p,delta),this._p3.rotate(p,delta),this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.moveAlongAngle=function(deltaX,deltaY){this._p0.translate(deltaX,deltaY,this._angle),this._p1.translate(deltaX,deltaY,this._angle),this._p2.translate(deltaX,deltaY,this._angle),this._p3.translate(deltaX,deltaY,this._angle),this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.resizeFromPoint=function(scaleX,scaleY,point){_.forEach(this._points,function(p){p.x=point.x+(p.x-point.x)*scaleX,p.y=point.y+(p.y-point.y)*scaleY}),this._width*=scaleX,this._height*=scaleY,this._x=this._p0.x,this._y=this._p0.y},Rectangle.prototype.hitTest=function(p){var am=new Point(this._p0.x-p.x,this._p0.y-p.y),ab=new Point(this._p0.x-this._p1.x,this._p0.y-this._p1.y),ad=new Point(this._p0.x-this._p3.x,this._p0.y-this._p3.y);return am.dot(ab)>=0&&am.dot(ab)<=ab.dot(ab)&&am.dot(ad)>=0&&am.dot(ad)<=ad.dot(ad)},Rectangle.prototype.overlaps=function(rectangle){var r1=this.getBoundingBox(!0),r2=rectangle.getBoundingBox(!0);return!(r2._p0.x>r1._p2.x||r2._p2.x<r1._p0.x||r2._p0.y>r1._p2.y||r2._p2.y<r1._p0.y)},Rectangle.prototype.isInBounds=function(rectangle){var angleDelta=-this.angle,outer=this.clone(),inner=rectangle.clone(),rotatePoint=outer.getCenterPoint();return outer.rotateBy(rotatePoint,angleDelta),inner.rotateBy(rotatePoint,angleDelta),inner=inner.getBoundingBox(!0),outer._p0.x<=inner._p0.x&&outer._p0.y<=inner._p0.y&&outer._p1.x>=inner._p1.x&&outer._p1.y<=inner._p1.y&&outer._p2.x>=inner._p2.x&&outer._p2.y>=inner._p2.y&&outer._p3.x<=inner._p3.x&&outer._p3.y>=inner._p3.y},Rectangle.prototype.getMaxBounds=function(current,changed){var inner=changed.clone();return this.angle?inner:current.width!==changed.width||current.height!==changed.height?this.getMaxBoundsResize(current,inner):(Calc.Between(this._p0.x,this._p1.x,inner._p1.x)?Calc.Between(this._p0.x,this._p1.x,inner._p0.x)||(inner.x=this.x):inner.x-=inner._p1.x-this._p1.x,Calc.Between(this._p0.y,this._p3.y,inner._p3.y)?Calc.Between(this._p0.y,this._p3.y,inner._p0.y)||(inner.y=this.y):inner.y-=inner._p3.y-this._p3.y,inner)},Rectangle.prototype.getMaxBoundsResize=function(current,changed){var inner=changed.clone();return current.width!==changed.width&&(current.x!==changed.x?(inner.x=Math.max(this.x,changed.x),inner.width=Math.min(current.width+current.x-this.x,changed.width)):inner.width=Math.min(this.width-inner.x+this.x,changed.width)),current.height!==changed.height&&(current.y!==changed.y?(inner.y=Math.max(this.y,changed.y),inner.height=Math.min(current.height+current.y-this.y,changed.height)):inner.height=Math.min(this.height-inner.y+this.y,changed.height)),inner},Rectangle.prototype.isEqual=function(rectangle){return this._angle===rectangle._angle&&_.isEqual(this._p0,rectangle._p0)&&_.isEqual(this._p1,rectangle._p1)&&_.isEqual(this._p2,rectangle._p2)&&_.isEqual(this._p3,rectangle._p3)},Rectangle.prototype.getBoundingBox=function(projected){var x,y;return projected&&this._angle?(x=this.getMinX(),y=this.getMinY(),new Rectangle(x,y,this.getMaxX()-x,this.getMaxY()-y)):this},Rectangle.prototype.getMinX=function(){return Math.min(this._p0.x,this._p1.x,this._p2.x,this._p3.x)},Rectangle.prototype.getMinY=function(){return Math.min(this._p0.y,this._p1.y,this._p2.y,this._p3.y)},Rectangle.prototype.getMaxX=function(){return Math.max(this._p0.x,this._p1.x,this._p2.x,this._p3.x)},Rectangle.prototype.getMaxY=function(){return Math.max(this._p0.y,this._p1.y,this._p2.y,this._p3.y)},Rectangle.prototype.getCenterPoint=function(){return new Point(this._p0.x+(this._p2.x-this._p0.x)/2,this._p0.y+(this._p2.y-this._p0.y)/2)},Rectangle.prototype.clone=function(){var r=new Rectangle;return r._x=this._x,r._y=this._y,r._width=this._width,r._height=this._height,r._angle=this._angle,r._p0=this._p0.clone(),r._p1=this._p1.clone(),r._p2=this._p2.clone(),r._p3=this._p3.clone(),r},Rectangle.prototype.serialize=function(){return{x:this.x,y:this.y,width:this.width,height:this.height,angle:this.angle}},Rectangle.prototype.toString=function(){return"Rectangle(x = "+this.x+", y = "+this.y+", w = "+this.width+", h = "+this.height+")"},Rectangle}()},{"../utils/Calc.js":215,"./Point.js":211,lodash:19}],213:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function Extend(objectClass,baseClass){objectClass.prototype=Object.create(baseClass.prototype),objectClass.constructor=objectClass,objectClass.prototype.AppliedBehaviors=_.clone(baseClass.prototype.AppliedBehaviors),objectClass.prototype.DefaultProperties={},_.extend(objectClass.prototype.DefaultProperties,baseClass.prototype.DefaultProperties),_.extend(objectClass.prototype.DefaultProperties,objectClass.DefaultProperties),objectClass.prototype.ExcludedProperties={},_.extend(objectClass.prototype.ExcludedProperties,baseClass.prototype.ExcludedProperties),_.extend(objectClass.prototype.ExcludedProperties,objectClass.ExcludedProperties)}function ApplyBehavior(objectClass,behaviorClass){var property,descriptor;objectClass.prototype.AppliedBehaviors.push(behaviorClass),_.extend(objectClass.prototype,behaviorClass.prototype),_.defaults(objectClass.prototype.DefaultProperties,behaviorClass.DefaultProperties),_.defaults(objectClass.prototype.ExcludedProperties,behaviorClass.ExcludedProperties);for(property in behaviorClass.DefaultProperties)behaviorClass.DefaultProperties.hasOwnProperty(property)&&(descriptor=Object.getOwnPropertyDescriptor(behaviorClass.prototype,property),descriptor&&Object.defineProperty(objectClass.prototype,property,descriptor))}var Base={Extend:Extend,ApplyBehavior:ApplyBehavior};return Base}()},{lodash:19}],214:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function Init(options){_userContentPrefix=options.userContentPrefix,_userContentPrefixCached=options.userContentPrefixCached,_staticContentPrefixCached=options.staticContentPrefixCached}function IsStatic(url){return 0===url.indexOf("/p/")||0===url.indexOf("/pics/")||0===url.indexOf("/app/")}function IsUserContent(url){return url.indexOf(_userContentPrefix)>-1}function GetStaticUrl(url){return _.isEmpty(_staticContentPrefixCached)?url:_staticContentPrefixCached+url}function GetUserContentUrl(url){return _.isEmpty(_userContentPrefixCached)?url:url.replace(_userContentPrefix,_userContentPrefixCached)}var _userContentPrefix=null,_userContentPrefixCached=null,_staticContentPrefixCached=null,CDNHelper={Init:Init,IsStatic:IsStatic,IsUserContent:IsUserContent,GetStaticUrl:GetStaticUrl,GetUserContentUrl:GetUserContentUrl};return CDNHelper}()},{lodash:19}],215:[function(_dereq_,module,exports){"use strict";module.exports=function(){function GetLinePointDistance(p0,p1,p){var d=((p1.y-p0.y)*p.x-(p1.x-p0.x)*p.y+p1.x*p0.y-p1.y*p0.x)/p1.distanceTo(p0);return d>1?d:1}function DegToRad(angle){return angle*Math.PI/180}function RadToDeg(rad){return 180*rad/Math.PI}function Round(value,numberOfDecimalPlaces){var p=Math.pow(10,numberOfDecimalPlaces);return Math.round(value*p)/p}function Between(a,b,value){var min=Math.min(a,b),max=Math.max(a,b);return value>=min&&value<=max}var Calc={GetLinePointDistance:GetLinePointDistance,DegToRad:DegToRad,RadToDeg:RadToDeg,Round:Round,Between:Between};return Calc}()},{}],216:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash"),ElementTypes=_dereq_("../enums/ElementTypes"),ElementsHelper=_dereq_("../elements/helpers/ElementsHelper"),EventEmitter=_dereq_("event-emitter");module.exports=function(){function CollaborationUtils(canvas,Page){this.canvas=canvas,this.Page=Page,this.activeElements={},this.editingComponents={},this.events=EVENTS}function handleStoredElements(Page,changedData,component){var elementsToAdd=[],unshift=[].unshift,add=function(storedElements){return function(toAdd){storedElements.indexOf(toAdd)>-1||storedElements.push(toAdd)}},remove=function(storedElements){return function(toRemove){storedElements.indexOf(toRemove)!==-1&&storedElements.splice(storedElements.indexOf(toRemove),1)}},handleNewElement=function(elementData,id){var index=elementsToAdd.indexOf(id);elementData.props.storedElements&&(elementsToAdd=index!==-1?elementsToAdd.slice(0,index).concat(elementData.props.storedElements).concat(elementsToAdd.slice(index)):elementsToAdd.concat(elementData.props.storedElements)),elementData.props.states&&_.forEach(elementData.props.states,function(state){unshift.apply(elementsToAdd,state.elements)})};_.forEach(changedData.changed_elements,function(elementData,id){var element=id===ElementsHelper.CANVAS_ID&&component?component:Page.ElementsManager.getElementById(id,component&&component.id);if(!element)return handleNewElement(elementData,id);if(_.isUndefined(elementData.props.storedElements)&&!elementData.props.states)return void(elementsToAdd=elementsToAdd.concat(element.storedElements||[]));if(elementData.props.states)return void _.forEach(elementData.props.states,function(state){unshift.apply(elementsToAdd,state.elements)});var storedElements=_.clone(element.storedElements);_.difference(elementData.props.storedElements,element.storedElements).forEach(add(storedElements)),_.difference(element.storedElements,elementData.props.storedElements).forEach(remove(storedElements)),storedElements=_.sortBy(storedElements,function(id){var newElementsId=elementData.props.storedElements.indexOf(id);return newElementsId===-1?element.storedElements.indexOf(id):newElementsId}),elementData.props.storedElements=storedElements,elementsToAdd=elementsToAdd.concat(storedElements)});var elementsToAddPosition=function(data){var position=elementsToAdd.indexOf(data.id);return position===-1?elementsToAdd.length:position},withoutDeleted=function(data){return!changedData.deleted_elements[data.id]};return _.sortBy(_.filter(mapChangedElements(changedData.changed_elements),withoutDeleted),elementsToAddPosition)}function mapChangedElements(changedElements){return _.map(changedElements,function(data,id){return{id:id,data:data}})}var EVENTS={NEW_COLLABORATOR:"newCollaborator"};return CollaborationUtils.constructor=CollaborationUtils,CollaborationUtils.prototype=Object.create(EventEmitter.methods),CollaborationUtils.prototype.refreshCollaborators=function(scale){_.forEach(this.canvas.collaborators,function(collaborator){collaborator.refresh(scale)})},CollaborationUtils.prototype.cleanupCollaborator=function(id){delete this.activeElements[id]},CollaborationUtils.prototype.isElementEditing=function(id){return _.some(this.activeElements,function(elementIds){return elementIds.indexOf(id)>-1})},CollaborationUtils.prototype.isComponentEditing=function(componentId){return componentId=parseInt(componentId,10),_.some(this.editingComponents,function(editingComponentId){return editingComponentId===componentId})},CollaborationUtils.prototype.isElementEditingByAnotherUser=function(userId,elementId){var activeElements=_.clone(this.activeElements);return delete activeElements[userId],_.some(activeElements,function(elementIds){return elementIds.indexOf(elementId)>-1})},CollaborationUtils.prototype.setCollaborators=function(collaborators){this.canvas.setCollaborators(collaborators);var newCollaborators=_.difference(Object.keys(collaborators),Object.keys(this.activeElements)),disconnectedCollaborators=_.difference(Object.keys(this.activeElements),Object.keys(collaborators));disconnectedCollaborators.length&&disconnectedCollaborators.forEach(this.cleanupCollaborator.bind(this)),newCollaborators.length&&this.emit(EVENTS.NEW_COLLABORATOR,newCollaborators)},CollaborationUtils.prototype.setActiveElements=function(userId,data){data.is_component?this.editingComponents[userId]=parseInt(data.id_page,10):delete this.editingComponents[userId],this.activeElements[userId]=data.element_ids},CollaborationUtils.prototype.activateElement=function(data){var collaborator=this.canvas.getCollaborator(data.id_user);collaborator&&(collaborator.activateElement(data.id_page,data.element_ids,data.is_component),this.setActiveElements(data.id_user,data))},CollaborationUtils.prototype.elementsChanged=function(changedData){
if(parseInt(changedData.is_component)&&parseInt(changedData.id_page)!==parseInt(this.Page.pageId))return this._componentChanged(changedData);if(parseInt(changedData.id_page)===parseInt(this.Page.pageId)){var changedElements=handleStoredElements(this.Page,changedData),collaborator=this.canvas.getCollaborator(changedData.id_user);_.isEmpty(changedElements)||(_.forEach(changedElements,function(element){this.Page.collaborationUpdateElement(element.id,element.data)},this),collaborator&&collaborator.refresh()),_.forEach(changedData.deleted_elements,function(remove,id){this.Page.ElementsManager.removeElementById(id)}.bind(this))}},CollaborationUtils.prototype._componentChanged=function(changedData){var component=this.Page.getComponentById(changedData.id_page),oldComponentData=_.cloneDeep(component);if(!component)return this.Page.collaborationCreateComponent(changedData);var changedElements=mapChangedElements(changedData.changed_elements),componentInstances=this.Page.ElementsManager.getElementsByComponentId(changedData.id_page);_.isEmpty(componentInstances)||(changedElements=handleStoredElements(this.Page,changedData,_.first(componentInstances))),_.forEach(changedData.changed_elements,function(element,id){if(element.type!==ElementTypes.VIRTUAL_GROUP)return component[id]?(element.props=_.assign({},changedData.changed_properties[id],element.props),void _.assign(component[id].props,element.props)):void(component[id]=element)}),_.forEach(changedData.deleted_elements,function(noop,id){delete component[id]}),_.forEach(componentInstances,function(componentInstance){componentInstance.collaborationUpdateComponent(oldComponentData,component,changedElements)}.bind(this))},CollaborationUtils}()},{"../elements/helpers/ElementsHelper":97,"../enums/ElementTypes":184,"event-emitter":3,lodash:19}],217:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function addZeroes(str,len){return _.range(0,len-str.length,0).join("")+str}function expand(str){return _.reduce(str,function(s,c){return s+c+c},"")}function isHex(value){return value&&/^#([0-9a-f]{6})$/i.test(value)}function isShortHex(value){return value&&/^#([0-9a-f]{3})$/i.test(value)}function isRgba(value){return/^rgb/.test(value)}function isTransparent(value){return value===TRANSPARENT}function getAlpha(value){return"undefined"==typeof value||value>1?1:value}function hexToRgba(hex){hex=hex.substr(1),3===hex.length&&(hex=expand(hex));var r=parseInt(hex.substr(0,2),16),g=parseInt(hex.substr(2,2),16),b=parseInt(hex.substr(4,2),16),a=getAlpha();return{r:r,g:g,b:b,a:a}}function rgbToHex(r,g,b){return"#"+addZeroes(r.toString(16),2)+addZeroes(g.toString(16),2)+addZeroes(b.toString(16),2)}function getRgbaIngredients(value){var colorMatches=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,)?(\s*\d+[\.\d+]*)*\)/g.exec(value);return colorMatches?{r:parseInt(colorMatches[1]),g:parseInt(colorMatches[2]),b:parseInt(colorMatches[3]),a:getAlpha(colorMatches[5])}:null}function rgbaStringToHex(value){var rgbMatch=/rgba?\((\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,)(\s*\d+[\.\d+]*)*\)/g.exec(value);return isHex(value)?value:null!==rgbMatch&&rgbMatch[5]?rgbToHex(parseInt(rgbMatch[1],10),parseInt(rgbMatch[2],10),parseInt(rgbMatch[3],10)):null}function rgbaToString(r,g,b,a){return"rgba("+[r,g,b,getAlpha(a)].join(",")+")"}function toRgba(color){var rgba;return rgba=isHex(color)?hexToRgba(color):getRgbaIngredients(color),!!rgba&&rgbaToString(rgba.r,rgba.g,rgba.b,rgba.a)}function makeColorTransparent(color){var rgba;return isHex(color)?rgba=hexToRgba(color):"string"==typeof color?rgba=getRgbaIngredients(color):"object"==typeof color&&(rgba=void 0!==color.r&&color),!!rgba&&rgbaToString(rgba.r,rgba.g,rgba.b,0)}function illuminate(hex,lum){var rgb,c,i,illuminated="#";if(isTransparent(hex))return hex;if(isRgba(hex)&&(rgb=getRgbaIngredients(hex),hex=rgbToHex(rgb.r,rgb.g,rgb.b)),!isHex(hex)&&!isShortHex(hex))throw Error("Not hex color value provided");for(hex=String(hex).replace(/[^0-9a-f]/gi,""),lum=lum||0,hex.length<6&&(hex=hex[0]+hex[0]+hex[1]+hex[1]+hex[2]+hex[2]),i=0;i<3;i++)c=parseInt(hex.substr(2*i,2),16),c=Math.round(Math.min(Math.max(0,c+c*lum),255)).toString(16),illuminated+=("00"+c).substr(c.length);return illuminated}var TRANSPARENT="transparent",Color={isHex:isHex,isRgba:isRgba,isTransparent:isTransparent,hexToRgba:hexToRgba,rgbToHex:rgbToHex,rgbaStringToHex:rgbaStringToHex,rgbaToString:rgbaToString,getRgbaIngredients:getRgbaIngredients,toRgba:toRgba,illuminate:illuminate,makeColorTransparent:makeColorTransparent};return Color}()},{lodash:19}],218:[function(_dereq_,module,exports){"use strict";module.exports=function(){function log(type){return function(message){"undefined"!=typeof Rollbar&&Rollbar[type](message),"undefined"!=typeof console&&"function"==typeof console.error&&console.error(message)}}var TYPE={CRITICAL:"critical",INFO:"info",ERROR:"error"};return{critical:log(TYPE.CRITICAL),info:log(TYPE.INFO),error:log(TYPE.ERROR)}}()},{}],219:[function(_dereq_,module,exports){"use strict";module.exports=function(string){function RotateLeft(lValue,iShiftBits){return lValue<<iShiftBits|lValue>>>32-iShiftBits}function AddUnsigned(lX,lY){var lX4,lY4,lX8,lY8,lResult;return lX8=2147483648&lX,lY8=2147483648&lY,lX4=1073741824&lX,lY4=1073741824&lY,lResult=(1073741823&lX)+(1073741823&lY),lX4&lY4?2147483648^lResult^lX8^lY8:lX4|lY4?1073741824&lResult?3221225472^lResult^lX8^lY8:1073741824^lResult^lX8^lY8:lResult^lX8^lY8}function F(x,y,z){return x&y|~x&z}function G(x,y,z){return x&z|y&~z}function H(x,y,z){return x^y^z}function I(x,y,z){return y^(x|~z)}function FF(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(F(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function GG(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(G(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function HH(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(H(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function II(a,b,c,d,x,s,ac){return a=AddUnsigned(a,AddUnsigned(AddUnsigned(I(b,c,d),x),ac)),AddUnsigned(RotateLeft(a,s),b)}function ConvertToWordArray(string){for(var lWordCount,lMessageLength=string.length,lNumberOfWords_temp1=lMessageLength+8,lNumberOfWords_temp2=(lNumberOfWords_temp1-lNumberOfWords_temp1%64)/64,lNumberOfWords=16*(lNumberOfWords_temp2+1),lWordArray=Array(lNumberOfWords-1),lBytePosition=0,lByteCount=0;lByteCount<lMessageLength;)lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|string.charCodeAt(lByteCount)<<lBytePosition,lByteCount++;return lWordCount=(lByteCount-lByteCount%4)/4,lBytePosition=lByteCount%4*8,lWordArray[lWordCount]=lWordArray[lWordCount]|128<<lBytePosition,lWordArray[lNumberOfWords-2]=lMessageLength<<3,lWordArray[lNumberOfWords-1]=lMessageLength>>>29,lWordArray}function WordToHex(lValue){var lByte,lCount,WordToHexValue="",WordToHexValue_temp="";for(lCount=0;lCount<=3;lCount++)lByte=lValue>>>8*lCount&255,WordToHexValue_temp="0"+lByte.toString(16),WordToHexValue+=WordToHexValue_temp.substr(WordToHexValue_temp.length-2,2);return WordToHexValue}function Utf8Encode(string){string=string.replace(/\r\n/g,"\n");for(var utftext="",n=0;n<string.length;n++){var c=string.charCodeAt(n);c<128?utftext+=String.fromCharCode(c):c>127&&c<2048?(utftext+=String.fromCharCode(c>>6|192),utftext+=String.fromCharCode(63&c|128)):(utftext+=String.fromCharCode(c>>12|224),utftext+=String.fromCharCode(c>>6&63|128),utftext+=String.fromCharCode(63&c|128))}return utftext}var k,AA,BB,CC,DD,a,b,c,d,x=Array(),S11=7,S12=12,S13=17,S14=22,S21=5,S22=9,S23=14,S24=20,S31=4,S32=11,S33=16,S34=23,S41=6,S42=10,S43=15,S44=21;for(string=Utf8Encode(string),x=ConvertToWordArray(string),a=1732584193,b=4023233417,c=2562383102,d=271733878,k=0;k<x.length;k+=16)AA=a,BB=b,CC=c,DD=d,a=FF(a,b,c,d,x[k+0],S11,3614090360),d=FF(d,a,b,c,x[k+1],S12,3905402710),c=FF(c,d,a,b,x[k+2],S13,606105819),b=FF(b,c,d,a,x[k+3],S14,3250441966),a=FF(a,b,c,d,x[k+4],S11,4118548399),d=FF(d,a,b,c,x[k+5],S12,1200080426),c=FF(c,d,a,b,x[k+6],S13,2821735955),b=FF(b,c,d,a,x[k+7],S14,4249261313),a=FF(a,b,c,d,x[k+8],S11,1770035416),d=FF(d,a,b,c,x[k+9],S12,2336552879),c=FF(c,d,a,b,x[k+10],S13,4294925233),b=FF(b,c,d,a,x[k+11],S14,2304563134),a=FF(a,b,c,d,x[k+12],S11,1804603682),d=FF(d,a,b,c,x[k+13],S12,4254626195),c=FF(c,d,a,b,x[k+14],S13,2792965006),b=FF(b,c,d,a,x[k+15],S14,1236535329),a=GG(a,b,c,d,x[k+1],S21,4129170786),d=GG(d,a,b,c,x[k+6],S22,3225465664),c=GG(c,d,a,b,x[k+11],S23,643717713),b=GG(b,c,d,a,x[k+0],S24,3921069994),a=GG(a,b,c,d,x[k+5],S21,3593408605),d=GG(d,a,b,c,x[k+10],S22,38016083),c=GG(c,d,a,b,x[k+15],S23,3634488961),b=GG(b,c,d,a,x[k+4],S24,3889429448),a=GG(a,b,c,d,x[k+9],S21,568446438),d=GG(d,a,b,c,x[k+14],S22,3275163606),c=GG(c,d,a,b,x[k+3],S23,4107603335),b=GG(b,c,d,a,x[k+8],S24,1163531501),a=GG(a,b,c,d,x[k+13],S21,2850285829),d=GG(d,a,b,c,x[k+2],S22,4243563512),c=GG(c,d,a,b,x[k+7],S23,1735328473),b=GG(b,c,d,a,x[k+12],S24,2368359562),a=HH(a,b,c,d,x[k+5],S31,4294588738),d=HH(d,a,b,c,x[k+8],S32,2272392833),c=HH(c,d,a,b,x[k+11],S33,1839030562),b=HH(b,c,d,a,x[k+14],S34,4259657740),a=HH(a,b,c,d,x[k+1],S31,2763975236),d=HH(d,a,b,c,x[k+4],S32,1272893353),c=HH(c,d,a,b,x[k+7],S33,4139469664),b=HH(b,c,d,a,x[k+10],S34,3200236656),a=HH(a,b,c,d,x[k+13],S31,681279174),d=HH(d,a,b,c,x[k+0],S32,3936430074),c=HH(c,d,a,b,x[k+3],S33,3572445317),b=HH(b,c,d,a,x[k+6],S34,76029189),a=HH(a,b,c,d,x[k+9],S31,3654602809),d=HH(d,a,b,c,x[k+12],S32,3873151461),c=HH(c,d,a,b,x[k+15],S33,530742520),b=HH(b,c,d,a,x[k+2],S34,3299628645),a=II(a,b,c,d,x[k+0],S41,4096336452),d=II(d,a,b,c,x[k+7],S42,1126891415),c=II(c,d,a,b,x[k+14],S43,2878612391),b=II(b,c,d,a,x[k+5],S44,4237533241),a=II(a,b,c,d,x[k+12],S41,1700485571),d=II(d,a,b,c,x[k+3],S42,2399980690),c=II(c,d,a,b,x[k+10],S43,4293915773),b=II(b,c,d,a,x[k+1],S44,2240044497),a=II(a,b,c,d,x[k+8],S41,1873313359),d=II(d,a,b,c,x[k+15],S42,4264355552),c=II(c,d,a,b,x[k+6],S43,2734768916),b=II(b,c,d,a,x[k+13],S44,1309151649),a=II(a,b,c,d,x[k+4],S41,4149444226),d=II(d,a,b,c,x[k+11],S42,3174756917),c=II(c,d,a,b,x[k+2],S43,718787259),b=II(b,c,d,a,x[k+9],S44,3951481745),a=AddUnsigned(a,AA),b=AddUnsigned(b,BB),c=AddUnsigned(c,CC),d=AddUnsigned(d,DD);var temp=WordToHex(a)+WordToHex(b)+WordToHex(c)+WordToHex(d);return temp.toLowerCase()}},{}],220:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function toPx(value){return(parseInt(value,10)||0)+"px"}function toRealPx(value){return(parseFloat(value)||0)+"px"}function cloneDeep(obj){var cloned=_.clone(obj);return"object"==typeof obj&&_.forEach(obj,function(o,i){cloned[i]=cloneDeep(o)}),cloned}function getElementsMap(elements){return _.reduce(elements,function(map,element){return map[element.id]=element,map},{})}function backgroundImageString(backgroundImage){return backgroundImage?/^linear\-gradient/.test(backgroundImage)||/^radial\-gradient/.test(backgroundImage)?backgroundImage:"url("+backgroundImage+")":"none"}var Parse={toPx:toPx,toRealPx:toRealPx,cloneDeep:cloneDeep,getElementsMap:getElementsMap,backgroundImageString:backgroundImageString};return Parse}()},{lodash:19}],221:[function(_dereq_,module,exports){"use strict";var _=_dereq_("lodash");module.exports=function(){function ToHtml(template,params){return _.template(template)(params)}function ToDom(template,params){var container=document.createElement("div");return container.innerHTML=ToHtml(template,params),container.childNodes[0]}return Object.freeze({ToHtml:ToHtml,ToDom:ToDom})}()},{lodash:19}],222:[function(_dereq_,module,exports){"use strict";var Logger=_dereq_("./Logger"),localforage=_dereq_("localforage");module.exports=function(){function getStorage(){return _exceptionOccurred?_fallbackStorage:_storage}function Load(key){var storage=getStorage();return storage.get(key)}function Save(key,value){var storage=getStorage();storage.set(key,value)}function Update(key,property,value){var storage=getStorage();storage.get(key).then(function(data){data[property]=value,storage.set(key,data)})}var DB_NAME="uxpin",_exceptionOccurred=!1,_fallbackStorage=function(){var storageData={};return{get:function(key){return Promise.resolve(storageData[key])},set:function(key,value){storageData[key]=value}}}(),_storage=function(){var store=localforage.createInstance({name:DB_NAME,driver:[localforage.INDEXEDDB,localforage.WEBSQL]});return function(){var STORAGE_PREFIX="uxpeng_";try{for(var i=localStorage.length;--i>=0;){var key=localStorage.key(i);0===key.indexOf(STORAGE_PREFIX)&&localStorage.removeItem(key)}}catch(e){}}(),{get:function(key){return store.getItem(key).then(function(value){try{return JSON.parse(value)}catch(e){}return null})},set:function(key,value){return new Promise(function(){return store.setItem(key,JSON.stringify(value))["catch"](function(error){Logger.error(error),store.removeItem(key),_exceptionOccurred=!0,_fallbackStorage.set(key,value)})})}}}(),Storage={Load:Load,Save:Save,Update:Update};return Storage}()},{"./Logger":218,localforage:18}],223:[function(_dereq_,module,exports){"use strict";module.exports=function(){function getAncestors(element){for(var ancestors=[];element.parent;)ancestors.push(element.parent),element=element.parent;return ancestors}function IsAncestorOf(element,ancestor){return getAncestors(element).indexOf(ancestor)!==-1}function IsDescendantOf(element,descendant){return getAncestors(descendant).indexOf(element)!==-1}function GetRootElement(element,maxDepthParent){for(;element.parent&&!element.parent.isCanvas()&&element.parent!==maxDepthParent;)element=element.parent;return element}function GetAllAncestors(element){return getAncestors(element)}function GetAncestorGroup(element,maxDepthParent){for(var groups=[];element.parent&&!element.parent.isCanvas()&&element.parent!==maxDepthParent;)element=element.parent,element.isGroup()&&groups.unshift(element);return groups.length?groups[0]:maxDepthParent}function GetFirstAncestorGroup(element){return element.parent&&element.parent.isGroup()&&!element.parent.isCanvas()?element.parent:null}function GetClosestAncestor(element1,element2){for(var ancestor1,ancestor2,ancestors1=getAncestors(element1),ancestors2=getAncestors(element2),i=0;i<ancestors1.length;i++){ancestor1=ancestors1[i];for(var j=0;j<ancestors2.length;j++)if(ancestor2=ancestors2[j],ancestor1===ancestor2)return ancestor1}return null}function GetAllDescendants(element,descendants){var child;if(descendants||(descendants=[]),element.children)for(var i=0,len=element.children.length;i<len;i++)child=element.children[i],descendants.push(child),GetAllDescendants(child,descendants);return descendants}var Tree={IsAncestorOf:IsAncestorOf,IsDescendantOf:IsDescendantOf,GetRootElement:GetRootElement,GetAncestorGroup:GetAncestorGroup,GetFirstAncestorGroup:GetFirstAncestorGroup,GetClosestAncestor:GetClosestAncestor,GetAllDescendants:GetAllDescendants,GetAllAncestors:GetAllAncestors};return Tree}()},{}]},{},[23])(23)});
//# sourceMappingURL=maps/engine.js.map
